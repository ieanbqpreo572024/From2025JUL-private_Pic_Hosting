(()=>{var $E=Object.create;var l1=Object.defineProperty;var KE=Object.getOwnPropertyDescriptor;var JE=Object.getOwnPropertyNames;var QE=Object.getPrototypeOf,ZE=Object.prototype.hasOwnProperty;var c1=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var tt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var eA=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of JE(e))!ZE.call(t,n)&&n!==r&&l1(t,n,{get:()=>e[n],enumerable:!(o=KE(e,n))||o.enumerable});return t};var Fr=(t,e,r)=>(r=t!=null?$E(QE(t)):{},eA(e||!t||!t.__esModule?l1(r,"default",{value:t,enumerable:!0}):r,t));var $d=tt(()=>{});var Kd=tt(()=>{});var Jd=tt(()=>{});var f1=tt(Ce=>{var x=x||{version:"5.2.4"};typeof Ce<"u"?Ce.fabric=x:typeof define=="function"&&define.amd&&define([],function(){return x});typeof document<"u"&&typeof window<"u"?(document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?x.document=document:x.document=document.implementation.createHTMLDocument(""),x.window=window):(h1=$d(),Qd=new h1.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window,x.document=Qd.document,x.jsdomImplForWrapper=Kd().implForWrapper,x.nodeCanvas=Jd().Canvas,x.window=Qd,DOMParser=x.window.DOMParser);var h1,Qd;x.isTouchSupported="ontouchstart"in x.window||"ontouchstart"in x.document||x.window&&x.window.navigator&&x.window.navigator.maxTouchPoints>0;x.isLikelyNode=typeof Buffer<"u"&&typeof window>"u";x.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];x.DPI=96;x.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)";x.commaWsp="(?:\\s+,?\\s*|,\\s*)";x.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig;x.reNonWord=/[ \n\.,;!\?\-]/;x.fontPaths={};x.iMatrix=[1,0,0,1,0,0];x.svgNS="http://www.w3.org/2000/svg";x.perfLimitSizeTotal=2097152;x.maxCacheSideLimit=4096;x.minCacheSideLimit=256;x.charWidthsCache={};x.textureSize=2048;x.disableStyleCopyPaste=!1;x.enableGLFiltering=!0;x.devicePixelRatio=x.window.devicePixelRatio||x.window.webkitDevicePixelRatio||x.window.mozDevicePixelRatio||1;x.browserShadowBlurConstant=1;x.arcToSegmentsCache={};x.boundsOfCurveCache={};x.cachesBoundsOfCurve=!0;x.forceGLPutImageData=!1;x.initFilterBackend=function(){if(x.enableGLFiltering&&x.isWebglSupported&&x.isWebglSupported(x.textureSize))return console.log("max texture size: "+x.maxTextureSize),new x.WebglFilterBackend({tileSize:x.textureSize});if(x.Canvas2dFilterBackend)return new x.Canvas2dFilterBackend};typeof document<"u"&&typeof window<"u"&&(window.fabric=x);(function(){function t(i,a){if(this.__eventListeners[i]){var l=this.__eventListeners[i];a?l[l.indexOf(a)]=!1:x.util.array.fill(l,!1)}}function e(i,a){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var l in i)this.on(l,i[l]);else this.__eventListeners[i]||(this.__eventListeners[i]=[]),this.__eventListeners[i].push(a);return this}function r(i,a){var l=function(){a.apply(this,arguments),this.off(i,l)}.bind(this);this.on(i,l)}function o(i,a){if(arguments.length===1)for(var l in i)r.call(this,l,i[l]);else r.call(this,i,a);return this}function n(i,a){if(!this.__eventListeners)return this;if(arguments.length===0)for(i in this.__eventListeners)t.call(this,i);else if(arguments.length===1&&typeof arguments[0]=="object")for(var l in i)t.call(this,l,i[l]);else t.call(this,i,a);return this}function s(i,a){if(!this.__eventListeners)return this;var l=this.__eventListeners[i];if(!l)return this;for(var u=0,c=l.length;u<c;u++)l[u]&&l[u].call(this,a||{});return this.__eventListeners[i]=l.filter(function(h){return h!==!1}),this}x.Observable={fire:s,on:e,once:o,off:n}})();x.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(t,e,r){var o=this._objects;return r?o[e]=t:o.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var t=this._objects,e,r=!1,o=0,n=arguments.length;o<n;o++)e=t.indexOf(arguments[o]),e!==-1&&(r=!0,t.splice(e,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[o]));return this.renderOnAddRemove&&r&&this.requestRenderAll(),this},forEachObject:function(t,e){for(var r=this.getObjects(),o=0,n=r.length;o<n;o++)t.call(e,r[o],o,r);return this},getObjects:function(t){return typeof t>"u"?this._objects.concat():this._objects.filter(function(e){return e.type===t})},item:function(t){return this._objects[t]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(t,e){return this._objects.indexOf(t)>-1?!0:e?this._objects.some(function(r){return typeof r.contains=="function"&&r.contains(t,!0)}):!1},complexity:function(){return this._objects.reduce(function(t,e){return t+=e.complexity?e.complexity():0,t},0)}};x.CommonMethods={_setOptions:function(t){for(var e in t)this.set(e,t[e])},_initGradient:function(t,e){t&&t.colorStops&&!(t instanceof x.Gradient)&&this.set(e,new x.Gradient(t))},_initPattern:function(t,e,r){t&&t.source&&!(t instanceof x.Pattern)?this.set(e,new x.Pattern(t,r)):r&&r()},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return typeof t=="object"?this._setObject(t):this._set(t,e),this},_set:function(t,e){this[t]=e},toggle:function(t){var e=this.get(t);return typeof e=="boolean"&&this.set(t,!e),this},get:function(t){return this[t]}};(function(t){var e=Math.sqrt,r=Math.atan2,o=Math.pow,n=Math.PI/180,s=Math.PI/2;x.util={cos:function(i){if(i===0)return 1;i<0&&(i=-i);var a=i/s;switch(a){case 1:case 3:return 0;case 2:return-1}return Math.cos(i)},sin:function(i){if(i===0)return 0;var a=i/s,l=1;switch(i<0&&(l=-1),a){case 1:return l;case 2:return 0;case 3:return-l}return Math.sin(i)},removeFromArray:function(i,a){var l=i.indexOf(a);return l!==-1&&i.splice(l,1),i},getRandomInt:function(i,a){return Math.floor(Math.random()*(a-i+1))+i},degreesToRadians:function(i){return i*n},radiansToDegrees:function(i){return i/n},rotatePoint:function(i,a,l){var u=new x.Point(i.x-a.x,i.y-a.y),c=x.util.rotateVector(u,l);return new x.Point(c.x,c.y).addEquals(a)},rotateVector:function(i,a){var l=x.util.sin(a),u=x.util.cos(a),c=i.x*u-i.y*l,h=i.x*l+i.y*u;return{x:c,y:h}},createVector:function(i,a){return new x.Point(a.x-i.x,a.y-i.y)},calcAngleBetweenVectors:function(i,a){return Math.acos((i.x*a.x+i.y*a.y)/(Math.hypot(i.x,i.y)*Math.hypot(a.x,a.y)))},getHatVector:function(i){return new x.Point(i.x,i.y).multiply(1/Math.hypot(i.x,i.y))},getBisector:function(i,a,l){var u=x.util.createVector(i,a),c=x.util.createVector(i,l),h=x.util.calcAngleBetweenVectors(u,c),d=x.util.calcAngleBetweenVectors(x.util.rotateVector(u,h),c),g=h*(d===0?1:-1)/2;return{vector:x.util.getHatVector(x.util.rotateVector(u,g)),angle:h}},projectStrokeOnPoints:function(i,a,l){var u=[],c=a.strokeWidth/2,h=a.strokeUniform?new x.Point(1/a.scaleX,1/a.scaleY):new x.Point(1,1),d=function(g){var m=c/Math.hypot(g.x,g.y);return new x.Point(g.x*m*h.x,g.y*m*h.y)};return i.length<=1||i.forEach(function(g,m){var y=new x.Point(g.x,g.y),C,b;m===0?(b=i[m+1],C=l?d(x.util.createVector(b,y)).addEquals(y):i[i.length-1]):m===i.length-1?(C=i[m-1],b=l?d(x.util.createVector(C,y)).addEquals(y):i[0]):(C=i[m-1],b=i[m+1]);var k=x.util.getBisector(y,C,b),L=k.vector,N=k.angle,M,W;if(a.strokeLineJoin==="miter"&&(M=-c/Math.sin(N/2),W=new x.Point(L.x*M*h.x,L.y*M*h.y),Math.hypot(W.x,W.y)/c<=a.strokeMiterLimit)){u.push(y.add(W)),u.push(y.subtract(W));return}M=-c*Math.SQRT2,W=new x.Point(L.x*M*h.x,L.y*M*h.y),u.push(y.add(W)),u.push(y.subtract(W))}),u},transformPoint:function(i,a,l){return l?new x.Point(a[0]*i.x+a[2]*i.y,a[1]*i.x+a[3]*i.y):new x.Point(a[0]*i.x+a[2]*i.y+a[4],a[1]*i.x+a[3]*i.y+a[5])},makeBoundingBoxFromPoints:function(i,a){if(a)for(var l=0;l<i.length;l++)i[l]=x.util.transformPoint(i[l],a);var u=[i[0].x,i[1].x,i[2].x,i[3].x],c=x.util.array.min(u),h=x.util.array.max(u),d=h-c,g=[i[0].y,i[1].y,i[2].y,i[3].y],m=x.util.array.min(g),y=x.util.array.max(g),C=y-m;return{left:c,top:m,width:d,height:C}},invertTransform:function(i){var a=1/(i[0]*i[3]-i[1]*i[2]),l=[a*i[3],-a*i[1],-a*i[2],a*i[0]],u=x.util.transformPoint({x:i[4],y:i[5]},l,!0);return l[4]=-u.x,l[5]=-u.y,l},toFixed:function(i,a){return parseFloat(Number(i).toFixed(a))},parseUnit:function(i,a){var l=/\D{0,2}$/.exec(i),u=parseFloat(i);switch(a||(a=x.Text.DEFAULT_SVG_FONT_SIZE),l[0]){case"mm":return u*x.DPI/25.4;case"cm":return u*x.DPI/2.54;case"in":return u*x.DPI;case"pt":return u*x.DPI/72;case"pc":return u*x.DPI/72*12;case"em":return u*a;default:return u}},falseFunction:function(){return!1},getKlass:function(i,a){return i=x.util.string.camelize(i.charAt(0).toUpperCase()+i.slice(1)),x.util.resolveNamespace(a)[i]},getSvgAttributes:function(i){var a=["instantiated_by_use","style","id","class"];switch(i){case"linearGradient":a=a.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":a=a.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":a=a.concat(["offset","stop-color","stop-opacity"]);break}return a},resolveNamespace:function(i){if(!i)return x;var a=i.split("."),l=a.length,u,c=t||x.window;for(u=0;u<l;++u)c=c[a[u]];return c},loadImage:function(i,a,l,u){if(!i){a&&a.call(l,i);return}var c=x.util.createImage(),h=function(){a&&a.call(l,c,!1),c=c.onload=c.onerror=null};c.onload=h,c.onerror=function(){x.log("Error loading "+c.src),a&&a.call(l,null,!0),c=c.onload=c.onerror=null},i.indexOf("data")!==0&&u!==void 0&&u!==null&&(c.crossOrigin=u),i.substring(0,14)==="data:image/svg"&&(c.onload=null,x.util.loadImageInDom(c,h)),c.src=i},loadImageInDom:function(i,a){var l=x.document.createElement("div");l.style.width=l.style.height="1px",l.style.left=l.style.top="-100%",l.style.position="absolute",l.appendChild(i),x.document.querySelector("body").appendChild(l),i.onload=function(){a(),l.parentNode.removeChild(l),l=null}},enlivenObjects:function(i,a,l,u){i=i||[];var c=[],h=0,d=i.length;function g(){++h===d&&a&&a(c.filter(function(m){return m}))}if(!d){a&&a(c);return}i.forEach(function(m,y){if(!m||!m.type){g();return}var C=x.util.getKlass(m.type,l);C.fromObject(m,function(b,k){k||(c[y]=b),u&&u(m,b,k),g()})})},enlivenObjectEnlivables:function(i,a,l){var u=x.Object.ENLIVEN_PROPS.filter(function(c){return!!i[c]});x.util.enlivenObjects(u.map(function(c){return i[c]}),function(c){var h={};u.forEach(function(d,g){h[d]=c[g],a&&(a[d]=c[g])}),l&&l(h)})},enlivenPatterns:function(i,a){i=i||[];function l(){++c===h&&a&&a(u)}var u=[],c=0,h=i.length;if(!h){a&&a(u);return}i.forEach(function(d,g){d&&d.source?new x.Pattern(d,function(m){u[g]=m,l()}):(u[g]=d,l())})},groupSVGElements:function(i,a,l){var u;return i&&i.length===1?(typeof l<"u"&&(i[0].sourcePath=l),i[0]):(a&&(a.width&&a.height?a.centerPoint={x:a.width/2,y:a.height/2}:(delete a.width,delete a.height)),u=new x.Group(i,a),typeof l<"u"&&(u.sourcePath=l),u)},populateWithProperties:function(i,a,l){if(l&&Array.isArray(l))for(var u=0,c=l.length;u<c;u++)l[u]in i&&(a[l[u]]=i[l[u]])},createCanvasElement:function(){return x.document.createElement("canvas")},copyCanvasElement:function(i){var a=x.util.createCanvasElement();return a.width=i.width,a.height=i.height,a.getContext("2d").drawImage(i,0,0),a},toDataURL:function(i,a,l){return i.toDataURL("image/"+a,l)},createImage:function(){return x.document.createElement("img")},multiplyTransformMatrices:function(i,a,l){return[i[0]*a[0]+i[2]*a[1],i[1]*a[0]+i[3]*a[1],i[0]*a[2]+i[2]*a[3],i[1]*a[2]+i[3]*a[3],l?0:i[0]*a[4]+i[2]*a[5]+i[4],l?0:i[1]*a[4]+i[3]*a[5]+i[5]]},qrDecompose:function(i){var a=r(i[1],i[0]),l=o(i[0],2)+o(i[1],2),u=e(l),c=(i[0]*i[3]-i[2]*i[1])/u,h=r(i[0]*i[2]+i[1]*i[3],l);return{angle:a/n,scaleX:u,scaleY:c,skewX:h/n,skewY:0,translateX:i[4],translateY:i[5]}},calcRotateMatrix:function(i){if(!i.angle)return x.iMatrix.concat();var a=x.util.degreesToRadians(i.angle),l=x.util.cos(a),u=x.util.sin(a);return[l,u,-u,l,0,0]},calcDimensionsMatrix:function(i){var a=typeof i.scaleX>"u"?1:i.scaleX,l=typeof i.scaleY>"u"?1:i.scaleY,u=[i.flipX?-a:a,0,0,i.flipY?-l:l,0,0],c=x.util.multiplyTransformMatrices,h=x.util.degreesToRadians;return i.skewX&&(u=c(u,[1,0,Math.tan(h(i.skewX)),1],!0)),i.skewY&&(u=c(u,[1,Math.tan(h(i.skewY)),0,1],!0)),u},composeMatrix:function(i){var a=[1,0,0,1,i.translateX||0,i.translateY||0],l=x.util.multiplyTransformMatrices;return i.angle&&(a=l(a,x.util.calcRotateMatrix(i))),(i.scaleX!==1||i.scaleY!==1||i.skewX||i.skewY||i.flipX||i.flipY)&&(a=l(a,x.util.calcDimensionsMatrix(i))),a},resetObjectTransform:function(i){i.scaleX=1,i.scaleY=1,i.skewX=0,i.skewY=0,i.flipX=!1,i.flipY=!1,i.rotate(0)},saveObjectTransform:function(i){return{scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,angle:i.angle,left:i.left,flipX:i.flipX,flipY:i.flipY,top:i.top}},isTransparent:function(i,a,l,u){u>0&&(a>u?a-=u:a=0,l>u?l-=u:l=0);var c=!0,h,d,g=i.getImageData(a,l,u*2||1,u*2||1),m=g.data.length;for(h=3;h<m&&(d=g.data[h],c=d<=0,c!==!1);h+=4);return g=null,c},parsePreserveAspectRatioAttribute:function(i){var a="meet",l="Mid",u="Mid",c=i.split(" "),h;return c&&c.length&&(a=c.pop(),a!=="meet"&&a!=="slice"?(h=a,a="meet"):c.length&&(h=c.pop())),l=h!=="none"?h.slice(1,4):"none",u=h!=="none"?h.slice(5,8):"none",{meetOrSlice:a,alignX:l,alignY:u}},clearFabricFontCache:function(i){i=(i||"").toLowerCase(),i?x.charWidthsCache[i]&&delete x.charWidthsCache[i]:x.charWidthsCache={}},limitDimsByArea:function(i,a){var l=Math.sqrt(a*i),u=Math.floor(a/l);return{x:Math.floor(l),y:u}},capValue:function(i,a,l){return Math.max(i,Math.min(a,l))},findScaleToFit:function(i,a){return Math.min(a.width/i.width,a.height/i.height)},findScaleToCover:function(i,a){return Math.max(a.width/i.width,a.height/i.height)},matrixToSVG:function(i){return"matrix("+i.map(function(a){return x.util.toFixed(a,x.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(i,a){var l=x.util.invertTransform(a),u=x.util.multiplyTransformMatrices(l,i.calcOwnMatrix());x.util.applyTransformToObject(i,u)},addTransformToObject:function(i,a){x.util.applyTransformToObject(i,x.util.multiplyTransformMatrices(a,i.calcOwnMatrix()))},applyTransformToObject:function(i,a){var l=x.util.qrDecompose(a),u=new x.Point(l.translateX,l.translateY);i.flipX=!1,i.flipY=!1,i.set("scaleX",l.scaleX),i.set("scaleY",l.scaleY),i.skewX=l.skewX,i.skewY=l.skewY,i.angle=l.angle,i.setPositionByOrigin(u,"center","center")},sizeAfterTransform:function(i,a,l){var u=i/2,c=a/2,h=[{x:-u,y:-c},{x:u,y:-c},{x:-u,y:c},{x:u,y:c}],d=x.util.calcDimensionsMatrix(l),g=x.util.makeBoundingBoxFromPoints(h,d);return{x:g.width,y:g.height}},mergeClipPaths:function(i,a){var l=i,u=a;l.inverted&&!u.inverted&&(l=a,u=i),x.util.applyTransformToObject(u,x.util.multiplyTransformMatrices(x.util.invertTransform(l.calcTransformMatrix()),u.calcTransformMatrix()));var c=l.inverted&&u.inverted;return c&&(l.inverted=u.inverted=!1),new x.Group([l],{clipPath:u,inverted:c})},hasStyleChanged:function(i,a,l){return l=l||!1,i.fill!==a.fill||i.stroke!==a.stroke||i.strokeWidth!==a.strokeWidth||i.fontSize!==a.fontSize||i.fontFamily!==a.fontFamily||i.fontWeight!==a.fontWeight||i.fontStyle!==a.fontStyle||i.deltaY!==a.deltaY||l&&(i.overline!==a.overline||i.underline!==a.underline||i.linethrough!==a.linethrough)},stylesToArray:function(l,a){for(var l=x.util.object.clone(l,!0),u=a.split(`
`),c=-1,h={},d=[],g=0;g<u.length;g++){if(!l[g]){c+=u[g].length;continue}for(var m=0;m<u[g].length;m++){c++;var y=l[g][m];if(y){var C=x.util.hasStyleChanged(h,y,!0);C?d.push({start:c,end:c+1,style:y}):d[d.length-1].end++}h=y||{}}}return d},stylesFromArray:function(i,a){if(!Array.isArray(i))return i;for(var l=a.split(`
`),u=-1,c=0,h={},d=0;d<l.length;d++)for(var g=0;g<l[d].length;g++)u++,i[c]&&i[c].start<=u&&u<i[c].end&&(h[d]=h[d]||{},h[d][g]=Object.assign({},i[c].style),u===i[c].end-1&&c++);return h}}})(Ce);(function(){var t=Array.prototype.join,e={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},r={m:"l",M:"L"};function o(w,F,P,I,H,S,_,O,j,V,z){var X=x.util.cos(w),q=x.util.sin(w),ae=x.util.cos(F),$=x.util.sin(F),U=P*H*ae-I*S*$+_,te=I*H*ae+P*S*$+O,ee=V+j*(-P*H*q-I*S*X),Q=z+j*(-I*H*q+P*S*X),ne=U+j*(P*H*$+I*S*ae),ce=te+j*(I*H*$-P*S*ae);return["C",ee,Q,ne,ce,U,te]}function n(w,F,P,I,H,S,_){var O=Math.PI,j=_*O/180,V=x.util.sin(j),z=x.util.cos(j),X=0,q=0;P=Math.abs(P),I=Math.abs(I);var ae=-z*w*.5-V*F*.5,$=-z*F*.5+V*w*.5,U=P*P,te=I*I,ee=$*$,Q=ae*ae,ne=U*te-U*ee-te*Q,ce=0;if(ne<0){var Ee=Math.sqrt(1-ne/(U*te));P*=Ee,I*=Ee}else ce=(H===S?-1:1)*Math.sqrt(ne/(U*ee+te*Q));var we=ce*P*$/I,re=-ce*I*ae/P,ye=z*we-V*re+w*.5,Te=V*we+z*re+F*.5,Be=s(1,0,(ae-we)/P,($-re)/I),Ue=s((ae-we)/P,($-re)/I,(-ae-we)/P,(-$-re)/I);S===0&&Ue>0?Ue-=2*O:S===1&&Ue<0&&(Ue+=2*O);for(var Me=Math.ceil(Math.abs(Ue/O*2)),at=[],Qe=Ue/Me,Lt=8/3*Math.sin(Qe/4)*Math.sin(Qe/4)/Math.sin(Qe/2),Zt=Be+Qe,wt=0;wt<Me;wt++)at[wt]=o(Be,Zt,z,V,P,I,ye,Te,Lt,X,q),X=at[wt][5],q=at[wt][6],Be=Zt,Zt+=Qe;return at}function s(w,F,P,I){var H=Math.atan2(F,w),S=Math.atan2(I,P);return S>=H?S-H:2*Math.PI-(H-S)}function i(w,F,P,I,H,S,_,O){var j;if(x.cachesBoundsOfCurve&&(j=t.call(arguments),x.boundsOfCurveCache[j]))return x.boundsOfCurveCache[j];var V=Math.sqrt,z=Math.min,X=Math.max,q=Math.abs,ae=[],$=[[],[]],U,te,ee,Q,ne,ce,Ee,we;te=6*w-12*P+6*H,U=-3*w+9*P-9*H+3*_,ee=3*P-3*w;for(var re=0;re<2;++re){if(re>0&&(te=6*F-12*I+6*S,U=-3*F+9*I-9*S+3*O,ee=3*I-3*F),q(U)<1e-12){if(q(te)<1e-12)continue;Q=-ee/te,0<Q&&Q<1&&ae.push(Q);continue}Ee=te*te-4*ee*U,!(Ee<0)&&(we=V(Ee),ne=(-te+we)/(2*U),0<ne&&ne<1&&ae.push(ne),ce=(-te-we)/(2*U),0<ce&&ce<1&&ae.push(ce))}for(var ye,Te,Be=ae.length,Ue=Be,Me;Be--;)Q=ae[Be],Me=1-Q,ye=Me*Me*Me*w+3*Me*Me*Q*P+3*Me*Q*Q*H+Q*Q*Q*_,$[0][Be]=ye,Te=Me*Me*Me*F+3*Me*Me*Q*I+3*Me*Q*Q*S+Q*Q*Q*O,$[1][Be]=Te;$[0][Ue]=w,$[1][Ue]=F,$[0][Ue+1]=_,$[1][Ue+1]=O;var at=[{x:z.apply(null,$[0]),y:z.apply(null,$[1])},{x:X.apply(null,$[0]),y:X.apply(null,$[1])}];return x.cachesBoundsOfCurve&&(x.boundsOfCurveCache[j]=at),at}function a(w,F,P){for(var I=P[1],H=P[2],S=P[3],_=P[4],O=P[5],j=P[6],V=P[7],z=n(j-w,V-F,I,H,_,O,S),X=0,q=z.length;X<q;X++)z[X][1]+=w,z[X][2]+=F,z[X][3]+=w,z[X][4]+=F,z[X][5]+=w,z[X][6]+=F;return z}function l(w){var F=0,P=0,I=w.length,H=0,S=0,_,O,j,V=[],z,X,q;for(O=0;O<I;++O){switch(j=!1,_=w[O].slice(0),_[0]){case"l":_[0]="L",_[1]+=F,_[2]+=P;case"L":F=_[1],P=_[2];break;case"h":_[1]+=F;case"H":_[0]="L",_[2]=P,F=_[1];break;case"v":_[1]+=P;case"V":_[0]="L",P=_[1],_[1]=F,_[2]=P;break;case"m":_[0]="M",_[1]+=F,_[2]+=P;case"M":F=_[1],P=_[2],H=_[1],S=_[2];break;case"c":_[0]="C",_[1]+=F,_[2]+=P,_[3]+=F,_[4]+=P,_[5]+=F,_[6]+=P;case"C":X=_[3],q=_[4],F=_[5],P=_[6];break;case"s":_[0]="S",_[1]+=F,_[2]+=P,_[3]+=F,_[4]+=P;case"S":z==="C"?(X=2*F-X,q=2*P-q):(X=F,q=P),F=_[3],P=_[4],_[0]="C",_[5]=_[3],_[6]=_[4],_[3]=_[1],_[4]=_[2],_[1]=X,_[2]=q,X=_[3],q=_[4];break;case"q":_[0]="Q",_[1]+=F,_[2]+=P,_[3]+=F,_[4]+=P;case"Q":X=_[1],q=_[2],F=_[3],P=_[4];break;case"t":_[0]="T",_[1]+=F,_[2]+=P;case"T":z==="Q"?(X=2*F-X,q=2*P-q):(X=F,q=P),_[0]="Q",F=_[1],P=_[2],_[1]=X,_[2]=q,_[3]=F,_[4]=P;break;case"a":_[0]="A",_[6]+=F,_[7]+=P;case"A":j=!0,V=V.concat(a(F,P,_)),F=_[6],P=_[7];break;case"z":case"Z":F=H,P=S;break;default:}j||V.push(_),z=_[0]}return V}function u(w,F,P,I){return Math.sqrt((P-w)*(P-w)+(I-F)*(I-F))}function c(w){return w*w*w}function h(w){return 3*w*w*(1-w)}function d(w){return 3*w*(1-w)*(1-w)}function g(w){return(1-w)*(1-w)*(1-w)}function m(w,F,P,I,H,S,_,O){return function(j){var V=c(j),z=h(j),X=d(j),q=g(j);return{x:_*V+H*z+P*X+w*q,y:O*V+S*z+I*X+F*q}}}function y(w,F,P,I,H,S,_,O){return function(j){var V=1-j,z=3*V*V*(P-w)+6*V*j*(H-P)+3*j*j*(_-H),X=3*V*V*(I-F)+6*V*j*(S-I)+3*j*j*(O-S);return Math.atan2(X,z)}}function C(w){return w*w}function b(w){return 2*w*(1-w)}function k(w){return(1-w)*(1-w)}function L(w,F,P,I,H,S){return function(_){var O=C(_),j=b(_),V=k(_);return{x:H*O+P*j+w*V,y:S*O+I*j+F*V}}}function N(w,F,P,I,H,S){return function(_){var O=1-_,j=2*O*(P-w)+2*_*(H-P),V=2*O*(I-F)+2*_*(S-I);return Math.atan2(V,j)}}function M(w,F,P){var I={x:F,y:P},H,S=0,_;for(_=1;_<=100;_+=1)H=w(_/100),S+=u(I.x,I.y,H.x,H.y),I=H;return S}function W(w,F){for(var P=0,I=0,H=w.iterator,S={x:w.x,y:w.y},_,O,j=.01,V=w.angleFinder,z;I<F&&j>1e-4;)_=H(P),z=P,O=u(S.x,S.y,_.x,_.y),O+I>F?(P-=j,j/=2):(S=_,P+=j,I+=O);return _.angle=V(z),_}function Y(w){for(var F=0,P=w.length,I,H=0,S=0,_=0,O=0,j=[],V,z,X,q=0;q<P;q++){switch(I=w[q],z={x:H,y:S,command:I[0]},I[0]){case"M":z.length=0,_=H=I[1],O=S=I[2];break;case"L":z.length=u(H,S,I[1],I[2]),H=I[1],S=I[2];break;case"C":V=m(H,S,I[1],I[2],I[3],I[4],I[5],I[6]),X=y(H,S,I[1],I[2],I[3],I[4],I[5],I[6]),z.iterator=V,z.angleFinder=X,z.length=M(V,H,S),H=I[5],S=I[6];break;case"Q":V=L(H,S,I[1],I[2],I[3],I[4]),X=N(H,S,I[1],I[2],I[3],I[4]),z.iterator=V,z.angleFinder=X,z.length=M(V,H,S),H=I[3],S=I[4];break;case"Z":case"z":z.destX=_,z.destY=O,z.length=u(H,S,_,O),H=_,S=O;break}F+=z.length,j.push(z)}return j.push({length:F,x:H,y:S}),j}function J(w,F,P){P||(P=Y(w));for(var I=0;F-P[I].length>0&&I<P.length-2;)F-=P[I].length,I++;var H=P[I],S=F/H.length,_=H.command,O=w[I],j;switch(_){case"M":return{x:H.x,y:H.y,angle:0};case"Z":case"z":return j=new x.Point(H.x,H.y).lerp(new x.Point(H.destX,H.destY),S),j.angle=Math.atan2(H.destY-H.y,H.destX-H.x),j;case"L":return j=new x.Point(H.x,H.y).lerp(new x.Point(O[1],O[2]),S),j.angle=Math.atan2(O[2]-H.y,O[1]-H.x),j;case"C":return W(H,F);case"Q":return W(H,F)}}function oe(w){var F=[],P=[],I,H,S=x.rePathCommand,_="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",O="("+_+")"+x.commaWsp,j="([01])"+x.commaWsp+"?",V=O+"?"+O+"?"+O+j+j+O+"?("+_+")",z=new RegExp(V,"g"),X,q,ae;if(!w||!w.match)return F;ae=w.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var $=0,U,te=ae.length;$<te;$++){I=ae[$],q=I.slice(1).trim(),P.length=0;var ee=I.charAt(0);if(U=[ee],ee.toLowerCase()==="a")for(var Q;Q=z.exec(q);)for(var ne=1;ne<Q.length;ne++)P.push(Q[ne]);else for(;X=S.exec(q);)P.push(X[0]);for(var ne=0,ce=P.length;ne<ce;ne++)H=parseFloat(P[ne]),isNaN(H)||U.push(H);var Ee=e[ee.toLowerCase()],we=r[ee]||ee;if(U.length-1>Ee)for(var re=1,ye=U.length;re<ye;re+=Ee)F.push([ee].concat(U.slice(re,re+Ee))),ee=we;else F.push(U)}return F}function pe(w,F){var P=[],I,H=new x.Point(w[0].x,w[0].y),S=new x.Point(w[1].x,w[1].y),_=w.length,O=1,j=0,V=_>2;for(F=F||0,V&&(O=w[2].x<S.x?-1:w[2].x===S.x?0:1,j=w[2].y<S.y?-1:w[2].y===S.y?0:1),P.push(["M",H.x-O*F,H.y-j*F]),I=1;I<_;I++){if(!H.eq(S)){var z=H.midPointFrom(S);P.push(["Q",H.x,H.y,z.x,z.y])}H=w[I],I+1<w.length&&(S=w[I+1])}return V&&(O=H.x>w[I-2].x?1:H.x===w[I-2].x?0:-1,j=H.y>w[I-2].y?1:H.y===w[I-2].y?0:-1),P.push(["L",H.x+O*F,H.y+j*F]),P}function le(w,F,P){return P&&(F=x.util.multiplyTransformMatrices(F,[1,0,0,1,-P.x,-P.y])),w.map(function(I){for(var H=I.slice(0),S={},_=1;_<I.length-1;_+=2)S.x=I[_],S.y=I[_+1],S=x.util.transformPoint(S,F),H[_]=S.x,H[_+1]=S.y;return H})}x.util.joinPath=function(w){return w.map(function(F){return F.join(" ")}).join(" ")},x.util.parsePath=oe,x.util.makePathSimpler=l,x.util.getSmoothPathFromPoints=pe,x.util.getPathSegmentsInfo=Y,x.util.getBoundsOfCurve=i,x.util.getPointOnPath=J,x.util.transformPath=le})();(function(){var t=Array.prototype.slice;function e(i,a){for(var l=t.call(arguments,2),u=[],c=0,h=i.length;c<h;c++)u[c]=l.length?i[c][a].apply(i[c],l):i[c][a].call(i[c]);return u}function r(i,a){return s(i,a,function(l,u){return l>=u})}function o(i,a){return s(i,a,function(l,u){return l<u})}function n(i,a){for(var l=i.length;l--;)i[l]=a;return i}function s(i,a,l){if(!(!i||i.length===0)){var u=i.length-1,c=a?i[u][a]:i[u];if(a)for(;u--;)l(i[u][a],c)&&(c=i[u][a]);else for(;u--;)l(i[u],c)&&(c=i[u]);return c}}x.util.array={fill:n,invoke:e,min:o,max:r}})();(function(){function t(r,o,n){if(n)if(!x.isLikelyNode&&o instanceof Element)r=o;else if(o instanceof Array){r=[];for(var s=0,i=o.length;s<i;s++)r[s]=t({},o[s],n)}else if(o&&typeof o=="object")for(var a in o)a==="canvas"||a==="group"?r[a]=null:o.hasOwnProperty(a)&&(r[a]=t({},o[a],n));else r=o;else for(var a in o)r[a]=o[a];return r}function e(r,o){return t({},r,o)}x.util.object={extend:t,clone:e},x.util.object.extend(x.util,x.Observable)})();(function(){function t(s){return s.replace(/-+(.)?/g,function(i,a){return a?a.toUpperCase():""})}function e(s,i){return s.charAt(0).toUpperCase()+(i?s.slice(1):s.slice(1).toLowerCase())}function r(s){return s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function o(s){var i=0,a,l=[];for(i=0,a;i<s.length;i++)(a=n(s,i))!==!1&&l.push(a);return l}function n(s,i){var a=s.charCodeAt(i);if(isNaN(a))return"";if(a<55296||a>57343)return s.charAt(i);if(55296<=a&&a<=56319){if(s.length<=i+1)throw"High surrogate without following low surrogate";var l=s.charCodeAt(i+1);if(56320>l||l>57343)throw"High surrogate without following low surrogate";return s.charAt(i)+s.charAt(i+1)}if(i===0)throw"Low surrogate without preceding high surrogate";var u=s.charCodeAt(i-1);if(55296>u||u>56319)throw"Low surrogate without preceding high surrogate";return!1}x.util.string={camelize:t,capitalize:e,escapeXml:r,graphemeSplit:o}})();(function(){var t=Array.prototype.slice,e=function(){},r=function(){for(var a in{toString:1})if(a==="toString")return!1;return!0}(),o=function(a,l,u){for(var c in l)c in a.prototype&&typeof a.prototype[c]=="function"&&(l[c]+"").indexOf("callSuper")>-1?a.prototype[c]=function(h){return function(){var d=this.constructor.superclass;this.constructor.superclass=u;var g=l[h].apply(this,arguments);if(this.constructor.superclass=d,h!=="initialize")return g}}(c):a.prototype[c]=l[c],r&&(l.toString!==Object.prototype.toString&&(a.prototype.toString=l.toString),l.valueOf!==Object.prototype.valueOf&&(a.prototype.valueOf=l.valueOf))};function n(){}function s(a){for(var l=null,u=this;u.constructor.superclass;){var c=u.constructor.superclass.prototype[a];if(u[a]!==c){l=c;break}u=u.constructor.superclass.prototype}return l?arguments.length>1?l.apply(this,t.call(arguments,1)):l.call(this):console.log("tried to callSuper "+a+", method not found in prototype chain",this)}function i(){var a=null,l=t.call(arguments,0);typeof l[0]=="function"&&(a=l.shift());function u(){this.initialize.apply(this,arguments)}u.superclass=a,u.subclasses=[],a&&(n.prototype=a.prototype,u.prototype=new n,a.subclasses.push(u));for(var c=0,h=l.length;c<h;c++)o(u,l[c],a);return u.prototype.initialize||(u.prototype.initialize=e),u.prototype.constructor=u,u.prototype.callSuper=s,u}x.util.createClass=i})();(function(){var t=!!x.document.createElement("div").attachEvent,e=["touchstart","touchmove","touchend"];x.util.addListener=function(o,n,s,i){o&&o.addEventListener(n,s,t?!1:i)},x.util.removeListener=function(o,n,s,i){o&&o.removeEventListener(n,s,t?!1:i)};function r(o){var n=o.changedTouches;return n&&n[0]?n[0]:o}x.util.getPointer=function(o){var n=o.target,s=x.util.getScrollLeftTop(n),i=r(o);return{x:i.clientX+s.left,y:i.clientY+s.top}},x.util.isTouchEvent=function(o){return e.indexOf(o.type)>-1||o.pointerType==="touch"}})();(function(){function t(i,a){var l=i.style;if(!l)return i;if(typeof a=="string")return i.style.cssText+=";"+a,a.indexOf("opacity")>-1?s(i,a.match(/opacity:\s*(\d?\.?\d*)/)[1]):i;for(var u in a)if(u==="opacity")s(i,a[u]);else{var c=u==="float"||u==="cssFloat"?typeof l.styleFloat>"u"?"cssFloat":"styleFloat":u;l.setProperty(c,a[u])}return i}var e=x.document.createElement("div"),r=typeof e.style.opacity=="string",o=typeof e.style.filter=="string",n=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,s=function(i){return i};r?s=function(i,a){return i.style.opacity=a,i}:o&&(s=function(i,a){var l=i.style;return i.currentStyle&&!i.currentStyle.hasLayout&&(l.zoom=1),n.test(l.filter)?(a=a>=.9999?"":"alpha(opacity="+a*100+")",l.filter=l.filter.replace(n,a)):l.filter+=" alpha(opacity="+a*100+")",i}),x.util.setStyle=t})();(function(){var t=Array.prototype.slice;function e(g){return typeof g=="string"?x.document.getElementById(g):g}var r,o=function(g){return t.call(g,0)};try{r=o(x.document.childNodes)instanceof Array}catch{}r||(o=function(g){for(var m=new Array(g.length),y=g.length;y--;)m[y]=g[y];return m});function n(g,m){var y=x.document.createElement(g);for(var C in m)C==="class"?y.className=m[C]:C==="for"?y.htmlFor=m[C]:y.setAttribute(C,m[C]);return y}function s(g,m){g&&(" "+g.className+" ").indexOf(" "+m+" ")===-1&&(g.className+=(g.className?" ":"")+m)}function i(g,m,y){return typeof m=="string"&&(m=n(m,y)),g.parentNode&&g.parentNode.replaceChild(m,g),m.appendChild(g),m}function a(g){for(var m=0,y=0,C=x.document.documentElement,b=x.document.body||{scrollLeft:0,scrollTop:0};g&&(g.parentNode||g.host)&&(g=g.parentNode||g.host,g===x.document?(m=b.scrollLeft||C.scrollLeft||0,y=b.scrollTop||C.scrollTop||0):(m+=g.scrollLeft||0,y+=g.scrollTop||0),!(g.nodeType===1&&g.style.position==="fixed")););return{left:m,top:y}}function l(g){var m,y=g&&g.ownerDocument,C={left:0,top:0},b={left:0,top:0},k,L={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!y)return b;for(var N in L)b[L[N]]+=parseInt(u(g,N),10)||0;return m=y.documentElement,typeof g.getBoundingClientRect<"u"&&(C=g.getBoundingClientRect()),k=a(g),{left:C.left+k.left-(m.clientLeft||0)+b.left,top:C.top+k.top-(m.clientTop||0)+b.top}}var u;x.document.defaultView&&x.document.defaultView.getComputedStyle?u=function(g,m){var y=x.document.defaultView.getComputedStyle(g,null);return y?y[m]:void 0}:u=function(g,m){var y=g.style[m];return!y&&g.currentStyle&&(y=g.currentStyle[m]),y},function(){var g=x.document.documentElement.style,m="userSelect"in g?"userSelect":"MozUserSelect"in g?"MozUserSelect":"WebkitUserSelect"in g?"WebkitUserSelect":"KhtmlUserSelect"in g?"KhtmlUserSelect":"";function y(b){return typeof b.onselectstart<"u"&&(b.onselectstart=x.util.falseFunction),m?b.style[m]="none":typeof b.unselectable=="string"&&(b.unselectable="on"),b}function C(b){return typeof b.onselectstart<"u"&&(b.onselectstart=null),m?b.style[m]="":typeof b.unselectable=="string"&&(b.unselectable=""),b}x.util.makeElementUnselectable=y,x.util.makeElementSelectable=C}();function c(g){var m=x.jsdomImplForWrapper(g);return m._canvas||m._image}function h(g){if(x.isLikelyNode){var m=x.jsdomImplForWrapper(g);m&&(m._image=null,m._canvas=null,m._currentSrc=null,m._attributes=null,m._classList=null)}}function d(g,m){g.imageSmoothingEnabled=g.imageSmoothingEnabled||g.webkitImageSmoothingEnabled||g.mozImageSmoothingEnabled||g.msImageSmoothingEnabled||g.oImageSmoothingEnabled,g.imageSmoothingEnabled=m}x.util.setImageSmoothing=d,x.util.getById=e,x.util.toArray=o,x.util.addClass=s,x.util.makeElement=n,x.util.wrapElement=i,x.util.getScrollLeftTop=a,x.util.getElementOffset=l,x.util.getNodeCanvas=c,x.util.cleanUpJsdomNode=h})();(function(){function t(o,n){return o+(/\?/.test(o)?"&":"?")+n}function e(){}function r(o,n){n||(n={});var s=n.method?n.method.toUpperCase():"GET",i=n.onComplete||function(){},a=new x.window.XMLHttpRequest,l=n.body||n.parameters;return a.onreadystatechange=function(){a.readyState===4&&(i(a),a.onreadystatechange=e)},s==="GET"&&(l=null,typeof n.parameters=="string"&&(o=t(o,n.parameters))),a.open(s,o,!0),(s==="POST"||s==="PUT")&&a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(l),a}x.util.request=r})();x.log=console.log;x.warn=console.warn;(function(){var t=x.util.object.extend,e=x.util.object.clone,r=[];x.util.object.extend(r,{cancelAll:function(){var c=this.splice(0);return c.forEach(function(h){h.cancel()}),c},cancelByCanvas:function(c){if(!c)return[];var h=this.filter(function(d){return typeof d.target=="object"&&d.target.canvas===c});return h.forEach(function(d){d.cancel()}),h},cancelByTarget:function(c){var h=this.findAnimationsByTarget(c);return h.forEach(function(d){d.cancel()}),h},findAnimationIndex:function(c){return this.indexOf(this.findAnimation(c))},findAnimation:function(c){return this.find(function(h){return h.cancel===c})},findAnimationsByTarget:function(c){return c?this.filter(function(h){return h.target===c}):[]}});function o(){return!1}function n(c,h,d,g){return-d*Math.cos(c/g*(Math.PI/2))+d+h}function s(c){c||(c={});var h=!1,d,g=function(){var m=x.runningAnimations.indexOf(d);return m>-1&&x.runningAnimations.splice(m,1)[0]};return d=t(e(c),{cancel:function(){return h=!0,g()},currentValue:"startValue"in c?c.startValue:0,completionRate:0,durationRate:0}),x.runningAnimations.push(d),l(function(m){var y=m||+new Date,C=c.duration||500,b=y+C,k,L=c.onChange||o,N=c.abort||o,M=c.onComplete||o,W=c.easing||n,Y="startValue"in c?c.startValue.length>0:!1,J="startValue"in c?c.startValue:0,oe="endValue"in c?c.endValue:100,pe=c.byValue||(Y?J.map(function(le,w){return oe[w]-J[w]}):oe-J);c.onStart&&c.onStart(),function le(w){k=w||+new Date;var F=k>b?C:k-y,P=F/C,I=Y?J.map(function(S,_){return W(F,J[_],pe[_],C)}):W(F,J,pe,C),H=Math.abs(Y?(I[0]-J[0])/pe[0]:(I-J)/pe);if(d.currentValue=Y?I.slice():I,d.completionRate=H,d.durationRate=P,!h){if(N(I,H,P)){g();return}if(k>b){d.currentValue=Y?oe.slice():oe,d.completionRate=1,d.durationRate=1,L(Y?oe.slice():oe,1,1),M(oe,1,1),g();return}else L(I,H,P),l(le)}}(y)}),d.cancel}var i=x.window.requestAnimationFrame||x.window.webkitRequestAnimationFrame||x.window.mozRequestAnimationFrame||x.window.oRequestAnimationFrame||x.window.msRequestAnimationFrame||function(c){return x.window.setTimeout(c,1e3/60)},a=x.window.cancelAnimationFrame||x.window.clearTimeout;function l(){return i.apply(x.window,arguments)}function u(){return a.apply(x.window,arguments)}x.util.animate=s,x.util.requestAnimFrame=l,x.util.cancelAnimFrame=u,x.runningAnimations=r})();(function(){function t(r,o,n){var s="rgba("+parseInt(r[0]+n*(o[0]-r[0]),10)+","+parseInt(r[1]+n*(o[1]-r[1]),10)+","+parseInt(r[2]+n*(o[2]-r[2]),10);return s+=","+(r&&o?parseFloat(r[3]+n*(o[3]-r[3])):1),s+=")",s}function e(r,o,n,s){var i=new x.Color(r).getSource(),a=new x.Color(o).getSource(),l=s.onComplete,u=s.onChange;return s=s||{},x.util.animate(x.util.object.extend(s,{duration:n||500,startValue:i,endValue:a,byValue:a,easing:function(c,h,d,g){var m=s.colorEasing?s.colorEasing(c,g):1-Math.cos(c/g*(Math.PI/2));return t(h,d,m)},onComplete:function(c,h,d){if(l)return l(t(a,a,0),h,d)},onChange:function(c,h,d){if(u){if(Array.isArray(c))return u(t(c,c,0),h,d);u(c,h,d)}}}))}x.util.animateColor=e})();(function(){function t(w,F,P,I){return w<Math.abs(F)?(w=F,I=P/4):F===0&&w===0?I=P/(2*Math.PI)*Math.asin(1):I=P/(2*Math.PI)*Math.asin(F/w),{a:w,c:F,p:P,s:I}}function e(w,F,P){return w.a*Math.pow(2,10*(F-=1))*Math.sin((F*P-w.s)*(2*Math.PI)/w.p)}function r(w,F,P,I){return P*((w=w/I-1)*w*w+1)+F}function o(w,F,P,I){return w/=I/2,w<1?P/2*w*w*w+F:P/2*((w-=2)*w*w+2)+F}function n(w,F,P,I){return P*(w/=I)*w*w*w+F}function s(w,F,P,I){return-P*((w=w/I-1)*w*w*w-1)+F}function i(w,F,P,I){return w/=I/2,w<1?P/2*w*w*w*w+F:-P/2*((w-=2)*w*w*w-2)+F}function a(w,F,P,I){return P*(w/=I)*w*w*w*w+F}function l(w,F,P,I){return P*((w=w/I-1)*w*w*w*w+1)+F}function u(w,F,P,I){return w/=I/2,w<1?P/2*w*w*w*w*w+F:P/2*((w-=2)*w*w*w*w+2)+F}function c(w,F,P,I){return-P*Math.cos(w/I*(Math.PI/2))+P+F}function h(w,F,P,I){return P*Math.sin(w/I*(Math.PI/2))+F}function d(w,F,P,I){return-P/2*(Math.cos(Math.PI*w/I)-1)+F}function g(w,F,P,I){return w===0?F:P*Math.pow(2,10*(w/I-1))+F}function m(w,F,P,I){return w===I?F+P:P*(-Math.pow(2,-10*w/I)+1)+F}function y(w,F,P,I){return w===0?F:w===I?F+P:(w/=I/2,w<1?P/2*Math.pow(2,10*(w-1))+F:P/2*(-Math.pow(2,-10*--w)+2)+F)}function C(w,F,P,I){return-P*(Math.sqrt(1-(w/=I)*w)-1)+F}function b(w,F,P,I){return P*Math.sqrt(1-(w=w/I-1)*w)+F}function k(w,F,P,I){return w/=I/2,w<1?-P/2*(Math.sqrt(1-w*w)-1)+F:P/2*(Math.sqrt(1-(w-=2)*w)+1)+F}function L(w,F,P,I){var H=1.70158,S=0,_=P;if(w===0)return F;if(w/=I,w===1)return F+P;S||(S=I*.3);var O=t(_,P,S,H);return-e(O,w,I)+F}function N(w,F,P,I){var H=1.70158,S=0,_=P;if(w===0)return F;if(w/=I,w===1)return F+P;S||(S=I*.3);var O=t(_,P,S,H);return O.a*Math.pow(2,-10*w)*Math.sin((w*I-O.s)*(2*Math.PI)/O.p)+O.c+F}function M(w,F,P,I){var H=1.70158,S=0,_=P;if(w===0)return F;if(w/=I/2,w===2)return F+P;S||(S=I*(.3*1.5));var O=t(_,P,S,H);return w<1?-.5*e(O,w,I)+F:O.a*Math.pow(2,-10*(w-=1))*Math.sin((w*I-O.s)*(2*Math.PI)/O.p)*.5+O.c+F}function W(w,F,P,I,H){return H===void 0&&(H=1.70158),P*(w/=I)*w*((H+1)*w-H)+F}function Y(w,F,P,I,H){return H===void 0&&(H=1.70158),P*((w=w/I-1)*w*((H+1)*w+H)+1)+F}function J(w,F,P,I,H){return H===void 0&&(H=1.70158),w/=I/2,w<1?P/2*(w*w*(((H*=1.525)+1)*w-H))+F:P/2*((w-=2)*w*(((H*=1.525)+1)*w+H)+2)+F}function oe(w,F,P,I){return P-pe(I-w,0,P,I)+F}function pe(w,F,P,I){return(w/=I)<1/2.75?P*(7.5625*w*w)+F:w<2/2.75?P*(7.5625*(w-=1.5/2.75)*w+.75)+F:w<2.5/2.75?P*(7.5625*(w-=2.25/2.75)*w+.9375)+F:P*(7.5625*(w-=2.625/2.75)*w+.984375)+F}function le(w,F,P,I){return w<I/2?oe(w*2,0,P,I)*.5+F:pe(w*2-I,0,P,I)*.5+P*.5+F}x.util.ease={easeInQuad:function(w,F,P,I){return P*(w/=I)*w+F},easeOutQuad:function(w,F,P,I){return-P*(w/=I)*(w-2)+F},easeInOutQuad:function(w,F,P,I){return w/=I/2,w<1?P/2*w*w+F:-P/2*(--w*(w-2)-1)+F},easeInCubic:function(w,F,P,I){return P*(w/=I)*w*w+F},easeOutCubic:r,easeInOutCubic:o,easeInQuart:n,easeOutQuart:s,easeInOutQuart:i,easeInQuint:a,easeOutQuint:l,easeInOutQuint:u,easeInSine:c,easeOutSine:h,easeInOutSine:d,easeInExpo:g,easeOutExpo:m,easeInOutExpo:y,easeInCirc:C,easeOutCirc:b,easeInOutCirc:k,easeInElastic:L,easeOutElastic:N,easeInOutElastic:M,easeInBack:W,easeOutBack:Y,easeInOutBack:J,easeInBounce:oe,easeOutBounce:pe,easeInOutBounce:le}})();(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,o=e.util.object.clone,n=e.util.toFixed,s=e.util.parseUnit,i=e.util.multiplyTransformMatrices,a=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],l=["symbol","image","marker","pattern","view","svg"],u=["pattern","defs","symbol","metadata","clipPath","mask","desc"],c=["symbol","g","a","svg","clipPath","defs"],h={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},d={stroke:"strokeOpacity",fill:"fillOpacity"},g="font-size",m="clip-path";e.svgValidTagNamesRegEx=b(a),e.svgViewBoxElementsRegEx=b(l),e.svgInvalidAncestorsRegEx=b(u),e.svgValidParentsRegEx=b(c),e.cssRules={},e.gradientDefs={},e.clipPaths={};function y(S){return S in h?h[S]:S}function C(S,_,O,j){var V=Array.isArray(_),z;if((S==="fill"||S==="stroke")&&_==="none")_="";else{if(S==="strokeUniform")return _==="non-scaling-stroke";if(S==="strokeDashArray")_==="none"?_=null:_=_.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(S==="transformMatrix")O&&O.transformMatrix?_=i(O.transformMatrix,e.parseTransformAttribute(_)):_=e.parseTransformAttribute(_);else if(S==="visible")_=_!=="none"&&_!=="hidden",O&&O.visible===!1&&(_=!1);else if(S==="opacity")_=parseFloat(_),O&&typeof O.opacity<"u"&&(_*=O.opacity);else if(S==="textAnchor")_=_==="start"?"left":_==="end"?"right":"center";else if(S==="charSpacing")z=s(_,j)/j*1e3;else if(S==="paintFirst"){var X=_.indexOf("fill"),q=_.indexOf("stroke"),_="fill";(X>-1&&q>-1&&q<X||X===-1&&q>-1)&&(_="stroke")}else{if(S==="href"||S==="xlink:href"||S==="font")return _;if(S==="imageSmoothing")return _==="optimizeQuality";z=V?_.map(s):s(_,j)}}return!V&&isNaN(z)?_:z}function b(S){return new RegExp("^("+S.join("|")+")\\b","i")}function k(S){for(var _ in d)if(!(typeof S[d[_]]>"u"||S[_]==="")){if(typeof S[_]>"u"){if(!e.Object.prototype[_])continue;S[_]=e.Object.prototype[_]}if(S[_].indexOf("url(")!==0){var O=new e.Color(S[_]);S[_]=O.setAlpha(n(O.getAlpha()*S[d[_]],2)).toRgba()}}return S}function L(S,_){var O,j=[],V,z,X;for(z=0,X=_.length;z<X;z++)O=_[z],V=S.getElementsByTagName(O),j=j.concat(Array.prototype.slice.call(V));return j}e.parseTransformAttribute=function(){function S(re,ye){var Te=e.util.cos(ye[0]),Be=e.util.sin(ye[0]),Ue=0,Me=0;ye.length===3&&(Ue=ye[1],Me=ye[2]),re[0]=Te,re[1]=Be,re[2]=-Be,re[3]=Te,re[4]=Ue-(Te*Ue-Be*Me),re[5]=Me-(Be*Ue+Te*Me)}function _(re,ye){var Te=ye[0],Be=ye.length===2?ye[1]:ye[0];re[0]=Te,re[3]=Be}function O(re,ye,Te){re[Te]=Math.tan(e.util.degreesToRadians(ye[0]))}function j(re,ye){re[4]=ye[0],ye.length===2&&(re[5]=ye[1])}var V=e.iMatrix,z=e.reNum,X=e.commaWsp,q="(?:(skewX)\\s*\\(\\s*("+z+")\\s*\\))",ae="(?:(skewY)\\s*\\(\\s*("+z+")\\s*\\))",$="(?:(rotate)\\s*\\(\\s*("+z+")(?:"+X+"("+z+")"+X+"("+z+"))?\\s*\\))",U="(?:(scale)\\s*\\(\\s*("+z+")(?:"+X+"("+z+"))?\\s*\\))",te="(?:(translate)\\s*\\(\\s*("+z+")(?:"+X+"("+z+"))?\\s*\\))",ee="(?:(matrix)\\s*\\(\\s*("+z+")"+X+"("+z+")"+X+"("+z+")"+X+"("+z+")"+X+"("+z+")"+X+"("+z+")\\s*\\))",Q="(?:"+ee+"|"+te+"|"+U+"|"+$+"|"+q+"|"+ae+")",ne="(?:"+Q+"(?:"+X+"*"+Q+")*)",ce="^\\s*(?:"+ne+"?)\\s*$",Ee=new RegExp(ce),we=new RegExp(Q,"g");return function(re){var ye=V.concat(),Te=[];if(!re||re&&!Ee.test(re))return ye;re.replace(we,function(Ue){var Me=new RegExp(Q).exec(Ue).filter(function(Lt){return!!Lt}),at=Me[1],Qe=Me.slice(2).map(parseFloat);switch(at){case"translate":j(ye,Qe);break;case"rotate":Qe[0]=e.util.degreesToRadians(Qe[0]),S(ye,Qe);break;case"scale":_(ye,Qe);break;case"skewX":O(ye,Qe,2);break;case"skewY":O(ye,Qe,1);break;case"matrix":ye=Qe;break}Te.push(ye.concat()),ye=V.concat()});for(var Be=Te[0];Te.length>1;)Te.shift(),Be=e.util.multiplyTransformMatrices(Be,Te[0]);return Be}}();function N(S,_){var O,j;S.replace(/;\s*$/,"").split(";").forEach(function(V){var z=V.split(":");O=z[0].trim().toLowerCase(),j=z[1].trim(),_[O]=j})}function M(S,_){var O,j;for(var V in S)typeof S[V]>"u"||(O=V.toLowerCase(),j=S[V],_[O]=j)}function W(S,_){var O={};for(var j in e.cssRules[_])if(Y(S,j.split(" ")))for(var V in e.cssRules[_][j])O[V]=e.cssRules[_][j][V];return O}function Y(S,_){var O,j=!0;return O=oe(S,_.pop()),O&&_.length&&(j=J(S,_)),O&&j&&_.length===0}function J(S,_){for(var O,j=!0;S.parentNode&&S.parentNode.nodeType===1&&_.length;)j&&(O=_.pop()),S=S.parentNode,j=oe(S,O);return _.length===0}function oe(S,_){var O=S.nodeName,j=S.getAttribute("class"),V=S.getAttribute("id"),z,X;if(z=new RegExp("^"+O,"i"),_=_.replace(z,""),V&&_.length&&(z=new RegExp("#"+V+"(?![a-zA-Z\\-]+)","i"),_=_.replace(z,"")),j&&_.length)for(j=j.split(" "),X=j.length;X--;)z=new RegExp("\\."+j[X]+"(?![a-zA-Z\\-]+)","i"),_=_.replace(z,"");return _.length===0}function pe(S,_){var O;if(S.getElementById&&(O=S.getElementById(_)),O)return O;var j,V,z,X=S.getElementsByTagName("*");for(V=0,z=X.length;V<z;V++)if(j=X[V],_===j.getAttribute("id"))return j}function le(S){for(var _=L(S,["use","svg:use"]),O=0;_.length&&O<_.length;){var j=_[O],V=j.getAttribute("xlink:href")||j.getAttribute("href");if(V===null)return;var z=V.slice(1),X=j.getAttribute("x")||0,q=j.getAttribute("y")||0,ae=pe(S,z).cloneNode(!0),$=(ae.getAttribute("transform")||"")+" translate("+X+", "+q+")",U,te=_.length,ee,Q,ne,ce,Ee=e.svgNS;if(F(ae),/^svg$/i.test(ae.nodeName)){var we=ae.ownerDocument.createElementNS(Ee,"g");for(Q=0,ne=ae.attributes,ce=ne.length;Q<ce;Q++)ee=ne.item(Q),we.setAttributeNS(Ee,ee.nodeName,ee.nodeValue);for(;ae.firstChild;)we.appendChild(ae.firstChild);ae=we}for(Q=0,ne=j.attributes,ce=ne.length;Q<ce;Q++)ee=ne.item(Q),!(ee.nodeName==="x"||ee.nodeName==="y"||ee.nodeName==="xlink:href"||ee.nodeName==="href")&&(ee.nodeName==="transform"?$=ee.nodeValue+" "+$:ae.setAttribute(ee.nodeName,ee.nodeValue));ae.setAttribute("transform",$),ae.setAttribute("instantiated_by_use","1"),ae.removeAttribute("id"),U=j.parentNode,U.replaceChild(ae,j),_.length===te&&O++}}var w=new RegExp("^\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*$");function F(S){if(!e.svgViewBoxElementsRegEx.test(S.nodeName))return{};var _=S.getAttribute("viewBox"),O=1,j=1,V=0,z=0,X,q,ae,$,U=S.getAttribute("width"),te=S.getAttribute("height"),ee=S.getAttribute("x")||0,Q=S.getAttribute("y")||0,ne=S.getAttribute("preserveAspectRatio")||"",ce=!_||!(_=_.match(w)),Ee=!U||!te||U==="100%"||te==="100%",we=ce&&Ee,re={},ye="",Te=0,Be=0;if(re.width=0,re.height=0,re.toBeParsed=we,ce&&(ee||Q)&&S.parentNode&&S.parentNode.nodeName!=="#document"&&(ye=" translate("+s(ee)+" "+s(Q)+") ",ae=(S.getAttribute("transform")||"")+ye,S.setAttribute("transform",ae),S.removeAttribute("x"),S.removeAttribute("y")),we)return re;if(ce)return re.width=s(U),re.height=s(te),re;if(V=-parseFloat(_[1]),z=-parseFloat(_[2]),X=parseFloat(_[3]),q=parseFloat(_[4]),re.minX=V,re.minY=z,re.viewBoxWidth=X,re.viewBoxHeight=q,Ee?(re.width=X,re.height=q):(re.width=s(U),re.height=s(te),O=re.width/X,j=re.height/q),ne=e.util.parsePreserveAspectRatioAttribute(ne),ne.alignX!=="none"&&(ne.meetOrSlice==="meet"&&(j=O=O>j?j:O),ne.meetOrSlice==="slice"&&(j=O=O>j?O:j),Te=re.width-X*O,Be=re.height-q*O,ne.alignX==="Mid"&&(Te/=2),ne.alignY==="Mid"&&(Be/=2),ne.alignX==="Min"&&(Te=0),ne.alignY==="Min"&&(Be=0)),O===1&&j===1&&V===0&&z===0&&ee===0&&Q===0)return re;if((ee||Q)&&S.parentNode.nodeName!=="#document"&&(ye=" translate("+s(ee)+" "+s(Q)+") "),ae=ye+" matrix("+O+" 0 0 "+j+" "+(V*O+Te)+" "+(z*j+Be)+") ",S.nodeName==="svg"){for($=S.ownerDocument.createElementNS(e.svgNS,"g");S.firstChild;)$.appendChild(S.firstChild);S.appendChild($)}else $=S,$.removeAttribute("x"),$.removeAttribute("y"),ae=$.getAttribute("transform")+ae;return $.setAttribute("transform",ae),re}function P(S,_){for(;S&&(S=S.parentNode);)if(S.nodeName&&_.test(S.nodeName.replace("svg:",""))&&!S.getAttribute("instantiated_by_use"))return!0;return!1}e.parseSVGDocument=function(S,_,O,j){if(S){le(S);var V=e.Object.__uid++,z,X,q=F(S),ae=e.util.toArray(S.getElementsByTagName("*"));if(q.crossOrigin=j&&j.crossOrigin,q.svgUid=V,ae.length===0&&e.isLikelyNode){ae=S.selectNodes('//*[name(.)!="svg"]');var $=[];for(z=0,X=ae.length;z<X;z++)$[z]=ae[z];ae=$}var U=ae.filter(function(ee){return F(ee),e.svgValidTagNamesRegEx.test(ee.nodeName.replace("svg:",""))&&!P(ee,e.svgInvalidAncestorsRegEx)});if(!U||U&&!U.length){_&&_([],{});return}var te={};ae.filter(function(ee){return ee.nodeName.replace("svg:","")==="clipPath"}).forEach(function(ee){var Q=ee.getAttribute("id");te[Q]=e.util.toArray(ee.getElementsByTagName("*")).filter(function(ne){return e.svgValidTagNamesRegEx.test(ne.nodeName.replace("svg:",""))})}),e.gradientDefs[V]=e.getGradientDefs(S),e.cssRules[V]=e.getCSSRules(S),e.clipPaths[V]=te,e.parseElements(U,function(ee,Q){_&&(_(ee,q,Q,ae),delete e.gradientDefs[V],delete e.cssRules[V],delete e.clipPaths[V])},o(q),O,j)}};function I(S,_){var O=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],j="xlink:href",V=_.getAttribute(j).slice(1),z=pe(S,V);if(z&&z.getAttribute(j)&&I(S,z),O.forEach(function(q){z&&!_.hasAttribute(q)&&z.hasAttribute(q)&&_.setAttribute(q,z.getAttribute(q))}),!_.children.length)for(var X=z.cloneNode(!0);X.firstChild;)_.appendChild(X.firstChild);_.removeAttribute(j)}var H=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+e.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+e.reNum+"))?\\s+(.*)");r(e,{parseFontDeclaration:function(S,_){var O=S.match(H);if(O){var j=O[1],V=O[3],z=O[4],X=O[5],q=O[6];j&&(_.fontStyle=j),V&&(_.fontWeight=isNaN(parseFloat(V))?V:parseFloat(V)),z&&(_.fontSize=s(z)),q&&(_.fontFamily=q),X&&(_.lineHeight=X==="normal"?1:X)}},getGradientDefs:function(S){var _=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],O=L(S,_),j,V=0,z={};for(V=O.length;V--;)j=O[V],j.getAttribute("xlink:href")&&I(S,j),z[j.getAttribute("id")]=j;return z},parseAttributes:function(S,_,O){if(S){var j,V={},z,X;typeof O>"u"&&(O=S.getAttribute("svgUid")),S.parentNode&&e.svgValidParentsRegEx.test(S.parentNode.nodeName)&&(V=e.parseAttributes(S.parentNode,_,O));var q=_.reduce(function(ne,ce){return j=S.getAttribute(ce),j&&(ne[ce]=j),ne},{}),ae=r(W(S,O),e.parseStyleAttribute(S));q=r(q,ae),ae[m]&&S.setAttribute(m,ae[m]),z=X=V.fontSize||e.Text.DEFAULT_SVG_FONT_SIZE,q[g]&&(q[g]=z=s(q[g],X));var $,U,te={};for(var ee in q)$=y(ee),U=C($,q[ee],V,z),te[$]=U;te&&te.font&&e.parseFontDeclaration(te.font,te);var Q=r(V,te);return e.svgValidParentsRegEx.test(S.nodeName)?Q:k(Q)}},parseElements:function(S,_,O,j,V){new e.ElementsParser(S,_,O,j,V).parse()},parseStyleAttribute:function(S){var _={},O=S.getAttribute("style");return O&&(typeof O=="string"?N(O,_):M(O,_)),_},parsePointsAttribute:function(S){if(!S)return null;S=S.replace(/,/g," ").trim(),S=S.split(/\s+/);var _=[],O,j;for(O=0,j=S.length;O<j;O+=2)_.push({x:parseFloat(S[O]),y:parseFloat(S[O+1])});return _},getCSSRules:function(S){var _=S.getElementsByTagName("style"),O,j,V={},z;for(O=0,j=_.length;O<j;O++){var X=_[O].textContent;X=X.replace(/\/\*[\s\S]*?\*\//g,""),X.trim()!==""&&(z=X.split("}"),z=z.filter(function(q){return q.trim()}),z.forEach(function(q){var ae=q.split("{"),$={},U=ae[1].trim(),te=U.split(";").filter(function(ce){return ce.trim()});for(O=0,j=te.length;O<j;O++){var ee=te[O].split(":"),Q=ee[0].trim(),ne=ee[1].trim();$[Q]=ne}q=ae[0].trim(),q.split(",").forEach(function(ce){ce=ce.replace(/^svg/i,"").trim(),ce!==""&&(V[ce]?e.util.object.extend(V[ce],$):V[ce]=e.util.object.clone($))})}))}return V},loadSVGFromURL:function(S,_,O,j){S=S.replace(/^\n\s*/,"").trim(),new e.util.request(S,{method:"get",onComplete:V});function V(z){var X=z.responseXML;if(!X||!X.documentElement)return _&&_(null),!1;e.parseSVGDocument(X.documentElement,function(q,ae,$,U){_&&_(q,ae,$,U)},O,j)}},loadSVGFromString:function(S,_,O,j){var V=new e.window.DOMParser,z=V.parseFromString(S.trim(),"text/xml");e.parseSVGDocument(z.documentElement,function(X,q,ae,$){_(X,q,ae,$)},O,j)}})})(Ce);x.ElementsParser=function(t,e,r,o,n,s){this.elements=t,this.callback=e,this.options=r,this.reviver=o,this.svgUid=r&&r.svgUid||0,this.parsingOptions=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=s};(function(t){t.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},t.createObjects=function(){var e=this;this.elements.forEach(function(r,o){r.setAttribute("svgUid",e.svgUid),e.createObject(r,o)})},t.findTag=function(e){return x[x.util.string.capitalize(e.tagName.replace("svg:",""))]},t.createObject=function(e,r){var o=this.findTag(e);if(o&&o.fromElement)try{o.fromElement(e,this.createCallback(r,e),this.options)}catch(n){x.log(n)}else this.checkIfDone()},t.createCallback=function(e,r){var o=this;return function(n){var s;o.resolveGradient(n,r,"fill"),o.resolveGradient(n,r,"stroke"),n instanceof x.Image&&n._originalElement&&(s=n.parsePreserveAspectRatioAttribute(r)),n._removeTransformMatrix(s),o.resolveClipPath(n,r),o.reviver&&o.reviver(r,n),o.instances[e]=n,o.checkIfDone()}},t.extractPropertyDefinition=function(e,r,o){var n=e[r],s=this.regexUrl;if(s.test(n)){s.lastIndex=0;var i=s.exec(n)[1];return s.lastIndex=0,x[o][this.svgUid][i]}},t.resolveGradient=function(e,r,o){var n=this.extractPropertyDefinition(e,o,"gradientDefs");if(n){var s=r.getAttribute(o+"-opacity"),i=x.Gradient.fromElement(n,e,s,this.options);e.set(o,i)}},t.createClipPathCallback=function(e,r){return function(o){o._removeTransformMatrix(),o.fillRule=o.clipRule,r.push(o)}},t.resolveClipPath=function(e,r){var o=this.extractPropertyDefinition(e,"clipPath","clipPaths"),n,s,i,a,l,u;if(o){a=[],i=x.util.invertTransform(e.calcTransformMatrix());for(var c=o[0].parentNode,h=r;h.parentNode&&h.getAttribute("clip-path")!==e.clipPath;)h=h.parentNode;h.parentNode.appendChild(c);for(var d=0;d<o.length;d++)n=o[d],s=this.findTag(n),s.fromElement(n,this.createClipPathCallback(e,a),this.options);a.length===1?o=a[0]:o=new x.Group(a),l=x.util.multiplyTransformMatrices(i,o.calcTransformMatrix()),o.clipPath&&this.resolveClipPath(o,h);var u=x.util.qrDecompose(l);o.flipX=!1,o.flipY=!1,o.set("scaleX",u.scaleX),o.set("scaleY",u.scaleY),o.angle=u.angle,o.skewX=u.skewX,o.skewY=0,o.setPositionByOrigin({x:u.translateX,y:u.translateY},"center","center"),e.clipPath=o}else delete e.clipPath},t.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(e){return e!=null}),this.callback(this.instances,this.elements))}})(x.ElementsParser.prototype);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Point){e.warn("fabric.Point is already defined");return}e.Point=r;function r(o,n){this.x=o,this.y=n}r.prototype={type:"point",constructor:r,add:function(o){return new r(this.x+o.x,this.y+o.y)},addEquals:function(o){return this.x+=o.x,this.y+=o.y,this},scalarAdd:function(o){return new r(this.x+o,this.y+o)},scalarAddEquals:function(o){return this.x+=o,this.y+=o,this},subtract:function(o){return new r(this.x-o.x,this.y-o.y)},subtractEquals:function(o){return this.x-=o.x,this.y-=o.y,this},scalarSubtract:function(o){return new r(this.x-o,this.y-o)},scalarSubtractEquals:function(o){return this.x-=o,this.y-=o,this},multiply:function(o){return new r(this.x*o,this.y*o)},multiplyEquals:function(o){return this.x*=o,this.y*=o,this},divide:function(o){return new r(this.x/o,this.y/o)},divideEquals:function(o){return this.x/=o,this.y/=o,this},eq:function(o){return this.x===o.x&&this.y===o.y},lt:function(o){return this.x<o.x&&this.y<o.y},lte:function(o){return this.x<=o.x&&this.y<=o.y},gt:function(o){return this.x>o.x&&this.y>o.y},gte:function(o){return this.x>=o.x&&this.y>=o.y},lerp:function(o,n){return typeof n>"u"&&(n=.5),n=Math.max(Math.min(1,n),0),new r(this.x+(o.x-this.x)*n,this.y+(o.y-this.y)*n)},distanceFrom:function(o){var n=this.x-o.x,s=this.y-o.y;return Math.sqrt(n*n+s*s)},midPointFrom:function(o){return this.lerp(o)},min:function(o){return new r(Math.min(this.x,o.x),Math.min(this.y,o.y))},max:function(o){return new r(Math.max(this.x,o.x),Math.max(this.y,o.y))},toString:function(){return this.x+","+this.y},setXY:function(o,n){return this.x=o,this.y=n,this},setX:function(o){return this.x=o,this},setY:function(o){return this.y=o,this},setFromPoint:function(o){return this.x=o.x,this.y=o.y,this},swap:function(o){var n=this.x,s=this.y;this.x=o.x,this.y=o.y,o.x=n,o.y=s},clone:function(){return new r(this.x,this.y)}}})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Intersection){e.warn("fabric.Intersection is already defined");return}function r(o){this.status=o,this.points=[]}e.Intersection=r,e.Intersection.prototype={constructor:r,appendPoint:function(o){return this.points.push(o),this},appendPoints:function(o){return this.points=this.points.concat(o),this}},e.Intersection.intersectLineLine=function(o,n,s,i){var a,l=(i.x-s.x)*(o.y-s.y)-(i.y-s.y)*(o.x-s.x),u=(n.x-o.x)*(o.y-s.y)-(n.y-o.y)*(o.x-s.x),c=(i.y-s.y)*(n.x-o.x)-(i.x-s.x)*(n.y-o.y);if(c!==0){var h=l/c,d=u/c;0<=h&&h<=1&&0<=d&&d<=1?(a=new r("Intersection"),a.appendPoint(new e.Point(o.x+h*(n.x-o.x),o.y+h*(n.y-o.y)))):a=new r}else l===0||u===0?a=new r("Coincident"):a=new r("Parallel");return a},e.Intersection.intersectLinePolygon=function(o,n,s){var i=new r,a=s.length,l,u,c,h;for(h=0;h<a;h++)l=s[h],u=s[(h+1)%a],c=r.intersectLineLine(o,n,l,u),i.appendPoints(c.points);return i.points.length>0&&(i.status="Intersection"),i},e.Intersection.intersectPolygonPolygon=function(o,n){var s=new r,i=o.length,a;for(a=0;a<i;a++){var l=o[a],u=o[(a+1)%i],c=r.intersectLinePolygon(l,u,n);s.appendPoints(c.points)}return s.points.length>0&&(s.status="Intersection"),s},e.Intersection.intersectPolygonRectangle=function(o,n,s){var i=n.min(s),a=n.max(s),l=new e.Point(a.x,i.y),u=new e.Point(i.x,a.y),c=r.intersectLinePolygon(i,l,o),h=r.intersectLinePolygon(l,a,o),d=r.intersectLinePolygon(a,u,o),g=r.intersectLinePolygon(u,i,o),m=new r;return m.appendPoints(c.points),m.appendPoints(h.points),m.appendPoints(d.points),m.appendPoints(g.points),m.points.length>0&&(m.status="Intersection"),m}})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Color){e.warn("fabric.Color is already defined.");return}function r(n){n?this._tryParsingColor(n):this.setSource([0,0,0,1])}e.Color=r,e.Color.prototype={_tryParsingColor:function(n){var s;n in r.colorNameMap&&(n=r.colorNameMap[n]),n==="transparent"&&(s=[255,255,255,0]),s||(s=r.sourceFromHex(n)),s||(s=r.sourceFromRgb(n)),s||(s=r.sourceFromHsl(n)),s||(s=[0,0,0,1]),s&&this.setSource(s)},_rgbToHsl:function(n,s,i){n/=255,s/=255,i/=255;var a,l,u,c=e.util.array.max([n,s,i]),h=e.util.array.min([n,s,i]);if(u=(c+h)/2,c===h)a=l=0;else{var d=c-h;switch(l=u>.5?d/(2-c-h):d/(c+h),c){case n:a=(s-i)/d+(s<i?6:0);break;case s:a=(i-n)/d+2;break;case i:a=(n-s)/d+4;break}a/=6}return[Math.round(a*360),Math.round(l*100),Math.round(u*100)]},getSource:function(){return this._source},setSource:function(n){this._source=n},toRgb:function(){var n=this.getSource();return"rgb("+n[0]+","+n[1]+","+n[2]+")"},toRgba:function(){var n=this.getSource();return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},toHsl:function(){var n=this.getSource(),s=this._rgbToHsl(n[0],n[1],n[2]);return"hsl("+s[0]+","+s[1]+"%,"+s[2]+"%)"},toHsla:function(){var n=this.getSource(),s=this._rgbToHsl(n[0],n[1],n[2]);return"hsla("+s[0]+","+s[1]+"%,"+s[2]+"%,"+n[3]+")"},toHex:function(){var n=this.getSource(),s,i,a;return s=n[0].toString(16),s=s.length===1?"0"+s:s,i=n[1].toString(16),i=i.length===1?"0"+i:i,a=n[2].toString(16),a=a.length===1?"0"+a:a,s.toUpperCase()+i.toUpperCase()+a.toUpperCase()},toHexa:function(){var n=this.getSource(),s;return s=Math.round(n[3]*255),s=s.toString(16),s=s.length===1?"0"+s:s,this.toHex()+s.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(n){var s=this.getSource();return s[3]=n,this.setSource(s),this},toGrayscale:function(){var n=this.getSource(),s=parseInt((n[0]*.3+n[1]*.59+n[2]*.11).toFixed(0),10),i=n[3];return this.setSource([s,s,s,i]),this},toBlackWhite:function(n){var s=this.getSource(),i=(s[0]*.3+s[1]*.59+s[2]*.11).toFixed(0),a=s[3];return n=n||127,i=Number(i)<Number(n)?0:255,this.setSource([i,i,i,a]),this},overlayWith:function(n){n instanceof r||(n=new r(n));var s=[],i=this.getAlpha(),a=.5,l=this.getSource(),u=n.getSource(),c;for(c=0;c<3;c++)s.push(Math.round(l[c]*(1-a)+u[c]*a));return s[3]=i,this.setSource(s),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function o(n,s,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?n+(s-n)*6*i:i<1/2?s:i<2/3?n+(s-n)*(2/3-i)*6:n}e.Color.fromRgb=function(n){return r.fromSource(r.sourceFromRgb(n))},e.Color.sourceFromRgb=function(n){var s=n.match(r.reRGBa);if(s){var i=parseInt(s[1],10)/(/%$/.test(s[1])?100:1)*(/%$/.test(s[1])?255:1),a=parseInt(s[2],10)/(/%$/.test(s[2])?100:1)*(/%$/.test(s[2])?255:1),l=parseInt(s[3],10)/(/%$/.test(s[3])?100:1)*(/%$/.test(s[3])?255:1);return[parseInt(i,10),parseInt(a,10),parseInt(l,10),s[4]?parseFloat(s[4]):1]}},e.Color.fromRgba=r.fromRgb,e.Color.fromHsl=function(n){return r.fromSource(r.sourceFromHsl(n))},e.Color.sourceFromHsl=function(n){var s=n.match(r.reHSLa);if(s){var i=(parseFloat(s[1])%360+360)%360/360,a=parseFloat(s[2])/(/%$/.test(s[2])?100:1),l=parseFloat(s[3])/(/%$/.test(s[3])?100:1),u,c,h;if(a===0)u=c=h=l;else{var d=l<=.5?l*(a+1):l+a-l*a,g=l*2-d;u=o(g,d,i+1/3),c=o(g,d,i),h=o(g,d,i-1/3)}return[Math.round(u*255),Math.round(c*255),Math.round(h*255),s[4]?parseFloat(s[4]):1]}},e.Color.fromHsla=r.fromHsl,e.Color.fromHex=function(n){return r.fromSource(r.sourceFromHex(n))},e.Color.sourceFromHex=function(n){if(n.match(r.reHex)){var s=n.slice(n.indexOf("#")+1),i=s.length===3||s.length===4,a=s.length===8||s.length===4,l=i?s.charAt(0)+s.charAt(0):s.substring(0,2),u=i?s.charAt(1)+s.charAt(1):s.substring(2,4),c=i?s.charAt(2)+s.charAt(2):s.substring(4,6),h=a?i?s.charAt(3)+s.charAt(3):s.substring(6,8):"FF";return[parseInt(l,16),parseInt(u,16),parseInt(c,16),parseFloat((parseInt(h,16)/255).toFixed(2))]}},e.Color.fromSource=function(n){var s=new r;return s.setSource(n),s}})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=["e","se","s","sw","w","nw","n","ne","e"],o=["ns","nesw","ew","nwse"],n={},s="left",i="top",a="right",l="bottom",u="center",c={top:l,bottom:i,left:a,right:s,center:u},h=e.util.radiansToDegrees,d=Math.sign||function($){return($>0)-($<0)||+$};function g($,U){var te=$.angle+h(Math.atan2(U.y,U.x))+360;return Math.round(te%360/45)}function m($,U){var te=U.transform.target,ee=te.canvas,Q=e.util.object.clone(U);Q.target=te,ee&&ee.fire("object:"+$,Q),te.fire($,U)}function y($,U){var te=U.canvas,ee=te.uniScaleKey,Q=$[ee];return te.uniformScaling&&!Q||!te.uniformScaling&&Q}function C($){return $.originX===u&&$.originY===u}function b($,U,te){var ee=$.lockScalingX,Q=$.lockScalingY;return!!(ee&&Q||!U&&(ee||Q)&&te||ee&&U==="x"||Q&&U==="y")}function k($,U,te){var ee="not-allowed",Q=y($,te),ne="";if(U.x!==0&&U.y===0?ne="x":U.x===0&&U.y!==0&&(ne="y"),b(te,ne,Q))return ee;var ce=g(te,U);return r[ce]+"-resize"}function L($,U,te){var ee="not-allowed";if(U.x!==0&&te.lockSkewingY||U.y!==0&&te.lockSkewingX)return ee;var Q=g(te,U)%4;return o[Q]+"-resize"}function N($,U,te){return $[te.canvas.altActionKey]?n.skewCursorStyleHandler($,U,te):n.scaleCursorStyleHandler($,U,te)}function M($,U,te){var ee=$[te.canvas.altActionKey];if(U.x===0)return ee?"skewX":"scaleY";if(U.y===0)return ee?"skewY":"scaleX"}function W($,U,te){return te.lockRotation?"not-allowed":U.cursorStyle}function Y($,U,te,ee){return{e:$,transform:U,pointer:{x:te,y:ee}}}function J($){return function(U,te,ee,Q){var ne=te.target,ce=ne.getCenterPoint(),Ee=ne.translateToOriginPoint(ce,te.originX,te.originY),we=$(U,te,ee,Q);return ne.setPositionByOrigin(Ee,te.originX,te.originY),we}}function oe($,U){return function(te,ee,Q,ne){var ce=U(te,ee,Q,ne);return ce&&m($,Y(te,ee,Q,ne)),ce}}function pe($,U,te,ee,Q){var ne=$.target,ce=ne.controls[$.corner],Ee=ne.canvas.getZoom(),we=ne.padding/Ee,re=ne.toLocalPoint(new e.Point(ee,Q),U,te);return re.x>=we&&(re.x-=we),re.x<=-we&&(re.x+=we),re.y>=we&&(re.y-=we),re.y<=we&&(re.y+=we),re.x-=ce.offsetX,re.y-=ce.offsetY,re}function le($){return $.flipX!==$.flipY}function w($,U,te,ee,Q){if($[U]!==0){var ne=$._getTransformedDimensions()[ee],ce=Q/ne*$[te];$.set(te,ce)}}function F($,U,te,ee){var Q=U.target,ne=Q._getTransformedDimensions(0,Q.skewY),ce=pe(U,U.originX,U.originY,te,ee),Ee=Math.abs(ce.x*2)-ne.x,we=Q.skewX,re;Ee<2?re=0:(re=h(Math.atan2(Ee/Q.scaleX,ne.y/Q.scaleY)),U.originX===s&&U.originY===l&&(re=-re),U.originX===a&&U.originY===i&&(re=-re),le(Q)&&(re=-re));var ye=we!==re;if(ye){var Te=Q._getTransformedDimensions().y;Q.set("skewX",re),w(Q,"skewY","scaleY","y",Te)}return ye}function P($,U,te,ee){var Q=U.target,ne=Q._getTransformedDimensions(Q.skewX,0),ce=pe(U,U.originX,U.originY,te,ee),Ee=Math.abs(ce.y*2)-ne.y,we=Q.skewY,re;Ee<2?re=0:(re=h(Math.atan2(Ee/Q.scaleY,ne.x/Q.scaleX)),U.originX===s&&U.originY===l&&(re=-re),U.originX===a&&U.originY===i&&(re=-re),le(Q)&&(re=-re));var ye=we!==re;if(ye){var Te=Q._getTransformedDimensions().x;Q.set("skewY",re),w(Q,"skewX","scaleX","x",Te)}return ye}function I($,U,te,ee){var Q=U.target,ne=Q.skewX,ce,Ee=U.originY;if(Q.lockSkewingX)return!1;if(ne===0){var we=pe(U,u,u,te,ee);we.x>0?ce=s:ce=a}else ne>0&&(ce=Ee===i?s:a),ne<0&&(ce=Ee===i?a:s),le(Q)&&(ce=ce===s?a:s);U.originX=ce;var re=oe("skewing",J(F));return re($,U,te,ee)}function H($,U,te,ee){var Q=U.target,ne=Q.skewY,ce,Ee=U.originX;if(Q.lockSkewingY)return!1;if(ne===0){var we=pe(U,u,u,te,ee);we.y>0?ce=i:ce=l}else ne>0&&(ce=Ee===s?i:l),ne<0&&(ce=Ee===s?l:i),le(Q)&&(ce=ce===i?l:i);U.originY=ce;var re=oe("skewing",J(P));return re($,U,te,ee)}function S($,U,te,ee){var Q=U,ne=Q.target,ce=ne.translateToOriginPoint(ne.getCenterPoint(),Q.originX,Q.originY);if(ne.lockRotation)return!1;var Ee=Math.atan2(Q.ey-ce.y,Q.ex-ce.x),we=Math.atan2(ee-ce.y,te-ce.x),re=h(we-Ee+Q.theta),ye=!0;if(ne.snapAngle>0){var Te=ne.snapAngle,Be=ne.snapThreshold||Te,Ue=Math.ceil(re/Te)*Te,Me=Math.floor(re/Te)*Te;Math.abs(re-Me)<Be?re=Me:Math.abs(re-Ue)<Be&&(re=Ue)}return re<0&&(re=360+re),re%=360,ye=ne.angle!==re,ne.angle=re,ye}function _($,U,te,ee,Q){Q=Q||{};var ne=U.target,ce=ne.lockScalingX,Ee=ne.lockScalingY,we=Q.by,re,ye,Te,Be,Ue=y($,ne),Me=b(ne,we,Ue),at,Qe,Lt=U.gestureScale;if(Me)return!1;if(Lt)ye=U.scaleX*Lt,Te=U.scaleY*Lt;else{if(re=pe(U,U.originX,U.originY,te,ee),at=we!=="y"?d(re.x):1,Qe=we!=="x"?d(re.y):1,U.signX||(U.signX=at),U.signY||(U.signY=Qe),ne.lockScalingFlip&&(U.signX!==at||U.signY!==Qe))return!1;if(Be=ne._getTransformedDimensions(),Ue&&!we){var Zt=Math.abs(re.x)+Math.abs(re.y),wt=U.original,Zr=Math.abs(Be.x*wt.scaleX/ne.scaleX)+Math.abs(Be.y*wt.scaleY/ne.scaleY),vn=Zt/Zr;ye=wt.scaleX*vn,Te=wt.scaleY*vn}else ye=Math.abs(re.x*ne.scaleX/Be.x),Te=Math.abs(re.y*ne.scaleY/Be.y);C(U)&&(ye*=2,Te*=2),U.signX!==at&&we!=="y"&&(U.originX=c[U.originX],ye*=-1,U.signX=at),U.signY!==Qe&&we!=="x"&&(U.originY=c[U.originY],Te*=-1,U.signY=Qe)}var Pn=ne.scaleX,Dr=ne.scaleY;return we?(we==="x"&&ne.set("scaleX",ye),we==="y"&&ne.set("scaleY",Te)):(!ce&&ne.set("scaleX",ye),!Ee&&ne.set("scaleY",Te)),Pn!==ne.scaleX||Dr!==ne.scaleY}function O($,U,te,ee){return _($,U,te,ee)}function j($,U,te,ee){return _($,U,te,ee,{by:"x"})}function V($,U,te,ee){return _($,U,te,ee,{by:"y"})}function z($,U,te,ee){return $[U.target.canvas.altActionKey]?n.skewHandlerX($,U,te,ee):n.scalingY($,U,te,ee)}function X($,U,te,ee){return $[U.target.canvas.altActionKey]?n.skewHandlerY($,U,te,ee):n.scalingX($,U,te,ee)}function q($,U,te,ee){var Q=U.target,ne=pe(U,U.originX,U.originY,te,ee),ce=Q.strokeWidth/(Q.strokeUniform?Q.scaleX:1),Ee=C(U)?2:1,we=Q.width,re=Math.abs(ne.x*Ee/Q.scaleX)-ce;return Q.set("width",Math.max(re,0)),we!==re}function ae($,U,te,ee){var Q=U.target,ne=te-U.offsetX,ce=ee-U.offsetY,Ee=!Q.get("lockMovementX")&&Q.left!==ne,we=!Q.get("lockMovementY")&&Q.top!==ce;return Ee&&Q.set("left",ne),we&&Q.set("top",ce),(Ee||we)&&m("moving",Y($,U,te,ee)),Ee||we}n.scaleCursorStyleHandler=k,n.skewCursorStyleHandler=L,n.scaleSkewCursorStyleHandler=N,n.rotationWithSnapping=oe("rotating",J(S)),n.scalingEqually=oe("scaling",J(O)),n.scalingX=oe("scaling",J(j)),n.scalingY=oe("scaling",J(V)),n.scalingYOrSkewingX=z,n.scalingXOrSkewingY=X,n.changeWidth=oe("resizing",J(q)),n.skewHandlerX=I,n.skewHandlerY=H,n.dragHandler=ae,n.scaleOrSkewActionName=M,n.rotationStyleHandler=W,n.fireEvent=m,n.wrapWithFixedAnchor=J,n.wrapWithFireEvent=oe,n.getLocalPoint=pe,e.controlsUtils=n})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.degreesToRadians,o=e.controlsUtils;function n(i,a,l,u,c){u=u||{};var h=this.sizeX||u.cornerSize||c.cornerSize,d=this.sizeY||u.cornerSize||c.cornerSize,g=typeof u.transparentCorners<"u"?u.transparentCorners:c.transparentCorners,m=g?"stroke":"fill",y=!g&&(u.cornerStrokeColor||c.cornerStrokeColor),C=a,b=l,k;i.save(),i.fillStyle=u.cornerColor||c.cornerColor,i.strokeStyle=u.cornerStrokeColor||c.cornerStrokeColor,h>d?(k=h,i.scale(1,d/h),b=l*h/d):d>h?(k=d,i.scale(h/d,1),C=a*d/h):k=h,i.lineWidth=1,i.beginPath(),i.arc(C,b,k/2,0,2*Math.PI,!1),i[m](),y&&i.stroke(),i.restore()}function s(i,a,l,u,c){u=u||{};var h=this.sizeX||u.cornerSize||c.cornerSize,d=this.sizeY||u.cornerSize||c.cornerSize,g=typeof u.transparentCorners<"u"?u.transparentCorners:c.transparentCorners,m=g?"stroke":"fill",y=!g&&(u.cornerStrokeColor||c.cornerStrokeColor),C=h/2,b=d/2;i.save(),i.fillStyle=u.cornerColor||c.cornerColor,i.strokeStyle=u.cornerStrokeColor||c.cornerStrokeColor,i.lineWidth=1,i.translate(a,l),i.rotate(r(c.angle)),i[m+"Rect"](-C,-b,h,d),y&&i.strokeRect(-C,-b,h,d),i.restore()}o.renderCircleControl=n,o.renderSquareControl=s})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={});function r(o){for(var n in o)this[n]=o[n]}e.Control=r,e.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(o,n){return n.cursorStyle},getActionName:function(o,n){return n.actionName},getVisibility:function(o,n){var s=o._controlsVisibility;return s&&typeof s[n]<"u"?s[n]:this.visible},setVisibility:function(o){this.visible=o},positionHandler:function(o,n){var s=e.util.transformPoint({x:this.x*o.x+this.offsetX,y:this.y*o.y+this.offsetY},n);return s},calcCornerCoords:function(o,n,s,i,a){var l,u,c,h,d=a?this.touchSizeX:this.sizeX,g=a?this.touchSizeY:this.sizeY;if(d&&g&&d!==g){var m=Math.atan2(g,d),y=Math.sqrt(d*d+g*g)/2,C=m-e.util.degreesToRadians(o),b=Math.PI/2-m-e.util.degreesToRadians(o);l=y*e.util.cos(C),u=y*e.util.sin(C),c=y*e.util.cos(b),h=y*e.util.sin(b)}else{var k=d&&g?d:n;y=k*.7071067812;var C=e.util.degreesToRadians(45-o);l=c=y*e.util.cos(C),u=h=y*e.util.sin(C)}return{tl:{x:s-h,y:i-c},tr:{x:s+l,y:i-u},bl:{x:s-l,y:i+u},br:{x:s+h,y:i+c}}},render:function(o,n,s,i,a){switch(i=i||{},i.cornerStyle||a.cornerStyle){case"circle":e.controlsUtils.renderCircleControl.call(this,o,n,s,i,a);break;default:e.controlsUtils.renderSquareControl.call(this,o,n,s,i,a)}}}})(Ce);(function(){function t(s,i){var a=s.getAttribute("style"),l=s.getAttribute("offset")||0,u,c,h,d;if(l=parseFloat(l)/(/%$/.test(l)?100:1),l=l<0?0:l>1?1:l,a){var g=a.split(/\s*;\s*/);for(g[g.length-1]===""&&g.pop(),d=g.length;d--;){var m=g[d].split(/\s*:\s*/),y=m[0].trim(),C=m[1].trim();y==="stop-color"?u=C:y==="stop-opacity"&&(h=C)}}return u||(u=s.getAttribute("stop-color")||"rgb(0,0,0)"),h||(h=s.getAttribute("stop-opacity")),u=new x.Color(u),c=u.getAlpha(),h=isNaN(parseFloat(h))?1:parseFloat(h),h*=c*i,{offset:l,color:u.toRgb(),opacity:h}}function e(s){return{x1:s.getAttribute("x1")||0,y1:s.getAttribute("y1")||0,x2:s.getAttribute("x2")||"100%",y2:s.getAttribute("y2")||0}}function r(s){return{x1:s.getAttribute("fx")||s.getAttribute("cx")||"50%",y1:s.getAttribute("fy")||s.getAttribute("cy")||"50%",r1:0,x2:s.getAttribute("cx")||"50%",y2:s.getAttribute("cy")||"50%",r2:s.getAttribute("r")||"50%"}}var o=x.util.object.clone;x.Gradient=x.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(s){s||(s={}),s.coords||(s.coords={});var i,a=this;Object.keys(s).forEach(function(l){a[l]=s[l]}),this.id?this.id+="_"+x.Object.__uid++:this.id=x.Object.__uid++,i={x1:s.coords.x1||0,y1:s.coords.y1||0,x2:s.coords.x2||0,y2:s.coords.y2||0},this.type==="radial"&&(i.r1=s.coords.r1||0,i.r2=s.coords.r2||0),this.coords=i,this.colorStops=s.colorStops.slice()},addColorStop:function(s){for(var i in s){var a=new x.Color(s[i]);this.colorStops.push({offset:parseFloat(i),color:a.toRgb(),opacity:a.getAlpha()})}return this},toObject:function(s){var i={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return x.util.populateWithProperties(this,i,s),i},toSVG:function(s,c){var a=o(this.coords,!0),l,u,c=c||{},h,d,g=o(this.colorStops,!0),m=a.r1>a.r2,y=this.gradientTransform?this.gradientTransform.concat():x.iMatrix.concat(),C=-this.offsetX,b=-this.offsetY,k=!!c.additionalTransform,L=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(g.sort(function(J,oe){return J.offset-oe.offset}),L==="objectBoundingBox"?(C/=s.width,b/=s.height):(C+=s.width/2,b+=s.height/2),s.type==="path"&&this.gradientUnits!=="percentage"&&(C-=s.pathOffset.x,b-=s.pathOffset.y),y[4]-=C,y[5]-=b,d='id="SVGID_'+this.id+'" gradientUnits="'+L+'"',d+=' gradientTransform="'+(k?c.additionalTransform+" ":"")+x.util.matrixToSVG(y)+'" ',this.type==="linear"?h=["<linearGradient ",d,' x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,`">
`]:this.type==="radial"&&(h=["<radialGradient ",d,' cx="',m?a.x1:a.x2,'" cy="',m?a.y1:a.y2,'" r="',m?a.r1:a.r2,'" fx="',m?a.x2:a.x1,'" fy="',m?a.y2:a.y1,`">
`]),this.type==="radial"){if(m)for(g=g.concat(),g.reverse(),l=0,u=g.length;l<u;l++)g[l].offset=1-g[l].offset;var N=Math.min(a.r1,a.r2);if(N>0){var M=Math.max(a.r1,a.r2),W=N/M;for(l=0,u=g.length;l<u;l++)g[l].offset+=W*(1-g[l].offset)}}for(l=0,u=g.length;l<u;l++){var Y=g[l];h.push("<stop ",'offset="',Y.offset*100+"%",'" style="stop-color:',Y.color,typeof Y.opacity<"u"?";stop-opacity: "+Y.opacity:";",`"/>
`)}return h.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),h.join("")},toLive:function(s){var i,a=x.util.object.clone(this.coords),l,u;if(this.type){for(this.type==="linear"?i=s.createLinearGradient(a.x1,a.y1,a.x2,a.y2):this.type==="radial"&&(i=s.createRadialGradient(a.x1,a.y1,a.r1,a.x2,a.y2,a.r2)),l=0,u=this.colorStops.length;l<u;l++){var c=this.colorStops[l].color,h=this.colorStops[l].opacity,d=this.colorStops[l].offset;typeof h<"u"&&(c=new x.Color(c).setAlpha(h).toRgba()),i.addColorStop(d,c)}return i}}}),x.util.object.extend(x.Gradient,{fromElement:function(s,i,a,l){var u=parseFloat(a)/(/%$/.test(a)?100:1);u=u<0?0:u>1?1:u,isNaN(u)&&(u=1);var c=s.getElementsByTagName("stop"),h,d=s.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",g=s.getAttribute("gradientTransform")||"",m=[],y,C,b=0,k=0,L;for(s.nodeName==="linearGradient"||s.nodeName==="LINEARGRADIENT"?(h="linear",y=e(s)):(h="radial",y=r(s)),C=c.length;C--;)m.push(t(c[C],u));L=x.parseTransformAttribute(g),n(i,y,l,d),d==="pixels"&&(b=-i.left,k=-i.top);var N=new x.Gradient({id:s.getAttribute("id"),type:h,coords:y,colorStops:m,gradientUnits:d,gradientTransform:L,offsetX:b,offsetY:k});return N}});function n(s,i,a,l){var u,c;Object.keys(i).forEach(function(h){u=i[h],u==="Infinity"?c=1:u==="-Infinity"?c=0:(c=parseFloat(i[h],10),typeof u=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(u)&&(c*=.01,l==="pixels"&&((h==="x1"||h==="x2"||h==="r2")&&(c*=a.viewBoxWidth||a.width),(h==="y1"||h==="y2")&&(c*=a.viewBoxHeight||a.height)))),i[h]=c})}})();(function(){"use strict";var t=x.util.toFixed;x.Pattern=x.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(e,r){if(e||(e={}),this.id=x.Object.__uid++,this.setOptions(e),!e.source||e.source&&typeof e.source!="string"){r&&r(this);return}else{var o=this;this.source=x.util.createImage(),x.util.loadImage(e.source,function(n,s){o.source=n,r&&r(o,s)},null,this.crossOrigin)}},toObject:function(e){var r=x.Object.NUM_FRACTION_DIGITS,o,n;return typeof this.source.src=="string"?o=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(o=this.source.toDataURL()),n={type:"pattern",source:o,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:t(this.offsetX,r),offsetY:t(this.offsetY,r),patternTransform:this.patternTransform?this.patternTransform.concat():null},x.util.populateWithProperties(this,n,e),n},toSVG:function(e){var r=typeof this.source=="function"?this.source():this.source,o=r.width/e.width,n=r.height/e.height,s=this.offsetX/e.width,i=this.offsetY/e.height,a="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(n=1,i&&(n+=Math.abs(i))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(o=1,s&&(o+=Math.abs(s))),r.src?a=r.src:r.toDataURL&&(a=r.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+s+'" y="'+i+'" width="'+o+'" height="'+n+`">
<image x="0" y="0" width="`+r.width+'" height="'+r.height+'" xlink:href="'+a+`"></image>
</pattern>
`},setOptions:function(e){for(var r in e)this[r]=e[r]},toLive:function(e){var r=this.source;return!r||typeof r.src<"u"&&(!r.complete||r.naturalWidth===0||r.naturalHeight===0)?"":e.createPattern(r,this.repeat)}})})();(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.toFixed;if(e.Shadow){e.warn("fabric.Shadow is already defined.");return}e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(o){typeof o=="string"&&(o=this._parseShadow(o));for(var n in o)this[n]=o[n];this.id=e.Object.__uid++},_parseShadow:function(o){var n=o.trim(),s=e.Shadow.reOffsetsAndBlur.exec(n)||[],i=n.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:i.trim(),offsetX:parseFloat(s[1],10)||0,offsetY:parseFloat(s[2],10)||0,blur:parseFloat(s[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(o){var n=40,s=40,i=e.Object.NUM_FRACTION_DIGITS,a=e.util.rotateVector({x:this.offsetX,y:this.offsetY},e.util.degreesToRadians(-o.angle)),l=20,u=new e.Color(this.color);return o.width&&o.height&&(n=r((Math.abs(a.x)+this.blur)/o.width,i)*100+l,s=r((Math.abs(a.y)+this.blur)/o.height,i)*100+l),o.flipX&&(a.x*=-1),o.flipY&&(a.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+s+'%" height="'+(100+2*s)+'%" x="-'+n+'%" width="'+(100+2*n)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+r(this.blur?this.blur/2:0,i)+`"></feGaussianBlur>
	<feOffset dx="`+r(a.x,i)+'" dy="'+r(a.y,i)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+u.toRgb()+'" flood-opacity="'+u.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var o={},n=e.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(s){this[s]!==n[s]&&(o[s]=this[s])},this),o}}),e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/})(Ce);(function(){"use strict";if(x.StaticCanvas){x.warn("fabric.StaticCanvas is already defined.");return}var t=x.util.object.extend,e=x.util.getElementOffset,r=x.util.removeFromArray,o=x.util.toFixed,n=x.util.transformPoint,s=x.util.invertTransform,i=x.util.getNodeCanvas,a=x.util.createCanvasElement,l=new Error("Could not initialize `canvas` element");x.StaticCanvas=x.util.createClass(x.CommonMethods,{initialize:function(u,c){c||(c={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(u,c)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:x.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(u,c){var h=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(u),this._initOptions(c),this.interactive||this._initRetinaScaling(),c.overlayImage&&this.setOverlayImage(c.overlayImage,h),c.backgroundImage&&this.setBackgroundImage(c.backgroundImage,h),c.backgroundColor&&this.setBackgroundColor(c.backgroundColor,h),c.overlayColor&&this.setOverlayColor(c.overlayColor,h),this.calcOffset()},_isRetinaScaling:function(){return x.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,x.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var u=x.devicePixelRatio;this.__initRetinaScaling(u,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(u,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(u,c,h){c.setAttribute("width",this.width*u),c.setAttribute("height",this.height*u),h.scale(u,u)},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(u,c,h){return this.__setBgOverlayImage("overlayImage",u,c,h)},setBackgroundImage:function(u,c,h){return this.__setBgOverlayImage("backgroundImage",u,c,h)},setOverlayColor:function(u,c){return this.__setBgOverlayColor("overlayColor",u,c)},setBackgroundColor:function(u,c){return this.__setBgOverlayColor("backgroundColor",u,c)},__setBgOverlayImage:function(u,c,h,d){return typeof c=="string"?x.util.loadImage(c,function(g,m){if(g){var y=new x.Image(g,d);this[u]=y,y.canvas=this}h&&h(g,m)},this,d&&d.crossOrigin):(d&&c.setOptions(d),this[u]=c,c&&(c.canvas=this),h&&h(c,!1)),this},__setBgOverlayColor:function(u,c,h){return this[u]=c,this._initGradient(c,u),this._initPattern(c,u,h),this},_createCanvasElement:function(){var u=a();if(!u||(u.style||(u.style={}),typeof u.getContext>"u"))throw l;return u},_initOptions:function(u){var c=this.lowerCanvasEl;this._setOptions(u),this.width=this.width||parseInt(c.width,10)||0,this.height=this.height||parseInt(c.height,10)||0,this.lowerCanvasEl.style&&(c.width=this.width,c.height=this.height,c.style.width=this.width+"px",c.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(u){u&&u.getContext?this.lowerCanvasEl=u:this.lowerCanvasEl=x.util.getById(u)||this._createCanvasElement(),x.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(u,c){return this.setDimensions({width:u},c)},setHeight:function(u,c){return this.setDimensions({height:u},c)},setDimensions:function(u,c){var h;c=c||{};for(var d in u)h=u[d],c.cssOnly||(this._setBackstoreDimension(d,u[d]),h+="px",this.hasLostContext=!0),c.backstoreOnly||this._setCssDimension(d,h);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),c.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(u,c){return this.lowerCanvasEl[u]=c,this.upperCanvasEl&&(this.upperCanvasEl[u]=c),this.cacheCanvasEl&&(this.cacheCanvasEl[u]=c),this[u]=c,this},_setCssDimension:function(u,c){return this.lowerCanvasEl.style[u]=c,this.upperCanvasEl&&(this.upperCanvasEl.style[u]=c),this.wrapperEl&&(this.wrapperEl.style[u]=c),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(u){var c=this._activeObject,h=this.backgroundImage,d=this.overlayImage,g,m,y;for(this.viewportTransform=u,m=0,y=this._objects.length;m<y;m++)g=this._objects[m],g.group||g.setCoords(!0);return c&&c.setCoords(),h&&h.setCoords(!0),d&&d.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(u,c){var h=u,d=this.viewportTransform.slice(0);u=n(u,s(this.viewportTransform)),d[0]=c,d[3]=c;var g=n(u,d);return d[4]+=h.x-g.x,d[5]+=h.y-g.y,this.setViewportTransform(d)},setZoom:function(u){return this.zoomToPoint(new x.Point(0,0),u),this},absolutePan:function(u){var c=this.viewportTransform.slice(0);return c[4]=-u.x,c[5]=-u.y,this.setViewportTransform(c)},relativePan:function(u){return this.absolutePan(new x.Point(-u.x-this.viewportTransform[4],-u.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(u){this.stateful&&u.setupState(),u._set("canvas",this),u.setCoords(),this.fire("object:added",{target:u}),u.fire("added")},_onObjectRemoved:function(u){this.fire("object:removed",{target:u}),u.fire("removed"),delete u.canvas},clearContext:function(u){return u.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var u=this.contextContainer;return this.renderCanvas(u,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=x.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var u={},c=this.width,h=this.height,d=s(this.viewportTransform);return u.tl=n({x:0,y:0},d),u.br=n({x:c,y:h},d),u.tr=new x.Point(u.br.x,u.tl.y),u.bl=new x.Point(u.tl.x,u.br.y),this.vptCoords=u,u},cancelRequestedRender:function(){this.isRendering&&(x.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(u,c){var h=this.viewportTransform,d=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(u),x.util.setImageSmoothing(u,this.imageSmoothingEnabled),this.fire("before:render",{ctx:u}),this._renderBackground(u),u.save(),u.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._renderObjects(u,c),u.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(u),d&&(d.canvas=this,d.shouldCache(),d._transformDone=!0,d.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(u)),this._renderOverlay(u),this.controlsAboveOverlay&&this.interactive&&this.drawControls(u),this.fire("after:render",{ctx:u})},drawClipPathOnCanvas:function(u){var c=this.viewportTransform,h=this.clipPath;u.save(),u.transform(c[0],c[1],c[2],c[3],c[4],c[5]),u.globalCompositeOperation="destination-in",h.transform(u),u.scale(1/h.zoomX,1/h.zoomY),u.drawImage(h._cacheCanvas,-h.cacheTranslationX,-h.cacheTranslationY),u.restore()},_renderObjects:function(u,c){var h,d;for(h=0,d=c.length;h<d;++h)c[h]&&c[h].render(u)},_renderBackgroundOrOverlay:function(u,c){var h=this[c+"Color"],d=this[c+"Image"],g=this.viewportTransform,m=this[c+"Vpt"];if(!(!h&&!d)){if(h){u.save(),u.beginPath(),u.moveTo(0,0),u.lineTo(this.width,0),u.lineTo(this.width,this.height),u.lineTo(0,this.height),u.closePath(),u.fillStyle=h.toLive?h.toLive(u,this):h,m&&u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),u.transform(1,0,0,1,h.offsetX||0,h.offsetY||0);var y=h.gradientTransform||h.patternTransform;y&&u.transform(y[0],y[1],y[2],y[3],y[4],y[5]),u.fill(),u.restore()}d&&(u.save(),m&&u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),d.render(u),u.restore())}},_renderBackground:function(u){this._renderBackgroundOrOverlay(u,"background")},_renderOverlay:function(u){this._renderBackgroundOrOverlay(u,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new x.Point(this.width/2,this.height/2)},centerObjectH:function(u){return this._centerObject(u,new x.Point(this.getCenterPoint().x,u.getCenterPoint().y))},centerObjectV:function(u){return this._centerObject(u,new x.Point(u.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(u){var c=this.getCenterPoint();return this._centerObject(u,c)},viewportCenterObject:function(u){var c=this.getVpCenter();return this._centerObject(u,c)},viewportCenterObjectH:function(u){var c=this.getVpCenter();return this._centerObject(u,new x.Point(c.x,u.getCenterPoint().y)),this},viewportCenterObjectV:function(u){var c=this.getVpCenter();return this._centerObject(u,new x.Point(u.getCenterPoint().x,c.y))},getVpCenter:function(){var u=this.getCenterPoint(),c=s(this.viewportTransform);return n(u,c)},_centerObject:function(u,c){return u.setPositionByOrigin(c,"center","center"),u.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(u){return this.toDatalessObject(u)},toObject:function(u){return this._toObjectMethod("toObject",u)},toDatalessObject:function(u){return this._toObjectMethod("toDatalessObject",u)},_toObjectMethod:function(u,c){var h=this.clipPath,d={version:x.version,objects:this._toObjects(u,c)};return h&&!h.excludeFromExport&&(d.clipPath=this._toObject(this.clipPath,u,c)),t(d,this.__serializeBgOverlay(u,c)),x.util.populateWithProperties(this,d,c),d},_toObjects:function(u,c){return this._objects.filter(function(h){return!h.excludeFromExport}).map(function(h){return this._toObject(h,u,c)},this)},_toObject:function(u,c,h){var d;this.includeDefaultValues||(d=u.includeDefaultValues,u.includeDefaultValues=!1);var g=u[c](h);return this.includeDefaultValues||(u.includeDefaultValues=d),g},__serializeBgOverlay:function(u,c){var h={},d=this.backgroundImage,g=this.overlayImage,m=this.backgroundColor,y=this.overlayColor;return m&&m.toObject?m.excludeFromExport||(h.background=m.toObject(c)):m&&(h.background=m),y&&y.toObject?y.excludeFromExport||(h.overlay=y.toObject(c)):y&&(h.overlay=y),d&&!d.excludeFromExport&&(h.backgroundImage=this._toObject(d,u,c)),g&&!g.excludeFromExport&&(h.overlayImage=this._toObject(g,u,c)),h},svgViewportTransformation:!0,toSVG:function(u,c){u||(u={}),u.reviver=c;var h=[];return this._setSVGPreamble(h,u),this._setSVGHeader(h,u),this.clipPath&&h.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(h,"background"),this._setSVGBgOverlayImage(h,"backgroundImage",c),this._setSVGObjects(h,c),this.clipPath&&h.push(`</g>
`),this._setSVGBgOverlayColor(h,"overlay"),this._setSVGBgOverlayImage(h,"overlayImage",c),h.push("</svg>"),h.join("")},_setSVGPreamble:function(u,c){c.suppressPreamble||u.push('<?xml version="1.0" encoding="',c.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(u,c){var h=c.width||this.width,d=c.height||this.height,g,m='viewBox="0 0 '+this.width+" "+this.height+'" ',y=x.Object.NUM_FRACTION_DIGITS;c.viewBox?m='viewBox="'+c.viewBox.x+" "+c.viewBox.y+" "+c.viewBox.width+" "+c.viewBox.height+'" ':this.svgViewportTransformation&&(g=this.viewportTransform,m='viewBox="'+o(-g[4]/g[0],y)+" "+o(-g[5]/g[3],y)+" "+o(this.width/g[0],y)+" "+o(this.height/g[3],y)+'" '),u.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',h,'" ','height="',d,'" ',m,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",x.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(c),`</defs>
`)},createSVGClipPathMarkup:function(u){var c=this.clipPath;return c?(c.clipPathId="CLIPPATH_"+x.Object.__uid++,'<clipPath id="'+c.clipPathId+`" >
`+this.clipPath.toClipPathSVG(u.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var u=this,c=["background","overlay"].map(function(h){var d=u[h+"Color"];if(d&&d.toLive){var g=u[h+"Vpt"],m=u.viewportTransform,y={width:u.width/(g?m[0]:1),height:u.height/(g?m[3]:1)};return d.toSVG(y,{additionalTransform:g?x.util.matrixToSVG(m):""})}});return c.join("")},createSVGFontFacesMarkup:function(){var u="",c={},h,d,g,m,y,C,b,k,L,N=x.fontPaths,M=[];for(this._objects.forEach(function Y(J){M.push(J),J._objects&&J._objects.forEach(Y)}),k=0,L=M.length;k<L;k++)if(h=M[k],d=h.fontFamily,!(h.type.indexOf("text")===-1||c[d]||!N[d])&&(c[d]=!0,!!h.styles)){g=h.styles;for(y in g){m=g[y];for(b in m)C=m[b],d=C.fontFamily,!c[d]&&N[d]&&(c[d]=!0)}}for(var W in c)u+=[`		@font-face {
`,"			font-family: '",W,`';
`,"			src: url('",N[W],`');
`,`		}
`].join("");return u&&(u=['	<style type="text/css">',`<![CDATA[
`,u,"]]>",`</style>
`].join("")),u},_setSVGObjects:function(u,c){var h,d,g,m=this._objects;for(d=0,g=m.length;d<g;d++)h=m[d],!h.excludeFromExport&&this._setSVGObject(u,h,c)},_setSVGObject:function(u,c,h){u.push(c.toSVG(h))},_setSVGBgOverlayImage:function(u,c,h){this[c]&&!this[c].excludeFromExport&&this[c].toSVG&&u.push(this[c].toSVG(h))},_setSVGBgOverlayColor:function(u,c){var h=this[c+"Color"],d=this.viewportTransform,g=this.width,m=this.height;if(h)if(h.toLive){var y=h.repeat,C=x.util.invertTransform(d),b=this[c+"Vpt"],k=b?x.util.matrixToSVG(C):"";u.push('<rect transform="'+k+" translate(",g/2,",",m/2,')"',' x="',h.offsetX-g/2,'" y="',h.offsetY-m/2,'" ','width="',y==="repeat-y"||y==="no-repeat"?h.source.width:g,'" height="',y==="repeat-x"||y==="no-repeat"?h.source.height:m,'" fill="url(#SVGID_'+h.id+')"',`></rect>
`)}else u.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',h,'"',`></rect>
`)},sendToBack:function(u){if(!u)return this;var c=this._activeObject,h,d,g;if(u===c&&u.type==="activeSelection")for(g=c._objects,h=g.length;h--;)d=g[h],r(this._objects,d),this._objects.unshift(d);else r(this._objects,u),this._objects.unshift(u);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(u){if(!u)return this;var c=this._activeObject,h,d,g;if(u===c&&u.type==="activeSelection")for(g=c._objects,h=0;h<g.length;h++)d=g[h],r(this._objects,d),this._objects.push(d);else r(this._objects,u),this._objects.push(u);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(u,c){if(!u)return this;var h=this._activeObject,d,g,m,y,C,b=0;if(u===h&&u.type==="activeSelection")for(C=h._objects,d=0;d<C.length;d++)g=C[d],m=this._objects.indexOf(g),m>0+b&&(y=m-1,r(this._objects,g),this._objects.splice(y,0,g)),b++;else m=this._objects.indexOf(u),m!==0&&(y=this._findNewLowerIndex(u,m,c),r(this._objects,u),this._objects.splice(y,0,u));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(u,c,h){var d,g;if(h)for(d=c,g=c-1;g>=0;--g){var m=u.intersectsWithObject(this._objects[g])||u.isContainedWithinObject(this._objects[g])||this._objects[g].isContainedWithinObject(u);if(m){d=g;break}}else d=c-1;return d},bringForward:function(u,c){if(!u)return this;var h=this._activeObject,d,g,m,y,C,b=0;if(u===h&&u.type==="activeSelection")for(C=h._objects,d=C.length;d--;)g=C[d],m=this._objects.indexOf(g),m<this._objects.length-1-b&&(y=m+1,r(this._objects,g),this._objects.splice(y,0,g)),b++;else m=this._objects.indexOf(u),m!==this._objects.length-1&&(y=this._findNewUpperIndex(u,m,c),r(this._objects,u),this._objects.splice(y,0,u));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(u,c,h){var d,g,m;if(h)for(d=c,g=c+1,m=this._objects.length;g<m;++g){var y=u.intersectsWithObject(this._objects[g])||u.isContainedWithinObject(this._objects[g])||this._objects[g].isContainedWithinObject(u);if(y){d=g;break}}else d=c+1;return d},moveTo:function(u,c){return r(this._objects,u),this._objects.splice(c,0,u),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(x.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(u){u.dispose&&u.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),x.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),x.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),t(x.StaticCanvas.prototype,x.Observable),t(x.StaticCanvas.prototype,x.Collection),t(x.StaticCanvas.prototype,x.DataURLExporter),t(x.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(u){var c=a();if(!c||!c.getContext)return null;var h=c.getContext("2d");if(!h)return null;switch(u){case"setLineDash":return typeof h.setLineDash<"u";default:return null}}}),x.StaticCanvas.prototype.toJSON=x.StaticCanvas.prototype.toObject,x.isLikelyNode&&(x.StaticCanvas.prototype.createPNGStream=function(){var u=i(this.lowerCanvasEl);return u&&u.createPNGStream()},x.StaticCanvas.prototype.createJPEGStream=function(u){var c=i(this.lowerCanvasEl);return c&&c.createJPEGStream(u)})})();x.BaseBrush=x.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(t){t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,t.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(t){var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},_setShadow:function(){if(this.shadow){var t=this.canvas,e=this.shadow,r=t.contextTop,o=t.getZoom();t&&t._isRetinaScaling()&&(o*=x.devicePixelRatio),r.shadowColor=e.color,r.shadowBlur=e.blur*o,r.shadowOffsetX=e.offsetX*o,r.shadowOffsetY=e.offsetY*o}},needsFullRender:function(){var t=new x.Color(this.color);return t.getAlpha()<1||!!this.shadow},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0},_isOutSideCanvas:function(t){return t.x<0||t.x>this.canvas.getWidth()||t.y<0||t.y>this.canvas.getHeight()}});(function(){x.PencilBrush=x.util.createClass(x.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(t){this.canvas=t,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(t,e,r){var o=e.midPointFrom(r);return t.quadraticCurveTo(e.x,e.y,o.x,o.y),o},onMouseDown:function(t,e){this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],this._prepareForDrawing(t),this._captureDrawingPath(t),this._render())},onMouseMove:function(t,e){if(this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(t))&&this._captureDrawingPath(t)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var r=this._points,o=r.length,n=this.canvas.contextTop;this._saveAndTransform(n),this.oldEnd&&(n.beginPath(),n.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(n,r[o-2],r[o-1],!0),n.stroke(),n.restore()}},onMouseUp:function(t){return this.canvas._isMainEvent(t.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(t){var e=new x.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){return this._points.length>1&&t.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(t),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(t){var e=new x.Point(t.x,t.y);return this._addPoint(e)},_render:function(t){var e,r,o=this._points[0],n=this._points[1];if(t=t||this.canvas.contextTop,this._saveAndTransform(t),t.beginPath(),this._points.length===2&&o.x===n.x&&o.y===n.y){var s=this.width/1e3;o=new x.Point(o.x,o.y),n=new x.Point(n.x,n.y),o.x-=s,n.x+=s}for(t.moveTo(o.x,o.y),e=1,r=this._points.length;e<r;e++)this._drawSegment(t,o,n),o=this._points[e],n=this._points[e+1];t.lineTo(o.x,o.y),t.stroke(),t.restore()},convertPointsToSVGPath:function(t){var e=this.width/1e3;return x.util.getSmoothPathFromPoints(t,e)},_isEmptySVGPath:function(t){var e=x.util.joinPath(t);return e==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(t){var e=new x.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new x.Shadow(this.shadow)),e},decimatePoints:function(t,e){if(t.length<=2)return t;var r=this.canvas.getZoom(),o=Math.pow(e/r,2),n,s=t.length-1,i=t[0],a=[i],l;for(n=1;n<s-1;n++)l=Math.pow(i.x-t[n].x,2)+Math.pow(i.y-t[n].y,2),l>=o&&(i=t[n],a.push(i));return a.push(t[s]),a},_finalizeAndAddPath:function(){var t=this.canvas.contextTop;t.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var e=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(e)){this.canvas.requestRenderAll();return}var r=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:r}),this.canvas.add(r),this.canvas.requestRenderAll(),r.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:r})}})})();x.CircleBrush=x.util.createClass(x.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),r=this.canvas.contextTop;this._saveAndTransform(r),this.dot(r,e),r.restore()},dot:function(t,e){t.fillStyle=e.fill,t.beginPath(),t.arc(e.x,e.y,e.radius,0,Math.PI*2,!1),t.closePath(),t.fill()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},_render:function(){var t=this.canvas.contextTop,e,r,o=this.points;for(this._saveAndTransform(t),e=0,r=o.length;e<r;e++)this.dot(t,o[e]);t.restore()},onMouseMove:function(t){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(t)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(t),this._render()):this.drawDot(t))},onMouseUp:function(){var t=this.canvas.renderOnAddRemove,e,r;this.canvas.renderOnAddRemove=!1;var o=[];for(e=0,r=this.points.length;e<r;e++){var n=this.points[e],s=new x.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&(s.shadow=new x.Shadow(this.shadow)),o.push(s)}var i=new x.Group(o);i.canvas=this.canvas,this.canvas.fire("before:path:created",{path:i}),this.canvas.add(i),this.canvas.fire("path:created",{path:i}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},addPoint:function(t){var e=new x.Point(t.x,t.y),r=x.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,o=new x.Color(this.color).setAlpha(x.util.getRandomInt(0,100)/100).toRgba();return e.radius=r,e.fill=o,this.points.push(e),e}});x.SprayBrush=x.util.createClass(x.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseMove:function(t){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(t)||(this.addSprayChunk(t),this.render(this.sprayChunkPoints))},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],r=0,o=this.sprayChunks.length;r<o;r++)for(var n=this.sprayChunks[r],s=0,i=n.length;s<i;s++){var a=new x.Rect({width:n[s].width,height:n[s].width,left:n[s].x+1,top:n[s].y+1,originX:"center",originY:"center",fill:this.color});e.push(a)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var l=new x.Group(e);this.shadow&&l.set("shadow",new x.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:l}),this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},_getOptimizedRects:function(t){var e={},r,o,n;for(o=0,n=t.length;o<n;o++)r=t[o].left+""+t[o].top,e[r]||(e[r]=t[o]);var s=[];for(r in e)s.push(e[r]);return s},render:function(t){var e=this.canvas.contextTop,r,o;for(e.fillStyle=this.color,this._saveAndTransform(e),r=0,o=t.length;r<o;r++){var n=t[r];typeof n.opacity<"u"&&(e.globalAlpha=n.opacity),e.fillRect(n.x,n.y,n.width,n.width)}e.restore()},_render:function(){var t=this.canvas.contextTop,e,r;for(t.fillStyle=this.color,this._saveAndTransform(t),e=0,r=this.sprayChunks.length;e<r;e++)this.render(this.sprayChunks[e]);t.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];var e,r,o,n=this.width/2,s;for(s=0;s<this.density;s++){e=x.util.getRandomInt(t.x-n,t.x+n),r=x.util.getRandomInt(t.y-n,t.y+n),this.dotWidthVariance?o=x.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):o=this.dotWidth;var i=new x.Point(e,r);i.width=o,this.randomOpacity&&(i.opacity=x.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(i)}this.sprayChunks.push(this.sprayChunkPoints)}});x.PatternBrush=x.util.createClass(x.PencilBrush,{getPatternSrc:function(){var t=20,e=5,r=x.util.createCanvasElement(),o=r.getContext("2d");return r.width=r.height=t+e,o.fillStyle=this.color,o.beginPath(),o.arc(t/2,t/2,t/2,0,Math.PI*2,!1),o.closePath(),o.fill(),r},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(t){return t.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(t){this.callSuper("_setBrushStyles",t),t.strokeStyle=this.getPattern(t)},createPath:function(t){var e=this.callSuper("createPath",t),r=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new x.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-r.x,offsetY:-r.y}),e}});(function(){var t=x.util.getPointer,e=x.util.degreesToRadians,r=x.util.isTouchEvent;x.Canvas=x.util.createClass(x.StaticCanvas,{initialize:function(n,s){s||(s={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(n,s),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=x.PencilBrush&&new x.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var n=this.getActiveObjects(),s,i,a;if(n.length>0&&!this.preserveObjectStacking){i=[],a=[];for(var l=0,u=this._objects.length;l<u;l++)s=this._objects[l],n.indexOf(s)===-1?i.push(s):a.push(s);n.length>1&&(this._activeObject._objects=a),i.push.apply(i,a)}else i=this._objects;return i},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var n=this.contextContainer;return this.renderCanvas(n,this._chooseObjectsToRender()),this},renderTopLayer:function(n){n.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(n),this.contextTopDirty=!0),n.restore()},renderTop:function(){var n=this.contextTop;return this.clearContext(n),this.renderTopLayer(n),this.fire("after:render"),this},_normalizePointer:function(n,s){var i=n.calcTransformMatrix(),a=x.util.invertTransform(i),l=this.restorePointerVpt(s);return x.util.transformPoint(l,a)},isTargetTransparent:function(n,s,i){if(n.shouldCache()&&n._cacheCanvas&&n!==this._activeObject){var a=this._normalizePointer(n,{x:s,y:i}),l=Math.max(n.cacheTranslationX+a.x*n.zoomX,0),u=Math.max(n.cacheTranslationY+a.y*n.zoomY,0),g=x.util.isTransparent(n._cacheContext,Math.round(l),Math.round(u),this.targetFindTolerance);return g}var c=this.contextCache,h=n.selectionBackgroundColor,d=this.viewportTransform;n.selectionBackgroundColor="",this.clearContext(c),c.save(),c.transform(d[0],d[1],d[2],d[3],d[4],d[5]),n.render(c),c.restore(),n.selectionBackgroundColor=h;var g=x.util.isTransparent(c,s,i,this.targetFindTolerance);return g},_isSelectionKeyPressed:function(n){var s=!1;return Array.isArray(this.selectionKey)?s=!!this.selectionKey.find(function(i){return n[i]===!0}):s=n[this.selectionKey],s},_shouldClearSelection:function(n,s){var i=this.getActiveObjects(),a=this._activeObject;return!s||s&&a&&i.length>1&&i.indexOf(s)===-1&&a!==s&&!this._isSelectionKeyPressed(n)||s&&!s.evented||s&&!s.selectable&&a&&a!==s},_shouldCenterTransform:function(n,s,i){if(n){var a;return s==="scale"||s==="scaleX"||s==="scaleY"||s==="resizing"?a=this.centeredScaling||n.centeredScaling:s==="rotate"&&(a=this.centeredRotation||n.centeredRotation),a?!i:i}},_getOriginFromCorner:function(n,s){var i={x:n.originX,y:n.originY};return s==="ml"||s==="tl"||s==="bl"?i.x="right":(s==="mr"||s==="tr"||s==="br")&&(i.x="left"),s==="tl"||s==="mt"||s==="tr"?i.y="bottom":(s==="bl"||s==="mb"||s==="br")&&(i.y="top"),i},_getActionFromCorner:function(n,s,i,a){if(!s||!n)return"drag";var l=a.controls[s];return l.getActionName(i,l,a)},_setupCurrentTransform:function(n,s,i){if(s){var a=this.getPointer(n),l=s.__corner,u=s.controls[l],c=i&&l?u.getActionHandler(n,s,u):x.controlsUtils.dragHandler,h=this._getActionFromCorner(i,l,n,s),d=this._getOriginFromCorner(s,l),g=n[this.centeredKey],m={target:s,action:h,actionHandler:c,corner:l,scaleX:s.scaleX,scaleY:s.scaleY,skewX:s.skewX,skewY:s.skewY,offsetX:a.x-s.left,offsetY:a.y-s.top,originX:d.x,originY:d.y,ex:a.x,ey:a.y,lastX:a.x,lastY:a.y,theta:e(s.angle),width:s.width*s.scaleX,shiftKey:n.shiftKey,altKey:g,original:x.util.saveObjectTransform(s)};this._shouldCenterTransform(s,h,g)&&(m.originX="center",m.originY="center"),m.original.originX=d.x,m.original.originY=d.y,this._currentTransform=m,this._beforeTransform(n)}},setCursor:function(n){this.upperCanvasEl.style.cursor=n},_drawSelection:function(n){var s=this._groupSelector,i=new x.Point(s.ex,s.ey),a=x.util.transformPoint(i,this.viewportTransform),l=new x.Point(s.ex+s.left,s.ey+s.top),u=x.util.transformPoint(l,this.viewportTransform),c=Math.min(a.x,u.x),h=Math.min(a.y,u.y),d=Math.max(a.x,u.x),g=Math.max(a.y,u.y),m=this.selectionLineWidth/2;this.selectionColor&&(n.fillStyle=this.selectionColor,n.fillRect(c,h,d-c,g-h)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(n.lineWidth=this.selectionLineWidth,n.strokeStyle=this.selectionBorderColor,c+=m,h+=m,d-=m,g-=m,x.Object.prototype._setLineDash.call(this,n,this.selectionDashArray),n.strokeRect(c,h,d-c,g-h))},findTarget:function(n,s){if(!this.skipTargetFind){var i=!0,a=this.getPointer(n,i),l=this._activeObject,u=this.getActiveObjects(),c,h,d=r(n),g=u.length>1&&!s||u.length===1;if(this.targets=[],g&&l._findTargetCorner(a,d)||u.length>1&&!s&&l===this._searchPossibleTargets([l],a))return l;if(u.length===1&&l===this._searchPossibleTargets([l],a))if(this.preserveObjectStacking)c=l,h=this.targets,this.targets=[];else return l;var m=this._searchPossibleTargets(this._objects,a);return n[this.altSelectionKey]&&m&&c&&m!==c&&(m=c,this.targets=h),m}},_checkTarget:function(n,s,i){if(s&&s.visible&&s.evented&&s.containsPoint(n))if((this.perPixelTargetFind||s.perPixelTargetFind)&&!s.isEditing){var a=this.isTargetTransparent(s,i.x,i.y);if(!a)return!0}else return!0},_searchPossibleTargets:function(n,s){for(var i,a=n.length,l;a--;){var u=n[a],c=u.group?this._normalizePointer(u.group,s):s;if(this._checkTarget(c,u,s)){i=n[a],i.subTargetCheck&&i instanceof x.Group&&(l=this._searchPossibleTargets(i._objects,s),l&&this.targets.push(l));break}}return i},restorePointerVpt:function(n){return x.util.transformPoint(n,x.util.invertTransform(this.viewportTransform))},getPointer:function(n,s){if(this._absolutePointer&&!s)return this._absolutePointer;if(this._pointer&&s)return this._pointer;var i=t(n),a=this.upperCanvasEl,l=a.getBoundingClientRect(),u=l.width||0,c=l.height||0,h;(!u||!c)&&("top"in l&&"bottom"in l&&(c=Math.abs(l.top-l.bottom)),"right"in l&&"left"in l&&(u=Math.abs(l.right-l.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,s||(i=this.restorePointerVpt(i));var d=this.getRetinaScaling();return d!==1&&(i.x/=d,i.y/=d),u===0||c===0?h={width:1,height:1}:h={width:a.width/u,height:a.height/c},{x:i.x*h.width,y:i.y*h.height}},_createUpperCanvas:function(){var n=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),s=this.lowerCanvasEl,i=this.upperCanvasEl;i?i.className="":(i=this._createCanvasElement(),this.upperCanvasEl=i),x.util.addClass(i,"upper-canvas "+n),this.wrapperEl.appendChild(i),this._copyCanvasStyle(s,i),this._applyCanvasStyle(i),this.contextTop=i.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=x.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),x.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),x.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(n){var s=this.width||n.width,i=this.height||n.height;x.util.setStyle(n,{position:"absolute",width:s+"px",height:i+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),n.width=s,n.height=i,x.util.makeElementUnselectable(n)},_copyCanvasStyle:function(n,s){s.style.cssText=n.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var n=this._activeObject;return n?n.type==="activeSelection"&&n._objects?n._objects.slice(0):[n]:[]},_onObjectRemoved:function(n){n===this._activeObject&&(this.fire("before:selection:cleared",{target:n}),this._discardActiveObject(),this.fire("selection:cleared",{target:n}),n.fire("deselected")),n===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",n)},_fireSelectionEvents:function(n,s){var i=!1,a=this.getActiveObjects(),l=[],u=[];n.forEach(function(c){a.indexOf(c)===-1&&(i=!0,c.fire("deselected",{e:s,target:c}),u.push(c))}),a.forEach(function(c){n.indexOf(c)===-1&&(i=!0,c.fire("selected",{e:s,target:c}),l.push(c))}),n.length>0&&a.length>0?i&&this.fire("selection:updated",{e:s,selected:l,deselected:u}):a.length>0?this.fire("selection:created",{e:s,selected:l}):n.length>0&&this.fire("selection:cleared",{e:s,deselected:u})},setActiveObject:function(n,s){var i=this.getActiveObjects();return this._setActiveObject(n,s),this._fireSelectionEvents(i,s),this},_setActiveObject:function(n,s){return this._activeObject===n||!this._discardActiveObject(s,n)||n.onSelect({e:s})?!1:(this._activeObject=n,!0)},_discardActiveObject:function(n,s){var i=this._activeObject;if(i){if(i.onDeselect({e:n,object:s}))return!1;this._activeObject=null}return!0},discardActiveObject:function(n){var s=this.getActiveObjects(),i=this.getActiveObject();return s.length&&this.fire("before:selection:cleared",{target:i,e:n}),this._discardActiveObject(n),this._fireSelectionEvents(s,n),this},dispose:function(){var n=this.wrapperEl;return this.removeListeners(),n.removeChild(this.upperCanvasEl),n.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(s){x.util.cleanUpJsdomNode(this[s]),this[s]=void 0}.bind(this)),n.parentNode&&n.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,x.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(n){var s=this._activeObject;s&&s._renderControls(n)},_toObject:function(n,s,i){var a=this._realizeGroupTransformOnObject(n),l=this.callSuper("_toObject",n,s,i);return this._unwindGroupTransformOnObject(n,a),l},_realizeGroupTransformOnObject:function(n){if(n.group&&n.group.type==="activeSelection"&&this._activeObject===n.group){var s=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],i={};return s.forEach(function(a){i[a]=n[a]}),x.util.addTransformToObject(n,this._activeObject.calcOwnMatrix()),i}else return null},_unwindGroupTransformOnObject:function(n,s){s&&n.set(s)},_setSVGObject:function(n,s,i){var a=this._realizeGroupTransformOnObject(s);this.callSuper("_setSVGObject",n,s,i),this._unwindGroupTransformOnObject(s,a)},setViewportTransform:function(n){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),x.StaticCanvas.prototype.setViewportTransform.call(this,n)}});for(var o in x.StaticCanvas)o!=="prototype"&&(x.Canvas[o]=x.StaticCanvas[o])})();(function(){var t=x.util.addListener,e=x.util.removeListener,r=3,o=2,n=1,s={passive:!1};function i(a,l){return a.button&&a.button===l-1}x.util.object.extend(x.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(t,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(a,l){var u=this.upperCanvasEl,c=this._getEventPrefix();a(x.window,"resize",this._onResize),a(u,c+"down",this._onMouseDown),a(u,c+"move",this._onMouseMove,s),a(u,c+"out",this._onMouseOut),a(u,c+"enter",this._onMouseEnter),a(u,"wheel",this._onMouseWheel),a(u,"contextmenu",this._onContextMenu),a(u,"dblclick",this._onDoubleClick),a(u,"dragover",this._onDragOver),a(u,"dragenter",this._onDragEnter),a(u,"dragleave",this._onDragLeave),a(u,"drop",this._onDrop),this.enablePointerEvents||a(u,"touchstart",this._onTouchStart,s),typeof eventjs<"u"&&l in eventjs&&(eventjs[l](u,"gesture",this._onGesture),eventjs[l](u,"drag",this._onDrag),eventjs[l](u,"orientation",this._onOrientationChange),eventjs[l](u,"shake",this._onShake),eventjs[l](u,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(e,"remove");var a=this._getEventPrefix();e(x.document,a+"up",this._onMouseUp),e(x.document,"touchend",this._onTouchEnd,s),e(x.document,a+"move",this._onMouseMove,s),e(x.document,"touchmove",this._onMouseMove,s)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(a,l){this.__onTransformGesture&&this.__onTransformGesture(a,l)},_onDrag:function(a,l){this.__onDrag&&this.__onDrag(a,l)},_onMouseWheel:function(a){this.__onMouseWheel(a)},_onMouseOut:function(a){var l=this._hoveredTarget;this.fire("mouse:out",{target:l,e:a}),this._hoveredTarget=null,l&&l.fire("mouseout",{e:a});var u=this;this._hoveredTargets.forEach(function(c){u.fire("mouse:out",{target:l,e:a}),c&&l.fire("mouseout",{e:a})}),this._hoveredTargets=[]},_onMouseEnter:function(a){!this._currentTransform&&!this.findTarget(a)&&(this.fire("mouse:over",{target:null,e:a}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(a,l){this.__onOrientationChange&&this.__onOrientationChange(a,l)},_onShake:function(a,l){this.__onShake&&this.__onShake(a,l)},_onLongPress:function(a,l){this.__onLongPress&&this.__onLongPress(a,l)},_onDragOver:function(a){a.preventDefault();var l=this._simpleEventHandler("dragover",a);this._fireEnterLeaveEvents(l,a)},_onDrop:function(a){return this._simpleEventHandler("drop:before",a),this._simpleEventHandler("drop",a)},_onContextMenu:function(a){return this.stopContextMenu&&(a.stopPropagation(),a.preventDefault()),!1},_onDoubleClick:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"dblclick"),this._resetTransformEventData(a)},getPointerId:function(a){var l=a.changedTouches;return l?l[0]&&l[0].identifier:this.enablePointerEvents?a.pointerId:-1},_isMainEvent:function(a){return a.isPrimary===!0?!0:a.isPrimary===!1?!1:a.type==="touchend"&&a.touches.length===0?!0:a.changedTouches?a.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(a){a.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(a)),this.__onMouseDown(a),this._resetTransformEventData();var l=this.upperCanvasEl,u=this._getEventPrefix();t(x.document,"touchend",this._onTouchEnd,s),t(x.document,"touchmove",this._onMouseMove,s),e(l,u+"down",this._onMouseDown)},_onMouseDown:function(a){this.__onMouseDown(a),this._resetTransformEventData();var l=this.upperCanvasEl,u=this._getEventPrefix();e(l,u+"move",this._onMouseMove,s),t(x.document,u+"up",this._onMouseUp),t(x.document,u+"move",this._onMouseMove,s)},_onTouchEnd:function(a){if(!(a.touches.length>0)){this.__onMouseUp(a),this._resetTransformEventData(),this.mainTouchId=null;var l=this._getEventPrefix();e(x.document,"touchend",this._onTouchEnd,s),e(x.document,"touchmove",this._onMouseMove,s);var u=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){t(u.upperCanvasEl,l+"down",u._onMouseDown),u._willAddMouseDown=0},400)}},_onMouseUp:function(a){this.__onMouseUp(a),this._resetTransformEventData();var l=this.upperCanvasEl,u=this._getEventPrefix();this._isMainEvent(a)&&(e(x.document,u+"up",this._onMouseUp),e(x.document,u+"move",this._onMouseMove,s),t(l,u+"move",this._onMouseMove,s))},_onMouseMove:function(a){!this.allowTouchScrolling&&a.preventDefault&&a.preventDefault(),this.__onMouseMove(a)},_onResize:function(){this.calcOffset()},_shouldRender:function(a){var l=this._activeObject;return!!l!=!!a||l&&a&&l!==a?!0:(l&&l.isEditing,!1)},__onMouseUp:function(a){var l,u=this._currentTransform,c=this._groupSelector,h=!1,d=!c||c.left===0&&c.top===0;if(this._cacheTransformEventData(a),l=this._target,this._handleEvent(a,"up:before"),i(a,r)){this.fireRightClick&&this._handleEvent(a,"up",r,d);return}if(i(a,o)){this.fireMiddleClick&&this._handleEvent(a,"up",o,d),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(a);return}if(this._isMainEvent(a)){if(u&&(this._finalizeCurrentTransform(a),h=u.actionPerformed),!d){var g=l===this._activeObject;this._maybeGroupObjects(a),h||(h=this._shouldRender(l)||!g&&l===this._activeObject)}var m,y;if(l){if(m=l._findTargetCorner(this.getPointer(a,!0),x.util.isTouchEvent(a)),l.selectable&&l!==this._activeObject&&l.activeOn==="up")this.setActiveObject(l,a),h=!0;else{var C=l.controls[m],b=C&&C.getMouseUpHandler(a,l,C);b&&(y=this.getPointer(a),b(a,u,y.x,y.y))}l.isMoving=!1}if(u&&(u.target!==l||u.corner!==m)){var k=u.target&&u.target.controls[u.corner],L=k&&k.getMouseUpHandler(a,l,C);y=y||this.getPointer(a),L&&L(a,u,y.x,y.y)}this._setCursorFromEvent(a,l),this._handleEvent(a,"up",n,d),this._groupSelector=null,this._currentTransform=null,l&&(l.__corner=0),h?this.requestRenderAll():d||this.renderTop()}},_simpleEventHandler:function(a,l){var u=this.findTarget(l),c=this.targets,h={e:l,target:u,subTargets:c};if(this.fire(a,h),u&&u.fire(a,h),!c)return u;for(var d=0;d<c.length;d++)c[d].fire(a,h);return u},_handleEvent:function(a,l,u,c){var h=this._target,d=this.targets||[],g={e:a,target:h,subTargets:d,button:u||n,isClick:c||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};l==="up"&&(g.currentTarget=this.findTarget(a),g.currentSubTargets=this.targets),this.fire("mouse:"+l,g),h&&h.fire("mouse"+l,g);for(var m=0;m<d.length;m++)d[m].fire("mouse"+l,g)},_finalizeCurrentTransform:function(a){var l=this._currentTransform,u=l.target,c={e:a,target:u,transform:l,action:l.action};u._scaling&&(u._scaling=!1),u.setCoords(),(l.actionPerformed||this.stateful&&u.hasStateChanged())&&this._fire("modified",c)},_onMouseDownInDrawingMode:function(a){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(a).requestRenderAll();var l=this.getPointer(a);this.freeDrawingBrush.onMouseDown(l,{e:a,pointer:l}),this._handleEvent(a,"down")},_onMouseMoveInDrawingMode:function(a){if(this._isCurrentlyDrawing){var l=this.getPointer(a);this.freeDrawingBrush.onMouseMove(l,{e:a,pointer:l})}this.setCursor(this.freeDrawingCursor),this._handleEvent(a,"move")},_onMouseUpInDrawingMode:function(a){var l=this.getPointer(a);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:a,pointer:l}),this._handleEvent(a,"up")},__onMouseDown:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"down:before");var l=this._target;if(i(a,r)){this.fireRightClick&&this._handleEvent(a,"down",r);return}if(i(a,o)){this.fireMiddleClick&&this._handleEvent(a,"down",o);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(a);return}if(this._isMainEvent(a)&&!this._currentTransform){var u=this._pointer;this._previousPointer=u;var c=this._shouldRender(l),h=this._shouldGroup(a,l);if(this._shouldClearSelection(a,l)?this.discardActiveObject(a):h&&(this._handleGrouping(a,l),l=this._activeObject),this.selection&&(!l||!l.selectable&&!l.isEditing&&l!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),l){var d=l===this._activeObject;l.selectable&&l.activeOn==="down"&&this.setActiveObject(l,a);var g=l._findTargetCorner(this.getPointer(a,!0),x.util.isTouchEvent(a));if(l.__corner=g,l===this._activeObject&&(g||!h)){this._setupCurrentTransform(a,l,d);var m=l.controls[g],u=this.getPointer(a),y=m&&m.getMouseDownHandler(a,l,m);y&&y(a,this._currentTransform,u.x,u.y)}}this._handleEvent(a,"down"),(c||h)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(a){this._resetTransformEventData(),this._pointer=this.getPointer(a,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(a)||null},_beforeTransform:function(a){var l=this._currentTransform;this.stateful&&l.target.saveState(),this.fire("before:transform",{e:a,transform:l})},__onMouseMove:function(a){this._handleEvent(a,"move:before"),this._cacheTransformEventData(a);var l,u;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(a);return}if(this._isMainEvent(a)){var c=this._groupSelector;c?(u=this._absolutePointer,c.left=u.x-c.ex,c.top=u.y-c.ey,this.renderTop()):this._currentTransform?this._transformObject(a):(l=this.findTarget(a)||null,this._setCursorFromEvent(a,l),this._fireOverOutEvents(l,a)),this._handleEvent(a,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(a,l){var u=this._hoveredTarget,c=this._hoveredTargets,h=this.targets,d=Math.max(c.length,h.length);this.fireSyntheticInOutEvents(a,l,{oldTarget:u,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var g=0;g<d;g++)this.fireSyntheticInOutEvents(h[g],l,{oldTarget:c[g],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=a,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(a,l){var u=this._draggedoverTarget,c=this._hoveredTargets,h=this.targets,d=Math.max(c.length,h.length);this.fireSyntheticInOutEvents(a,l,{oldTarget:u,evtOut:"dragleave",evtIn:"dragenter"});for(var g=0;g<d;g++)this.fireSyntheticInOutEvents(h[g],l,{oldTarget:c[g],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=a},fireSyntheticInOutEvents:function(a,l,u){var c,h,d=u.oldTarget,g,m,y=d!==a,C=u.canvasEvtIn,b=u.canvasEvtOut;y&&(c={e:l,target:a,previousTarget:d},h={e:l,target:d,nextTarget:a}),m=a&&y,g=d&&y,g&&(b&&this.fire(b,h),d.fire(u.evtOut,h)),m&&(C&&this.fire(C,c),a.fire(u.evtIn,c))},__onMouseWheel:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"wheel"),this._resetTransformEventData()},_transformObject:function(a){var l=this.getPointer(a),u=this._currentTransform;u.reset=!1,u.shiftKey=a.shiftKey,u.altKey=a[this.centeredKey],this._performTransformAction(a,u,l),u.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(a,l,u){var c=u.x,h=u.y,d=l.action,g=!1,m=l.actionHandler;m&&(g=m(a,l,c,h)),d==="drag"&&g&&(l.target.isMoving=!0,this.setCursor(l.target.moveCursor||this.moveCursor)),l.actionPerformed=l.actionPerformed||g},_fire:x.controlsUtils.fireEvent,_setCursorFromEvent:function(a,l){if(!l)return this.setCursor(this.defaultCursor),!1;var u=l.hoverCursor||this.hoverCursor,c=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,h=(!c||!c.contains(l))&&l._findTargetCorner(this.getPointer(a,!0));h?this.setCursor(this.getCornerCursor(h,l,a)):(l.subTargetCheck&&this.targets.concat().reverse().map(function(d){u=d.hoverCursor||u}),this.setCursor(u))},getCornerCursor:function(a,l,u){var c=l.controls[a];return c.cursorStyleHandler(u,c,l)}})})();(function(){var t=Math.min,e=Math.max;x.util.object.extend(x.Canvas.prototype,{_shouldGroup:function(r,o){var n=this._activeObject;return n&&this._isSelectionKeyPressed(r)&&o&&o.selectable&&this.selection&&(n!==o||n.type==="activeSelection")&&!o.onSelect({e:r})},_handleGrouping:function(r,o){var n=this._activeObject;n.__corner||o===n&&(o=this.findTarget(r,!0),!o||!o.selectable)||(n&&n.type==="activeSelection"?this._updateActiveSelection(o,r):this._createActiveSelection(o,r))},_updateActiveSelection:function(r,o){var n=this._activeObject,s=n._objects.slice(0);n.contains(r)?(n.removeWithUpdate(r),this._hoveredTarget=r,this._hoveredTargets=this.targets.concat(),n.size()===1&&this._setActiveObject(n.item(0),o)):(n.addWithUpdate(r),this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(s,o)},_createActiveSelection:function(r,o){var n=this.getActiveObjects(),s=this._createGroup(r);this._hoveredTarget=s,this._setActiveObject(s,o),this._fireSelectionEvents(n,o)},_createGroup:function(r){var o=this._objects,n=o.indexOf(this._activeObject)<o.indexOf(r),s=n?[this._activeObject,r]:[r,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new x.ActiveSelection(s,{canvas:this})},_groupSelectedObjects:function(r){var o=this._collectObjects(r),n;o.length===1?this.setActiveObject(o[0],r):o.length>1&&(n=new x.ActiveSelection(o.reverse(),{canvas:this}),this.setActiveObject(n,r))},_collectObjects:function(r){for(var o=[],n,s=this._groupSelector.ex,i=this._groupSelector.ey,a=s+this._groupSelector.left,l=i+this._groupSelector.top,u=new x.Point(t(s,a),t(i,l)),c=new x.Point(e(s,a),e(i,l)),h=!this.selectionFullyContained,d=s===a&&i===l,g=this._objects.length;g--&&(n=this._objects[g],!(!(!n||!n.selectable||!n.visible)&&(h&&n.intersectsWithRect(u,c,!0)||n.isContainedWithinRect(u,c,!0)||h&&n.containsPoint(u,null,!0)||h&&n.containsPoint(c,null,!0))&&(o.push(n),d))););return o.length>1&&(o=o.filter(function(m){return!m.onSelect({e:r})})),o},_maybeGroupObjects:function(r){this.selection&&this._groupSelector&&this._groupSelectedObjects(r),this.setCursor(this.defaultCursor),this._groupSelector=null}})})();(function(){x.util.object.extend(x.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",r=t.quality||1,o=(t.multiplier||1)*(t.enableRetinaScaling?this.getRetinaScaling():1),n=this.toCanvasElement(o,t);return x.util.toDataURL(n,e,r)},toCanvasElement:function(t,e){t=t||1,e=e||{};var r=(e.width||this.width)*t,o=(e.height||this.height)*t,n=this.getZoom(),s=this.width,i=this.height,a=n*t,l=this.viewportTransform,u=(l[4]-(e.left||0))*t,c=(l[5]-(e.top||0))*t,h=this.interactive,d=[a,0,0,a,u,c],g=this.enableRetinaScaling,m=x.util.createCanvasElement(),y=this.contextTop;return m.width=r,m.height=o,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=d,this.width=r,this.height=o,this.calcViewportBoundaries(),this.renderCanvas(m.getContext("2d"),this._objects),this.viewportTransform=l,this.width=s,this.height=i,this.calcViewportBoundaries(),this.interactive=h,this.enableRetinaScaling=g,this.contextTop=y,m}})})();x.util.object.extend(x.StaticCanvas.prototype,{loadFromJSON:function(t,e,r){if(t){var o=typeof t=="string"?JSON.parse(t):x.util.object.clone(t),n=this,s=o.clipPath,i=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete o.clipPath,this._enlivenObjects(o.objects,function(a){n.clear(),n._setBgOverlay(o,function(){s?n._enlivenObjects([s],function(l){n.clipPath=l[0],n.__setupCanvas.call(n,o,a,i,e)}):n.__setupCanvas.call(n,o,a,i,e)})},r),this}},__setupCanvas:function(t,e,r,o){var n=this;e.forEach(function(s,i){n.insertAt(s,i)}),this.renderOnAddRemove=r,delete t.objects,delete t.backgroundImage,delete t.overlayImage,delete t.background,delete t.overlay,this._setOptions(t),this.renderAll(),o&&o()},_setBgOverlay:function(t,e){var r={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!t.backgroundImage&&!t.overlayImage&&!t.background&&!t.overlay){e&&e();return}var o=function(){r.backgroundImage&&r.overlayImage&&r.backgroundColor&&r.overlayColor&&e&&e()};this.__setBgOverlay("backgroundImage",t.backgroundImage,r,o),this.__setBgOverlay("overlayImage",t.overlayImage,r,o),this.__setBgOverlay("backgroundColor",t.background,r,o),this.__setBgOverlay("overlayColor",t.overlay,r,o)},__setBgOverlay:function(t,e,r,o){var n=this;if(!e){r[t]=!0,o&&o();return}t==="backgroundImage"||t==="overlayImage"?x.util.enlivenObjects([e],function(s){n[t]=s[0],r[t]=!0,o&&o()}):this["set"+x.util.string.capitalize(t,!0)](e,function(){r[t]=!0,o&&o()})},_enlivenObjects:function(t,e,r){if(!t||t.length===0){e&&e([]);return}x.util.enlivenObjects(t,function(o){e&&e(o)},null,r)},_toDataURL:function(t,e){this.clone(function(r){e(r.toDataURL(t))})},_toDataURLWithMultiplier:function(t,e,r){this.clone(function(o){r(o.toDataURLWithMultiplier(t,e))})},clone:function(t,e){var r=JSON.stringify(this.toJSON(e));this.cloneWithoutData(function(o){o.loadFromJSON(r,function(){t&&t(o)})})},cloneWithoutData:function(t){var e=x.util.createCanvasElement();e.width=this.width,e.height=this.height;var r=new x.Canvas(e);this.backgroundImage?(r.setBackgroundImage(this.backgroundImage.src,function(){r.renderAll(),t&&t(r)}),r.backgroundImageOpacity=this.backgroundImageOpacity,r.backgroundImageStretch=this.backgroundImageStretch):t&&t(r)}});(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,o=e.util.object.clone,n=e.util.toFixed,s=e.util.string.capitalize,i=e.util.degreesToRadians,a=!e.isLikelyNode,l=2;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:a,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(u){u&&this.setOptions(u)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(u){var c=e.perfLimitSizeTotal,h=u.width,d=u.height,g=e.maxCacheSideLimit,m=e.minCacheSideLimit;if(h<=g&&d<=g&&h*d<=c)return h<m&&(u.width=m),d<m&&(u.height=m),u;var y=h/d,C=e.util.limitDimsByArea(y,c),b=e.util.capValue,k=b(m,C.x,g),L=b(m,C.y,g);return h>k&&(u.zoomX/=h/k,u.width=k,u.capped=!0),d>L&&(u.zoomY/=d/L,u.height=L,u.capped=!0),u},_getCacheCanvasDimensions:function(){var u=this.getTotalObjectScaling(),c=this._getTransformedDimensions(0,0),h=c.x*u.scaleX/this.scaleX,d=c.y*u.scaleY/this.scaleY;return{width:h+l,height:d+l,zoomX:u.scaleX,zoomY:u.scaleY,x:h,y:d}},_updateCacheCanvas:function(){var u=this.canvas;if(this.noScaleCache&&u&&u._currentTransform){var c=u._currentTransform.target,h=u._currentTransform.action;if(this===c&&h.slice&&h.slice(0,5)==="scale")return!1}var d=this._cacheCanvas,g=this._limitCacheSize(this._getCacheCanvasDimensions()),m=e.minCacheSideLimit,y=g.width,C=g.height,b,k,L=g.zoomX,N=g.zoomY,M=y!==this.cacheWidth||C!==this.cacheHeight,W=this.zoomX!==L||this.zoomY!==N,Y=M||W,J=0,oe=0,pe=!1;if(M){var le=this._cacheCanvas.width,w=this._cacheCanvas.height,F=y>le||C>w,P=(y<le*.9||C<w*.9)&&le>m&&w>m;pe=F||P,F&&!g.capped&&(y>m||C>m)&&(J=y*.1,oe=C*.1)}return this instanceof e.Text&&this.path&&(Y=!0,pe=!0,J+=this.getHeightOfLine(0)*this.zoomX,oe+=this.getHeightOfLine(0)*this.zoomY),Y?(pe?(d.width=Math.ceil(y+J),d.height=Math.ceil(C+oe)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,d.width,d.height)),b=g.x/2,k=g.y/2,this.cacheTranslationX=Math.round(d.width/2-b)+b,this.cacheTranslationY=Math.round(d.height/2-k)+k,this.cacheWidth=y,this.cacheHeight=C,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(L,N),this.zoomX=L,this.zoomY=N,!0):!1},setOptions:function(u){this._setOptions(u),this._initGradient(u.fill,"fill"),this._initGradient(u.stroke,"stroke"),this._initPattern(u.fill,"fill"),this._initPattern(u.stroke,"stroke")},transform:function(u){var c=this.group&&!this.group._transformDone||this.group&&this.canvas&&u===this.canvas.contextTop,h=this.calcTransformMatrix(!c);u.transform(h[0],h[1],h[2],h[3],h[4],h[5])},toObject:function(u){var c=e.Object.NUM_FRACTION_DIGITS,h={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:n(this.left,c),top:n(this.top,c),width:n(this.width,c),height:n(this.height,c),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:n(this.strokeWidth,c),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:n(this.strokeMiterLimit,c),scaleX:n(this.scaleX,c),scaleY:n(this.scaleY,c),angle:n(this.angle,c),flipX:this.flipX,flipY:this.flipY,opacity:n(this.opacity,c),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:n(this.skewX,c),skewY:n(this.skewY,c)};return this.clipPath&&!this.clipPath.excludeFromExport&&(h.clipPath=this.clipPath.toObject(u),h.clipPath.inverted=this.clipPath.inverted,h.clipPath.absolutePositioned=this.clipPath.absolutePositioned),e.util.populateWithProperties(this,h,u),this.includeDefaultValues||(h=this._removeDefaultValues(h)),h},toDatalessObject:function(u){return this.toObject(u)},_removeDefaultValues:function(u){var c=e.util.getKlass(u.type).prototype,h=c.stateProperties;return h.forEach(function(d){d==="left"||d==="top"||(u[d]===c[d]&&delete u[d],Array.isArray(u[d])&&Array.isArray(c[d])&&u[d].length===0&&c[d].length===0&&delete u[d])}),u},toString:function(){return"#<fabric."+s(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var u=e.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(u.scaleX),scaleY:Math.abs(u.scaleY)}},getTotalObjectScaling:function(){var u=this.getObjectScaling(),c=u.scaleX,h=u.scaleY;if(this.canvas){var d=this.canvas.getZoom(),g=this.canvas.getRetinaScaling();c*=d*g,h*=d*g}return{scaleX:c,scaleY:h}},getObjectOpacity:function(){var u=this.opacity;return this.group&&(u*=this.group.getObjectOpacity()),u},_set:function(u,c){var h=u==="scaleX"||u==="scaleY",d=this[u]!==c,g=!1;return h&&(c=this._constrainScale(c)),u==="scaleX"&&c<0?(this.flipX=!this.flipX,c*=-1):u==="scaleY"&&c<0?(this.flipY=!this.flipY,c*=-1):u==="shadow"&&c&&!(c instanceof e.Shadow)?c=new e.Shadow(c):u==="dirty"&&this.group&&this.group.set("dirty",c),this[u]=c,d&&(g=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(u)>-1?(this.dirty=!0,g&&this.group.set("dirty",!0)):g&&this.stateProperties.indexOf(u)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(u){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(u.save(),this._setupCompositeOperation(u),this.drawSelectionBackground(u),this.transform(u),this._setOpacity(u),this._setShadow(u,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(u)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(u),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),u.restore())},renderCache:function(u){u=u||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,u.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(u,c){if(u.save(),c.inverted?u.globalCompositeOperation="destination-out":u.globalCompositeOperation="destination-in",c.absolutePositioned){var h=e.util.invertTransform(this.calcTransformMatrix());u.transform(h[0],h[1],h[2],h[3],h[4],h[5])}c.transform(u),u.scale(1/c.zoomX,1/c.zoomY),u.drawImage(c._cacheCanvas,-c.cacheTranslationX,-c.cacheTranslationY),u.restore()},drawObject:function(u,c){var h=this.fill,d=this.stroke;c?(this.fill="black",this.stroke="",this._setClippingProperties(u)):this._renderBackground(u),this._render(u),this._drawClipPath(u,this.clipPath),this.fill=h,this.stroke=d},_drawClipPath:function(u,c){c&&(c.canvas=this.canvas,c.shouldCache(),c._transformDone=!0,c.renderCache({forClipping:!0}),this.drawClipPathOnCache(u,c))},drawCacheOnCanvas:function(u){u.scale(1/this.zoomX,1/this.zoomY),u.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(u){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!u&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!u){var c=this.cacheWidth/this.zoomX,h=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-c/2,-h/2,c,h)}return!0}return!1},_renderBackground:function(u){if(this.backgroundColor){var c=this._getNonTransformedDimensions();u.fillStyle=this.backgroundColor,u.fillRect(-c.x/2,-c.y/2,c.x,c.y),this._removeShadow(u)}},_setOpacity:function(u){this.group&&!this.group._transformDone?u.globalAlpha=this.getObjectOpacity():u.globalAlpha*=this.opacity},_setStrokeStyles:function(u,c){var h=c.stroke;h&&(u.lineWidth=c.strokeWidth,u.lineCap=c.strokeLineCap,u.lineDashOffset=c.strokeDashOffset,u.lineJoin=c.strokeLineJoin,u.miterLimit=c.strokeMiterLimit,h.toLive?h.gradientUnits==="percentage"||h.gradientTransform||h.patternTransform?this._applyPatternForTransformedGradient(u,h):(u.strokeStyle=h.toLive(u,this),this._applyPatternGradientTransform(u,h)):u.strokeStyle=c.stroke)},_setFillStyles:function(u,c){var h=c.fill;h&&(h.toLive?(u.fillStyle=h.toLive(u,this),this._applyPatternGradientTransform(u,c.fill)):u.fillStyle=h)},_setClippingProperties:function(u){u.globalAlpha=1,u.strokeStyle="transparent",u.fillStyle="#000000"},_setLineDash:function(u,c){!c||c.length===0||(1&c.length&&c.push.apply(c,c),u.setLineDash(c))},_renderControls:function(u,c){var h=this.getViewportTransform(),d=this.calcTransformMatrix(),g,m,y;c=c||{},m=typeof c.hasBorders<"u"?c.hasBorders:this.hasBorders,y=typeof c.hasControls<"u"?c.hasControls:this.hasControls,d=e.util.multiplyTransformMatrices(h,d),g=e.util.qrDecompose(d),u.save(),u.translate(g.translateX,g.translateY),u.lineWidth=1*this.borderScaleFactor,this.group||(u.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(g.angle-=180),u.rotate(i(this.group?g.angle:this.angle)),c.forActiveSelection||this.group?m&&this.drawBordersInGroup(u,g,c):m&&this.drawBorders(u,c),y&&this.drawControls(u,c),u.restore()},_setShadow:function(u){if(this.shadow){var c=this.shadow,h=this.canvas,d,g=h&&h.viewportTransform[0]||1,m=h&&h.viewportTransform[3]||1;c.nonScaling?d={scaleX:1,scaleY:1}:d=this.getObjectScaling(),h&&h._isRetinaScaling()&&(g*=e.devicePixelRatio,m*=e.devicePixelRatio),u.shadowColor=c.color,u.shadowBlur=c.blur*e.browserShadowBlurConstant*(g+m)*(d.scaleX+d.scaleY)/4,u.shadowOffsetX=c.offsetX*g*d.scaleX,u.shadowOffsetY=c.offsetY*m*d.scaleY}},_removeShadow:function(u){this.shadow&&(u.shadowColor="",u.shadowBlur=u.shadowOffsetX=u.shadowOffsetY=0)},_applyPatternGradientTransform:function(u,c){if(!c||!c.toLive)return{offsetX:0,offsetY:0};var h=c.gradientTransform||c.patternTransform,d=-this.width/2+c.offsetX||0,g=-this.height/2+c.offsetY||0;return c.gradientUnits==="percentage"?u.transform(this.width,0,0,this.height,d,g):u.transform(1,0,0,1,d,g),h&&u.transform(h[0],h[1],h[2],h[3],h[4],h[5]),{offsetX:d,offsetY:g}},_renderPaintInOrder:function(u){this.paintFirst==="stroke"?(this._renderStroke(u),this._renderFill(u)):(this._renderFill(u),this._renderStroke(u))},_render:function(){},_renderFill:function(u){this.fill&&(u.save(),this._setFillStyles(u,this),this.fillRule==="evenodd"?u.fill("evenodd"):u.fill(),u.restore())},_renderStroke:function(u){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(u),u.save(),this.strokeUniform&&this.group){var c=this.getObjectScaling();u.scale(1/c.scaleX,1/c.scaleY)}else this.strokeUniform&&u.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(u,this.strokeDashArray),this._setStrokeStyles(u,this),u.stroke(),u.restore()}},_applyPatternForTransformedGradient:function(u,c){var h=this._limitCacheSize(this._getCacheCanvasDimensions()),d=e.util.createCanvasElement(),g,m=this.canvas.getRetinaScaling(),y=h.x/this.scaleX/m,C=h.y/this.scaleY/m;d.width=y,d.height=C,g=d.getContext("2d"),g.beginPath(),g.moveTo(0,0),g.lineTo(y,0),g.lineTo(y,C),g.lineTo(0,C),g.closePath(),g.translate(y/2,C/2),g.scale(h.zoomX/this.scaleX/m,h.zoomY/this.scaleY/m),this._applyPatternGradientTransform(g,c),g.fillStyle=c.toLive(u),g.fill(),u.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),u.scale(m*this.scaleX/h.zoomX,m*this.scaleY/h.zoomY),u.strokeStyle=g.createPattern(d,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var u=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",u.scaleX),this.set("scaleY",u.scaleY),this.angle=u.angle,this.skewX=u.skewX,this.skewY=0}},_removeTransformMatrix:function(u){var c=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),c=e.util.transformPoint(c,this.transformMatrix)),this.transformMatrix=null,u&&(this.scaleX*=u.scaleX,this.scaleY*=u.scaleY,this.cropX=u.cropX,this.cropY=u.cropY,c.x+=u.offsetLeft,c.y+=u.offsetTop,this.width=u.width,this.height=u.height),this.setPositionByOrigin(c,"center","center")},clone:function(u,c){var h=this.toObject(c);this.constructor.fromObject?this.constructor.fromObject(h,u):e.Object._fromObject("Object",h,u)},cloneAsImage:function(u,c){var h=this.toCanvasElement(c);return u&&u(new e.Image(h)),this},toCanvasElement:function(u){u||(u={});var c=e.util,h=c.saveObjectTransform(this),d=this.group,g=this.shadow,m=Math.abs,y=(u.multiplier||1)*(u.enableRetinaScaling?e.devicePixelRatio:1);delete this.group,u.withoutTransform&&c.resetObjectTransform(this),u.withoutShadow&&(this.shadow=null);var C=e.util.createCanvasElement(),b=this.getBoundingRect(!0,!0),k=this.shadow,L,N={x:0,y:0},M,W,Y;k&&(M=k.blur,k.nonScaling?L={scaleX:1,scaleY:1}:L=this.getObjectScaling(),N.x=2*Math.round(m(k.offsetX)+M)*m(L.scaleX),N.y=2*Math.round(m(k.offsetY)+M)*m(L.scaleY)),W=b.width+N.x,Y=b.height+N.y,C.width=Math.ceil(W),C.height=Math.ceil(Y);var J=new e.StaticCanvas(C,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});u.format==="jpeg"&&(J.backgroundColor="#fff"),this.setPositionByOrigin(new e.Point(J.width/2,J.height/2),"center","center");var oe=this.canvas;J.add(this);var pe=J.toCanvasElement(y||1,u);return this.shadow=g,this.set("canvas",oe),d&&(this.group=d),this.set(h).setCoords(),J._objects=[],J.dispose(),J=null,pe},toDataURL:function(u){return u||(u={}),e.util.toDataURL(this.toCanvasElement(u),u.format||"png",u.quality||1)},isType:function(u){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===u},complexity:function(){return 1},toJSON:function(u){return this.toObject(u)},rotate:function(u){var c=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return c&&this._setOriginToCenter(),this.set("angle",u),c&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(u,c){c=c||this.canvas.getPointer(u);var h=new e.Point(c.x,c.y),d=this._getLeftTopCoords();return this.angle&&(h=e.util.rotatePoint(h,d,i(-this.angle))),{x:h.x-d.x,y:h.y-d.y}},_setupCompositeOperation:function(u){this.globalCompositeOperation&&(u.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){e.runningAnimations&&e.runningAnimations.cancelByTarget(this)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),r(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object.ENLIVEN_PROPS=["clipPath"],e.Object._fromObject=function(u,c,h,d){var g=e[u];c=o(c,!0),e.util.enlivenPatterns([c.fill,c.stroke],function(m){typeof m[0]<"u"&&(c.fill=m[0]),typeof m[1]<"u"&&(c.stroke=m[1]),e.util.enlivenObjectEnlivables(c,c,function(){var y=d?new g(c[d],c):new g(c);h&&h(y)})})},e.Object.__uid=0)})(Ce);(function(){var t=x.util.degreesToRadians,e={left:-.5,center:0,right:.5},r={top:-.5,center:0,bottom:.5};x.util.object.extend(x.Object.prototype,{translateToGivenOrigin:function(o,n,s,i,a){var l=o.x,u=o.y,c,h,d;return typeof n=="string"?n=e[n]:n-=.5,typeof i=="string"?i=e[i]:i-=.5,c=i-n,typeof s=="string"?s=r[s]:s-=.5,typeof a=="string"?a=r[a]:a-=.5,h=a-s,(c||h)&&(d=this._getTransformedDimensions(),l=o.x+c*d.x,u=o.y+h*d.y),new x.Point(l,u)},translateToCenterPoint:function(o,n,s){var i=this.translateToGivenOrigin(o,n,s,"center","center");return this.angle?x.util.rotatePoint(i,o,t(this.angle)):i},translateToOriginPoint:function(o,n,s){var i=this.translateToGivenOrigin(o,"center","center",n,s);return this.angle?x.util.rotatePoint(i,o,t(this.angle)):i},getCenterPoint:function(){var o=new x.Point(this.left,this.top);return this.translateToCenterPoint(o,this.originX,this.originY)},getPointByOrigin:function(o,n){var s=this.getCenterPoint();return this.translateToOriginPoint(s,o,n)},toLocalPoint:function(o,n,s){var i=this.getCenterPoint(),a,l;return typeof n<"u"&&typeof s<"u"?a=this.translateToGivenOrigin(i,"center","center",n,s):a=new x.Point(this.left,this.top),l=new x.Point(o.x,o.y),this.angle&&(l=x.util.rotatePoint(l,i,-t(this.angle))),l.subtractEquals(a)},setPositionByOrigin:function(o,n,s){var i=this.translateToCenterPoint(o,n,s),a=this.translateToOriginPoint(i,this.originX,this.originY);this.set("left",a.x),this.set("top",a.y)},adjustPosition:function(o){var n=t(this.angle),s=this.getScaledWidth(),i=x.util.cos(n)*s,a=x.util.sin(n)*s,l,u;typeof this.originX=="string"?l=e[this.originX]:l=this.originX-.5,typeof o=="string"?u=e[o]:u=o-.5,this.left+=i*(u-l),this.top+=a*(u-l),this.setCoords(),this.originX=o},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var o=this.getCenterPoint();this.originX="center",this.originY="center",this.left=o.x,this.top=o.y},_resetOrigin:function(){var o=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=o.x,this.top=o.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})})();(function(){function t(s){return[new x.Point(s.tl.x,s.tl.y),new x.Point(s.tr.x,s.tr.y),new x.Point(s.br.x,s.br.y),new x.Point(s.bl.x,s.bl.y)]}var e=x.util,r=e.degreesToRadians,o=e.multiplyTransformMatrices,n=e.transformPoint;e.object.extend(x.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(s,i){return i?s?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),s?this.aCoords:this.lineCoords)},getCoords:function(s,i){return t(this._getCoords(s,i))},intersectsWithRect:function(s,i,a,l){var u=this.getCoords(a,l),c=x.Intersection.intersectPolygonRectangle(u,s,i);return c.status==="Intersection"},intersectsWithObject:function(s,i,a){var l=x.Intersection.intersectPolygonPolygon(this.getCoords(i,a),s.getCoords(i,a));return l.status==="Intersection"||s.isContainedWithinObject(this,i,a)||this.isContainedWithinObject(s,i,a)},isContainedWithinObject:function(s,i,a){for(var l=this.getCoords(i,a),u=i?s.aCoords:s.lineCoords,c=0,h=s._getImageLines(u);c<4;c++)if(!s.containsPoint(l[c],h))return!1;return!0},isContainedWithinRect:function(s,i,a,l){var u=this.getBoundingRect(a,l);return u.left>=s.x&&u.left+u.width<=i.x&&u.top>=s.y&&u.top+u.height<=i.y},containsPoint:function(s,c,a,l){var u=this._getCoords(a,l),c=c||this._getImageLines(u),h=this._findCrossPoints(s,c);return h!==0&&h%2===1},isOnScreen:function(s){if(!this.canvas)return!1;var i=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br,l=this.getCoords(!0,s);return l.some(function(u){return u.x<=a.x&&u.x>=i.x&&u.y<=a.y&&u.y>=i.y})||this.intersectsWithRect(i,a,!0,s)?!0:this._containsCenterOfCanvas(i,a,s)},_containsCenterOfCanvas:function(s,i,a){var l={x:(s.x+i.x)/2,y:(s.y+i.y)/2};return!!this.containsPoint(l,null,!0,a)},isPartiallyOnScreen:function(s){if(!this.canvas)return!1;var i=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br;if(this.intersectsWithRect(i,a,!0,s))return!0;var l=this.getCoords(!0,s).every(function(u){return(u.x>=a.x||u.x<=i.x)&&(u.y>=a.y||u.y<=i.y)});return l&&this._containsCenterOfCanvas(i,a,s)},_getImageLines:function(s){var i={topline:{o:s.tl,d:s.tr},rightline:{o:s.tr,d:s.br},bottomline:{o:s.br,d:s.bl},leftline:{o:s.bl,d:s.tl}};return i},_findCrossPoints:function(s,i){var a,l,u,c,h,d=0,g;for(var m in i)if(g=i[m],!(g.o.y<s.y&&g.d.y<s.y)&&!(g.o.y>=s.y&&g.d.y>=s.y)&&(g.o.x===g.d.x&&g.o.x>=s.x?h=g.o.x:(a=0,l=(g.d.y-g.o.y)/(g.d.x-g.o.x),u=s.y-a*s.x,c=g.o.y-l*g.o.x,h=-(u-c)/(a-l)),h>=s.x&&(d+=1),d===2))break;return d},getBoundingRect:function(s,i){var a=this.getCoords(s,i);return e.makeBoundingBoxFromPoints(a)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(s){return Math.abs(s)<this.minScaleLimit?s<0?-this.minScaleLimit:this.minScaleLimit:s===0?1e-4:s},scale:function(s){return this._set("scaleX",s),this._set("scaleY",s),this.setCoords()},scaleToWidth:function(s,i){var a=this.getBoundingRect(i).width/this.getScaledWidth();return this.scale(s/this.width/a)},scaleToHeight:function(s,i){var a=this.getBoundingRect(i).height/this.getScaledHeight();return this.scale(s/this.height/a)},calcLineCoords:function(){var s=this.getViewportTransform(),i=this.padding,a=r(this.angle),l=e.cos(a),u=e.sin(a),c=l*i,h=u*i,d=c+h,g=c-h,m=this.calcACoords(),y={tl:n(m.tl,s),tr:n(m.tr,s),bl:n(m.bl,s),br:n(m.br,s)};return i&&(y.tl.x-=g,y.tl.y-=d,y.tr.x+=d,y.tr.y-=g,y.bl.x-=d,y.bl.y+=g,y.br.x+=g,y.br.y+=d),y},calcOCoords:function(){var s=this._calcRotateMatrix(),i=this._calcTranslateMatrix(),a=this.getViewportTransform(),l=o(a,i),u=o(l,s),u=o(u,[1/a[0],0,0,1/a[3],0,0]),c=this._calculateCurrentDimensions(),h={};return this.forEachControl(function(d,g,m){h[g]=d.positionHandler(c,u,m)}),h},calcACoords:function(){var s=this._calcRotateMatrix(),i=this._calcTranslateMatrix(),a=o(i,s),l=this._getTransformedDimensions(),u=l.x/2,c=l.y/2;return{tl:n({x:-u,y:-c},a),tr:n({x:u,y:-c},a),bl:n({x:-u,y:c},a),br:n({x:u,y:c},a)}},setCoords:function(s){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),s?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return e.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var s=this.getCenterPoint();return[1,0,0,1,s.x,s.y]},transformMatrixKey:function(s){var i="_",a="";return!s&&this.group&&(a=this.group.transformMatrixKey(s)+i),a+this.top+i+this.left+i+this.scaleX+i+this.scaleY+i+this.skewX+i+this.skewY+i+this.angle+i+this.originX+i+this.originY+i+this.width+i+this.height+i+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(s){var i=this.calcOwnMatrix();if(s||!this.group)return i;var a=this.transformMatrixKey(s),l=this.matrixCache||(this.matrixCache={});return l.key===a?l.value:(this.group&&(i=o(this.group.calcTransformMatrix(!1),i)),l.key=a,l.value=i,i)},calcOwnMatrix:function(){var s=this.transformMatrixKey(!0),i=this.ownMatrixCache||(this.ownMatrixCache={});if(i.key===s)return i.value;var a=this._calcTranslateMatrix(),l={angle:this.angle,translateX:a[4],translateY:a[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return i.key=s,i.value=e.composeMatrix(l),i.value},_getNonTransformedDimensions:function(){var s=this.strokeWidth,i=this.width+s,a=this.height+s;return{x:i,y:a}},_getTransformedDimensions:function(s,i){typeof s>"u"&&(s=this.skewX),typeof i>"u"&&(i=this.skewY);var a,l,u,c=s===0&&i===0;if(this.strokeUniform?(l=this.width,u=this.height):(a=this._getNonTransformedDimensions(),l=a.x,u=a.y),c)return this._finalizeDimensions(l*this.scaleX,u*this.scaleY);var h=e.sizeAfterTransform(l,u,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:s,skewY:i});return this._finalizeDimensions(h.x,h.y)},_finalizeDimensions:function(s,i){return this.strokeUniform?{x:s+this.strokeWidth,y:i+this.strokeWidth}:{x:s,y:i}},_calculateCurrentDimensions:function(){var s=this.getViewportTransform(),i=this._getTransformedDimensions(),a=n(i,s,!0);return a.scalarAdd(2*this.padding)}})})();x.util.object.extend(x.Object.prototype,{sendToBack:function(){return this.group?x.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?x.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?x.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas&&this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?x.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas&&this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group&&this.group.type!=="activeSelection"?x.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas&&this.canvas.moveTo(this,t),this}});(function(){function t(r,o){if(o){if(o.toLive)return r+": url(#SVGID_"+o.id+"); ";var n=new x.Color(o),s=r+": "+n.toRgb()+"; ",i=n.getAlpha();return i!==1&&(s+=r+"-opacity: "+i.toString()+"; "),s}else return r+": none; "}var e=x.util.toFixed;x.util.object.extend(x.Object.prototype,{getSvgStyles:function(r){var o=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):"none",i=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",l=this.strokeLineJoin?this.strokeLineJoin:"miter",u=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=typeof this.opacity<"u"?this.opacity:"1",h=this.visible?"":" visibility: hidden;",d=r?"":this.getSvgFilter(),g=t("fill",this.fill),m=t("stroke",this.stroke);return[m,"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",i,"; ","stroke-linejoin: ",l,"; ","stroke-miterlimit: ",u,"; ",g,"fill-rule: ",o,"; ","opacity: ",c,";",d,h].join("")},getSvgSpanStyles:function(r,o){var n="; ",i=r.fontFamily?"font-family: "+(r.fontFamily.indexOf("'")===-1&&r.fontFamily.indexOf('"')===-1?"'"+r.fontFamily+"'":r.fontFamily)+n:"",s=r.strokeWidth?"stroke-width: "+r.strokeWidth+n:"",i=i,a=r.fontSize?"font-size: "+r.fontSize+"px"+n:"",l=r.fontStyle?"font-style: "+r.fontStyle+n:"",u=r.fontWeight?"font-weight: "+r.fontWeight+n:"",c=r.fill?t("fill",r.fill):"",h=r.stroke?t("stroke",r.stroke):"",d=this.getSvgTextDecoration(r),g=r.deltaY?"baseline-shift: "+-r.deltaY+"; ":"";return d&&(d="text-decoration: "+d+n),[h,s,i,a,l,u,d,c,g,o?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(r){return["overline","underline","line-through"].filter(function(o){return r[o.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(r,o){var n=r?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'+x.util.matrixToSVG(n);return s+(o||"")+'" '},_setSVGBg:function(r){if(this.backgroundColor){var o=x.Object.NUM_FRACTION_DIGITS;r.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',e(-this.width/2,o),'" y="',e(-this.height/2,o),'" width="',e(this.width,o),'" height="',e(this.height,o),`"></rect>
`)}},toSVG:function(r){return this._createBaseSVGMarkup(this._toSVG(r),{reviver:r})},toClipPathSVG:function(r){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(r),{reviver:r})},_createBaseClipPathSVGMarkup:function(r,o){o=o||{};var n=o.reviver,s=o.additionalTransform||"",i=[this.getSvgTransform(!0,s),this.getSvgCommons()].join(""),a=r.indexOf("COMMON_PARTS");return r[a]=i,n?n(r.join("")):r.join("")},_createBaseSVGMarkup:function(r,o){o=o||{};var n=o.noStyle,s=o.reviver,i=n?"":'style="'+this.getSvgStyles()+'" ',a=o.withShadow?'style="'+this.getSvgFilter()+'" ':"",l=this.clipPath,u=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",c=l&&l.absolutePositioned,h=this.stroke,d=this.fill,g=this.shadow,m,y=[],C,b=r.indexOf("COMMON_PARTS"),k=o.additionalTransform;return l&&(l.clipPathId="CLIPPATH_"+x.Object.__uid++,C='<clipPath id="'+l.clipPathId+`" >
`+l.toClipPathSVG(s)+`</clipPath>
`),c&&y.push("<g ",a,this.getSvgCommons(),` >
`),y.push("<g ",this.getSvgTransform(!1),c?"":a+this.getSvgCommons(),` >
`),m=[i,u,n?"":this.addPaintOrder()," ",k?'transform="'+k+'" ':""].join(""),r[b]=m,d&&d.toLive&&y.push(d.toSVG(this)),h&&h.toLive&&y.push(h.toSVG(this)),g&&y.push(g.toSVG(this)),l&&y.push(C),y.push(r.join("")),y.push(`</g>
`),c&&y.push(`</g>
`),s?s(y.join("")):y.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})})();(function(){var t=x.util.object.extend,e="stateProperties";function r(n,s,i){var a={},l=!0;i.forEach(function(u){a[u]=n[u]}),t(n[s],a,l)}function o(n,s,i){if(n===s)return!0;if(Array.isArray(n)){if(!Array.isArray(s)||n.length!==s.length)return!1;for(var a=0,l=n.length;a<l;a++)if(!o(n[a],s[a]))return!1;return!0}else if(n&&typeof n=="object"){var u=Object.keys(n),c;if(!s||typeof s!="object"||!i&&u.length!==Object.keys(s).length)return!1;for(var a=0,l=u.length;a<l;a++)if(c=u[a],!(c==="canvas"||c==="group")&&!o(n[c],s[c]))return!1;return!0}}x.util.object.extend(x.Object.prototype,{hasStateChanged:function(n){n=n||e;var s="_"+n;return Object.keys(this[s]).length<this[n].length?!0:!o(this[s],this,!0)},saveState:function(n){var s=n&&n.propertySet||e,i="_"+s;return this[i]?(r(this,i,this[s]),n&&n.stateProperties&&r(this,i,n.stateProperties),this):this.setupState(n)},setupState:function(n){n=n||{};var s=n.propertySet||e;return n.propertySet=s,this["_"+s]={},this.saveState(n),this}})})();(function(){var t=x.util.degreesToRadians;x.util.object.extend(x.Object.prototype,{_findTargetCorner:function(e,r){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var o=e.x,n=e.y,s,i,a=Object.keys(this.oCoords),l=a.length-1,u;for(this.__corner=0;l>=0;l--)if(u=a[l],!!this.isControlVisible(u)&&(i=this._getImageLines(r?this.oCoords[u].touchCorner:this.oCoords[u].corner),s=this._findCrossPoints({x:o,y:n},i),s!==0&&s%2===1))return this.__corner=u,u;return!1},forEachControl:function(e){for(var r in this.controls)e(this.controls[r],r,this)},_setCornerCoords:function(){var e=this.oCoords;for(var r in e){var o=this.controls[r];e[r].corner=o.calcCornerCoords(this.angle,this.cornerSize,e[r].x,e[r].y,!1),e[r].touchCorner=o.calcCornerCoords(this.angle,this.touchCornerSize,e[r].x,e[r].y,!0)}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var r=this.getCenterPoint(),o=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return e.translate(r.x,r.y),e.scale(1/n[0],1/n[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-o.x/2,-o.y/2,o.x,o.y),e.restore(),this},drawBorders:function(e,r){r=r||{};var o=this._calculateCurrentDimensions(),n=this.borderScaleFactor,s=o.x+n,i=o.y+n,a=typeof r.hasControls<"u"?r.hasControls:this.hasControls,l=!1;return e.save(),e.strokeStyle=r.borderColor||this.borderColor,this._setLineDash(e,r.borderDashArray||this.borderDashArray),e.strokeRect(-s/2,-i/2,s,i),a&&(e.beginPath(),this.forEachControl(function(u,c,h){u.withConnection&&u.getVisibility(h,c)&&(l=!0,e.moveTo(u.x*s,u.y*i),e.lineTo(u.x*s+u.offsetX,u.y*i+u.offsetY))}),l&&e.stroke()),e.restore(),this},drawBordersInGroup:function(e,r,o){o=o||{};var n=x.util.sizeAfterTransform(this.width,this.height,r),s=this.strokeWidth,i=this.strokeUniform,a=this.borderScaleFactor,l=n.x+s*(i?this.canvas.getZoom():r.scaleX)+a,u=n.y+s*(i?this.canvas.getZoom():r.scaleY)+a;return e.save(),this._setLineDash(e,o.borderDashArray||this.borderDashArray),e.strokeStyle=o.borderColor||this.borderColor,e.strokeRect(-l/2,-u/2,l,u),e.restore(),this},drawControls:function(e,r){r=r||{},e.save();var o=this.canvas.getRetinaScaling(),n,s;return e.setTransform(o,0,0,o,0,0),e.strokeStyle=e.fillStyle=r.cornerColor||this.cornerColor,this.transparentCorners||(e.strokeStyle=r.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(e,r.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(n=this.group.calcTransformMatrix()),this.forEachControl(function(i,a,l){s=l.oCoords[a],i.getVisibility(l,a)&&(n&&(s=x.util.transformPoint(s,n)),i.render(e,s.x,s.y,r,l))}),e.restore(),this},isControlVisible:function(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)},setControlVisible:function(e,r){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=r,this},setControlsVisibility:function(e){e||(e={});for(var r in e)this.setControlVisible(r,e[r]);return this},onDeselect:function(){},onSelect:function(){}})})();x.util.object.extend(x.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){e=e||{};var r=function(){},o=e.onComplete||r,n=e.onChange||r,s=this;return x.util.animate({target:this,startValue:t.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(i){t.set("left",i),s.requestRenderAll(),n()},onComplete:function(){t.setCoords(),o()}})},fxCenterObjectV:function(t,e){e=e||{};var r=function(){},o=e.onComplete||r,n=e.onChange||r,s=this;return x.util.animate({target:this,startValue:t.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(i){t.set("top",i),s.requestRenderAll(),n()},onComplete:function(){t.setCoords(),o()}})},fxRemove:function(t,e){e=e||{};var r=function(){},o=e.onComplete||r,n=e.onChange||r,s=this;return x.util.animate({target:this,startValue:t.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(i){t.set("opacity",i),s.requestRenderAll(),n()},onComplete:function(){s.remove(t),o()}})}});x.util.object.extend(x.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var t=[],e,r,o=[];for(e in arguments[0])t.push(e);for(var n=0,s=t.length;n<s;n++)e=t[n],r=n!==s-1,o.push(this._animate(e,arguments[0][e],arguments[1],r));return o}else return this._animate.apply(this,arguments)},_animate:function(t,e,r,o){var n=this,s;e=e.toString(),r?r=x.util.object.clone(r):r={},~t.indexOf(".")&&(s=t.split("."));var i=n.colorProperties.indexOf(t)>-1||s&&n.colorProperties.indexOf(s[1])>-1,a=s?this.get(s[0])[s[1]]:this.get(t);"from"in r||(r.from=a),i||(~e.indexOf("=")?e=a+parseFloat(e.replace("=","")):e=parseFloat(e));var l={target:this,startValue:r.from,endValue:e,byValue:r.by,easing:r.easing,duration:r.duration,abort:r.abort&&function(u,c,h){return r.abort.call(n,u,c,h)},onChange:function(u,c,h){s?n[s[0]][s[1]]=u:n.set(t,u),!o&&r.onChange&&r.onChange(u,c,h)},onComplete:function(u,c,h){o||(n.setCoords(),r.onComplete&&r.onComplete(u,c,h))}};return i?x.util.animateColor(l.startValue,l.endValue,l.duration,l):x.util.animate(l)}});(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,o=e.util.object.clone,n={x1:1,x2:1,y1:1,y2:1};if(e.Line){e.warn("fabric.Line is already defined");return}e.Line=e.util.createClass(e.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:e.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(i,a){i||(i=[0,0,0,0]),this.callSuper("initialize",a),this.set("x1",i[0]),this.set("y1",i[1]),this.set("x2",i[2]),this.set("y2",i[3]),this._setWidthHeight(a)},_setWidthHeight:function(i){i||(i={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in i?i.left:this._getLeftToOriginX(),this.top="top"in i?i.top:this._getTopToOriginY()},_set:function(i,a){return this.callSuper("_set",i,a),typeof n[i]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:s({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:s({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(i){i.beginPath();var a=this.calcLinePoints();i.moveTo(a.x1,a.y1),i.lineTo(a.x2,a.y2),i.lineWidth=this.strokeWidth;var l=i.strokeStyle;i.strokeStyle=this.stroke||i.fillStyle,this.stroke&&this._renderStroke(i),i.strokeStyle=l},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(i){return r(this.callSuper("toObject",i),this.calcLinePoints())},_getNonTransformedDimensions:function(){var i=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(i.y-=this.strokeWidth),this.height===0&&(i.x-=this.strokeWidth)),i},calcLinePoints:function(){var i=this.x1<=this.x2?-1:1,a=this.y1<=this.y2?-1:1,l=i*this.width*.5,u=a*this.height*.5,c=i*this.width*-.5,h=a*this.height*-.5;return{x1:l,x2:c,y1:u,y2:h}},_toSVG:function(){var i=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',i.x1,'" y1="',i.y1,'" x2="',i.x2,'" y2="',i.y2,`" />
`]}}),e.Line.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),e.Line.fromElement=function(i,a,l){l=l||{};var u=e.parseAttributes(i,e.Line.ATTRIBUTE_NAMES),c=[u.x1||0,u.y1||0,u.x2||0,u.y2||0];a(new e.Line(c,r(u,l)))},e.Line.fromObject=function(i,a){function l(c){delete c.points,a&&a(c)}var u=o(i,!0);u.points=[i.x1,i.y1,i.x2,i.y2],e.Object._fromObject("Line",u,l,"points")};function s(i,a){var l=i.origin,u=i.axis1,c=i.axis2,h=i.dimension,d=a.nearest,g=a.center,m=a.farthest;return function(){switch(this.get(l)){case d:return Math.min(this.get(u),this.get(c));case g:return Math.min(this.get(u),this.get(c))+.5*this.get(h);case m:return Math.max(this.get(u),this.get(c))}}}})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.degreesToRadians;if(e.Circle){e.warn("fabric.Circle is already defined.");return}e.Circle=e.util.createClass(e.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:e.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(n,s){return this.callSuper("_set",n,s),n==="radius"&&this.setRadius(s),this},toObject:function(n){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(n))},_toSVG:function(){var n,s=0,i=0,a=(this.endAngle-this.startAngle)%360;if(a===0)n=["<circle ","COMMON_PARTS",'cx="'+s+'" cy="'+i+'" ','r="',this.radius,`" />
`];else{var l=r(this.startAngle),u=r(this.endAngle),c=this.radius,h=e.util.cos(l)*c,d=e.util.sin(l)*c,g=e.util.cos(u)*c,m=e.util.sin(u)*c,y=a>180?"1":"0";n=['<path d="M '+h+" "+d," A "+c+" "+c," 0 ",+y+" 1"," "+g+" "+m,'" ',"COMMON_PARTS",` />
`]}return n},_render:function(n){n.beginPath(),n.arc(0,0,this.radius,r(this.startAngle),r(this.endAngle),!1),this._renderPaintInOrder(n)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(n){return this.radius=n,this.set("width",n*2).set("height",n*2)}}),e.Circle.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),e.Circle.fromElement=function(n,s){var i=e.parseAttributes(n,e.Circle.ATTRIBUTE_NAMES);if(!o(i))throw new Error("value of `r` attribute is required and can not be negative");i.left=(i.left||0)-i.radius,i.top=(i.top||0)-i.radius,s(new e.Circle(i))};function o(n){return"radius"in n&&n.radius>=0}e.Circle.fromObject=function(n,s){e.Object._fromObject("Circle",n,s)}})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Triangle){e.warn("fabric.Triangle is already defined");return}e.Triangle=e.util.createClass(e.Object,{type:"triangle",width:100,height:100,_render:function(r){var o=this.width/2,n=this.height/2;r.beginPath(),r.moveTo(-o,n),r.lineTo(0,-n),r.lineTo(o,n),r.closePath(),this._renderPaintInOrder(r)},_toSVG:function(){var r=this.width/2,o=this.height/2,n=[-r+" "+o,"0 "+-o,r+" "+o].join(",");return["<polygon ","COMMON_PARTS",'points="',n,'" />']}}),e.Triangle.fromObject=function(r,o){return e.Object._fromObject("Triangle",r,o)}})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=Math.PI*2;if(e.Ellipse){e.warn("fabric.Ellipse is already defined.");return}e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this.set("rx",o&&o.rx||0),this.set("ry",o&&o.ry||0)},_set:function(o,n){switch(this.callSuper("_set",o,n),o){case"rx":this.rx=n,this.set("width",n*2);break;case"ry":this.ry=n,this.set("height",n*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(o){o.beginPath(),o.save(),o.transform(1,0,0,this.ry/this.rx,0,0),o.arc(0,0,this.rx,0,r,!1),o.restore(),this._renderPaintInOrder(o)}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(o,n){var s=e.parseAttributes(o,e.Ellipse.ATTRIBUTE_NAMES);s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,n(new e.Ellipse(s))},e.Ellipse.fromObject=function(o,n){e.Object._fromObject("Ellipse",o,n)}})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend;if(e.Rect){e.warn("fabric.Rect is already defined");return}e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(o){var n=this.rx?Math.min(this.rx,this.width/2):0,s=this.ry?Math.min(this.ry,this.height/2):0,i=this.width,a=this.height,l=-this.width/2,u=-this.height/2,c=n!==0||s!==0,h=1-.5522847498;o.beginPath(),o.moveTo(l+n,u),o.lineTo(l+i-n,u),c&&o.bezierCurveTo(l+i-h*n,u,l+i,u+h*s,l+i,u+s),o.lineTo(l+i,u+a-s),c&&o.bezierCurveTo(l+i,u+a-h*s,l+i-h*n,u+a,l+i-n,u+a),o.lineTo(l+n,u+a),c&&o.bezierCurveTo(l+h*n,u+a,l,u+a-h*s,l,u+a-s),o.lineTo(l,u+s),c&&o.bezierCurveTo(l,u+h*s,l+h*n,u,l+n,u),o.closePath(),this._renderPaintInOrder(o)},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){var o=-this.width/2,n=-this.height/2;return["<rect ","COMMON_PARTS",'x="',o,'" y="',n,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(o,n,s){if(!o)return n(null);s=s||{};var i=e.parseAttributes(o,e.Rect.ATTRIBUTE_NAMES);i.left=i.left||0,i.top=i.top||0,i.height=i.height||0,i.width=i.width||0;var a=new e.Rect(r(s?e.util.object.clone(s):{},i));a.visible=a.visible&&a.width>0&&a.height>0,n(a)},e.Rect.fromObject=function(o,n){return e.Object._fromObject("Rect",o,n)}})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,o=e.util.array.min,n=e.util.array.max,s=e.util.toFixed,i=e.util.projectStrokeOnPoints;if(e.Polyline){e.warn("fabric.Polyline is already defined");return}e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:e.Object.prototype.cacheProperties.concat("points"),initialize:function(a,l){l=l||{},this.points=a||[],this.callSuper("initialize",l),this._setPositionDimensions(l)},_projectStrokeOnPoints:function(){return i(this.points,this,!0)},_setPositionDimensions:function(a){var l=this._calcDimensions(a),u,c=this.exactBoundingBox?this.strokeWidth:0;this.width=l.width-c,this.height=l.height-c,a.fromSVG||(u=this.translateToGivenOrigin({x:l.left-this.strokeWidth/2+c/2,y:l.top-this.strokeWidth/2+c/2},"left","top",this.originX,this.originY)),typeof a.left>"u"&&(this.left=a.fromSVG?l.left:u.x),typeof a.top>"u"&&(this.top=a.fromSVG?l.top:u.y),this.pathOffset={x:l.left+this.width/2+c/2,y:l.top+this.height/2+c/2}},_calcDimensions:function(){var a=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,l=o(a,"x")||0,u=o(a,"y")||0,c=n(a,"x")||0,h=n(a,"y")||0,d=c-l,g=h-u;return{left:l,top:u,width:d,height:g}},toObject:function(a){return r(this.callSuper("toObject",a),{points:this.points.concat()})},_toSVG:function(){for(var a=[],l=this.pathOffset.x,u=this.pathOffset.y,c=e.Object.NUM_FRACTION_DIGITS,h=0,d=this.points.length;h<d;h++)a.push(s(this.points[h].x-l,c),",",s(this.points[h].y-u,c)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',a.join(""),`" />
`]},commonRender:function(a){var l,u=this.points.length,c=this.pathOffset.x,h=this.pathOffset.y;if(!u||isNaN(this.points[u-1].y))return!1;a.beginPath(),a.moveTo(this.points[0].x-c,this.points[0].y-h);for(var d=0;d<u;d++)l=this.points[d],a.lineTo(l.x-c,l.y-h);return!0},_render:function(a){this.commonRender(a)&&this._renderPaintInOrder(a)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElementGenerator=function(a){return function(l,u,c){if(!l)return u(null);c||(c={});var h=e.parsePointsAttribute(l.getAttribute("points")),d=e.parseAttributes(l,e[a].ATTRIBUTE_NAMES);d.fromSVG=!0,u(new e[a](h,r(d,c)))}},e.Polyline.fromElement=e.Polyline.fromElementGenerator("Polyline"),e.Polyline.fromObject=function(a,l){return e.Object._fromObject("Polyline",a,l,"points")}})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.projectStrokeOnPoints;if(e.Polygon){e.warn("fabric.Polygon is already defined");return}e.Polygon=e.util.createClass(e.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return r(this.points,this)},_render:function(o){this.commonRender(o)&&(o.closePath(),this._renderPaintInOrder(o))}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=e.Polyline.fromElementGenerator("Polygon"),e.Polygon.fromObject=function(o,n){e.Object._fromObject("Polygon",o,n,"points")}})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.array.min,o=e.util.array.max,n=e.util.object.extend,s=e.util.object.clone,i=e.util.toFixed;if(e.Path){e.warn("fabric.Path is already defined");return}e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(a,l){l=s(l||{}),delete l.path,this.callSuper("initialize",l),this._setPath(a||[],l)},_setPath:function(a,l){this.path=e.util.makePathSimpler(Array.isArray(a)?a:e.util.parsePath(a)),e.Polyline.prototype._setPositionDimensions.call(this,l||{})},_renderPathCommands:function(a){var l,u=0,c=0,h=0,d=0,g=0,m=0,y=-this.pathOffset.x,C=-this.pathOffset.y;a.beginPath();for(var b=0,k=this.path.length;b<k;++b)switch(l=this.path[b],l[0]){case"L":h=l[1],d=l[2],a.lineTo(h+y,d+C);break;case"M":h=l[1],d=l[2],u=h,c=d,a.moveTo(h+y,d+C);break;case"C":h=l[5],d=l[6],g=l[3],m=l[4],a.bezierCurveTo(l[1]+y,l[2]+C,g+y,m+C,h+y,d+C);break;case"Q":a.quadraticCurveTo(l[1]+y,l[2]+C,l[3]+y,l[4]+C),h=l[3],d=l[4],g=l[1],m=l[2];break;case"z":case"Z":h=u,d=c,a.closePath();break}},_render:function(a){this._renderPathCommands(a),this._renderPaintInOrder(a)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(a){return n(this.callSuper("toObject",a),{path:this.path.map(function(l){return l.slice()})})},toDatalessObject:function(a){var l=this.toObject(["sourcePath"].concat(a));return l.sourcePath&&delete l.path,l},_toSVG:function(){var a=e.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',a,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var a=e.Object.NUM_FRACTION_DIGITS;return" translate("+i(-this.pathOffset.x,a)+", "+i(-this.pathOffset.y,a)+")"},toClipPathSVG:function(a){var l=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:l})},toSVG:function(a){var l=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:l})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var a=[],l=[],u,c=0,h=0,d=0,g=0,m,y=0,C=this.path.length;y<C;++y){switch(u=this.path[y],u[0]){case"L":d=u[1],g=u[2],m=[];break;case"M":d=u[1],g=u[2],c=d,h=g,m=[];break;case"C":m=e.util.getBoundsOfCurve(d,g,u[1],u[2],u[3],u[4],u[5],u[6]),d=u[5],g=u[6];break;case"Q":m=e.util.getBoundsOfCurve(d,g,u[1],u[2],u[1],u[2],u[3],u[4]),d=u[3],g=u[4];break;case"z":case"Z":d=c,g=h;break}m.forEach(function(Y){a.push(Y.x),l.push(Y.y)}),a.push(d),l.push(g)}var b=r(a)||0,k=r(l)||0,L=o(a)||0,N=o(l)||0,M=L-b,W=N-k;return{left:b,top:k,width:M,height:W}}}),e.Path.fromObject=function(a,l){if(typeof a.sourcePath=="string"){var u=a.sourcePath;e.loadSVGFromURL(u,function(c){var h=c[0];h.setOptions(a),a.clipPath?e.util.enlivenObjects([a.clipPath],function(d){h.clipPath=d[0],l&&l(h)}):l&&l(h)})}else e.Object._fromObject("Path",a,l,"path")},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(a,l,u){var c=e.parseAttributes(a,e.Path.ATTRIBUTE_NAMES);c.fromSVG=!0,l(new e.Path(c.d,n(c,u)))}})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.array.min,o=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(n,s,i){s=s||{},this._objects=[],i&&this.callSuper("initialize",s),this._objects=n||[];for(var a=this._objects.length;a--;)this._objects[a].group=this;if(i)this._updateObjectsACoords();else{var l=s&&s.centerPoint;s.originX!==void 0&&(this.originX=s.originX),s.originY!==void 0&&(this.originY=s.originY),l||this._calcBounds(),this._updateObjectsCoords(l),delete s.centerPoint,this.callSuper("initialize",s)}this.setCoords()},_updateObjectsACoords:function(){for(var n=!0,s=this._objects.length;s--;)this._objects[s].setCoords(n)},_updateObjectsCoords:function(s){for(var s=s||this.getCenterPoint(),i=this._objects.length;i--;)this._updateObjectCoords(this._objects[i],s)},_updateObjectCoords:function(n,s){var i=n.left,a=n.top,l=!0;n.set({left:i-s.x,top:a-s.y}),n.group=this,n.setCoords(l)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(n){var s=!!this.group;return this._restoreObjectsState(),e.util.resetObjectTransform(this),n&&(s&&e.util.removeTransformFromObject(n,this.group.calcTransformMatrix()),this._objects.push(n),n.group=this,n._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,s?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(n){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(n),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(n){this.dirty=!0,n.group=this,n._set("canvas",this.canvas)},_onObjectRemoved:function(n){this.dirty=!0,delete n.group},_set:function(n,s){var i=this._objects.length;if(this.useSetOnGroup)for(;i--;)this._objects[i].setOnGroup(n,s);if(n==="canvas")for(;i--;)this._objects[i]._set(n,s);e.Object.prototype._set.call(this,n,s)},toObject:function(n){var s=this.includeDefaultValues,i=this._objects.filter(function(l){return!l.excludeFromExport}).map(function(l){var u=l.includeDefaultValues;l.includeDefaultValues=s;var c=l.toObject(n);return l.includeDefaultValues=u,c}),a=e.Object.prototype.toObject.call(this,n);return a.objects=i,a},toDatalessObject:function(n){var s,i=this.sourcePath;if(i)s=i;else{var a=this.includeDefaultValues;s=this._objects.map(function(u){var c=u.includeDefaultValues;u.includeDefaultValues=a;var h=u.toDatalessObject(n);return u.includeDefaultValues=c,h})}var l=e.Object.prototype.toDatalessObject.call(this,n);return l.objects=s,l},render:function(n){this._transformDone=!0,this.callSuper("render",n),this._transformDone=!1},shouldCache:function(){var n=e.Object.prototype.shouldCache.call(this);if(n){for(var s=0,i=this._objects.length;s<i;s++)if(this._objects[s].willDrawShadow())return this.ownCaching=!1,!1}return n},willDrawShadow:function(){if(e.Object.prototype.willDrawShadow.call(this))return!0;for(var n=0,s=this._objects.length;n<s;n++)if(this._objects[n].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(n){for(var s=0,i=this._objects.length;s<i;s++)this._objects[s].render(n);this._drawClipPath(n,this.clipPath)},isCacheDirty:function(n){if(this.callSuper("isCacheDirty",n))return!0;if(!this.statefullCache)return!1;for(var s=0,i=this._objects.length;s<i;s++)if(this._objects[s].isCacheDirty(!0)){if(this._cacheCanvas){var a=this.cacheWidth/this.zoomX,l=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-a/2,-l/2,a,l)}return!0}return!1},_restoreObjectsState:function(){var n=this.calcOwnMatrix();return this._objects.forEach(function(s){e.util.addTransformToObject(s,n),delete s.group,s.setCoords()}),this},destroy:function(){return this._objects.forEach(function(n){n.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(n){n.dispose&&n.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var n=this._objects,s=this.canvas;this._objects=[];var i=this.toObject();delete i.objects;var a=new e.ActiveSelection([]);return a.set(i),a.type="activeSelection",s.remove(this),n.forEach(function(l){l.group=a,l.dirty=!0,s.add(l)}),a.canvas=s,a._objects=n,s._activeObject=a,a.setCoords(),a}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var n=!0;return this.forEachObject(function(s){s.setCoords(n)}),this},_calcBounds:function(n){for(var s=[],i=[],a,l,u,c=["tr","br","bl","tl"],h=0,d=this._objects.length,g,m=c.length;h<d;++h){for(a=this._objects[h],u=a.calcACoords(),g=0;g<m;g++)l=c[g],s.push(u[l].x),i.push(u[l].y);a.aCoords=u}this._getBounds(s,i,n)},_getBounds:function(n,s,i){var a=new e.Point(r(n),r(s)),l=new e.Point(o(n),o(s)),u=a.y||0,c=a.x||0,h=l.x-a.x||0,d=l.y-a.y||0;this.width=h,this.height=d,i||this.setPositionByOrigin({x:c,y:u},"left","top")},_toSVG:function(n){for(var s=["<g ","COMMON_PARTS",` >
`],i=0,a=this._objects.length;i<a;i++)s.push("		",this._objects[i].toSVG(n));return s.push(`</g>
`),s},getSvgStyles:function(){var n=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",s=this.visible?"":" visibility: hidden;";return[n,this.getSvgFilter(),s].join("")},toClipPathSVG:function(n){for(var s=[],i=0,a=this._objects.length;i<a;i++)s.push("	",this._objects[i].toClipPathSVG(n));return this._createBaseClipPathSVGMarkup(s,{reviver:n})}}),e.Group.fromObject=function(n,s){var i=n.objects,a=e.util.object.clone(n,!0);if(delete a.objects,typeof i=="string"){e.loadSVGFromURL(i,function(l){var u=e.util.groupSVGElements(l,n,i),c=a.clipPath;delete a.clipPath,u.set(a),c?e.util.enlivenObjects([c],function(h){u.clipPath=h[0],s&&s(u)}):s&&s(u)});return}e.util.enlivenObjects(i,function(l){e.util.enlivenObjectEnlivables(n,a,function(){s&&s(new e.Group(l,a,!0))})})})})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(r,o){o=o||{},this._objects=r||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;o.originX&&(this.originX=o.originX),o.originY&&(this.originY=o.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,o),this.setCoords()},toGroup:function(){var r=this._objects.concat();this._objects=[];var o=e.Object.prototype.toObject.call(this),n=new e.Group([]);if(delete o.type,n.set(o),r.forEach(function(i){i.canvas.remove(i),i.group=n}),n._objects=r,!this.canvas)return n;var s=this.canvas;return s.add(n),s._activeObject=n,n.setCoords(),n},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(r,o,n){r.save(),r.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",r,o),n=n||{},typeof n.hasControls>"u"&&(n.hasControls=!1),n.forActiveSelection=!0;for(var s=0,i=this._objects.length;s<i;s++)this._objects[s]._renderControls(r,n);r.restore()}}),e.ActiveSelection.fromObject=function(r,o){e.util.enlivenObjects(r.objects,function(n){delete r.objects,o&&o(new e.ActiveSelection(n,r,!0))})})})(Ce);(function(t){"use strict";var e=x.util.object.extend;if(t.fabric||(t.fabric={}),t.fabric.Image){x.warn("fabric.Image is already defined.");return}x.Image=x.util.createClass(x.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:x.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:x.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(r,o){o||(o={}),this.filters=[],this.cacheKey="texture"+x.Object.__uid++,this.callSuper("initialize",o),this._initElement(r,o)},getElement:function(){return this._element||{}},setElement:function(r,o){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=r,this._originalElement=r,this._initConfig(o),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(r){var o=x.filterBackend;o&&o.evictCachesForKey&&o.evictCachesForKey(r)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(r){x.util.cleanUpJsdomNode(this[r]),this[r]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var r=this.getElement();return{width:r.naturalWidth||r.width,height:r.naturalHeight||r.height}},_stroke:function(r){if(!(!this.stroke||this.strokeWidth===0)){var o=this.width/2,n=this.height/2;r.beginPath(),r.moveTo(-o,-n),r.lineTo(o,-n),r.lineTo(o,n),r.lineTo(-o,n),r.lineTo(-o,-n),r.closePath()}},toObject:function(r){var o=[];this.filters.forEach(function(s){s&&o.push(s.toObject())});var n=e(this.callSuper("toObject",["cropX","cropY"].concat(r)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:o});return this.resizeFilter&&(n.resizeFilter=this.resizeFilter.toObject()),n},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var r=[],o=[],n,s=this._element,i=-this.width/2,a=-this.height/2,l="",u="";if(!s)return[];if(this.hasCrop()){var c=x.Object.__uid++;r.push('<clipPath id="imageCrop_'+c+`">
`,'	<rect x="'+i+'" y="'+a+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),l=' clip-path="url(#imageCrop_'+c+')" '}if(this.imageSmoothing||(u='" image-rendering="optimizeSpeed'),o.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',i-this.cropX,'" y="',a-this.cropY,'" width="',s.width||s.naturalWidth,'" height="',s.height||s.height,u,'"',l,`></image>
`),this.stroke||this.strokeDashArray){var h=this.fill;this.fill=null,n=["	<rect ",'x="',i,'" y="',a,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=h}return this.paintFirst!=="fill"?r=r.concat(n,o):r=r.concat(o,n),r},getSrc:function(r){var o=r?this._element:this._originalElement;return o?o.toDataURL?o.toDataURL():this.srcFromAttribute?o.getAttribute("src"):o.src:this.src||""},setSrc:function(r,o,n){return x.util.loadImage(r,function(s,i){this.setElement(s,n),this._setWidthHeight(),o&&o(this,i)},this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var r=this.resizeFilter,o=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.scaleX,i=n.scaleY,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!r||s>o&&i>o){this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,this._lastScaleY=i;return}x.filterBackend||(x.filterBackend=x.initFilterBackend());var l=x.util.createCanvasElement(),u=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,c=a.width,h=a.height;l.width=c,l.height=h,this._element=l,this._lastScaleX=r.scaleX=s,this._lastScaleY=r.scaleY=i,x.filterBackend.applyFilters([r],a,c,h,this._element,u),this._filterScalingX=l.width/this._originalElement.width,this._filterScalingY=l.height/this._originalElement.height},applyFilters:function(r){if(r=r||this.filters||[],r=r.filter(function(a){return a&&!a.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),r.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var o=this._originalElement,n=o.naturalWidth||o.width,s=o.naturalHeight||o.height;if(this._element===this._originalElement){var i=x.util.createCanvasElement();i.width=n,i.height=s,this._element=i,this._filteredEl=i}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1;return x.filterBackend||(x.filterBackend=x.initFilterBackend()),x.filterBackend.applyFilters(r,this._originalElement,n,s,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(r){x.util.setImageSmoothing(r,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(r),this._renderPaintInOrder(r)},drawCacheOnCanvas:function(r){x.util.setImageSmoothing(r,this.imageSmoothing),x.Object.prototype.drawCacheOnCanvas.call(this,r)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(r){var o=this._element;if(o){var n=this._filterScalingX,s=this._filterScalingY,i=this.width,a=this.height,l=Math.min,u=Math.max,c=u(this.cropX,0),h=u(this.cropY,0),d=o.naturalWidth||o.width,g=o.naturalHeight||o.height,m=c*n,y=h*s,C=l(i*n,d-m),b=l(a*s,g-y),k=-i/2,L=-a/2,N=l(i,d/n-c),M=l(a,g/s-h);o&&r.drawImage(o,m,y,C,b,k,L,N,M)}},_needsResize:function(){var r=this.getTotalObjectScaling();return r.scaleX!==this._lastScaleX||r.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(r,o){this.setElement(x.util.getById(r),o),x.util.addClass(this.getElement(),x.Image.CSS_CANVAS)},_initConfig:function(r){r||(r={}),this.setOptions(r),this._setWidthHeight(r)},_initFilters:function(r,o){r&&r.length?x.util.enlivenObjects(r,function(n){o&&o(n)},"fabric.Image.filters"):o&&o()},_setWidthHeight:function(r){r||(r={});var o=this.getElement();this.width=r.width||o.naturalWidth||o.width||0,this.height=r.height||o.naturalHeight||o.height||0},parsePreserveAspectRatioAttribute:function(){var r=x.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),o=this._element.width,n=this._element.height,s=1,i=1,a=0,l=0,u=0,c=0,h,d=this.width,g=this.height,m={width:d,height:g};return r&&(r.alignX!=="none"||r.alignY!=="none")?(r.meetOrSlice==="meet"&&(s=i=x.util.findScaleToFit(this._element,m),h=(d-o*s)/2,r.alignX==="Min"&&(a=-h),r.alignX==="Max"&&(a=h),h=(g-n*i)/2,r.alignY==="Min"&&(l=-h),r.alignY==="Max"&&(l=h)),r.meetOrSlice==="slice"&&(s=i=x.util.findScaleToCover(this._element,m),h=o-d/s,r.alignX==="Mid"&&(u=h/2),r.alignX==="Max"&&(u=h),h=n-g/i,r.alignY==="Mid"&&(c=h/2),r.alignY==="Max"&&(c=h),o=d/s,n=g/i)):(s=d/o,i=g/n),{width:o,height:n,scaleX:s,scaleY:i,offsetLeft:a,offsetTop:l,cropX:u,cropY:c}}}),x.Image.CSS_CANVAS="canvas-img",x.Image.prototype.getSvgSrc=x.Image.prototype.getSrc,x.Image.fromObject=function(r,o){var n=x.util.object.clone(r);x.util.loadImage(n.src,function(s,i){if(i){o&&o(null,!0);return}x.Image.prototype._initFilters.call(n,n.filters,function(a){n.filters=a||[],x.Image.prototype._initFilters.call(n,[n.resizeFilter],function(l){n.resizeFilter=l[0],x.util.enlivenObjectEnlivables(n,n,function(){var u=new x.Image(s,n);o(u,!1)})})})},null,n.crossOrigin)},x.Image.fromURL=function(r,o,n){x.util.loadImage(r,function(s,i){o&&o(new x.Image(s,n),i)},null,n&&n.crossOrigin)},x.Image.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),x.Image.fromElement=function(r,o,n){var s=x.parseAttributes(r,x.Image.ATTRIBUTE_NAMES);x.Image.fromURL(s["xlink:href"],o,e(n?x.util.object.clone(n):{},s))}})(Ce);x.util.object.extend(x.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.angle%360;return t>0?Math.round((t-1)/90)*90:Math.round(t/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(t){t=t||{};var e=function(){},r=t.onComplete||e,o=t.onChange||e,n=this;return x.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(s){n.rotate(s),o()},onComplete:function(){n.setCoords(),r()}})}});x.util.object.extend(x.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.requestRenderAllBound})}});(function(){"use strict";function t(r,o){var n="precision "+o+` float;
void main(){}`,s=r.createShader(r.FRAGMENT_SHADER);return r.shaderSource(s,n),r.compileShader(s),!!r.getShaderParameter(s,r.COMPILE_STATUS)}x.isWebglSupported=function(r){if(x.isLikelyNode)return!1;r=r||x.WebglFilterBackend.prototype.tileSize;var o=document.createElement("canvas"),n=o.getContext("webgl")||o.getContext("experimental-webgl"),s=!1;if(n){x.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),s=x.maxTextureSize>=r;for(var i=["highp","mediump","lowp"],a=0;a<3;a++)if(t(n,i[a])){x.webGlPrecision=i[a];break}}return this.isSupported=s,s},x.WebglFilterBackend=e;function e(r){r&&r.tileSize&&(this.tileSize=r.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}e.prototype={tileSize:2048,resources:{},setupGLContext:function(r,o){this.dispose(),this.createWebGLCanvas(r,o),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(r,o)},chooseFastestCopyGLTo2DMethod:function(r,o){var n=typeof window.performance<"u",s;try{new ImageData(1,1),s=!0}catch{s=!1}var i=typeof ArrayBuffer<"u",a=typeof Uint8ClampedArray<"u";if(n&&s&&i&&a){var l=x.util.createCanvasElement(),u=new ArrayBuffer(r*o*4);if(x.forceGLPutImageData){this.imageBuffer=u,this.copyGLTo2D=ep;return}var c={imageBuffer:u,destinationWidth:r,destinationHeight:o,targetCanvas:l},h,d,g;l.width=r,l.height=o,h=window.performance.now(),Zd.call(c,this.gl,c),d=window.performance.now()-h,h=window.performance.now(),ep.call(c,this.gl,c),g=window.performance.now()-h,d>g?(this.imageBuffer=u,this.copyGLTo2D=ep):this.copyGLTo2D=Zd}},createWebGLCanvas:function(r,o){var n=x.util.createCanvasElement();n.width=r,n.height=o;var s={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},i=n.getContext("webgl",s);i||(i=n.getContext("experimental-webgl",s)),i&&(i.clearColor(0,0,0,0),this.canvas=n,this.gl=i)},applyFilters:function(r,o,n,s,i,a){var l=this.gl,u;a&&(u=this.getCachedTexture(a,o));var c={originalWidth:o.width||o.originalWidth,originalHeight:o.height||o.originalHeight,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:l,sourceTexture:this.createTexture(l,n,s,!u&&o),targetTexture:this.createTexture(l,n,s),originalTexture:u||this.createTexture(l,n,s,!u&&o),passes:r.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},h=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,h),r.forEach(function(d){d&&d.applyTo(c)}),tA(c),this.copyGLTo2D(l,c),l.bindTexture(l.TEXTURE_2D,null),l.deleteTexture(c.sourceTexture),l.deleteTexture(c.targetTexture),l.deleteFramebuffer(h),i.getContext("2d").setTransform(1,0,0,1,0,0),c},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(r,o,n,s){var i=r.createTexture();return r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),s?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,s):r.texImage2D(r.TEXTURE_2D,0,r.RGBA,o,n,0,r.RGBA,r.UNSIGNED_BYTE,null),i},getCachedTexture:function(r,o){if(this.textureCache[r])return this.textureCache[r];var n=this.createTexture(this.gl,o.width,o.height,o);return this.textureCache[r]=n,n},evictCachesForKey:function(r){this.textureCache[r]&&(this.gl.deleteTexture(this.textureCache[r]),delete this.textureCache[r])},copyGLTo2D:Zd,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var r=this.gl,o={renderer:"",vendor:""};if(!r)return o;var n=r.getExtension("WEBGL_debug_renderer_info");if(n){var s=r.getParameter(n.UNMASKED_RENDERER_WEBGL),i=r.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(o.renderer=s.toLowerCase()),i&&(o.vendor=i.toLowerCase())}return this.gpuInfo=o,o}}})();function tA(t){var e=t.targetCanvas,r=e.width,o=e.height,n=t.destinationWidth,s=t.destinationHeight;(r!==n||o!==s)&&(e.width=n,e.height=s)}function Zd(t,e){var r=t.canvas,o=e.targetCanvas,n=o.getContext("2d");n.translate(0,o.height),n.scale(1,-1);var s=r.height-o.height;n.drawImage(r,0,s,o.width,o.height,0,0,o.width,o.height)}function ep(t,e){var r=e.targetCanvas,o=r.getContext("2d"),n=e.destinationWidth,s=e.destinationHeight,i=n*s*4,a=new Uint8Array(this.imageBuffer,0,i),l=new Uint8ClampedArray(this.imageBuffer,0,i);t.readPixels(0,0,n,s,t.RGBA,t.UNSIGNED_BYTE,a);var u=new ImageData(l,n,s);o.putImageData(u,0,0)}(function(){"use strict";var t=function(){};x.Canvas2dFilterBackend=e;function e(){}e.prototype={evictCachesForKey:t,dispose:t,clearWebGLCaches:t,resources:{},applyFilters:function(r,o,n,s,i){var a=i.getContext("2d");a.drawImage(o,0,0,n,s);var l=a.getImageData(0,0,n,s),u=a.getImageData(0,0,n,s),c={sourceWidth:n,sourceHeight:s,imageData:l,originalEl:o,originalImageData:u,canvasEl:i,ctx:a,filterBackend:this};return r.forEach(function(h){h.applyTo(c)}),(c.imageData.width!==n||c.imageData.height!==s)&&(i.width=c.imageData.width,i.height=c.imageData.height),a.putImageData(c.imageData,0,0),c}}})();x.Image=x.Image||{};x.Image.filters=x.Image.filters||{};x.Image.filters.BaseFilter=x.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},createProgram:function(t,e,r){e=e||this.fragmentSource,r=r||this.vertexSource,x.webGlPrecision!=="highp"&&(e=e.replace(/precision highp float/g,"precision "+x.webGlPrecision+" float"));var o=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(o,r),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+t.getShaderInfoLog(o));var n=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+t.getShaderInfoLog(n));var s=t.createProgram();if(t.attachShader(s,o),t.attachShader(s,n),t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+t.getProgramInfoLog(s));var i=this.getAttributeLocations(t,s),a=this.getUniformLocations(t,s)||{};return a.uStepW=t.getUniformLocation(s,"uStepW"),a.uStepH=t.getUniformLocation(s,"uStepH"),{program:s,attributeLocations:i,uniformLocations:a}},getAttributeLocations:function(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(t,e,r){var o=e.aPosition,n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.enableVertexAttribArray(o),t.vertexAttribPointer(o,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW)},_setupFrameBuffer:function(t){var e=t.context,r,o;t.passes>1?(r=t.destinationWidth,o=t.destinationHeight,(t.sourceWidth!==r||t.sourceHeight!==o)&&(e.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(e,r,o)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.targetTexture,0)):(e.bindFramebuffer(e.FRAMEBUFFER,null),e.finish())},_swapTextures:function(t){t.passes--,t.pass++;var e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e},isNeutralState:function(){var t=this.mainParameter,e=x.Image.filters[this.type].prototype;if(t)if(Array.isArray(e[t])){for(var r=e[t].length;r--;)if(this[t][r]!==e[t][r])return!1;return!0}else return e[t]===this[t];else return!1},applyTo:function(t){t.webgl?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},retrieveShader:function(t){return t.programCache.hasOwnProperty(this.type)||(t.programCache[this.type]=this.createProgram(t.context)),t.programCache[this.type]},applyToWebGL:function(t){var e=t.context,r=this.retrieveShader(t);t.pass===0&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(r.program),this.sendAttributeData(e,r.attributeLocations,t.aPosition),e.uniform1f(r.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(r.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,r.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(t,e,r){t.activeTexture(r),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)},unbindAdditionalTexture:function(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(t){this[this.mainParameter]=t},sendUniformData:function(){},createHelpLayer:function(t){if(!t.helpLayer){var e=document.createElement("canvas");e.width=t.sourceWidth,e.height=t.sourceHeight,t.helpLayer=e}},toObject:function(){var t={type:this.type},e=this.mainParameter;return e&&(t[e]=this[e]),t},toJSON:function(){return this.toObject()}});x.Image.filters.BaseFilter.fromObject=function(t,e){var r=new x.Image.filters[t.type](t);return e&&e(r),r};(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.ColorMatrix=o(r.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(n){this.callSuper("initialize",n),this.matrix=this.matrix.slice(0)},applyTo2d:function(n){var s=n.imageData,i=s.data,a=i.length,l=this.matrix,u,c,h,d,g,m=this.colorsOnly;for(g=0;g<a;g+=4)u=i[g],c=i[g+1],h=i[g+2],m?(i[g]=u*l[0]+c*l[1]+h*l[2]+l[4]*255,i[g+1]=u*l[5]+c*l[6]+h*l[7]+l[9]*255,i[g+2]=u*l[10]+c*l[11]+h*l[12]+l[14]*255):(d=i[g+3],i[g]=u*l[0]+c*l[1]+h*l[2]+d*l[3]+l[4]*255,i[g+1]=u*l[5]+c*l[6]+h*l[7]+d*l[8]+l[9]*255,i[g+2]=u*l[10]+c*l[11]+h*l[12]+d*l[13]+l[14]*255,i[g+3]=u*l[15]+c*l[16]+h*l[17]+d*l[18]+l[19]*255)},getUniformLocations:function(n,s){return{uColorMatrix:n.getUniformLocation(s,"uColorMatrix"),uConstants:n.getUniformLocation(s,"uConstants")}},sendUniformData:function(n,s){var i=this.matrix,a=[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]],l=[i[4],i[9],i[14],i[19]];n.uniformMatrix4fv(s.uColorMatrix,!1,a),n.uniform4fv(s.uConstants,l)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Brightness=o(r.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(n){if(this.brightness!==0){var s=n.imageData,i=s.data,a,l=i.length,u=Math.round(this.brightness*255);for(a=0;a<l;a+=4)i[a]=i[a]+u,i[a+1]=i[a+1]+u,i[a+2]=i[a+2]+u}},getUniformLocations:function(n,s){return{uBrightness:n.getUniformLocation(s,"uBrightness")}},sendUniformData:function(n,s){n.uniform1f(s.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,o=e.Image.filters,n=e.util.createClass;o.Convolute=n(o.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(s){var i=Math.sqrt(this.matrix.length),a=this.type+"_"+i+"_"+(this.opaque?1:0),l=this.fragmentSource[a];return s.programCache.hasOwnProperty(a)||(s.programCache[a]=this.createProgram(s.context,l)),s.programCache[a]},applyTo2d:function(s){var i=s.imageData,a=i.data,l=this.matrix,u=Math.round(Math.sqrt(l.length)),c=Math.floor(u/2),h=i.width,d=i.height,g=s.ctx.createImageData(h,d),m=g.data,y=this.opaque?1:0,C,b,k,L,N,M,W,Y,J,oe,pe,le,w;for(pe=0;pe<d;pe++)for(oe=0;oe<h;oe++){for(N=(pe*h+oe)*4,C=0,b=0,k=0,L=0,w=0;w<u;w++)for(le=0;le<u;le++)W=pe+w-c,M=oe+le-c,!(W<0||W>=d||M<0||M>=h)&&(Y=(W*h+M)*4,J=l[w*u+le],C+=a[Y]*J,b+=a[Y+1]*J,k+=a[Y+2]*J,y||(L+=a[Y+3]*J));m[N]=C,m[N+1]=b,m[N+2]=k,y?m[N+3]=a[N+3]:m[N+3]=L}s.imageData=g},getUniformLocations:function(s,i){return{uMatrix:s.getUniformLocation(i,"uMatrix"),uOpaque:s.getUniformLocation(i,"uOpaque"),uHalfSize:s.getUniformLocation(i,"uHalfSize"),uSize:s.getUniformLocation(i,"uSize")}},sendUniformData:function(s,i){s.uniform1fv(i.uMatrix,this.matrix)},toObject:function(){return r(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Grayscale=o(r.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(n){var s=n.imageData,i=s.data,a,l=i.length,u,c=this.mode;for(a=0;a<l;a+=4)c==="average"?u=(i[a]+i[a+1]+i[a+2])/3:c==="lightness"?u=(Math.min(i[a],i[a+1],i[a+2])+Math.max(i[a],i[a+1],i[a+2]))/2:c==="luminosity"&&(u=.21*i[a]+.72*i[a+1]+.07*i[a+2]),i[a]=u,i[a+1]=u,i[a+2]=u},retrieveShader:function(n){var s=this.type+"_"+this.mode;if(!n.programCache.hasOwnProperty(s)){var i=this.fragmentSource[this.mode];n.programCache[s]=this.createProgram(n.context,i)}return n.programCache[s]},getUniformLocations:function(n,s){return{uMode:n.getUniformLocation(s,"uMode")}},sendUniformData:function(n,s){var i=1;n.uniform1i(s.uMode,i)},isNeutralState:function(){return!1}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Invert=o(r.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(n){var s=n.imageData,i=s.data,a,l=i.length;for(a=0;a<l;a+=4)i[a]=255-i[a],i[a+1]=255-i[a+1],i[a+2]=255-i[a+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(n,s){return{uInvert:n.getUniformLocation(s,"uInvert")}},sendUniformData:function(n,s){n.uniform1i(s.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,o=e.Image.filters,n=e.util.createClass;o.Noise=n(o.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(s){if(this.noise!==0){var i=s.imageData,a=i.data,l,u=a.length,c=this.noise,h;for(l=0,u=a.length;l<u;l+=4)h=(.5-Math.random())*c,a[l]+=h,a[l+1]+=h,a[l+2]+=h}},getUniformLocations:function(s,i){return{uNoise:s.getUniformLocation(i,"uNoise"),uSeed:s.getUniformLocation(i,"uSeed")}},sendUniformData:function(s,i){s.uniform1f(i.uNoise,this.noise/255),s.uniform1f(i.uSeed,Math.random())},toObject:function(){return r(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Pixelate=o(r.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(n){var s=n.imageData,i=s.data,a=s.height,l=s.width,u,c,h,d,g,m,y,C,b,k,L;for(c=0;c<a;c+=this.blocksize)for(h=0;h<l;h+=this.blocksize)for(u=c*4*l+h*4,d=i[u],g=i[u+1],m=i[u+2],y=i[u+3],k=Math.min(c+this.blocksize,a),L=Math.min(h+this.blocksize,l),C=c;C<k;C++)for(b=h;b<L;b++)u=C*4*l+b*4,i[u]=d,i[u+1]=g,i[u+2]=m,i[u+3]=y},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(n,s){return{uBlocksize:n.getUniformLocation(s,"uBlocksize"),uStepW:n.getUniformLocation(s,"uStepW"),uStepH:n.getUniformLocation(s,"uStepH")}},sendUniformData:function(n,s){n.uniform1f(s.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,o=e.Image.filters,n=e.util.createClass;o.RemoveColor=n(o.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(s){var i=s.imageData,a=i.data,l,u=this.distance*255,c,h,d,g=new e.Color(this.color).getSource(),m=[g[0]-u,g[1]-u,g[2]-u],y=[g[0]+u,g[1]+u,g[2]+u];for(l=0;l<a.length;l+=4)c=a[l],h=a[l+1],d=a[l+2],c>m[0]&&h>m[1]&&d>m[2]&&c<y[0]&&h<y[1]&&d<y[2]&&(a[l+3]=0)},getUniformLocations:function(s,i){return{uLow:s.getUniformLocation(i,"uLow"),uHigh:s.getUniformLocation(i,"uHigh")}},sendUniformData:function(s,i){var a=new e.Color(this.color).getSource(),l=parseFloat(this.distance),u=[0+a[0]/255-l,0+a[1]/255-l,0+a[2]/255-l,1],c=[a[0]/255+l,a[1]/255+l,a[2]/255+l,1];s.uniform4fv(i.uLow,u),s.uniform4fv(i.uHigh,c)},toObject:function(){return r(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),e.Image.filters.RemoveColor.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass,n={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var s in n)r[s]=o(r.ColorMatrix,{type:s,matrix:n[s],mainParameter:!1,colorsOnly:!0}),e.Image.filters[s].fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric,r=e.Image.filters,o=e.util.createClass;r.BlendColor=o(r.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(n){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[n]+`}
}`},retrieveShader:function(n){var s=this.type+"_"+this.mode,i;return n.programCache.hasOwnProperty(s)||(i=this.buildSource(this.mode),n.programCache[s]=this.createProgram(n.context,i)),n.programCache[s]},applyTo2d:function(n){var s=n.imageData,i=s.data,a=i.length,l,u,c,h,d,g,m,y=1-this.alpha;m=new e.Color(this.color).getSource(),l=m[0]*this.alpha,u=m[1]*this.alpha,c=m[2]*this.alpha;for(var C=0;C<a;C+=4)switch(h=i[C],d=i[C+1],g=i[C+2],this.mode){case"multiply":i[C]=h*l/255,i[C+1]=d*u/255,i[C+2]=g*c/255;break;case"screen":i[C]=255-(255-h)*(255-l)/255,i[C+1]=255-(255-d)*(255-u)/255,i[C+2]=255-(255-g)*(255-c)/255;break;case"add":i[C]=h+l,i[C+1]=d+u,i[C+2]=g+c;break;case"diff":case"difference":i[C]=Math.abs(h-l),i[C+1]=Math.abs(d-u),i[C+2]=Math.abs(g-c);break;case"subtract":i[C]=h-l,i[C+1]=d-u,i[C+2]=g-c;break;case"darken":i[C]=Math.min(h,l),i[C+1]=Math.min(d,u),i[C+2]=Math.min(g,c);break;case"lighten":i[C]=Math.max(h,l),i[C+1]=Math.max(d,u),i[C+2]=Math.max(g,c);break;case"overlay":i[C]=l<128?2*h*l/255:255-2*(255-h)*(255-l)/255,i[C+1]=u<128?2*d*u/255:255-2*(255-d)*(255-u)/255,i[C+2]=c<128?2*g*c/255:255-2*(255-g)*(255-c)/255;break;case"exclusion":i[C]=l+h-2*l*h/255,i[C+1]=u+d-2*u*d/255,i[C+2]=c+g-2*c*g/255;break;case"tint":i[C]=l+h*y,i[C+1]=u+d*y,i[C+2]=c+g*y}},getUniformLocations:function(n,s){return{uColor:n.getUniformLocation(s,"uColor")}},sendUniformData:function(n,s){var i=new e.Color(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,n.uniform4fv(s.uColor,i)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendColor.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric,r=e.Image.filters,o=e.util.createClass;r.BlendImage=o(r.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(n){var s=this.type+"_"+this.mode,i=this.fragmentSource[this.mode];return n.programCache.hasOwnProperty(s)||(n.programCache[s]=this.createProgram(n.context,i)),n.programCache[s]},applyToWebGL:function(n){var s=n.context,i=this.createTexture(n.filterBackend,this.image);this.bindAdditionalTexture(s,i,s.TEXTURE1),this.callSuper("applyToWebGL",n),this.unbindAdditionalTexture(s,s.TEXTURE1)},createTexture:function(n,s){return n.getCachedTexture(s.cacheKey,s._element)},calculateMatrix:function(){var n=this.image,s=n._element.width,i=n._element.height;return[1/n.scaleX,0,0,0,1/n.scaleY,0,-n.left/s,-n.top/i,1]},applyTo2d:function(n){var s=n.imageData,i=n.filterBackend.resources,a=s.data,l=a.length,u=s.width,c=s.height,h,d,g,m,y,C,b,k,L,N,M=this.image,W;i.blendImage||(i.blendImage=e.util.createCanvasElement()),L=i.blendImage,N=L.getContext("2d"),L.width!==u||L.height!==c?(L.width=u,L.height=c):N.clearRect(0,0,u,c),N.setTransform(M.scaleX,0,0,M.scaleY,M.left,M.top),N.drawImage(M._element,0,0,u,c),W=N.getImageData(0,0,u,c).data;for(var Y=0;Y<l;Y+=4)switch(y=a[Y],C=a[Y+1],b=a[Y+2],k=a[Y+3],h=W[Y],d=W[Y+1],g=W[Y+2],m=W[Y+3],this.mode){case"multiply":a[Y]=y*h/255,a[Y+1]=C*d/255,a[Y+2]=b*g/255,a[Y+3]=k*m/255;break;case"mask":a[Y+3]=m;break}},getUniformLocations:function(n,s){return{uTransformMatrix:n.getUniformLocation(s,"uTransformMatrix"),uImage:n.getUniformLocation(s,"uImage")}},sendUniformData:function(n,s){var i=this.calculateMatrix();n.uniform1i(s.uImage,1),n.uniformMatrix3fv(s.uTransformMatrix,!1,i)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendImage.fromObject=function(n,s){e.Image.fromObject(n.image,function(i){var a=e.util.object.clone(n);a.image=i,s(new e.Image.filters.BlendImage(a))})}})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=Math.pow,o=Math.floor,n=Math.sqrt,s=Math.abs,i=Math.round,a=Math.sin,l=Math.ceil,u=e.Image.filters,c=e.util.createClass;u.Resize=c(u.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(h,d){return{uDelta:h.getUniformLocation(d,"uDelta"),uTaps:h.getUniformLocation(d,"uTaps")}},sendUniformData:function(h,d){h.uniform2fv(d.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),h.uniform1fv(d.uTaps,this.taps)},retrieveShader:function(h){var d=this.getFilterWindow(),g=this.type+"_"+d;if(!h.programCache.hasOwnProperty(g)){var m=this.generateShader(d);h.programCache[g]=this.createProgram(h.context,m)}return h.programCache[g]},getFilterWindow:function(){var h=this.tempScale;return Math.ceil(this.lanczosLobes/h)},getTaps:function(){for(var h=this.lanczosCreate(this.lanczosLobes),d=this.tempScale,g=this.getFilterWindow(),m=new Array(g),y=1;y<=g;y++)m[y-1]=h(y*d);return m},generateShader:function(m){for(var d=new Array(m),g=this.fragmentSourceTOP,m,y=1;y<=m;y++)d[y-1]=y+".0 * uDelta";return g+="uniform float uTaps["+m+`];
`,g+=`void main() {
`,g+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,g+=`  float sum = 1.0;
`,d.forEach(function(C,b){g+="  color += texture2D(uTexture, vTexCoord + "+C+") * uTaps["+b+`];
`,g+="  color += texture2D(uTexture, vTexCoord - "+C+") * uTaps["+b+`];
`,g+="  sum += 2.0 * uTaps["+b+`];
`}),g+=`  gl_FragColor = color / sum;
`,g+="}",g},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(h){h.webgl?(h.passes++,this.width=h.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=h.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),h.destinationWidth=this.dW,this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h),h.sourceWidth=h.destinationWidth,this.height=h.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),h.destinationHeight=this.dH,this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h),h.sourceHeight=h.destinationHeight):this.applyTo2d(h)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(h){return function(d){if(d>=h||d<=-h)return 0;if(d<11920929e-14&&d>-11920929e-14)return 1;d*=Math.PI;var g=d/h;return a(d)/d*a(g)/g}},applyTo2d:function(h){var d=h.imageData,g=this.scaleX,m=this.scaleY;this.rcpScaleX=1/g,this.rcpScaleY=1/m;var y=d.width,C=d.height,b=i(y*g),k=i(C*m),L;this.resizeType==="sliceHack"?L=this.sliceByTwo(h,y,C,b,k):this.resizeType==="hermite"?L=this.hermiteFastResize(h,y,C,b,k):this.resizeType==="bilinear"?L=this.bilinearFiltering(h,y,C,b,k):this.resizeType==="lanczos"&&(L=this.lanczosResize(h,y,C,b,k)),h.imageData=L},sliceByTwo:function(h,d,g,m,y){var C=h.imageData,b=.5,k=!1,L=!1,N=d*b,M=g*b,W=e.filterBackend.resources,Y,J,oe=0,pe=0,le=d,w=0;for(W.sliceByTwo||(W.sliceByTwo=document.createElement("canvas")),Y=W.sliceByTwo,(Y.width<d*1.5||Y.height<g)&&(Y.width=d*1.5,Y.height=g),J=Y.getContext("2d"),J.clearRect(0,0,d*1.5,g),J.putImageData(C,0,0),m=o(m),y=o(y);!k||!L;)d=N,g=M,m<o(N*b)?N=o(N*b):(N=m,k=!0),y<o(M*b)?M=o(M*b):(M=y,L=!0),J.drawImage(Y,oe,pe,d,g,le,w,N,M),oe=le,pe=w,w+=M;return J.getImageData(oe,pe,m,y)},lanczosResize:function(h,d,g,m,y){function C(P){var I,H,S,_,O,j,V,z,X,q,ae;for(w.x=(P+.5)*M,F.x=o(w.x),I=0;I<y;I++){for(w.y=(I+.5)*W,F.y=o(w.y),O=0,j=0,V=0,z=0,X=0,H=F.x-oe;H<=F.x+oe;H++)if(!(H<0||H>=d)){q=o(1e3*s(H-w.x)),le[q]||(le[q]={});for(var $=F.y-pe;$<=F.y+pe;$++)$<0||$>=g||(ae=o(1e3*s($-w.y)),le[q][ae]||(le[q][ae]=N(n(r(q*Y,2)+r(ae*J,2))/1e3)),S=le[q][ae],S>0&&(_=($*d+H)*4,O+=S,j+=S*b[_],V+=S*b[_+1],z+=S*b[_+2],X+=S*b[_+3]))}_=(I*m+P)*4,L[_]=j/O,L[_+1]=V/O,L[_+2]=z/O,L[_+3]=X/O}return++P<m?C(P):k}var b=h.imageData.data,k=h.ctx.createImageData(m,y),L=k.data,N=this.lanczosCreate(this.lanczosLobes),M=this.rcpScaleX,W=this.rcpScaleY,Y=2/this.rcpScaleX,J=2/this.rcpScaleY,oe=l(M*this.lanczosLobes/2),pe=l(W*this.lanczosLobes/2),le={},w={},F={};return C(0)},bilinearFiltering:function(h,d,g,m,y){var C,b,k,L,N,M,W,Y,J,oe,pe,le,w=0,F,P=this.rcpScaleX,I=this.rcpScaleY,H=4*(d-1),S=h.imageData,_=S.data,O=h.ctx.createImageData(m,y),j=O.data;for(W=0;W<y;W++)for(Y=0;Y<m;Y++)for(N=o(P*Y),M=o(I*W),J=P*Y-N,oe=I*W-M,F=4*(M*d+N),pe=0;pe<4;pe++)C=_[F+pe],b=_[F+4+pe],k=_[F+H+pe],L=_[F+H+4+pe],le=C*(1-J)*(1-oe)+b*J*(1-oe)+k*oe*(1-J)+L*J*oe,j[w++]=le;return O},hermiteFastResize:function(h,d,g,m,y){for(var C=this.rcpScaleX,b=this.rcpScaleY,k=l(C/2),L=l(b/2),N=h.imageData,M=N.data,W=h.ctx.createImageData(m,y),Y=W.data,J=0;J<y;J++)for(var oe=0;oe<m;oe++){for(var pe=(oe+J*m)*4,le=0,w=0,F=0,P=0,I=0,H=0,S=0,_=(J+.5)*b,O=o(J*b);O<(J+1)*b;O++)for(var j=s(_-(O+.5))/L,V=(oe+.5)*C,z=j*j,X=o(oe*C);X<(oe+1)*C;X++){var q=s(V-(X+.5))/k,ae=n(z+q*q);ae>1&&ae<-1||(le=2*ae*ae*ae-3*ae*ae+1,le>0&&(q=4*(X+O*d),S+=le*M[q+3],F+=le,M[q+3]<255&&(le=le*M[q+3]/250),P+=le*M[q],I+=le*M[q+1],H+=le*M[q+2],w+=le))}Y[pe]=P/w,Y[pe+1]=I/w,Y[pe+2]=H/w,Y[pe+3]=S/F}return W},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Contrast=o(r.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(n){if(this.contrast!==0){var s=n.imageData,i,l,a=s.data,l=a.length,u=Math.floor(this.contrast*255),c=259*(u+255)/(255*(259-u));for(i=0;i<l;i+=4)a[i]=c*(a[i]-128)+128,a[i+1]=c*(a[i+1]-128)+128,a[i+2]=c*(a[i+2]-128)+128}},getUniformLocations:function(n,s){return{uContrast:n.getUniformLocation(s,"uContrast")}},sendUniformData:function(n,s){n.uniform1f(s.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Saturation=o(r.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(n){if(this.saturation!==0){var s=n.imageData,i=s.data,a=i.length,l=-this.saturation,u,c;for(u=0;u<a;u+=4)c=Math.max(i[u],i[u+1],i[u+2]),i[u]+=c!==i[u]?(c-i[u])*l:0,i[u+1]+=c!==i[u+1]?(c-i[u+1])*l:0,i[u+2]+=c!==i[u+2]?(c-i[u+2])*l:0}},getUniformLocations:function(n,s){return{uSaturation:n.getUniformLocation(s,"uSaturation")}},sendUniformData:function(n,s){n.uniform1f(s.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Vibrance=o(r.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(n){if(this.vibrance!==0){var s=n.imageData,i=s.data,a=i.length,l=-this.vibrance,u,c,h,d;for(u=0;u<a;u+=4)c=Math.max(i[u],i[u+1],i[u+2]),h=(i[u]+i[u+1]+i[u+2])/3,d=Math.abs(c-h)*2/255*l,i[u]+=c!==i[u]?(c-i[u])*d:0,i[u+1]+=c!==i[u+1]?(c-i[u+1])*d:0,i[u+2]+=c!==i[u+2]?(c-i[u+2])*d:0}},getUniformLocations:function(n,s){return{uVibrance:n.getUniformLocation(s,"uVibrance")}},sendUniformData:function(n,s){n.uniform1f(s.uVibrance,-this.vibrance)}}),e.Image.filters.Vibrance.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Blur=o(r.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(n){n.webgl?(this.aspectRatio=n.sourceWidth/n.sourceHeight,n.passes++,this._setupFrameBuffer(n),this.horizontal=!0,this.applyToWebGL(n),this._swapTextures(n),this._setupFrameBuffer(n),this.horizontal=!1,this.applyToWebGL(n),this._swapTextures(n)):this.applyTo2d(n)},applyTo2d:function(n){n.imageData=this.simpleBlur(n)},simpleBlur:function(n){var s=n.filterBackend.resources,i,a,l=n.imageData.width,u=n.imageData.height;s.blurLayer1||(s.blurLayer1=e.util.createCanvasElement(),s.blurLayer2=e.util.createCanvasElement()),i=s.blurLayer1,a=s.blurLayer2,(i.width!==l||i.height!==u)&&(a.width=i.width=l,a.height=i.height=u);var c=i.getContext("2d"),h=a.getContext("2d"),d=15,g,m,y,C,b=this.blur*.06*.5;for(c.putImageData(n.imageData,0,0),h.clearRect(0,0,l,u),C=-d;C<=d;C++)g=(Math.random()-.5)/4,m=C/d,y=b*m*l+g,h.globalAlpha=1-Math.abs(m),h.drawImage(i,y,g),c.drawImage(a,0,0),h.globalAlpha=1,h.clearRect(0,0,a.width,a.height);for(C=-d;C<=d;C++)g=(Math.random()-.5)/4,m=C/d,y=b*m*u+g,h.globalAlpha=1-Math.abs(m),h.drawImage(i,g,y),c.drawImage(a,0,0),h.globalAlpha=1,h.clearRect(0,0,a.width,a.height);n.ctx.drawImage(i,0,0);var k=n.ctx.getImageData(0,0,i.width,i.height);return c.globalAlpha=1,c.clearRect(0,0,i.width,i.height),k},getUniformLocations:function(n,s){return{delta:n.getUniformLocation(s,"uDelta")}},sendUniformData:function(n,s){var i=this.chooseRightDelta();n.uniform2fv(s.delta,i)},chooseRightDelta:function(){var n=1,s=[0,0],i;return this.horizontal?this.aspectRatio>1&&(n=1/this.aspectRatio):this.aspectRatio<1&&(n=this.aspectRatio),i=n*this.blur*.12,this.horizontal?s[0]=i:s[1]=i,s}}),r.Blur.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Gamma=o(r.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(n){this.gamma=[1,1,1],r.BaseFilter.prototype.initialize.call(this,n)},applyTo2d:function(n){var s=n.imageData,i=s.data,a=this.gamma,l=i.length,u=1/a[0],c=1/a[1],h=1/a[2],d;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),d=0,l=256;d<l;d++)this.rVals[d]=Math.pow(d/255,u)*255,this.gVals[d]=Math.pow(d/255,c)*255,this.bVals[d]=Math.pow(d/255,h)*255;for(d=0,l=i.length;d<l;d+=4)i[d]=this.rVals[i[d]],i[d+1]=this.gVals[i[d+1]],i[d+2]=this.bVals[i[d+2]]},getUniformLocations:function(n,s){return{uGamma:n.getUniformLocation(s,"uGamma")}},sendUniformData:function(n,s){n.uniform3fv(s.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Composed=o(r.BaseFilter,{type:"Composed",subFilters:[],initialize:function(n){this.callSuper("initialize",n),this.subFilters=this.subFilters.slice(0)},applyTo:function(n){n.passes+=this.subFilters.length-1,this.subFilters.forEach(function(s){s.applyTo(n)})},toObject:function(){return e.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(n){return n.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(n){return!n.isNeutralState()})}}),e.Image.filters.Composed.fromObject=function(n,s){var i=n.subFilters||[],a=i.map(function(u){return new e.Image.filters[u.type](u)}),l=new e.Image.filters.Composed({subFilters:a});return s&&s(l),l}})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.HueRotation=o(r.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var n=this.rotation*Math.PI,s=e.util.cos(n),i=e.util.sin(n),a=1/3,l=Math.sqrt(a)*i,u=1-s;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=s+u/3,this.matrix[1]=a*u-l,this.matrix[2]=a*u+l,this.matrix[5]=a*u+l,this.matrix[6]=s+a*u,this.matrix[7]=a*u-l,this.matrix[10]=a*u-l,this.matrix[11]=a*u+l,this.matrix[12]=s+a*u},isNeutralState:function(n){return this.calculateMatrix(),r.BaseFilter.prototype.isNeutralState.call(this,n)},applyTo:function(n){this.calculateMatrix(),r.BaseFilter.prototype.applyTo.call(this,n)}}),e.Image.filters.HueRotation.fromObject=e.Image.filters.BaseFilter.fromObject})(Ce);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.clone;if(e.Text){e.warn("fabric.Text is already defined");return}var o="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:e.Object.prototype.stateProperties.concat(o),cacheProperties:e.Object.prototype.cacheProperties.concat(o),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(n,s){this.styles=s?s.styles||{}:{},this.text=n,this.__skipDimension=!0,this.callSuper("initialize",s),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var n=this.path;n&&(n.segmentsInfo=e.util.getPathSegmentsInfo(n.path))},getMeasuringContext:function(){return e._measuringContext||(e._measuringContext=this.canvas&&this.canvas.contextCache||e.util.createCanvasElement().getContext("2d")),e._measuringContext},_splitText:function(){var n=this._splitTextIntoLines(this.text);return this.textLines=n.lines,this._textLines=n.graphemeLines,this._unwrappedTextLines=n._unwrappedLines,this._text=n.graphemeText,n},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var n,s,i,a,l,u,c,h=0,d=this._textLines.length;h<d;h++)if(!(this.textAlign!=="justify"&&(h===d-1||this.isEndOfWrapping(h)))&&(a=0,l=this._textLines[h],s=this.getLineWidth(h),s<this.width&&(c=this.textLines[h].match(this._reSpacesAndTabs)))){i=c.length,n=(this.width-s)/i;for(var g=0,m=l.length;g<=m;g++)u=this.__charBounds[h][g],this._reSpaceAndTab.test(l[g])?(u.width+=n,u.kernedWidth+=n,u.left+=a,a+=n):u.left+=a}},isEndOfWrapping:function(n){return n===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var n=this.callSuper("_getCacheCanvasDimensions"),s=this.fontSize;return n.width+=s*n.zoomX,n.height+=s*n.zoomY,n},_render:function(n){var s=this.path;s&&!s.isNotVisible()&&s._render(n),this._setTextStyles(n),this._renderTextLinesBackground(n),this._renderTextDecoration(n,"underline"),this._renderText(n),this._renderTextDecoration(n,"overline"),this._renderTextDecoration(n,"linethrough")},_renderText:function(n){this.paintFirst==="stroke"?(this._renderTextStroke(n),this._renderTextFill(n)):(this._renderTextFill(n),this._renderTextStroke(n))},_setTextStyles:function(n,s,i){if(n.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":n.textBaseline="middle";break;case"ascender":n.textBaseline="top";break;case"descender":n.textBaseline="bottom";break}n.font=this._getFontDeclaration(s,i)},calcTextWidth:function(){for(var n=this.getLineWidth(0),s=1,i=this._textLines.length;s<i;s++){var a=this.getLineWidth(s);a>n&&(n=a)}return n},_renderTextLine:function(n,s,i,a,l,u){this._renderChars(n,s,i,a,l,u)},_renderTextLinesBackground:function(n){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var s,i,a=n.fillStyle,l,u,c=this._getLeftOffset(),h=this._getTopOffset(),d=0,g=0,m,y,C=this.path,b,k=0,L=this._textLines.length;k<L;k++){if(s=this.getHeightOfLine(k),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",k)){h+=s;continue}l=this._textLines[k],i=this._getLineLeftOffset(k),g=0,d=0,u=this.getValueOfPropertyAt(k,0,"textBackgroundColor");for(var N=0,M=l.length;N<M;N++)m=this.__charBounds[k][N],y=this.getValueOfPropertyAt(k,N,"textBackgroundColor"),C?(n.save(),n.translate(m.renderLeft,m.renderTop),n.rotate(m.angle),n.fillStyle=y,y&&n.fillRect(-m.width/2,-s/this.lineHeight*(1-this._fontSizeFraction),m.width,s/this.lineHeight),n.restore()):y!==u?(b=c+i+d,this.direction==="rtl"&&(b=this.width-b-g),n.fillStyle=u,u&&n.fillRect(b,h,g,s/this.lineHeight),d=m.left,g=m.width,u=y):g+=m.kernedWidth;y&&!C&&(b=c+i+d,this.direction==="rtl"&&(b=this.width-b-g),n.fillStyle=y,n.fillRect(b,h,g,s/this.lineHeight)),h+=s}n.fillStyle=a,this._removeShadow(n)}},getFontCache:function(n){var s=n.fontFamily.toLowerCase();e.charWidthsCache[s]||(e.charWidthsCache[s]={});var i=e.charWidthsCache[s],a=n.fontStyle.toLowerCase()+"_"+(n.fontWeight+"").toLowerCase();return i[a]||(i[a]={}),i[a]},_measureChar:function(n,s,i,a){var l=this.getFontCache(s),u=this._getFontDeclaration(s),c=this._getFontDeclaration(a),h=i+n,d=u===c,g,m,y,C=s.fontSize/this.CACHE_FONT_SIZE,b;if(i&&l[i]!==void 0&&(y=l[i]),l[n]!==void 0&&(b=g=l[n]),d&&l[h]!==void 0&&(m=l[h],b=m-y),g===void 0||y===void 0||m===void 0){var k=this.getMeasuringContext();this._setTextStyles(k,s,!0)}return g===void 0&&(b=g=k.measureText(n).width,l[n]=g),y===void 0&&d&&i&&(y=k.measureText(i).width,l[i]=y),d&&m===void 0&&(m=k.measureText(h).width,l[h]=m,b=m-y),{width:g*C,kernedWidth:b*C}},getHeightOfChar:function(n,s){return this.getValueOfPropertyAt(n,s,"fontSize")},measureLine:function(n){var s=this._measureLine(n);return this.charSpacing!==0&&(s.width-=this._getWidthOfCharSpacing()),s.width<0&&(s.width=0),s},_measureLine:function(n){var s=0,i,a,l=this._textLines[n],u,c,h=0,d=new Array(l.length),g=0,m,y,C=this.path,b=this.pathSide==="right";for(this.__charBounds[n]=d,i=0;i<l.length;i++)a=l[i],c=this._getGraphemeBox(a,n,i,u),d[i]=c,s+=c.kernedWidth,u=a;if(d[i]={left:c?c.left+c.width:0,width:0,kernedWidth:0,height:this.fontSize},C){switch(y=C.segmentsInfo[C.segmentsInfo.length-1].length,m=e.util.getPointOnPath(C.path,0,C.segmentsInfo),m.x+=C.pathOffset.x,m.y+=C.pathOffset.y,this.textAlign){case"left":g=b?y-s:0;break;case"center":g=(y-s)/2;break;case"right":g=b?0:y-s;break}for(g+=this.pathStartOffset*(b?-1:1),i=b?l.length-1:0;b?i>=0:i<l.length;b?i--:i++)c=d[i],g>y?g%=y:g<0&&(g+=y),this._setGraphemeOnPath(g,c,m),g+=c.kernedWidth}return{width:s,numOfSpaces:h}},_setGraphemeOnPath:function(n,s,i){var a=n+s.kernedWidth/2,l=this.path,u=e.util.getPointOnPath(l.path,a,l.segmentsInfo);s.renderLeft=u.x-i.x,s.renderTop=u.y-i.y,s.angle=u.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(n,s,i,a,l){var u=this.getCompleteStyleDeclaration(s,i),c=a?this.getCompleteStyleDeclaration(s,i-1):{},h=this._measureChar(n,u,a,c),d=h.kernedWidth,g=h.width,m;this.charSpacing!==0&&(m=this._getWidthOfCharSpacing(),g+=m,d+=m);var y={width:g,left:0,height:u.fontSize,kernedWidth:d,deltaY:u.deltaY};if(i>0&&!l){var C=this.__charBounds[s][i-1];y.left=C.left+C.width+h.kernedWidth-h.width}return y},getHeightOfLine:function(n){if(this.__lineHeights[n])return this.__lineHeights[n];for(var s=this._textLines[n],i=this.getHeightOfChar(n,0),a=1,l=s.length;a<l;a++)i=Math.max(this.getHeightOfChar(n,a),i);return this.__lineHeights[n]=i*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var n,s=0,i=0,a=this._textLines.length;i<a;i++)n=this.getHeightOfLine(i),s+=i===a-1?n/this.lineHeight:n;return s},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(n,s){n.save();for(var i=0,a=this._getLeftOffset(),l=this._getTopOffset(),u=0,c=this._textLines.length;u<c;u++){var h=this.getHeightOfLine(u),d=h/this.lineHeight,g=this._getLineLeftOffset(u);this._renderTextLine(s,n,this._textLines[u],a+g,l+i+d,u),i+=h}n.restore()},_renderTextFill:function(n){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(n,"fillText")},_renderTextStroke:function(n){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(n),n.save(),this._setLineDash(n,this.strokeDashArray),n.beginPath(),this._renderTextCommon(n,"strokeText"),n.closePath(),n.restore())},_renderChars:function(n,s,i,a,l,u){var c=this.getHeightOfLine(u),h=this.textAlign.indexOf("justify")!==-1,d,g,m="",y,C=0,b,k=this.path,L=!h&&this.charSpacing===0&&this.isEmptyStyles(u)&&!k,N=this.direction==="ltr",M=this.direction==="ltr"?1:-1,W,Y=s.canvas.getAttribute("dir");if(s.save(),Y!==this.direction&&(s.canvas.setAttribute("dir",N?"ltr":"rtl"),s.direction=N?"ltr":"rtl",s.textAlign=N?"left":"right"),l-=c*this._fontSizeFraction/this.lineHeight,L){this._renderChar(n,s,u,0,i.join(""),a,l,c),s.restore();return}for(var J=0,oe=i.length-1;J<=oe;J++)b=J===oe||this.charSpacing||k,m+=i[J],y=this.__charBounds[u][J],C===0?(a+=M*(y.kernedWidth-y.width),C+=y.width):C+=y.kernedWidth,h&&!b&&this._reSpaceAndTab.test(i[J])&&(b=!0),b||(d=d||this.getCompleteStyleDeclaration(u,J),g=this.getCompleteStyleDeclaration(u,J+1),b=e.util.hasStyleChanged(d,g,!1)),b&&(k?(s.save(),s.translate(y.renderLeft,y.renderTop),s.rotate(y.angle),this._renderChar(n,s,u,J,m,-C/2,0,c),s.restore()):(W=a,this._renderChar(n,s,u,J,m,W,l,c)),m="",d=g,a+=M*C,C=0);s.restore()},_applyPatternGradientTransformText:function(n){var s=e.util.createCanvasElement(),i,a=this.width+this.strokeWidth,l=this.height+this.strokeWidth;return s.width=a,s.height=l,i=s.getContext("2d"),i.beginPath(),i.moveTo(0,0),i.lineTo(a,0),i.lineTo(a,l),i.lineTo(0,l),i.closePath(),i.translate(a/2,l/2),i.fillStyle=n.toLive(i),this._applyPatternGradientTransform(i,n),i.fill(),i.createPattern(s,"no-repeat")},handleFiller:function(n,s,i){var a,l;return i.toLive?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?(a=-this.width/2,l=-this.height/2,n.translate(a,l),n[s]=this._applyPatternGradientTransformText(i),{offsetX:a,offsetY:l}):(n[s]=i.toLive(n,this),this._applyPatternGradientTransform(n,i)):(n[s]=i,{offsetX:0,offsetY:0})},_setStrokeStyles:function(n,s){return n.lineWidth=s.strokeWidth,n.lineCap=this.strokeLineCap,n.lineDashOffset=this.strokeDashOffset,n.lineJoin=this.strokeLineJoin,n.miterLimit=this.strokeMiterLimit,this.handleFiller(n,"strokeStyle",s.stroke)},_setFillStyles:function(n,s){return this.handleFiller(n,"fillStyle",s.fill)},_renderChar:function(n,s,i,a,l,u,c){var h=this._getStyleDeclaration(i,a),d=this.getCompleteStyleDeclaration(i,a),g=n==="fillText"&&d.fill,m=n==="strokeText"&&d.stroke&&d.strokeWidth,y,C;!m&&!g||(s.save(),g&&(y=this._setFillStyles(s,d)),m&&(C=this._setStrokeStyles(s,d)),s.font=this._getFontDeclaration(d),h&&h.textBackgroundColor&&this._removeShadow(s),h&&h.deltaY&&(c+=h.deltaY),g&&s.fillText(l,u-y.offsetX,c-y.offsetY),m&&s.strokeText(l,u-C.offsetX,c-C.offsetY),s.restore())},setSuperscript:function(n,s){return this._setScript(n,s,this.superscript)},setSubscript:function(n,s){return this._setScript(n,s,this.subscript)},_setScript:function(n,s,i){var a=this.get2DCursorLocation(n,!0),l=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"fontSize"),u=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"deltaY"),c={fontSize:l*i.size,deltaY:u+l*i.baseline};return this.setSelectionStyles(c,n,s),this},_getLineLeftOffset:function(n){var s=this.getLineWidth(n),i=this.width-s,a=this.textAlign,l=this.direction,c,u=0,c=this.isEndOfWrapping(n);return a==="justify"||a==="justify-center"&&!c||a==="justify-right"&&!c||a==="justify-left"&&!c?0:(a==="center"&&(u=i/2),a==="right"&&(u=i),a==="justify-center"&&(u=i/2),a==="justify-right"&&(u=i),l==="rtl"&&(u-=i),u)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var n=this._forceClearCache;return n||(n=this.hasStateChanged("_dimensionAffectingProps")),n&&(this.dirty=!0,this._forceClearCache=!1),n},getLineWidth:function(n){if(this.__lineWidths[n]!==void 0)return this.__lineWidths[n];var s=this.measureLine(n),i=s.width;return this.__lineWidths[n]=i,i},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(n,s,i){var a=this._getStyleDeclaration(n,s);return a&&typeof a[i]<"u"?a[i]:this[i]},_renderTextDecoration:function(n,s){if(!(!this[s]&&!this.styleHas(s))){for(var i,a,l,u,c,h,d,g,m=this._getLeftOffset(),y=this._getTopOffset(),C,b,k,L,N,M,W,Y,J=this.path,oe=this._getWidthOfCharSpacing(),pe=this.offsets[s],le=0,w=this._textLines.length;le<w;le++){if(i=this.getHeightOfLine(le),!this[s]&&!this.styleHas(s,le)){y+=i;continue}d=this._textLines[le],M=i/this.lineHeight,u=this._getLineLeftOffset(le),b=0,k=0,g=this.getValueOfPropertyAt(le,0,s),Y=this.getValueOfPropertyAt(le,0,"fill"),C=y+M*(1-this._fontSizeFraction),a=this.getHeightOfChar(le,0),c=this.getValueOfPropertyAt(le,0,"deltaY");for(var F=0,P=d.length;F<P;F++)if(L=this.__charBounds[le][F],N=this.getValueOfPropertyAt(le,F,s),W=this.getValueOfPropertyAt(le,F,"fill"),l=this.getHeightOfChar(le,F),h=this.getValueOfPropertyAt(le,F,"deltaY"),J&&N&&W)n.save(),n.fillStyle=Y,n.translate(L.renderLeft,L.renderTop),n.rotate(L.angle),n.fillRect(-L.kernedWidth/2,pe*l+h,L.kernedWidth,this.fontSize/15),n.restore();else if((N!==g||W!==Y||l!==a||h!==c)&&k>0){var I=m+u+b;this.direction==="rtl"&&(I=this.width-I-k),g&&Y&&(n.fillStyle=Y,n.fillRect(I,C+pe*a+c,k,this.fontSize/15)),b=L.left,k=L.width,g=N,Y=W,a=l,c=h}else k+=L.kernedWidth;var I=m+u+b;this.direction==="rtl"&&(I=this.width-I-k),n.fillStyle=W,N&&W&&n.fillRect(I,C+pe*a+c,k-oe,this.fontSize/15),y+=i}this._removeShadow(n)}},_getFontDeclaration:function(n,s){var i=n||this,a=this.fontFamily,l=e.Text.genericFonts.indexOf(a.toLowerCase())>-1,u=a===void 0||a.indexOf("'")>-1||a.indexOf(",")>-1||a.indexOf('"')>-1||l?i.fontFamily:'"'+i.fontFamily+'"';return[e.isLikelyNode?i.fontWeight:i.fontStyle,e.isLikelyNode?i.fontStyle:i.fontWeight,s?this.CACHE_FONT_SIZE+"px":i.fontSize+"px",u].join(" ")},render:function(n){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",n)))},_splitTextIntoLines:function(n){for(var s=n.split(this._reNewline),i=new Array(s.length),a=[`
`],l=[],u=0;u<s.length;u++)i[u]=e.util.string.graphemeSplit(s[u]),l=l.concat(i[u],a);return l.pop(),{_unwrappedLines:i,lines:s,graphemeText:l,graphemeLines:i}},toObject:function(n){var s=o.concat(n),i=this.callSuper("toObject",s);return i.styles=e.util.stylesToArray(this.styles,this.text),i.path&&(i.path=this.path.toObject()),i},set:function(n,s){this.callSuper("set",n,s);var i=!1,a=!1;if(typeof n=="object")for(var l in n)l==="path"&&this.setPathInfo(),i=i||this._dimensionAffectingProps.indexOf(l)!==-1,a=a||l==="path";else i=this._dimensionAffectingProps.indexOf(n)!==-1,a=n==="path";return a&&this.setPathInfo(),i&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(n,s,i){if(!n)return s(null);var a=e.parseAttributes(n,e.Text.ATTRIBUTE_NAMES),l=a.textAnchor||"left";if(i=e.util.object.extend(i?r(i):{},a),i.top=i.top||0,i.left=i.left||0,a.textDecoration){var u=a.textDecoration;u.indexOf("underline")!==-1&&(i.underline=!0),u.indexOf("overline")!==-1&&(i.overline=!0),u.indexOf("line-through")!==-1&&(i.linethrough=!0),delete i.textDecoration}"dx"in a&&(i.left+=a.dx),"dy"in a&&(i.top+=a.dy),"fontSize"in i||(i.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE);var c="";"textContent"in n?c=n.textContent:"firstChild"in n&&n.firstChild!==null&&"data"in n.firstChild&&n.firstChild.data!==null&&(c=n.firstChild.data),c=c.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var h=i.strokeWidth;i.strokeWidth=0;var d=new e.Text(c,i),g=d.getScaledHeight()/d.height,m=(d.height+d.strokeWidth)*d.lineHeight-d.height,y=m*g,C=d.getScaledHeight()+y,b=0;l==="center"&&(b=d.getScaledWidth()/2),l==="right"&&(b=d.getScaledWidth()),d.set({left:d.left-b,top:d.top-(C-d.fontSize*(.07+d._fontSizeFraction))/d.lineHeight,strokeWidth:typeof h<"u"?h:1}),s(d)},e.Text.fromObject=function(n,s){var i=r(n),a=n.path;return delete i.path,e.Object._fromObject("Text",i,function(l){l.styles=e.util.stylesFromArray(n.styles,n.text),a?e.Object._fromObject("Path",a,function(u){l.set("path",u),s(l)},"path"):s(l)},"text")},e.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],e.util.createAccessors&&e.util.createAccessors(e.Text)})(Ce);(function(){x.util.object.extend(x.Text.prototype,{isEmptyStyles:function(t){if(!this.styles||typeof t<"u"&&!this.styles[t])return!0;var e=typeof t>"u"?this.styles:{line:this.styles[t]};for(var r in e)for(var o in e[r])for(var n in e[r][o])return!1;return!0},styleHas:function(t,e){if(!this.styles||!t||t===""||typeof e<"u"&&!this.styles[e])return!1;var r=typeof e>"u"?this.styles:{0:this.styles[e]};for(var o in r)for(var n in r[o])if(typeof r[o][n][t]<"u")return!0;return!1},cleanStyle:function(t){if(!this.styles||!t||t==="")return!1;var e=this.styles,r=0,o,n,s=!0,i=0,a;for(var l in e){o=0;for(var u in e[l]){var a=e[l][u],c=a.hasOwnProperty(t);r++,c?(n?a[t]!==n&&(s=!1):n=a[t],a[t]===this[t]&&delete a[t]):s=!1,Object.keys(a).length!==0?o++:delete e[l][u]}o===0&&delete e[l]}for(var h=0;h<this._textLines.length;h++)i+=this._textLines[h].length;s&&r===i&&(this[t]=n,this.removeStyle(t))},removeStyle:function(t){if(!(!this.styles||!t||t==="")){var e=this.styles,r,o,n;for(o in e){r=e[o];for(n in r)delete r[n][t],Object.keys(r[n]).length===0&&delete r[n];Object.keys(r).length===0&&delete e[o]}}},_extendStyles:function(t,e){var r=this.get2DCursorLocation(t);this._getLineStyle(r.lineIndex)||this._setLineStyle(r.lineIndex),this._getStyleDeclaration(r.lineIndex,r.charIndex)||this._setStyleDeclaration(r.lineIndex,r.charIndex,{}),x.util.object.extend(this._getStyleDeclaration(r.lineIndex,r.charIndex),e)},get2DCursorLocation:function(t,e){typeof t>"u"&&(t=this.selectionStart);for(var r=e?this._unwrappedTextLines:this._textLines,o=r.length,n=0;n<o;n++){if(t<=r[n].length)return{lineIndex:n,charIndex:t};t-=r[n].length+this.missingNewlineOffset(n)}return{lineIndex:n-1,charIndex:r[n-1].length<t?r[n-1].length:t}},getSelectionStyles:function(t,e,r){typeof t>"u"&&(t=this.selectionStart||0),typeof e>"u"&&(e=this.selectionEnd||t);for(var o=[],n=t;n<e;n++)o.push(this.getStyleAtPosition(n,r));return o},getStyleAtPosition:function(t,e){var r=this.get2DCursorLocation(t),o=e?this.getCompleteStyleDeclaration(r.lineIndex,r.charIndex):this._getStyleDeclaration(r.lineIndex,r.charIndex);return o||{}},setSelectionStyles:function(t,e,r){typeof e>"u"&&(e=this.selectionStart||0),typeof r>"u"&&(r=this.selectionEnd||e);for(var o=e;o<r;o++)this._extendStyles(o,t);return this._forceClearCache=!0,this},_getStyleDeclaration:function(t,e){var r=this.styles&&this.styles[t];return r?r[e]:null},getCompleteStyleDeclaration:function(t,e){for(var r=this._getStyleDeclaration(t,e)||{},o={},n,s=0;s<this._styleProperties.length;s++)n=this._styleProperties[s],o[n]=typeof r[n]>"u"?this[n]:r[n];return o},_setStyleDeclaration:function(t,e,r){this.styles[t][e]=r},_deleteStyleDeclaration:function(t,e){delete this.styles[t][e]},_getLineStyle:function(t){return!!this.styles[t]},_setLineStyle:function(t){this.styles[t]={}},_deleteLineStyle:function(t){delete this.styles[t]}})})();(function(){function t(e){e.textDecoration&&(e.textDecoration.indexOf("underline")>-1&&(e.underline=!0),e.textDecoration.indexOf("line-through")>-1&&(e.linethrough=!0),e.textDecoration.indexOf("overline")>-1&&(e.overline=!0),delete e.textDecoration)}x.IText=x.util.createClass(x.Text,x.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(e,r){this.callSuper("initialize",e,r),this.initBehavior()},setSelectionStart:function(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)},setSelectionEnd:function(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)},_updateAndFire:function(e,r){this[e]!==r&&(this._fireSelectionChanged(),this[e]=r),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(e){this.clearContextTop(),this.callSuper("render",e),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(e){this.callSuper("_render",e)},clearContextTop:function(e){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var r=this.canvas.contextTop,o=this.canvas.viewportTransform;r.save(),r.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this.transform(r),this._clearTextArea(r),e||r.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var e=this._getCursorBoundaries(),r=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(e,r):this.renderSelection(e,r),r.restore()}},_clearTextArea:function(e){var r=this.width+4,o=this.height+4;e.clearRect(-r/2,-o/2,r,o)},_getCursorBoundaries:function(e){typeof e>"u"&&(e=this.selectionStart);var r=this._getLeftOffset(),o=this._getTopOffset(),n=this._getCursorBoundariesOffsets(e);return{left:r,top:o,leftOffset:n.left,topOffset:n.top}},_getCursorBoundariesOffsets:function(e){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var r,o,n,s=0,i=0,a,l=this.get2DCursorLocation(e);n=l.charIndex,o=l.lineIndex;for(var u=0;u<o;u++)s+=this.getHeightOfLine(u);r=this._getLineLeftOffset(o);var c=this.__charBounds[o][n];return c&&(i=c.left),this.charSpacing!==0&&n===this._textLines[o].length&&(i-=this._getWidthOfCharSpacing()),a={top:s,left:r+(i>0?i:0)},this.direction==="rtl"&&(a.left*=-1),this.cursorOffsetCache=a,this.cursorOffsetCache},renderCursor:function(e,r){var o=this.get2DCursorLocation(),n=o.lineIndex,s=o.charIndex>0?o.charIndex-1:0,i=this.getValueOfPropertyAt(n,s,"fontSize"),a=this.scaleX*this.canvas.getZoom(),l=this.cursorWidth/a,u=e.topOffset,c=this.getValueOfPropertyAt(n,s,"deltaY");u+=(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-i*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(e,r),r.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,s,"fill"),r.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,r.fillRect(e.left+e.leftOffset-l/2,u+e.top+c,l,i)},renderSelection:function(e,r){for(var o=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,n=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,s=this.textAlign.indexOf("justify")!==-1,i=this.get2DCursorLocation(o),a=this.get2DCursorLocation(n),l=i.lineIndex,u=a.lineIndex,c=i.charIndex<0?0:i.charIndex,h=a.charIndex<0?0:a.charIndex,d=l;d<=u;d++){var g=this._getLineLeftOffset(d)||0,m=this.getHeightOfLine(d),y=0,C=0,b=0;if(d===l&&(C=this.__charBounds[l][c].left),d>=l&&d<u)b=s&&!this.isEndOfWrapping(d)?this.width:this.getLineWidth(d)||5;else if(d===u)if(h===0)b=this.__charBounds[u][h].left;else{var k=this._getWidthOfCharSpacing();b=this.__charBounds[u][h-1].left+this.__charBounds[u][h-1].width-k}y=m,(this.lineHeight<1||d===u&&this.lineHeight>1)&&(m/=this.lineHeight);var L=e.left+g+C,N=b-C,M=m,W=0;this.inCompositionMode?(r.fillStyle=this.compositionColor||"black",M=1,W=m):r.fillStyle=this.selectionColor,this.direction==="rtl"&&(L=this.width-L-N),r.fillRect(L,e.top+e.topOffset+W,N,M),e.topOffset+=y}},getCurrentCharFontSize:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")},getCurrentCharColor:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fill")},_getCurrentCharIndex:function(){var e=this.get2DCursorLocation(this.selectionStart,!0),r=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:r}}}),x.IText.fromObject=function(e,r){var o=x.util.stylesFromArray(e.styles,e.text),n=Object.assign({},e,{styles:o});if(t(n),n.styles)for(var s in n.styles)for(var i in n.styles[s])t(n.styles[s][i]);x.Object._fromObject("IText",n,r,"text")}})();(function(){var t=x.util.object.clone;x.util.object.extend(x.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var e=this;this.on("added",function(){var r=e.canvas;r&&(r._hasITextHandlers||(r._hasITextHandlers=!0,e._initCanvasHandlers(r)),r._iTextInstances=r._iTextInstances||[],r._iTextInstances.push(e))})},initRemovedHandler:function(){var e=this;this.on("removed",function(){var r=e.canvas;r&&(r._iTextInstances=r._iTextInstances||[],x.util.removeFromArray(r._iTextInstances,e),r._iTextInstances.length===0&&(r._hasITextHandlers=!1,e._removeCanvasHandlers(r)))})},_initCanvasHandlers:function(e){e._mouseUpITextHandler=function(){e._iTextInstances&&e._iTextInstances.forEach(function(r){r.__isMousedown=!1})},e.on("mouse:up",e._mouseUpITextHandler)},_removeCanvasHandlers:function(e){e.off("mouse:up",e._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(e,r,o,n){var s;return s={isAborted:!1,abort:function(){this.isAborted=!0}},e.animate("_currentCursorOpacity",r,{duration:o,onComplete:function(){s.isAborted||e[n]()},onChange:function(){e.canvas&&e.selectionStart===e.selectionEnd&&e.renderCursorOrSelection()},abort:function(){return s.isAborted}}),s},_onTickComplete:function(){var e=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){e._currentTickCompleteState=e._animateCursor(e,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(e){var r=this,o=e?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){r._tick()},o)},abortCursorAnimation:function(){var e=this._currentTickState||this._currentTickCompleteState,r=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,e&&r&&r.clearContext(r.contextTop||r.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(e){var r=0,o=e-1;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)r++,o--;for(;/\S/.test(this._text[o])&&o>-1;)r++,o--;return e-r},findWordBoundaryRight:function(e){var r=0,o=e;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)r++,o++;for(;/\S/.test(this._text[o])&&o<this._text.length;)r++,o++;return e+r},findLineBoundaryLeft:function(e){for(var r=0,o=e-1;!/\n/.test(this._text[o])&&o>-1;)r++,o--;return e-r},findLineBoundaryRight:function(e){for(var r=0,o=e;!/\n/.test(this._text[o])&&o<this._text.length;)r++,o++;return e+r},searchWordBoundary:function(e,r){for(var o=this._text,n=this._reSpace.test(o[e])?e-1:e,s=o[n],i=x.reNonWord;!i.test(s)&&n>0&&n<o.length;)n+=r,s=o[n];return i.test(s)&&(n+=r===1?0:1),n},selectWord:function(e){e=e||this.selectionStart;var r=this.searchWordBoundary(e,-1),o=this.searchWordBoundary(e,1);this.selectionStart=r,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(e){e=e||this.selectionStart;var r=this.findLineBoundaryLeft(e),o=this.findLineBoundaryRight(e);return this.selectionStart=r,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(e){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(e),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(e){e._iTextInstances&&e._iTextInstances.forEach(function(r){r.selected=!1,r.isEditing&&r.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(e){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var r=this.getSelectionStartFromPointer(e.e),o=this.selectionStart,n=this.selectionEnd;(r!==this.__selectionStartOnMouseDown||o===n)&&(o===r||n===r)||(r>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=r):(this.selectionStart=r,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==o||this.selectionEnd!==n)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(e,r,o){var n=o.slice(0,e),s=x.util.string.graphemeSplit(n).length;if(e===r)return{selectionStart:s,selectionEnd:s};var i=o.slice(e,r),a=x.util.string.graphemeSplit(i).length;return{selectionStart:s,selectionEnd:s+a}},fromGraphemeToStringSelection:function(e,r,o){var n=o.slice(0,e),s=n.join("").length;if(e===r)return{selectionStart:s,selectionEnd:s};var i=o.slice(e,r),a=i.join("").length;return{selectionStart:s,selectionEnd:s+a}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var e=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=e.selectionEnd,this.inCompositionMode||(this.selectionStart=e.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var e=this.inCompositionMode?this.compositionStart:this.selectionStart,r=this._getCursorBoundaries(e),o=this.get2DCursorLocation(e),n=o.lineIndex,s=o.charIndex,i=this.getValueOfPropertyAt(n,s,"fontSize")*this.lineHeight,a=r.leftOffset,l=this.calcTransformMatrix(),u={x:r.left+a,y:r.top+r.topOffset+i},c=this.canvas.getRetinaScaling(),h=this.canvas.upperCanvasEl,d=h.width/c,g=h.height/c,m=d-i,y=g-i,C=h.clientWidth/d,b=h.clientHeight/g;return u=x.util.transformPoint(u,l),u=x.util.transformPoint(u,this.canvas.viewportTransform),u.x*=C,u.y*=b,u.x<0&&(u.x=0),u.x>m&&(u.x=m),u.y<0&&(u.y=0),u.y>y&&(u.y=y),u.x+=this.canvas._offset.left,u.y+=this.canvas._offset.top,{left:u.x+"px",top:u.y+"px",fontSize:i+"px",charHeight:i}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var e=this._textBeforeEdit!==this.text,r=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,r&&(r.blur&&r.blur(),r.parentNode&&r.parentNode.removeChild(r)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),e&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var e in this.styles)this._textLines[e]||delete this.styles[e]},removeStyleFromTo:function(e,r){var o=this.get2DCursorLocation(e,!0),n=this.get2DCursorLocation(r,!0),s=o.lineIndex,i=o.charIndex,a=n.lineIndex,l=n.charIndex,u,c;if(s!==a){if(this.styles[s])for(u=i;u<this._unwrappedTextLines[s].length;u++)delete this.styles[s][u];if(this.styles[a])for(u=l;u<this._unwrappedTextLines[a].length;u++)c=this.styles[a][u],c&&(this.styles[s]||(this.styles[s]={}),this.styles[s][i+u-l]=c);for(u=s+1;u<=a;u++)delete this.styles[u];this.shiftLineStyles(a,s-a)}else if(this.styles[s]){c=this.styles[s];var h=l-i,d,g;for(u=i;u<l;u++)delete c[u];for(g in this.styles[s])d=parseInt(g,10),d>=l&&(c[d-h]=c[g],delete c[g])}},shiftLineStyles:function(e,r){var o=t(this.styles);for(var n in this.styles){var s=parseInt(n,10);s>e&&(this.styles[s+r]=o[s],o[s-r]||delete this.styles[s])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(e,r,o,n){var s,i={},a=!1,l=this._unwrappedTextLines[e].length===r;o||(o=1),this.shiftLineStyles(e,o),this.styles[e]&&(s=this.styles[e][r===0?r:r-1]);for(var u in this.styles[e]){var c=parseInt(u,10);c>=r&&(a=!0,i[c-r]=this.styles[e][u],l&&r===0||delete this.styles[e][u])}var h=!1;for(a&&!l&&(this.styles[e+o]=i,h=!0),h&&o--;o>0;)n&&n[o-1]?this.styles[e+o]={0:t(n[o-1])}:s?this.styles[e+o]={0:t(s)}:delete this.styles[e+o],o--;this._forceClearCache=!0},insertCharStyleObject:function(e,r,o,n){this.styles||(this.styles={});var s=this.styles[e],i=s?t(s):{};o||(o=1);for(var a in i){var l=parseInt(a,10);l>=r&&(s[l+o]=i[l],i[l-o]||delete s[l])}if(this._forceClearCache=!0,n){for(;o--;)Object.keys(n[o]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][r+o]=t(n[o]));return}if(s)for(var u=s[r?r-1:1];u&&o--;)this.styles[e][r+o]=t(u)},insertNewStyleBlock:function(e,r,o){for(var n=this.get2DCursorLocation(r,!0),s=[0],i=0,a=0;a<e.length;a++)e[a]===`
`?(i++,s[i]=0):s[i]++;s[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,s[0],o),o=o&&o.slice(s[0]+1)),i&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+s[0],i);for(var a=1;a<i;a++)s[a]>0?this.insertCharStyleObject(n.lineIndex+a,0,s[a],o):o&&this.styles[n.lineIndex+a]&&o[0]&&(this.styles[n.lineIndex+a][0]=o[0]),o=o&&o.slice(s[a]+1);s[a]>0&&this.insertCharStyleObject(n.lineIndex+a,0,s[a],o)},setSelectionStartEndWithShift:function(e,r,o){o<=e?(r===e?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=e),this.selectionStart=o):o>e&&o<r?this._selectionDirection==="right"?this.selectionEnd=o:this.selectionStart=o:(r===e?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=r),this.selectionEnd=o)},setSelectionInBoundaries:function(){var e=this.text.length;this.selectionStart>e?this.selectionStart=e:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>e?this.selectionEnd=e:this.selectionEnd<0&&(this.selectionEnd=0)}})})();x.util.object.extend(x.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(t){if(this.canvas){this.__newClickTime=+new Date;var e=t.pointer;this.isTripleClick(e)&&(this.fire("tripleclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(t){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(t.e))},tripleClickHandler:function(t){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(t.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(t){!this.canvas||!this.editable||t.e.button&&t.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(t){!this.canvas||!this.editable||t.e.button&&t.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(t){if(this.__isMousedown=!1,!(!this.editable||this.group||t.transform&&t.transform.actionPerformed||t.e.button&&t.e.button!==1)){if(this.canvas){var e=this.canvas._activeObject;if(e&&e!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t),r=this.selectionStart,o=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(r,o,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(t){for(var e=this.getLocalPointer(t),r=0,o=0,n=0,s=0,i=0,a,l,u=0,c=this._textLines.length;u<c&&n<=e.y;u++)n+=this.getHeightOfLine(u)*this.scaleY,i=u,u>0&&(s+=this._textLines[u-1].length+this.missingNewlineOffset(u-1));a=this._getLineLeftOffset(i),o=a*this.scaleX,l=this._textLines[i],this.direction==="rtl"&&(e.x=this.width*this.scaleX-e.x+o);for(var h=0,d=l.length;h<d&&(r=o,o+=this.__charBounds[i][h].kernedWidth*this.scaleX,o<=e.x);h++)s++;return this._getNewSelectionStartFromOffset(e,r,o,s,d)},_getNewSelectionStartFromOffset:function(t,e,r,o,n){var s=t.x-e,i=r-t.x,a=i>s||i<0?0:1,l=o+a;return this.flipX&&(l=n-l),l>this._text.length&&(l=this._text.length),l}});x.util.object.extend(x.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=x.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var t=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+t.top+"; left: "+t.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uFF70top: "+t.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):x.document.body.appendChild(this.hiddenTextarea),x.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),x.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),x.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),x.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),x.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),x.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),x.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),x.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),x.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(x.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing){var e=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else if(t.keyCode in this.ctrlKeysMapDown&&(t.ctrlKey||t.metaKey))this[this.ctrlKeysMapDown[t.keyCode]](t);else return;t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(t){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey))this[this.ctrlKeysMapUp[t.keyCode]](t);else return;t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(t){var e=this.fromPaste;if(this.fromPaste=!1,t&&t.stopPropagation(),!!this.isEditing){var r=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,o=this._text.length,n=r.length,s,i,a=n-o,l=this.selectionStart,u=this.selectionEnd,c=l!==u,h,d,g;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var m=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),y=l>m.selectionStart;c?(s=this._text.slice(l,u),a+=u-l):n<o&&(y?s=this._text.slice(u+a,u):s=this._text.slice(l,l-a)),i=r.slice(m.selectionEnd-a,m.selectionEnd),s&&s.length&&(i.length&&(h=this.getSelectionStyles(l,l+1,!1),h=i.map(function(){return h[0]})),c?(d=l,g=u):y?(d=u-s.length,g=u):(d=u,g=u+s.length),this.removeStyleFromTo(d,g)),i.length&&(e&&i.join("")===x.copiedText&&!x.disableStyleCopyPaste&&(h=x.copiedTextStyle),this.insertNewStyleBlock(i,l,h)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(t){this.compositionStart=t.target.selectionStart,this.compositionEnd=t.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(x.copiedText=this.getSelectedText(),x.disableStyleCopyPaste?x.copiedTextStyle=null:x.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(t){return t&&t.clipboardData||x.window.clipboardData},_getWidthBeforeCursor:function(t,e){var r=this._getLineLeftOffset(t),o;return e>0&&(o=this.__charBounds[t][e-1],r+=o.left+o.width),r},getDownCursorOffset:function(t,e){var r=this._getSelectionForOffset(t,e),o=this.get2DCursorLocation(r),n=o.lineIndex;if(n===this._textLines.length-1||t.metaKey||t.keyCode===34)return this._text.length-r;var s=o.charIndex,i=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n+1,i),l=this._textLines[n].slice(s);return l.length+a+1+this.missingNewlineOffset(n)},_getSelectionForOffset:function(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(t,e){var r=this._getSelectionForOffset(t,e),o=this.get2DCursorLocation(r),n=o.lineIndex;if(n===0||t.metaKey||t.keyCode===33)return-r;var s=o.charIndex,i=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n-1,i),l=this._textLines[n].slice(0,s),u=this.missingNewlineOffset(n-1);return-this._textLines[n-1].length+a-l.length+(1-u)},_getIndexOnLine:function(t,e){for(var r=this._textLines[t],o=this._getLineLeftOffset(t),n=o,s=0,i,a,l=0,u=r.length;l<u;l++)if(i=this.__charBounds[t][l].width,n+=i,n>e){a=!0;var c=n-i,h=n,d=Math.abs(c-e),g=Math.abs(h-e);s=g<d?l:l-1;break}return a||(s=r.length-1),s},moveCursorDown:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)},moveCursorUp:function(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",t)},_moveCursorUpOrDown:function(t,e){var r="get"+t+"CursorOffset",o=this[r](e,this._selectionDirection==="right");e.shiftKey?this.moveCursorWithShift(o):this.moveCursorWithoutShift(o),o!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(t){var e=this._selectionDirection==="left"?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),t!==0},moveCursorWithoutShift:function(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),t!==0},moveCursorLeft:function(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",t)},_move:function(t,e,r){var o;if(t.altKey)o=this["findWordBoundary"+r](this[e]);else if(t.metaKey||t.keyCode===35||t.keyCode===36)o=this["findLineBoundary"+r](this[e]);else return this[e]+=r==="Left"?-1:1,!0;if(typeof o<"u"&&this[e]!==o)return this[e]=o,!0},_moveLeft:function(t,e){return this._move(t,e,"Left")},_moveRight:function(t,e){return this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(t){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(t,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(t,"selectionStart")},moveCursorRight:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)},_moveCursorLeftOrRight:function(t,e){var r="moveCursor"+t+"With";this._currentCursorOpacity=1,e.shiftKey?r+="Shift":r+="outShift",this[r](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(t){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(t,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(t,"selectionEnd")},moveCursorRightWithoutShift:function(t){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(t,e){typeof e>"u"&&(e=t+1),this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(t,e,r,o){typeof o>"u"&&(o=r),o>r&&this.removeStyleFromTo(r,o);var n=x.util.string.graphemeSplit(t);this.insertNewStyleBlock(n,r,e),this._text=[].concat(this._text.slice(0,r),n,this._text.slice(o)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}});(function(){var t=x.util.toFixed,e=/  +/g;x.util.object.extend(x.Text.prototype,{_toSVG:function(){var r=this._getSVGLeftTopOffsets(),o=this._getSVGTextAndBg(r.textTop,r.textLeft);return this._wrapSVGTextAndBg(o)},toSVG:function(r){return this._createBaseSVGMarkup(this._toSVG(),{reviver:r,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(r){var o=!0,n=this.getSvgTextDecoration(this);return[r.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",n?'text-decoration="'+n+'" ':"",'style="',this.getSvgStyles(o),'"',this.addPaintOrder()," >",r.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(r,o){var n=[],s=[],i=r,a;this._setSVGBg(s);for(var l=0,u=this._textLines.length;l<u;l++)a=this._getLineLeftOffset(l),(this.textBackgroundColor||this.styleHas("textBackgroundColor",l))&&this._setSVGTextLineBg(s,l,o+a,i),this._setSVGTextLineText(n,l,o+a,i),i+=this.getHeightOfLine(l);return{textSpans:n,textBgRects:s}},_createTextCharSpan:function(r,o,n,s){var i=r!==r.trim()||r.match(e),a=this.getSvgSpanStyles(o,i),l=a?'style="'+a+'"':"",u=o.deltaY,c="",h=x.Object.NUM_FRACTION_DIGITS;return u&&(c=' dy="'+t(u,h)+'" '),['<tspan x="',t(n,h),'" y="',t(s,h),'" ',c,l,">",x.util.string.escapeXml(r),"</tspan>"].join("")},_setSVGTextLineText:function(r,o,n,s){var i=this.getHeightOfLine(o),a=this.textAlign.indexOf("justify")!==-1,l,u,c="",h,d,g=0,m=this._textLines[o],y;s+=i*(1-this._fontSizeFraction)/this.lineHeight;for(var C=0,b=m.length-1;C<=b;C++)y=C===b||this.charSpacing,c+=m[C],h=this.__charBounds[o][C],g===0?(n+=h.kernedWidth-h.width,g+=h.width):g+=h.kernedWidth,a&&!y&&this._reSpaceAndTab.test(m[C])&&(y=!0),y||(l=l||this.getCompleteStyleDeclaration(o,C),u=this.getCompleteStyleDeclaration(o,C+1),y=x.util.hasStyleChanged(l,u,!0)),y&&(d=this._getStyleDeclaration(o,C)||{},r.push(this._createTextCharSpan(c,d,n,s)),c="",l=u,n+=g,g=0)},_pushTextBgRect:function(r,o,n,s,i,a){var l=x.Object.NUM_FRACTION_DIGITS;r.push("		<rect ",this._getFillAttributes(o),' x="',t(n,l),'" y="',t(s,l),'" width="',t(i,l),'" height="',t(a,l),`"></rect>
`)},_setSVGTextLineBg:function(r,o,n,s){for(var i=this._textLines[o],a=this.getHeightOfLine(o)/this.lineHeight,l=0,u=0,c,h,d=this.getValueOfPropertyAt(o,0,"textBackgroundColor"),g=0,m=i.length;g<m;g++)c=this.__charBounds[o][g],h=this.getValueOfPropertyAt(o,g,"textBackgroundColor"),h!==d?(d&&this._pushTextBgRect(r,d,n+u,s,l,a),u=c.left,l=c.width,d=h):l+=c.kernedWidth;h&&this._pushTextBgRect(r,h,n+u,s,l,a)},_getFillAttributes:function(r){var o=r&&typeof r=="string"?new x.Color(r):"";return!o||!o.getSource()||o.getAlpha()===1?'fill="'+r+'"':'opacity="'+o.getAlpha()+'" fill="'+o.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(r){for(var o=0,n=0,s=0;s<r;s++)o+=this.getHeightOfLine(s);return n=this.getHeightOfLine(s),{lineTop:o,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(r){var o=x.Object.prototype.getSvgStyles.call(this,r);return o+" white-space: pre;"}})})();(function(t){"use strict";var e=t.fabric||(t.fabric={});e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:e.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(r){for(var o=0,n=0,s=0,i={},a=0;a<r.graphemeLines.length;a++)r.graphemeText[s]===`
`&&a>0?(n=0,s++,o++):!this.splitByGrapheme&&this._reSpaceAndTab.test(r.graphemeText[s])&&a>0&&(n++,s++),i[a]={line:o,offset:n},s+=r.graphemeLines[a].length,n+=r.graphemeLines[a].length;return i},styleHas:function(r,o){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[o];n&&(o=n.line)}return e.Text.prototype.styleHas.call(this,r,o)},isEmptyStyles:function(r){if(!this.styles)return!0;var o=0,n=r+1,s,i,a=!1,l=this._styleMap[r],u=this._styleMap[r+1];l&&(r=l.line,o=l.offset),u&&(n=u.line,a=n===r,s=u.offset),i=typeof r>"u"?this.styles:{line:this.styles[r]};for(var c in i)for(var h in i[c])if(h>=o&&(!a||h<s))for(var d in i[c][h])return!1;return!0},_getStyleDeclaration:function(r,o){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[r];if(!n)return null;r=n.line,o=n.offset+o}return this.callSuper("_getStyleDeclaration",r,o)},_setStyleDeclaration:function(r,o,n){var s=this._styleMap[r];r=s.line,o=s.offset+o,this.styles[r][o]=n},_deleteStyleDeclaration:function(r,o){var n=this._styleMap[r];r=n.line,o=n.offset+o,delete this.styles[r][o]},_getLineStyle:function(r){var o=this._styleMap[r];return!!this.styles[o.line]},_setLineStyle:function(r){var o=this._styleMap[r];this.styles[o.line]={}},_wrapText:function(r,o){var n=[],s;for(this.isWrapping=!0,s=0;s<r.length;s++)n=n.concat(this._wrapLine(r[s],s,o));return this.isWrapping=!1,n},_measureWord:function(r,o,n){var s=0,i,a=!0;n=n||0;for(var l=0,u=r.length;l<u;l++){var c=this._getGraphemeBox(r[l],o,l+n,i,a);s+=c.kernedWidth,i=r[l]}return s},_wrapLine:function(r,o,n,L){var i=0,a=this.splitByGrapheme,l=[],u=[],c=a?e.util.string.graphemeSplit(r):r.split(this._wordJoiners),h="",d=0,g=a?"":" ",m=0,y=0,C=0,b=!0,k=this._getWidthOfCharSpacing(),L=L||0;c.length===0&&c.push([]),n-=L;for(var N=0;N<c.length;N++)h=a?c[N]:e.util.string.graphemeSplit(c[N]),m=this._measureWord(h,o,d),d+=h.length,i+=y+m-k,i>n&&!b?(l.push(u),u=[],i=m,b=!0):i+=k,!b&&!a&&u.push(g),u=u.concat(h),y=a?0:this._measureWord([g],o,d),d++,b=!1,m>C&&(C=m);return N&&l.push(u),C+L>this.dynamicMinWidth&&(this.dynamicMinWidth=C-k+L),l},isEndOfWrapping:function(r){return!this._styleMap[r+1]||this._styleMap[r+1].line!==this._styleMap[r].line},missingNewlineOffset:function(r){return this.splitByGrapheme?this.isEndOfWrapping(r)?1:0:1},_splitTextIntoLines:function(r){for(var o=e.Text.prototype._splitTextIntoLines.call(this,r),n=this._wrapText(o.lines,this.width),s=new Array(n.length),i=0;i<n.length;i++)s[i]=n[i].join("");return o.lines=s,o.graphemeLines=n,o},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var r={};for(var o in this._styleMap)this._textLines[o]&&(r[this._styleMap[o].line]=1);for(var o in this.styles)r[o]||delete this.styles[o]},toObject:function(r){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(r))}}),e.Textbox.fromObject=function(r,o){var n=e.util.stylesFromArray(r.styles,r.text),s=Object.assign({},r,{styles:n});return e.Object._fromObject("Textbox",s,o,"text")}})(Ce);(function(){var t=x.controlsUtils,e=t.scaleSkewCursorStyleHandler,r=t.scaleCursorStyleHandler,o=t.scalingEqually,n=t.scalingYOrSkewingX,s=t.scalingXOrSkewingY,i=t.scaleOrSkewActionName,a=x.Object.prototype.controls;if(a.ml=new x.Control({x:-.5,y:0,cursorStyleHandler:e,actionHandler:s,getActionName:i}),a.mr=new x.Control({x:.5,y:0,cursorStyleHandler:e,actionHandler:s,getActionName:i}),a.mb=new x.Control({x:0,y:.5,cursorStyleHandler:e,actionHandler:n,getActionName:i}),a.mt=new x.Control({x:0,y:-.5,cursorStyleHandler:e,actionHandler:n,getActionName:i}),a.tl=new x.Control({x:-.5,y:-.5,cursorStyleHandler:r,actionHandler:o}),a.tr=new x.Control({x:.5,y:-.5,cursorStyleHandler:r,actionHandler:o}),a.bl=new x.Control({x:-.5,y:.5,cursorStyleHandler:r,actionHandler:o}),a.br=new x.Control({x:.5,y:.5,cursorStyleHandler:r,actionHandler:o}),a.mtr=new x.Control({x:0,y:-.5,actionHandler:t.rotationWithSnapping,cursorStyleHandler:t.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),x.Textbox){var l=x.Textbox.prototype.controls={};l.mtr=a.mtr,l.tr=a.tr,l.br=a.br,l.tl=a.tl,l.bl=a.bl,l.mt=a.mt,l.mb=a.mb,l.mr=new x.Control({x:.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"}),l.ml=new x.Control({x:-.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"})}})()});var tp=tt((WP,p1)=>{"use strict";var d1=Object.getOwnPropertySymbols,rA=Object.prototype.hasOwnProperty,nA=Object.prototype.propertyIsEnumerable;function iA(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function sA(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;var o=Object.getOwnPropertyNames(e).map(function(s){return e[s]});if(o.join("")!=="0123456789")return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(s){n[s]=s}),Object.keys(Object.assign({},n)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}p1.exports=sA()?Object.assign:function(t,e){for(var r,o=iA(t),n,s=1;s<arguments.length;s++){r=Object(arguments[s]);for(var i in r)rA.call(r,i)&&(o[i]=r[i]);if(d1){n=d1(r);for(var a=0;a<n.length;a++)nA.call(r,n[a])&&(o[n[a]]=r[n[a]])}}return o}});var O1=tt(_t=>{"use strict";var np=tp(),Ua=60103,v1=60106;_t.Fragment=60107;_t.StrictMode=60108;_t.Profiler=60114;var y1=60109,C1=60110,_1=60112;_t.Suspense=60113;var w1=60115,S1=60116;typeof Symbol=="function"&&Symbol.for&&(Hn=Symbol.for,Ua=Hn("react.element"),v1=Hn("react.portal"),_t.Fragment=Hn("react.fragment"),_t.StrictMode=Hn("react.strict_mode"),_t.Profiler=Hn("react.profiler"),y1=Hn("react.provider"),C1=Hn("react.context"),_1=Hn("react.forward_ref"),_t.Suspense=Hn("react.suspense"),w1=Hn("react.memo"),S1=Hn("react.lazy"));var Hn,g1=typeof Symbol=="function"&&Symbol.iterator;function oA(t){return t===null||typeof t!="object"?null:(t=g1&&t[g1]||t["@@iterator"],typeof t=="function"?t:null)}function al(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var b1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x1={};function za(t,e,r){this.props=t,this.context=e,this.refs=x1,this.updater=r||b1}za.prototype.isReactComponent={};za.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error(al(85));this.updater.enqueueSetState(this,t,e,"setState")};za.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function D1(){}D1.prototype=za.prototype;function ip(t,e,r){this.props=t,this.context=e,this.refs=x1,this.updater=r||b1}var sp=ip.prototype=new D1;sp.constructor=ip;np(sp,za.prototype);sp.isPureReactComponent=!0;var op={current:null},E1=Object.prototype.hasOwnProperty,A1={key:!0,ref:!0,__self:!0,__source:!0};function T1(t,e,r){var o,n={},s=null,i=null;if(e!=null)for(o in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(s=""+e.key),e)E1.call(e,o)&&!A1.hasOwnProperty(o)&&(n[o]=e[o]);var a=arguments.length-2;if(a===1)n.children=r;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];n.children=l}if(t&&t.defaultProps)for(o in a=t.defaultProps,a)n[o]===void 0&&(n[o]=a[o]);return{$$typeof:Ua,type:t,key:s,ref:i,props:n,_owner:op.current}}function aA(t,e){return{$$typeof:Ua,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ap(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ua}function uA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var m1=/\/+/g;function rp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?uA(""+t.key):e.toString(36)}function ah(t,e,r,o,n){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Ua:case v1:i=!0}}if(i)return i=t,n=n(i),t=o===""?"."+rp(i,0):o,Array.isArray(n)?(r="",t!=null&&(r=t.replace(m1,"$&/")+"/"),ah(n,e,r,"",function(u){return u})):n!=null&&(ap(n)&&(n=aA(n,r+(!n.key||i&&i.key===n.key?"":(""+n.key).replace(m1,"$&/")+"/")+t)),e.push(n)),1;if(i=0,o=o===""?".":o+":",Array.isArray(t))for(var a=0;a<t.length;a++){s=t[a];var l=o+rp(s,a);i+=ah(s,e,r,l,n)}else if(l=oA(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=o+rp(s,a++),i+=ah(s,e,r,l,n);else if(s==="object")throw e=""+t,Error(al(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e));return i}function oh(t,e,r){if(t==null)return t;var o=[],n=0;return ah(t,o,"","",function(s){return e.call(r,s,n++)}),o}function lA(t){if(t._status===-1){var e=t._result;e=e(),t._status=0,t._result=e,e.then(function(r){t._status===0&&(r=r.default,t._status=1,t._result=r)},function(r){t._status===0&&(t._status=2,t._result=r)})}if(t._status===1)return t._result;throw t._result}var F1={current:null};function cs(){var t=F1.current;if(t===null)throw Error(al(321));return t}var cA={ReactCurrentDispatcher:F1,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:op,IsSomeRendererActing:{current:!1},assign:np};_t.Children={map:oh,forEach:function(t,e,r){oh(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return oh(t,function(){e++}),e},toArray:function(t){return oh(t,function(e){return e})||[]},only:function(t){if(!ap(t))throw Error(al(143));return t}};_t.Component=za;_t.PureComponent=ip;_t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cA;_t.cloneElement=function(t,e,r){if(t==null)throw Error(al(267,t));var o=np({},t.props),n=t.key,s=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,i=op.current),e.key!==void 0&&(n=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)E1.call(e,l)&&!A1.hasOwnProperty(l)&&(o[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)o.children=r;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];o.children=a}return{$$typeof:Ua,type:t.type,key:n,ref:s,props:o,_owner:i}};_t.createContext=function(t,e){return e===void 0&&(e=null),t={$$typeof:C1,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider={$$typeof:y1,_context:t},t.Consumer=t};_t.createElement=T1;_t.createFactory=function(t){var e=T1.bind(null,t);return e.type=t,e};_t.createRef=function(){return{current:null}};_t.forwardRef=function(t){return{$$typeof:_1,render:t}};_t.isValidElement=ap;_t.lazy=function(t){return{$$typeof:S1,_payload:{_status:-1,_result:t},_init:lA}};_t.memo=function(t,e){return{$$typeof:w1,type:t,compare:e===void 0?null:e}};_t.useCallback=function(t,e){return cs().useCallback(t,e)};_t.useContext=function(t,e){return cs().useContext(t,e)};_t.useDebugValue=function(){};_t.useEffect=function(t,e){return cs().useEffect(t,e)};_t.useImperativeHandle=function(t,e,r){return cs().useImperativeHandle(t,e,r)};_t.useLayoutEffect=function(t,e){return cs().useLayoutEffect(t,e)};_t.useMemo=function(t,e){return cs().useMemo(t,e)};_t.useReducer=function(t,e,r){return cs().useReducer(t,e,r)};_t.useRef=function(t){return cs().useRef(t)};_t.useState=function(t){return cs().useState(t)};_t.version="17.0.2"});var Go=tt((HP,k1)=>{"use strict";k1.exports=O1()});var uh=tt((Wa,ul)=>{(function(){var t,e="4.17.21",r=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",n="Expected a function",s="Invalid `variable` option passed into `_.template`",i="__lodash_hash_undefined__",a=500,l="__lodash_placeholder__",u=1,c=2,h=4,d=1,g=2,m=1,y=2,C=4,b=8,k=16,L=32,N=64,M=128,W=256,Y=512,J=30,oe="...",pe=800,le=16,w=1,F=2,P=3,I=1/0,H=9007199254740991,S=17976931348623157e292,_=NaN,O=4294967295,j=O-1,V=O>>>1,z=[["ary",M],["bind",m],["bindKey",y],["curry",b],["curryRight",k],["flip",Y],["partial",L],["partialRight",N],["rearg",W]],X="[object Arguments]",q="[object Array]",ae="[object AsyncFunction]",$="[object Boolean]",U="[object Date]",te="[object DOMException]",ee="[object Error]",Q="[object Function]",ne="[object GeneratorFunction]",ce="[object Map]",Ee="[object Number]",we="[object Null]",re="[object Object]",ye="[object Promise]",Te="[object Proxy]",Be="[object RegExp]",Ue="[object Set]",Me="[object String]",at="[object Symbol]",Qe="[object Undefined]",Lt="[object WeakMap]",Zt="[object WeakSet]",wt="[object ArrayBuffer]",Zr="[object DataView]",vn="[object Float32Array]",Pn="[object Float64Array]",Dr="[object Int8Array]",Ci="[object Int16Array]",ke="[object Int32Array]",Ne="[object Uint8Array]",Xe="[object Uint8ClampedArray]",ct="[object Uint16Array]",Nt="[object Uint32Array]",ar=/\b__p \+= '';/g,er=/\b(__p \+=) '' \+/g,Ni=/(__e\(.*?\)|\b__t\)) \+\n'';/g,_i=/&(?:amp|lt|gt|quot|#39);/g,mo=/[&<>"']/g,Fu=RegExp(_i.source),Ou=RegExp(mo.source),ku=/<%-([\s\S]+?)%>/g,Cs=/<%([\s\S]+?)%>/g,Ui=/<%=([\s\S]+?)%>/g,ei=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,da=/^\w*$/,Pu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ti=/[\\^$.*+?()[\]{}|]/g,vo=RegExp(ti.source),Yt=/^\s+/,_s=/\s/,zi=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,yo=/\{\n\/\* \[wrapped with (.+)\] \*/,Iu=/,? & /,pa=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Bu=/[()=,{}\[\]\/\s]/,ga=/\\(\\)?/g,Co=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Er=/\w*$/,In=/^[-+]0x[0-9a-f]+$/i,Vt=/^0b[01]+$/i,ws=/^\[object .+?Constructor\]$/,Wi=/^0o[0-7]+$/i,St=/^(?:0|[1-9]\d*)$/,Lu=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ss=/($^)/,ma=/['\n\r\u2028\u2029\\]/g,yn="\\ud800-\\udfff",_o="\\u0300-\\u036f",bs="\\ufe20-\\ufe2f",Wt="\\u20d0-\\u20ff",xs=_o+bs+Wt,Gt="\\u2700-\\u27bf",wo="a-z\\xdf-\\xf6\\xf8-\\xff",Mt="\\xac\\xb1\\xd7\\xf7",Gi="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",So="\\u2000-\\u206f",va=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ds="A-Z\\xc0-\\xd6\\xd8-\\xde",bo="\\ufe0e\\ufe0f",Hi=Mt+Gi+So+va,Bn="['\u2019]",xo="["+yn+"]",Cn="["+Hi+"]",_n="["+xs+"]",Es="\\d+",wi="["+Gt+"]",Xi="["+wo+"]",Yi="[^"+yn+Hi+Es+Gt+wo+Ds+"]",As="\\ud83c[\\udffb-\\udfff]",ri="(?:"+_n+"|"+As+")",Vi="[^"+yn+"]",qi="(?:\\ud83c[\\udde6-\\uddff]){2}",ni="[\\ud800-\\udbff][\\udc00-\\udfff]",jr="["+Ds+"]",ii="\\u200d",si="(?:"+Xi+"|"+Yi+")",Si="(?:"+jr+"|"+Yi+")",Do="(?:"+Bn+"(?:d|ll|m|re|s|t|ve))?",Ts="(?:"+Bn+"(?:D|LL|M|RE|S|T|VE))?",Eo=ri+"?",$i="["+bo+"]?",Fs="(?:"+ii+"(?:"+[Vi,qi,ni].join("|")+")"+$i+Eo+")*",wn="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",bi="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ln=$i+Eo+Fs,Os="(?:"+[wi,qi,ni].join("|")+")"+Ln,Mu="(?:"+[Vi+_n+"?",_n,qi,ni,xo].join("|")+")",Ru=RegExp(Bn,"g"),ks=RegExp(_n,"g"),Mn=RegExp(As+"(?="+As+")|"+Mu+Ln,"g"),ya=RegExp([jr+"?"+Xi+"+"+Do+"(?="+[Cn,jr,"$"].join("|")+")",Si+"+"+Ts+"(?="+[Cn,jr+si,"$"].join("|")+")",jr+"?"+si+"+"+Do,jr+"+"+Ts,bi,wn,Es,Os].join("|"),"g"),ju=RegExp("["+ii+yn+xs+bo+"]"),Ca=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Rn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ki=-1,xt={};xt[vn]=xt[Pn]=xt[Dr]=xt[Ci]=xt[ke]=xt[Ne]=xt[Xe]=xt[ct]=xt[Nt]=!0,xt[X]=xt[q]=xt[wt]=xt[$]=xt[Zr]=xt[U]=xt[ee]=xt[Q]=xt[ce]=xt[Ee]=xt[re]=xt[Be]=xt[Ue]=xt[Me]=xt[Lt]=!1;var gt={};gt[X]=gt[q]=gt[wt]=gt[Zr]=gt[$]=gt[U]=gt[vn]=gt[Pn]=gt[Dr]=gt[Ci]=gt[ke]=gt[ce]=gt[Ee]=gt[re]=gt[Be]=gt[Ue]=gt[Me]=gt[at]=gt[Ne]=gt[Xe]=gt[ct]=gt[Nt]=!0,gt[ee]=gt[Q]=gt[Lt]=!1;var oi={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Ao={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Nu={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},tr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ps=parseFloat,_a=parseInt,To=typeof global=="object"&&global&&global.Object===Object&&global,Fo=typeof self=="object"&&self&&self.Object===Object&&self,Ot=To||Fo||Function("return this")(),Nr=typeof Wa=="object"&&Wa&&!Wa.nodeType&&Wa,jn=Nr&&typeof ul=="object"&&ul&&!ul.nodeType&&ul,Is=jn&&jn.exports===Nr,xi=Is&&To.process,mr=function(){try{var he=jn&&jn.require&&jn.require("util").types;return he||xi&&xi.binding&&xi.binding("util")}catch{}}(),wa=mr&&mr.isArrayBuffer,se=mr&&mr.isDate,Oe=mr&&mr.isMap,Fe=mr&&mr.isRegExp,Je=mr&&mr.isSet,Pt=mr&&mr.isTypedArray;function yt(he,Se,me){switch(me.length){case 0:return he.call(Se);case 1:return he.call(Se,me[0]);case 2:return he.call(Se,me[0],me[1]);case 3:return he.call(Se,me[0],me[1],me[2])}return he.apply(Se,me)}function sr(he,Se,me,Le){for(var et=-1,Ct=he==null?0:he.length;++et<Ct;){var qt=he[et];Se(Le,qt,me(qt),he)}return Le}function or(he,Se){for(var me=-1,Le=he==null?0:he.length;++me<Le&&Se(he[me],me,he)!==!1;);return he}function en(he,Se){for(var me=he==null?0:he.length;me--&&Se(he[me],me,he)!==!1;);return he}function tn(he,Se){for(var me=-1,Le=he==null?0:he.length;++me<Le;)if(!Se(he[me],me,he))return!1;return!0}function It(he,Se){for(var me=-1,Le=he==null?0:he.length,et=0,Ct=[];++me<Le;){var qt=he[me];Se(qt,me,he)&&(Ct[et++]=qt)}return Ct}function Ji(he,Se){var me=he==null?0:he.length;return!!me&&rn(he,Se,0)>-1}function Oo(he,Se,me){for(var Le=-1,et=he==null?0:he.length;++Le<et;)if(me(Se,he[Le]))return!0;return!1}function kt(he,Se){for(var me=-1,Le=he==null?0:he.length,et=Array(Le);++me<Le;)et[me]=Se(he[me],me,he);return et}function ai(he,Se){for(var me=-1,Le=Se.length,et=he.length;++me<Le;)he[et+me]=Se[me];return he}function Sa(he,Se,me,Le){var et=-1,Ct=he==null?0:he.length;for(Le&&Ct&&(me=he[++et]);++et<Ct;)me=Se(me,he[et],et,he);return me}function Sc(he,Se,me,Le){var et=he==null?0:he.length;for(Le&&et&&(me=he[--et]);et--;)me=Se(me,he[et],et,he);return me}function ba(he,Se){for(var me=-1,Le=he==null?0:he.length;++me<Le;)if(Se(he[me],me,he))return!0;return!1}var Uf=Bs("length");function zf(he){return he.split("")}function Wf(he){return he.match(pa)||[]}function bc(he,Se,me){var Le;return me(he,function(et,Ct,qt){if(Se(et,Ct,qt))return Le=Ct,!1}),Le}function xa(he,Se,me,Le){for(var et=he.length,Ct=me+(Le?1:-1);Le?Ct--:++Ct<et;)if(Se(he[Ct],Ct,he))return Ct;return-1}function rn(he,Se,me){return Se===Se?qf(he,Se,me):xa(he,Uu,me)}function xc(he,Se,me,Le){for(var et=me-1,Ct=he.length;++et<Ct;)if(Le(he[et],Se))return et;return-1}function Uu(he){return he!==he}function zu(he,Se){var me=he==null?0:he.length;return me?Wu(he,Se)/me:_}function Bs(he){return function(Se){return Se==null?t:Se[he]}}function Da(he){return function(Se){return he==null?t:he[Se]}}function Dc(he,Se,me,Le,et){return et(he,function(Ct,qt,Tt){me=Le?(Le=!1,Ct):Se(me,Ct,qt,Tt)}),me}function Ec(he,Se){var me=he.length;for(he.sort(Se);me--;)he[me]=he[me].value;return he}function Wu(he,Se){for(var me,Le=-1,et=he.length;++Le<et;){var Ct=Se(he[Le]);Ct!==t&&(me=me===t?Ct:me+Ct)}return me}function Ea(he,Se){for(var me=-1,Le=Array(he);++me<he;)Le[me]=Se(me);return Le}function Gf(he,Se){return kt(Se,function(me){return[me,he[me]]})}function Gu(he){return he&&he.slice(0,Pc(he)+1).replace(Yt,"")}function Ur(he){return function(Se){return he(Se)}}function ko(he,Se){return kt(Se,function(me){return he[me]})}function Po(he,Se){return he.has(Se)}function Ac(he,Se){for(var me=-1,Le=he.length;++me<Le&&rn(Se,he[me],0)>-1;);return me}function Aa(he,Se){for(var me=he.length;me--&&rn(Se,he[me],0)>-1;);return me}function Hu(he,Se){for(var me=he.length,Le=0;me--;)he[me]===Se&&++Le;return Le}var Hf=Da(oi),Xf=Da(Ao);function Yf(he){return"\\"+tr[he]}function Vf(he,Se){return he==null?t:he[Se]}function Ls(he){return ju.test(he)}function Tc(he){return Ca.test(he)}function Fc(he){for(var Se,me=[];!(Se=he.next()).done;)me.push(Se.value);return me}function Xu(he){var Se=-1,me=Array(he.size);return he.forEach(function(Le,et){me[++Se]=[et,Le]}),me}function Oc(he,Se){return function(me){return he(Se(me))}}function ui(he,Se){for(var me=-1,Le=he.length,et=0,Ct=[];++me<Le;){var qt=he[me];(qt===Se||qt===l)&&(he[me]=l,Ct[et++]=me)}return Ct}function Qi(he){var Se=-1,me=Array(he.size);return he.forEach(function(Le){me[++Se]=Le}),me}function kc(he){var Se=-1,me=Array(he.size);return he.forEach(function(Le){me[++Se]=[Le,Le]}),me}function qf(he,Se,me){for(var Le=me-1,et=he.length;++Le<et;)if(he[Le]===Se)return Le;return-1}function $f(he,Se,me){for(var Le=me+1;Le--;)if(he[Le]===Se)return Le;return Le}function Ms(he){return Ls(he)?Jf(he):Uf(he)}function Sn(he){return Ls(he)?Qf(he):zf(he)}function Pc(he){for(var Se=he.length;Se--&&_s.test(he.charAt(Se)););return Se}var Kf=Da(Nu);function Jf(he){for(var Se=Mn.lastIndex=0;Mn.test(he);)++Se;return Se}function Qf(he){return he.match(Mn)||[]}function Zf(he){return he.match(ya)||[]}var ed=function he(Se){Se=Se==null?Ot:Di.defaults(Ot.Object(),Se,Di.pick(Ot,Rn));var me=Se.Array,Le=Se.Date,et=Se.Error,Ct=Se.Function,qt=Se.Math,Tt=Se.Object,Yu=Se.RegExp,Ic=Se.String,ur=Se.TypeError,Io=me.prototype,Ta=Ct.prototype,Zi=Tt.prototype,Fa=Se["__core-js_shared__"],Bo=Ta.toString,bt=Zi.hasOwnProperty,td=0,Bc=function(){var f=/[^.]+$/.exec(Fa&&Fa.keys&&Fa.keys.IE_PROTO||"");return f?"Symbol(src)_1."+f:""}(),Oa=Zi.toString,rd=Bo.call(Tt),ka=Ot._,Vu=Yu("^"+Bo.call(bt).replace(ti,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Lo=Is?Se.Buffer:t,T=Se.Symbol,E=Se.Uint8Array,B=Lo?Lo.allocUnsafe:t,Z=Oc(Tt.getPrototypeOf,Tt),de=Tt.create,ge=Zi.propertyIsEnumerable,ve=Io.splice,De=T?T.isConcatSpreadable:t,Ie=T?T.iterator:t,Re=T?T.toStringTag:t,nt=function(){try{var f=Uo(Tt,"defineProperty");return f({},"",{}),f}catch{}}(),We=Se.clearTimeout!==Ot.clearTimeout&&Se.clearTimeout,He=Le&&Le.now!==Ot.Date.now&&Le.now,Ze=Se.setTimeout!==Ot.setTimeout&&Se.setTimeout,Ke=qt.ceil,ht=qt.floor,Dt=Tt.getOwnPropertySymbols,$t=Lo?Lo.isBuffer:t,zr=Se.isFinite,es=Io.join,Zw=Oc(Tt.keys,Tt),lr=qt.max,Ar=qt.min,eS=Le.now,tS=Se.parseInt,Em=qt.random,rS=Io.reverse,nd=Uo(Se,"DataView"),qu=Uo(Se,"Map"),id=Uo(Se,"Promise"),Pa=Uo(Se,"Set"),$u=Uo(Se,"WeakMap"),Ku=Uo(Tt,"create"),Lc=$u&&new $u,Ia={},nS=zo(nd),iS=zo(qu),sS=zo(id),oS=zo(Pa),aS=zo($u),Mc=T?T.prototype:t,Ju=Mc?Mc.valueOf:t,Am=Mc?Mc.toString:t;function G(f){if(Kt(f)&&!it(f)&&!(f instanceof pt)){if(f instanceof Nn)return f;if(bt.call(f,"__wrapped__"))return Tv(f)}return new Nn(f)}var Ba=function(){function f(){}return function(p){if(!Ht(p))return{};if(de)return de(p);f.prototype=p;var v=new f;return f.prototype=t,v}}();function Rc(){}function Nn(f,p){this.__wrapped__=f,this.__actions__=[],this.__chain__=!!p,this.__index__=0,this.__values__=t}G.templateSettings={escape:ku,evaluate:Cs,interpolate:Ui,variable:"",imports:{_:G}},G.prototype=Rc.prototype,G.prototype.constructor=G,Nn.prototype=Ba(Rc.prototype),Nn.prototype.constructor=Nn;function pt(f){this.__wrapped__=f,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=O,this.__views__=[]}function uS(){var f=new pt(this.__wrapped__);return f.__actions__=nn(this.__actions__),f.__dir__=this.__dir__,f.__filtered__=this.__filtered__,f.__iteratees__=nn(this.__iteratees__),f.__takeCount__=this.__takeCount__,f.__views__=nn(this.__views__),f}function lS(){if(this.__filtered__){var f=new pt(this);f.__dir__=-1,f.__filtered__=!0}else f=this.clone(),f.__dir__*=-1;return f}function cS(){var f=this.__wrapped__.value(),p=this.__dir__,v=it(f),A=p<0,R=v?f.length:0,K=Sb(0,R,this.__views__),ie=K.start,ue=K.end,fe=ue-ie,be=A?ue:ie-1,xe=this.__iteratees__,Ae=xe.length,je=0,Ge=Ar(fe,this.__takeCount__);if(!v||!A&&R==fe&&Ge==fe)return Jm(f,this.__actions__);var qe=[];e:for(;fe--&&je<Ge;){be+=p;for(var lt=-1,$e=f[be];++lt<Ae;){var dt=xe[lt],mt=dt.iteratee,Dn=dt.type,Hr=mt($e);if(Dn==F)$e=Hr;else if(!Hr){if(Dn==w)continue e;break e}}qe[je++]=$e}return qe}pt.prototype=Ba(Rc.prototype),pt.prototype.constructor=pt;function Mo(f){var p=-1,v=f==null?0:f.length;for(this.clear();++p<v;){var A=f[p];this.set(A[0],A[1])}}function hS(){this.__data__=Ku?Ku(null):{},this.size=0}function fS(f){var p=this.has(f)&&delete this.__data__[f];return this.size-=p?1:0,p}function dS(f){var p=this.__data__;if(Ku){var v=p[f];return v===i?t:v}return bt.call(p,f)?p[f]:t}function pS(f){var p=this.__data__;return Ku?p[f]!==t:bt.call(p,f)}function gS(f,p){var v=this.__data__;return this.size+=this.has(f)?0:1,v[f]=Ku&&p===t?i:p,this}Mo.prototype.clear=hS,Mo.prototype.delete=fS,Mo.prototype.get=dS,Mo.prototype.has=pS,Mo.prototype.set=gS;function ts(f){var p=-1,v=f==null?0:f.length;for(this.clear();++p<v;){var A=f[p];this.set(A[0],A[1])}}function mS(){this.__data__=[],this.size=0}function vS(f){var p=this.__data__,v=jc(p,f);if(v<0)return!1;var A=p.length-1;return v==A?p.pop():ve.call(p,v,1),--this.size,!0}function yS(f){var p=this.__data__,v=jc(p,f);return v<0?t:p[v][1]}function CS(f){return jc(this.__data__,f)>-1}function _S(f,p){var v=this.__data__,A=jc(v,f);return A<0?(++this.size,v.push([f,p])):v[A][1]=p,this}ts.prototype.clear=mS,ts.prototype.delete=vS,ts.prototype.get=yS,ts.prototype.has=CS,ts.prototype.set=_S;function rs(f){var p=-1,v=f==null?0:f.length;for(this.clear();++p<v;){var A=f[p];this.set(A[0],A[1])}}function wS(){this.size=0,this.__data__={hash:new Mo,map:new(qu||ts),string:new Mo}}function SS(f){var p=Kc(this,f).delete(f);return this.size-=p?1:0,p}function bS(f){return Kc(this,f).get(f)}function xS(f){return Kc(this,f).has(f)}function DS(f,p){var v=Kc(this,f),A=v.size;return v.set(f,p),this.size+=v.size==A?0:1,this}rs.prototype.clear=wS,rs.prototype.delete=SS,rs.prototype.get=bS,rs.prototype.has=xS,rs.prototype.set=DS;function Ro(f){var p=-1,v=f==null?0:f.length;for(this.__data__=new rs;++p<v;)this.add(f[p])}function ES(f){return this.__data__.set(f,i),this}function AS(f){return this.__data__.has(f)}Ro.prototype.add=Ro.prototype.push=ES,Ro.prototype.has=AS;function li(f){var p=this.__data__=new ts(f);this.size=p.size}function TS(){this.__data__=new ts,this.size=0}function FS(f){var p=this.__data__,v=p.delete(f);return this.size=p.size,v}function OS(f){return this.__data__.get(f)}function kS(f){return this.__data__.has(f)}function PS(f,p){var v=this.__data__;if(v instanceof ts){var A=v.__data__;if(!qu||A.length<r-1)return A.push([f,p]),this.size=++v.size,this;v=this.__data__=new rs(A)}return v.set(f,p),this.size=v.size,this}li.prototype.clear=TS,li.prototype.delete=FS,li.prototype.get=OS,li.prototype.has=kS,li.prototype.set=PS;function Tm(f,p){var v=it(f),A=!v&&Wo(f),R=!v&&!A&&zs(f),K=!v&&!A&&!R&&ja(f),ie=v||A||R||K,ue=ie?Ea(f.length,Ic):[],fe=ue.length;for(var be in f)(p||bt.call(f,be))&&!(ie&&(be=="length"||R&&(be=="offset"||be=="parent")||K&&(be=="buffer"||be=="byteLength"||be=="byteOffset")||os(be,fe)))&&ue.push(be);return ue}function Fm(f){var p=f.length;return p?f[gd(0,p-1)]:t}function IS(f,p){return Jc(nn(f),jo(p,0,f.length))}function BS(f){return Jc(nn(f))}function sd(f,p,v){(v!==t&&!ci(f[p],v)||v===t&&!(p in f))&&ns(f,p,v)}function Qu(f,p,v){var A=f[p];(!(bt.call(f,p)&&ci(A,v))||v===t&&!(p in f))&&ns(f,p,v)}function jc(f,p){for(var v=f.length;v--;)if(ci(f[v][0],p))return v;return-1}function LS(f,p,v,A){return Rs(f,function(R,K,ie){p(A,R,v(R),ie)}),A}function Om(f,p){return f&&Ai(p,dr(p),f)}function MS(f,p){return f&&Ai(p,on(p),f)}function ns(f,p,v){p=="__proto__"&&nt?nt(f,p,{configurable:!0,enumerable:!0,value:v,writable:!0}):f[p]=v}function od(f,p){for(var v=-1,A=p.length,R=me(A),K=f==null;++v<A;)R[v]=K?t:Ud(f,p[v]);return R}function jo(f,p,v){return f===f&&(v!==t&&(f=f<=v?f:v),p!==t&&(f=f>=p?f:p)),f}function Un(f,p,v,A,R,K){var ie,ue=p&u,fe=p&c,be=p&h;if(v&&(ie=R?v(f,A,R,K):v(f)),ie!==t)return ie;if(!Ht(f))return f;var xe=it(f);if(xe){if(ie=xb(f),!ue)return nn(f,ie)}else{var Ae=Tr(f),je=Ae==Q||Ae==ne;if(zs(f))return ev(f,ue);if(Ae==re||Ae==X||je&&!R){if(ie=fe||je?{}:Cv(f),!ue)return fe?db(f,MS(ie,f)):fb(f,Om(ie,f))}else{if(!gt[Ae])return R?f:{};ie=Db(f,Ae,ue)}}K||(K=new li);var Ge=K.get(f);if(Ge)return Ge;K.set(f,ie),qv(f)?f.forEach(function($e){ie.add(Un($e,p,v,$e,f,K))}):Yv(f)&&f.forEach(function($e,dt){ie.set(dt,Un($e,p,v,dt,f,K))});var qe=be?fe?Ed:Dd:fe?on:dr,lt=xe?t:qe(f);return or(lt||f,function($e,dt){lt&&(dt=$e,$e=f[dt]),Qu(ie,dt,Un($e,p,v,dt,f,K))}),ie}function RS(f){var p=dr(f);return function(v){return km(v,f,p)}}function km(f,p,v){var A=v.length;if(f==null)return!A;for(f=Tt(f);A--;){var R=v[A],K=p[R],ie=f[R];if(ie===t&&!(R in f)||!K(ie))return!1}return!0}function Pm(f,p,v){if(typeof f!="function")throw new ur(n);return sl(function(){f.apply(t,v)},p)}function Zu(f,p,v,A){var R=-1,K=Ji,ie=!0,ue=f.length,fe=[],be=p.length;if(!ue)return fe;v&&(p=kt(p,Ur(v))),A?(K=Oo,ie=!1):p.length>=r&&(K=Po,ie=!1,p=new Ro(p));e:for(;++R<ue;){var xe=f[R],Ae=v==null?xe:v(xe);if(xe=A||xe!==0?xe:0,ie&&Ae===Ae){for(var je=be;je--;)if(p[je]===Ae)continue e;fe.push(xe)}else K(p,Ae,A)||fe.push(xe)}return fe}var Rs=sv(Ei),Im=sv(ud,!0);function jS(f,p){var v=!0;return Rs(f,function(A,R,K){return v=!!p(A,R,K),v}),v}function Nc(f,p,v){for(var A=-1,R=f.length;++A<R;){var K=f[A],ie=p(K);if(ie!=null&&(ue===t?ie===ie&&!xn(ie):v(ie,ue)))var ue=ie,fe=K}return fe}function NS(f,p,v,A){var R=f.length;for(v=ut(v),v<0&&(v=-v>R?0:R+v),A=A===t||A>R?R:ut(A),A<0&&(A+=R),A=v>A?0:Kv(A);v<A;)f[v++]=p;return f}function Bm(f,p){var v=[];return Rs(f,function(A,R,K){p(A,R,K)&&v.push(A)}),v}function vr(f,p,v,A,R){var K=-1,ie=f.length;for(v||(v=Ab),R||(R=[]);++K<ie;){var ue=f[K];p>0&&v(ue)?p>1?vr(ue,p-1,v,A,R):ai(R,ue):A||(R[R.length]=ue)}return R}var ad=ov(),Lm=ov(!0);function Ei(f,p){return f&&ad(f,p,dr)}function ud(f,p){return f&&Lm(f,p,dr)}function Uc(f,p){return It(p,function(v){return as(f[v])})}function No(f,p){p=Ns(p,f);for(var v=0,A=p.length;f!=null&&v<A;)f=f[Ti(p[v++])];return v&&v==A?f:t}function Mm(f,p,v){var A=p(f);return it(f)?A:ai(A,v(f))}function Wr(f){return f==null?f===t?Qe:we:Re&&Re in Tt(f)?wb(f):Bb(f)}function ld(f,p){return f>p}function US(f,p){return f!=null&&bt.call(f,p)}function zS(f,p){return f!=null&&p in Tt(f)}function WS(f,p,v){return f>=Ar(p,v)&&f<lr(p,v)}function cd(f,p,v){for(var A=v?Oo:Ji,R=f[0].length,K=f.length,ie=K,ue=me(K),fe=1/0,be=[];ie--;){var xe=f[ie];ie&&p&&(xe=kt(xe,Ur(p))),fe=Ar(xe.length,fe),ue[ie]=!v&&(p||R>=120&&xe.length>=120)?new Ro(ie&&xe):t}xe=f[0];var Ae=-1,je=ue[0];e:for(;++Ae<R&&be.length<fe;){var Ge=xe[Ae],qe=p?p(Ge):Ge;if(Ge=v||Ge!==0?Ge:0,!(je?Po(je,qe):A(be,qe,v))){for(ie=K;--ie;){var lt=ue[ie];if(!(lt?Po(lt,qe):A(f[ie],qe,v)))continue e}je&&je.push(qe),be.push(Ge)}}return be}function GS(f,p,v,A){return Ei(f,function(R,K,ie){p(A,v(R),K,ie)}),A}function el(f,p,v){p=Ns(p,f),f=bv(f,p);var A=f==null?f:f[Ti(Wn(p))];return A==null?t:yt(A,f,v)}function Rm(f){return Kt(f)&&Wr(f)==X}function HS(f){return Kt(f)&&Wr(f)==wt}function XS(f){return Kt(f)&&Wr(f)==U}function tl(f,p,v,A,R){return f===p?!0:f==null||p==null||!Kt(f)&&!Kt(p)?f!==f&&p!==p:YS(f,p,v,A,tl,R)}function YS(f,p,v,A,R,K){var ie=it(f),ue=it(p),fe=ie?q:Tr(f),be=ue?q:Tr(p);fe=fe==X?re:fe,be=be==X?re:be;var xe=fe==re,Ae=be==re,je=fe==be;if(je&&zs(f)){if(!zs(p))return!1;ie=!0,xe=!1}if(je&&!xe)return K||(K=new li),ie||ja(f)?mv(f,p,v,A,R,K):Cb(f,p,fe,v,A,R,K);if(!(v&d)){var Ge=xe&&bt.call(f,"__wrapped__"),qe=Ae&&bt.call(p,"__wrapped__");if(Ge||qe){var lt=Ge?f.value():f,$e=qe?p.value():p;return K||(K=new li),R(lt,$e,v,A,K)}}return je?(K||(K=new li),_b(f,p,v,A,R,K)):!1}function VS(f){return Kt(f)&&Tr(f)==ce}function hd(f,p,v,A){var R=v.length,K=R,ie=!A;if(f==null)return!K;for(f=Tt(f);R--;){var ue=v[R];if(ie&&ue[2]?ue[1]!==f[ue[0]]:!(ue[0]in f))return!1}for(;++R<K;){ue=v[R];var fe=ue[0],be=f[fe],xe=ue[1];if(ie&&ue[2]){if(be===t&&!(fe in f))return!1}else{var Ae=new li;if(A)var je=A(be,xe,fe,f,p,Ae);if(!(je===t?tl(xe,be,d|g,A,Ae):je))return!1}}return!0}function jm(f){if(!Ht(f)||Fb(f))return!1;var p=as(f)?Vu:ws;return p.test(zo(f))}function qS(f){return Kt(f)&&Wr(f)==Be}function $S(f){return Kt(f)&&Tr(f)==Ue}function KS(f){return Kt(f)&&nh(f.length)&&!!xt[Wr(f)]}function Nm(f){return typeof f=="function"?f:f==null?an:typeof f=="object"?it(f)?Wm(f[0],f[1]):zm(f):a1(f)}function fd(f){if(!il(f))return Zw(f);var p=[];for(var v in Tt(f))bt.call(f,v)&&v!="constructor"&&p.push(v);return p}function JS(f){if(!Ht(f))return Ib(f);var p=il(f),v=[];for(var A in f)A=="constructor"&&(p||!bt.call(f,A))||v.push(A);return v}function dd(f,p){return f<p}function Um(f,p){var v=-1,A=sn(f)?me(f.length):[];return Rs(f,function(R,K,ie){A[++v]=p(R,K,ie)}),A}function zm(f){var p=Td(f);return p.length==1&&p[0][2]?wv(p[0][0],p[0][1]):function(v){return v===f||hd(v,f,p)}}function Wm(f,p){return Od(f)&&_v(p)?wv(Ti(f),p):function(v){var A=Ud(v,f);return A===t&&A===p?zd(v,f):tl(p,A,d|g)}}function zc(f,p,v,A,R){f!==p&&ad(p,function(K,ie){if(R||(R=new li),Ht(K))QS(f,p,ie,v,zc,A,R);else{var ue=A?A(Pd(f,ie),K,ie+"",f,p,R):t;ue===t&&(ue=K),sd(f,ie,ue)}},on)}function QS(f,p,v,A,R,K,ie){var ue=Pd(f,v),fe=Pd(p,v),be=ie.get(fe);if(be){sd(f,v,be);return}var xe=K?K(ue,fe,v+"",f,p,ie):t,Ae=xe===t;if(Ae){var je=it(fe),Ge=!je&&zs(fe),qe=!je&&!Ge&&ja(fe);xe=fe,je||Ge||qe?it(ue)?xe=ue:rr(ue)?xe=nn(ue):Ge?(Ae=!1,xe=ev(fe,!0)):qe?(Ae=!1,xe=tv(fe,!0)):xe=[]:ol(fe)||Wo(fe)?(xe=ue,Wo(ue)?xe=Jv(ue):(!Ht(ue)||as(ue))&&(xe=Cv(fe))):Ae=!1}Ae&&(ie.set(fe,xe),R(xe,fe,A,K,ie),ie.delete(fe)),sd(f,v,xe)}function Gm(f,p){var v=f.length;if(v)return p+=p<0?v:0,os(p,v)?f[p]:t}function Hm(f,p,v){p.length?p=kt(p,function(K){return it(K)?function(ie){return No(ie,K.length===1?K[0]:K)}:K}):p=[an];var A=-1;p=kt(p,Ur(Ve()));var R=Um(f,function(K,ie,ue){var fe=kt(p,function(be){return be(K)});return{criteria:fe,index:++A,value:K}});return Ec(R,function(K,ie){return hb(K,ie,v)})}function ZS(f,p){return Xm(f,p,function(v,A){return zd(f,A)})}function Xm(f,p,v){for(var A=-1,R=p.length,K={};++A<R;){var ie=p[A],ue=No(f,ie);v(ue,ie)&&rl(K,Ns(ie,f),ue)}return K}function eb(f){return function(p){return No(p,f)}}function pd(f,p,v,A){var R=A?xc:rn,K=-1,ie=p.length,ue=f;for(f===p&&(p=nn(p)),v&&(ue=kt(f,Ur(v)));++K<ie;)for(var fe=0,be=p[K],xe=v?v(be):be;(fe=R(ue,xe,fe,A))>-1;)ue!==f&&ve.call(ue,fe,1),ve.call(f,fe,1);return f}function Ym(f,p){for(var v=f?p.length:0,A=v-1;v--;){var R=p[v];if(v==A||R!==K){var K=R;os(R)?ve.call(f,R,1):yd(f,R)}}return f}function gd(f,p){return f+ht(Em()*(p-f+1))}function tb(f,p,v,A){for(var R=-1,K=lr(Ke((p-f)/(v||1)),0),ie=me(K);K--;)ie[A?K:++R]=f,f+=v;return ie}function md(f,p){var v="";if(!f||p<1||p>H)return v;do p%2&&(v+=f),p=ht(p/2),p&&(f+=f);while(p);return v}function ft(f,p){return Id(Sv(f,p,an),f+"")}function rb(f){return Fm(Na(f))}function nb(f,p){var v=Na(f);return Jc(v,jo(p,0,v.length))}function rl(f,p,v,A){if(!Ht(f))return f;p=Ns(p,f);for(var R=-1,K=p.length,ie=K-1,ue=f;ue!=null&&++R<K;){var fe=Ti(p[R]),be=v;if(fe==="__proto__"||fe==="constructor"||fe==="prototype")return f;if(R!=ie){var xe=ue[fe];be=A?A(xe,fe,ue):t,be===t&&(be=Ht(xe)?xe:os(p[R+1])?[]:{})}Qu(ue,fe,be),ue=ue[fe]}return f}var Vm=Lc?function(f,p){return Lc.set(f,p),f}:an,ib=nt?function(f,p){return nt(f,"toString",{configurable:!0,enumerable:!1,value:Gd(p),writable:!0})}:an;function sb(f){return Jc(Na(f))}function zn(f,p,v){var A=-1,R=f.length;p<0&&(p=-p>R?0:R+p),v=v>R?R:v,v<0&&(v+=R),R=p>v?0:v-p>>>0,p>>>=0;for(var K=me(R);++A<R;)K[A]=f[A+p];return K}function ob(f,p){var v;return Rs(f,function(A,R,K){return v=p(A,R,K),!v}),!!v}function Wc(f,p,v){var A=0,R=f==null?A:f.length;if(typeof p=="number"&&p===p&&R<=V){for(;A<R;){var K=A+R>>>1,ie=f[K];ie!==null&&!xn(ie)&&(v?ie<=p:ie<p)?A=K+1:R=K}return R}return vd(f,p,an,v)}function vd(f,p,v,A){var R=0,K=f==null?0:f.length;if(K===0)return 0;p=v(p);for(var ie=p!==p,ue=p===null,fe=xn(p),be=p===t;R<K;){var xe=ht((R+K)/2),Ae=v(f[xe]),je=Ae!==t,Ge=Ae===null,qe=Ae===Ae,lt=xn(Ae);if(ie)var $e=A||qe;else be?$e=qe&&(A||je):ue?$e=qe&&je&&(A||!Ge):fe?$e=qe&&je&&!Ge&&(A||!lt):Ge||lt?$e=!1:$e=A?Ae<=p:Ae<p;$e?R=xe+1:K=xe}return Ar(K,j)}function qm(f,p){for(var v=-1,A=f.length,R=0,K=[];++v<A;){var ie=f[v],ue=p?p(ie):ie;if(!v||!ci(ue,fe)){var fe=ue;K[R++]=ie===0?0:ie}}return K}function $m(f){return typeof f=="number"?f:xn(f)?_:+f}function bn(f){if(typeof f=="string")return f;if(it(f))return kt(f,bn)+"";if(xn(f))return Am?Am.call(f):"";var p=f+"";return p=="0"&&1/f==-I?"-0":p}function js(f,p,v){var A=-1,R=Ji,K=f.length,ie=!0,ue=[],fe=ue;if(v)ie=!1,R=Oo;else if(K>=r){var be=p?null:vb(f);if(be)return Qi(be);ie=!1,R=Po,fe=new Ro}else fe=p?[]:ue;e:for(;++A<K;){var xe=f[A],Ae=p?p(xe):xe;if(xe=v||xe!==0?xe:0,ie&&Ae===Ae){for(var je=fe.length;je--;)if(fe[je]===Ae)continue e;p&&fe.push(Ae),ue.push(xe)}else R(fe,Ae,v)||(fe!==ue&&fe.push(Ae),ue.push(xe))}return ue}function yd(f,p){return p=Ns(p,f),f=bv(f,p),f==null||delete f[Ti(Wn(p))]}function Km(f,p,v,A){return rl(f,p,v(No(f,p)),A)}function Gc(f,p,v,A){for(var R=f.length,K=A?R:-1;(A?K--:++K<R)&&p(f[K],K,f););return v?zn(f,A?0:K,A?K+1:R):zn(f,A?K+1:0,A?R:K)}function Jm(f,p){var v=f;return v instanceof pt&&(v=v.value()),Sa(p,function(A,R){return R.func.apply(R.thisArg,ai([A],R.args))},v)}function Cd(f,p,v){var A=f.length;if(A<2)return A?js(f[0]):[];for(var R=-1,K=me(A);++R<A;)for(var ie=f[R],ue=-1;++ue<A;)ue!=R&&(K[R]=Zu(K[R]||ie,f[ue],p,v));return js(vr(K,1),p,v)}function Qm(f,p,v){for(var A=-1,R=f.length,K=p.length,ie={};++A<R;){var ue=A<K?p[A]:t;v(ie,f[A],ue)}return ie}function _d(f){return rr(f)?f:[]}function wd(f){return typeof f=="function"?f:an}function Ns(f,p){return it(f)?f:Od(f,p)?[f]:Av(Et(f))}var ab=ft;function Us(f,p,v){var A=f.length;return v=v===t?A:v,!p&&v>=A?f:zn(f,p,v)}var Zm=We||function(f){return Ot.clearTimeout(f)};function ev(f,p){if(p)return f.slice();var v=f.length,A=B?B(v):new f.constructor(v);return f.copy(A),A}function Sd(f){var p=new f.constructor(f.byteLength);return new E(p).set(new E(f)),p}function ub(f,p){var v=p?Sd(f.buffer):f.buffer;return new f.constructor(v,f.byteOffset,f.byteLength)}function lb(f){var p=new f.constructor(f.source,Er.exec(f));return p.lastIndex=f.lastIndex,p}function cb(f){return Ju?Tt(Ju.call(f)):{}}function tv(f,p){var v=p?Sd(f.buffer):f.buffer;return new f.constructor(v,f.byteOffset,f.length)}function rv(f,p){if(f!==p){var v=f!==t,A=f===null,R=f===f,K=xn(f),ie=p!==t,ue=p===null,fe=p===p,be=xn(p);if(!ue&&!be&&!K&&f>p||K&&ie&&fe&&!ue&&!be||A&&ie&&fe||!v&&fe||!R)return 1;if(!A&&!K&&!be&&f<p||be&&v&&R&&!A&&!K||ue&&v&&R||!ie&&R||!fe)return-1}return 0}function hb(f,p,v){for(var A=-1,R=f.criteria,K=p.criteria,ie=R.length,ue=v.length;++A<ie;){var fe=rv(R[A],K[A]);if(fe){if(A>=ue)return fe;var be=v[A];return fe*(be=="desc"?-1:1)}}return f.index-p.index}function nv(f,p,v,A){for(var R=-1,K=f.length,ie=v.length,ue=-1,fe=p.length,be=lr(K-ie,0),xe=me(fe+be),Ae=!A;++ue<fe;)xe[ue]=p[ue];for(;++R<ie;)(Ae||R<K)&&(xe[v[R]]=f[R]);for(;be--;)xe[ue++]=f[R++];return xe}function iv(f,p,v,A){for(var R=-1,K=f.length,ie=-1,ue=v.length,fe=-1,be=p.length,xe=lr(K-ue,0),Ae=me(xe+be),je=!A;++R<xe;)Ae[R]=f[R];for(var Ge=R;++fe<be;)Ae[Ge+fe]=p[fe];for(;++ie<ue;)(je||R<K)&&(Ae[Ge+v[ie]]=f[R++]);return Ae}function nn(f,p){var v=-1,A=f.length;for(p||(p=me(A));++v<A;)p[v]=f[v];return p}function Ai(f,p,v,A){var R=!v;v||(v={});for(var K=-1,ie=p.length;++K<ie;){var ue=p[K],fe=A?A(v[ue],f[ue],ue,v,f):t;fe===t&&(fe=f[ue]),R?ns(v,ue,fe):Qu(v,ue,fe)}return v}function fb(f,p){return Ai(f,Fd(f),p)}function db(f,p){return Ai(f,vv(f),p)}function Hc(f,p){return function(v,A){var R=it(v)?sr:LS,K=p?p():{};return R(v,f,Ve(A,2),K)}}function La(f){return ft(function(p,v){var A=-1,R=v.length,K=R>1?v[R-1]:t,ie=R>2?v[2]:t;for(K=f.length>3&&typeof K=="function"?(R--,K):t,ie&&Gr(v[0],v[1],ie)&&(K=R<3?t:K,R=1),p=Tt(p);++A<R;){var ue=v[A];ue&&f(p,ue,A,K)}return p})}function sv(f,p){return function(v,A){if(v==null)return v;if(!sn(v))return f(v,A);for(var R=v.length,K=p?R:-1,ie=Tt(v);(p?K--:++K<R)&&A(ie[K],K,ie)!==!1;);return v}}function ov(f){return function(p,v,A){for(var R=-1,K=Tt(p),ie=A(p),ue=ie.length;ue--;){var fe=ie[f?ue:++R];if(v(K[fe],fe,K)===!1)break}return p}}function pb(f,p,v){var A=p&m,R=nl(f);function K(){var ie=this&&this!==Ot&&this instanceof K?R:f;return ie.apply(A?v:this,arguments)}return K}function av(f){return function(p){p=Et(p);var v=Ls(p)?Sn(p):t,A=v?v[0]:p.charAt(0),R=v?Us(v,1).join(""):p.slice(1);return A[f]()+R}}function Ma(f){return function(p){return Sa(s1(i1(p).replace(Ru,"")),f,"")}}function nl(f){return function(){var p=arguments;switch(p.length){case 0:return new f;case 1:return new f(p[0]);case 2:return new f(p[0],p[1]);case 3:return new f(p[0],p[1],p[2]);case 4:return new f(p[0],p[1],p[2],p[3]);case 5:return new f(p[0],p[1],p[2],p[3],p[4]);case 6:return new f(p[0],p[1],p[2],p[3],p[4],p[5]);case 7:return new f(p[0],p[1],p[2],p[3],p[4],p[5],p[6])}var v=Ba(f.prototype),A=f.apply(v,p);return Ht(A)?A:v}}function gb(f,p,v){var A=nl(f);function R(){for(var K=arguments.length,ie=me(K),ue=K,fe=Ra(R);ue--;)ie[ue]=arguments[ue];var be=K<3&&ie[0]!==fe&&ie[K-1]!==fe?[]:ui(ie,fe);if(K-=be.length,K<v)return fv(f,p,Xc,R.placeholder,t,ie,be,t,t,v-K);var xe=this&&this!==Ot&&this instanceof R?A:f;return yt(xe,this,ie)}return R}function uv(f){return function(p,v,A){var R=Tt(p);if(!sn(p)){var K=Ve(v,3);p=dr(p),v=function(ue){return K(R[ue],ue,R)}}var ie=f(p,v,A);return ie>-1?R[K?p[ie]:ie]:t}}function lv(f){return ss(function(p){var v=p.length,A=v,R=Nn.prototype.thru;for(f&&p.reverse();A--;){var K=p[A];if(typeof K!="function")throw new ur(n);if(R&&!ie&&$c(K)=="wrapper")var ie=new Nn([],!0)}for(A=ie?A:v;++A<v;){K=p[A];var ue=$c(K),fe=ue=="wrapper"?Ad(K):t;fe&&kd(fe[0])&&fe[1]==(M|b|L|W)&&!fe[4].length&&fe[9]==1?ie=ie[$c(fe[0])].apply(ie,fe[3]):ie=K.length==1&&kd(K)?ie[ue]():ie.thru(K)}return function(){var be=arguments,xe=be[0];if(ie&&be.length==1&&it(xe))return ie.plant(xe).value();for(var Ae=0,je=v?p[Ae].apply(this,be):xe;++Ae<v;)je=p[Ae].call(this,je);return je}})}function Xc(f,p,v,A,R,K,ie,ue,fe,be){var xe=p&M,Ae=p&m,je=p&y,Ge=p&(b|k),qe=p&Y,lt=je?t:nl(f);function $e(){for(var dt=arguments.length,mt=me(dt),Dn=dt;Dn--;)mt[Dn]=arguments[Dn];if(Ge)var Hr=Ra($e),En=Hu(mt,Hr);if(A&&(mt=nv(mt,A,R,Ge)),K&&(mt=iv(mt,K,ie,Ge)),dt-=En,Ge&&dt<be){var nr=ui(mt,Hr);return fv(f,p,Xc,$e.placeholder,v,mt,nr,ue,fe,be-dt)}var hi=Ae?v:this,ls=je?hi[f]:f;return dt=mt.length,ue?mt=Lb(mt,ue):qe&&dt>1&&mt.reverse(),xe&&fe<dt&&(mt.length=fe),this&&this!==Ot&&this instanceof $e&&(ls=lt||nl(ls)),ls.apply(hi,mt)}return $e}function cv(f,p){return function(v,A){return GS(v,f,p(A),{})}}function Yc(f,p){return function(v,A){var R;if(v===t&&A===t)return p;if(v!==t&&(R=v),A!==t){if(R===t)return A;typeof v=="string"||typeof A=="string"?(v=bn(v),A=bn(A)):(v=$m(v),A=$m(A)),R=f(v,A)}return R}}function bd(f){return ss(function(p){return p=kt(p,Ur(Ve())),ft(function(v){var A=this;return f(p,function(R){return yt(R,A,v)})})})}function Vc(f,p){p=p===t?" ":bn(p);var v=p.length;if(v<2)return v?md(p,f):p;var A=md(p,Ke(f/Ms(p)));return Ls(p)?Us(Sn(A),0,f).join(""):A.slice(0,f)}function mb(f,p,v,A){var R=p&m,K=nl(f);function ie(){for(var ue=-1,fe=arguments.length,be=-1,xe=A.length,Ae=me(xe+fe),je=this&&this!==Ot&&this instanceof ie?K:f;++be<xe;)Ae[be]=A[be];for(;fe--;)Ae[be++]=arguments[++ue];return yt(je,R?v:this,Ae)}return ie}function hv(f){return function(p,v,A){return A&&typeof A!="number"&&Gr(p,v,A)&&(v=A=t),p=us(p),v===t?(v=p,p=0):v=us(v),A=A===t?p<v?1:-1:us(A),tb(p,v,A,f)}}function qc(f){return function(p,v){return typeof p=="string"&&typeof v=="string"||(p=Gn(p),v=Gn(v)),f(p,v)}}function fv(f,p,v,A,R,K,ie,ue,fe,be){var xe=p&b,Ae=xe?ie:t,je=xe?t:ie,Ge=xe?K:t,qe=xe?t:K;p|=xe?L:N,p&=~(xe?N:L),p&C||(p&=~(m|y));var lt=[f,p,R,Ge,Ae,qe,je,ue,fe,be],$e=v.apply(t,lt);return kd(f)&&xv($e,lt),$e.placeholder=A,Dv($e,f,p)}function xd(f){var p=qt[f];return function(v,A){if(v=Gn(v),A=A==null?0:Ar(ut(A),292),A&&zr(v)){var R=(Et(v)+"e").split("e"),K=p(R[0]+"e"+(+R[1]+A));return R=(Et(K)+"e").split("e"),+(R[0]+"e"+(+R[1]-A))}return p(v)}}var vb=Pa&&1/Qi(new Pa([,-0]))[1]==I?function(f){return new Pa(f)}:Yd;function dv(f){return function(p){var v=Tr(p);return v==ce?Xu(p):v==Ue?kc(p):Gf(p,f(p))}}function is(f,p,v,A,R,K,ie,ue){var fe=p&y;if(!fe&&typeof f!="function")throw new ur(n);var be=A?A.length:0;if(be||(p&=~(L|N),A=R=t),ie=ie===t?ie:lr(ut(ie),0),ue=ue===t?ue:ut(ue),be-=R?R.length:0,p&N){var xe=A,Ae=R;A=R=t}var je=fe?t:Ad(f),Ge=[f,p,v,A,R,xe,Ae,K,ie,ue];if(je&&Pb(Ge,je),f=Ge[0],p=Ge[1],v=Ge[2],A=Ge[3],R=Ge[4],ue=Ge[9]=Ge[9]===t?fe?0:f.length:lr(Ge[9]-be,0),!ue&&p&(b|k)&&(p&=~(b|k)),!p||p==m)var qe=pb(f,p,v);else p==b||p==k?qe=gb(f,p,ue):(p==L||p==(m|L))&&!R.length?qe=mb(f,p,v,A):qe=Xc.apply(t,Ge);var lt=je?Vm:xv;return Dv(lt(qe,Ge),f,p)}function pv(f,p,v,A){return f===t||ci(f,Zi[v])&&!bt.call(A,v)?p:f}function gv(f,p,v,A,R,K){return Ht(f)&&Ht(p)&&(K.set(p,f),zc(f,p,t,gv,K),K.delete(p)),f}function yb(f){return ol(f)?t:f}function mv(f,p,v,A,R,K){var ie=v&d,ue=f.length,fe=p.length;if(ue!=fe&&!(ie&&fe>ue))return!1;var be=K.get(f),xe=K.get(p);if(be&&xe)return be==p&&xe==f;var Ae=-1,je=!0,Ge=v&g?new Ro:t;for(K.set(f,p),K.set(p,f);++Ae<ue;){var qe=f[Ae],lt=p[Ae];if(A)var $e=ie?A(lt,qe,Ae,p,f,K):A(qe,lt,Ae,f,p,K);if($e!==t){if($e)continue;je=!1;break}if(Ge){if(!ba(p,function(dt,mt){if(!Po(Ge,mt)&&(qe===dt||R(qe,dt,v,A,K)))return Ge.push(mt)})){je=!1;break}}else if(!(qe===lt||R(qe,lt,v,A,K))){je=!1;break}}return K.delete(f),K.delete(p),je}function Cb(f,p,v,A,R,K,ie){switch(v){case Zr:if(f.byteLength!=p.byteLength||f.byteOffset!=p.byteOffset)return!1;f=f.buffer,p=p.buffer;case wt:return!(f.byteLength!=p.byteLength||!K(new E(f),new E(p)));case $:case U:case Ee:return ci(+f,+p);case ee:return f.name==p.name&&f.message==p.message;case Be:case Me:return f==p+"";case ce:var ue=Xu;case Ue:var fe=A&d;if(ue||(ue=Qi),f.size!=p.size&&!fe)return!1;var be=ie.get(f);if(be)return be==p;A|=g,ie.set(f,p);var xe=mv(ue(f),ue(p),A,R,K,ie);return ie.delete(f),xe;case at:if(Ju)return Ju.call(f)==Ju.call(p)}return!1}function _b(f,p,v,A,R,K){var ie=v&d,ue=Dd(f),fe=ue.length,be=Dd(p),xe=be.length;if(fe!=xe&&!ie)return!1;for(var Ae=fe;Ae--;){var je=ue[Ae];if(!(ie?je in p:bt.call(p,je)))return!1}var Ge=K.get(f),qe=K.get(p);if(Ge&&qe)return Ge==p&&qe==f;var lt=!0;K.set(f,p),K.set(p,f);for(var $e=ie;++Ae<fe;){je=ue[Ae];var dt=f[je],mt=p[je];if(A)var Dn=ie?A(mt,dt,je,p,f,K):A(dt,mt,je,f,p,K);if(!(Dn===t?dt===mt||R(dt,mt,v,A,K):Dn)){lt=!1;break}$e||($e=je=="constructor")}if(lt&&!$e){var Hr=f.constructor,En=p.constructor;Hr!=En&&"constructor"in f&&"constructor"in p&&!(typeof Hr=="function"&&Hr instanceof Hr&&typeof En=="function"&&En instanceof En)&&(lt=!1)}return K.delete(f),K.delete(p),lt}function ss(f){return Id(Sv(f,t,kv),f+"")}function Dd(f){return Mm(f,dr,Fd)}function Ed(f){return Mm(f,on,vv)}var Ad=Lc?function(f){return Lc.get(f)}:Yd;function $c(f){for(var p=f.name+"",v=Ia[p],A=bt.call(Ia,p)?v.length:0;A--;){var R=v[A],K=R.func;if(K==null||K==f)return R.name}return p}function Ra(f){var p=bt.call(G,"placeholder")?G:f;return p.placeholder}function Ve(){var f=G.iteratee||Hd;return f=f===Hd?Nm:f,arguments.length?f(arguments[0],arguments[1]):f}function Kc(f,p){var v=f.__data__;return Tb(p)?v[typeof p=="string"?"string":"hash"]:v.map}function Td(f){for(var p=dr(f),v=p.length;v--;){var A=p[v],R=f[A];p[v]=[A,R,_v(R)]}return p}function Uo(f,p){var v=Vf(f,p);return jm(v)?v:t}function wb(f){var p=bt.call(f,Re),v=f[Re];try{f[Re]=t;var A=!0}catch{}var R=Oa.call(f);return A&&(p?f[Re]=v:delete f[Re]),R}var Fd=Dt?function(f){return f==null?[]:(f=Tt(f),It(Dt(f),function(p){return ge.call(f,p)}))}:Vd,vv=Dt?function(f){for(var p=[];f;)ai(p,Fd(f)),f=Z(f);return p}:Vd,Tr=Wr;(nd&&Tr(new nd(new ArrayBuffer(1)))!=Zr||qu&&Tr(new qu)!=ce||id&&Tr(id.resolve())!=ye||Pa&&Tr(new Pa)!=Ue||$u&&Tr(new $u)!=Lt)&&(Tr=function(f){var p=Wr(f),v=p==re?f.constructor:t,A=v?zo(v):"";if(A)switch(A){case nS:return Zr;case iS:return ce;case sS:return ye;case oS:return Ue;case aS:return Lt}return p});function Sb(f,p,v){for(var A=-1,R=v.length;++A<R;){var K=v[A],ie=K.size;switch(K.type){case"drop":f+=ie;break;case"dropRight":p-=ie;break;case"take":p=Ar(p,f+ie);break;case"takeRight":f=lr(f,p-ie);break}}return{start:f,end:p}}function bb(f){var p=f.match(yo);return p?p[1].split(Iu):[]}function yv(f,p,v){p=Ns(p,f);for(var A=-1,R=p.length,K=!1;++A<R;){var ie=Ti(p[A]);if(!(K=f!=null&&v(f,ie)))break;f=f[ie]}return K||++A!=R?K:(R=f==null?0:f.length,!!R&&nh(R)&&os(ie,R)&&(it(f)||Wo(f)))}function xb(f){var p=f.length,v=new f.constructor(p);return p&&typeof f[0]=="string"&&bt.call(f,"index")&&(v.index=f.index,v.input=f.input),v}function Cv(f){return typeof f.constructor=="function"&&!il(f)?Ba(Z(f)):{}}function Db(f,p,v){var A=f.constructor;switch(p){case wt:return Sd(f);case $:case U:return new A(+f);case Zr:return ub(f,v);case vn:case Pn:case Dr:case Ci:case ke:case Ne:case Xe:case ct:case Nt:return tv(f,v);case ce:return new A;case Ee:case Me:return new A(f);case Be:return lb(f);case Ue:return new A;case at:return cb(f)}}function Eb(f,p){var v=p.length;if(!v)return f;var A=v-1;return p[A]=(v>1?"& ":"")+p[A],p=p.join(v>2?", ":" "),f.replace(zi,`{
/* [wrapped with `+p+`] */
`)}function Ab(f){return it(f)||Wo(f)||!!(De&&f&&f[De])}function os(f,p){var v=typeof f;return p=p??H,!!p&&(v=="number"||v!="symbol"&&St.test(f))&&f>-1&&f%1==0&&f<p}function Gr(f,p,v){if(!Ht(v))return!1;var A=typeof p;return(A=="number"?sn(v)&&os(p,v.length):A=="string"&&p in v)?ci(v[p],f):!1}function Od(f,p){if(it(f))return!1;var v=typeof f;return v=="number"||v=="symbol"||v=="boolean"||f==null||xn(f)?!0:da.test(f)||!ei.test(f)||p!=null&&f in Tt(p)}function Tb(f){var p=typeof f;return p=="string"||p=="number"||p=="symbol"||p=="boolean"?f!=="__proto__":f===null}function kd(f){var p=$c(f),v=G[p];if(typeof v!="function"||!(p in pt.prototype))return!1;if(f===v)return!0;var A=Ad(v);return!!A&&f===A[0]}function Fb(f){return!!Bc&&Bc in f}var Ob=Fa?as:qd;function il(f){var p=f&&f.constructor,v=typeof p=="function"&&p.prototype||Zi;return f===v}function _v(f){return f===f&&!Ht(f)}function wv(f,p){return function(v){return v==null?!1:v[f]===p&&(p!==t||f in Tt(v))}}function kb(f){var p=th(f,function(A){return v.size===a&&v.clear(),A}),v=p.cache;return p}function Pb(f,p){var v=f[1],A=p[1],R=v|A,K=R<(m|y|M),ie=A==M&&v==b||A==M&&v==W&&f[7].length<=p[8]||A==(M|W)&&p[7].length<=p[8]&&v==b;if(!(K||ie))return f;A&m&&(f[2]=p[2],R|=v&m?0:C);var ue=p[3];if(ue){var fe=f[3];f[3]=fe?nv(fe,ue,p[4]):ue,f[4]=fe?ui(f[3],l):p[4]}return ue=p[5],ue&&(fe=f[5],f[5]=fe?iv(fe,ue,p[6]):ue,f[6]=fe?ui(f[5],l):p[6]),ue=p[7],ue&&(f[7]=ue),A&M&&(f[8]=f[8]==null?p[8]:Ar(f[8],p[8])),f[9]==null&&(f[9]=p[9]),f[0]=p[0],f[1]=R,f}function Ib(f){var p=[];if(f!=null)for(var v in Tt(f))p.push(v);return p}function Bb(f){return Oa.call(f)}function Sv(f,p,v){return p=lr(p===t?f.length-1:p,0),function(){for(var A=arguments,R=-1,K=lr(A.length-p,0),ie=me(K);++R<K;)ie[R]=A[p+R];R=-1;for(var ue=me(p+1);++R<p;)ue[R]=A[R];return ue[p]=v(ie),yt(f,this,ue)}}function bv(f,p){return p.length<2?f:No(f,zn(p,0,-1))}function Lb(f,p){for(var v=f.length,A=Ar(p.length,v),R=nn(f);A--;){var K=p[A];f[A]=os(K,v)?R[K]:t}return f}function Pd(f,p){if(!(p==="constructor"&&typeof f[p]=="function")&&p!="__proto__")return f[p]}var xv=Ev(Vm),sl=Ze||function(f,p){return Ot.setTimeout(f,p)},Id=Ev(ib);function Dv(f,p,v){var A=p+"";return Id(f,Eb(A,Mb(bb(A),v)))}function Ev(f){var p=0,v=0;return function(){var A=eS(),R=le-(A-v);if(v=A,R>0){if(++p>=pe)return arguments[0]}else p=0;return f.apply(t,arguments)}}function Jc(f,p){var v=-1,A=f.length,R=A-1;for(p=p===t?A:p;++v<p;){var K=gd(v,R),ie=f[K];f[K]=f[v],f[v]=ie}return f.length=p,f}var Av=kb(function(f){var p=[];return f.charCodeAt(0)===46&&p.push(""),f.replace(Pu,function(v,A,R,K){p.push(R?K.replace(ga,"$1"):A||v)}),p});function Ti(f){if(typeof f=="string"||xn(f))return f;var p=f+"";return p=="0"&&1/f==-I?"-0":p}function zo(f){if(f!=null){try{return Bo.call(f)}catch{}try{return f+""}catch{}}return""}function Mb(f,p){return or(z,function(v){var A="_."+v[0];p&v[1]&&!Ji(f,A)&&f.push(A)}),f.sort()}function Tv(f){if(f instanceof pt)return f.clone();var p=new Nn(f.__wrapped__,f.__chain__);return p.__actions__=nn(f.__actions__),p.__index__=f.__index__,p.__values__=f.__values__,p}function Rb(f,p,v){(v?Gr(f,p,v):p===t)?p=1:p=lr(ut(p),0);var A=f==null?0:f.length;if(!A||p<1)return[];for(var R=0,K=0,ie=me(Ke(A/p));R<A;)ie[K++]=zn(f,R,R+=p);return ie}function jb(f){for(var p=-1,v=f==null?0:f.length,A=0,R=[];++p<v;){var K=f[p];K&&(R[A++]=K)}return R}function Nb(){var f=arguments.length;if(!f)return[];for(var p=me(f-1),v=arguments[0],A=f;A--;)p[A-1]=arguments[A];return ai(it(v)?nn(v):[v],vr(p,1))}var Ub=ft(function(f,p){return rr(f)?Zu(f,vr(p,1,rr,!0)):[]}),zb=ft(function(f,p){var v=Wn(p);return rr(v)&&(v=t),rr(f)?Zu(f,vr(p,1,rr,!0),Ve(v,2)):[]}),Wb=ft(function(f,p){var v=Wn(p);return rr(v)&&(v=t),rr(f)?Zu(f,vr(p,1,rr,!0),t,v):[]});function Gb(f,p,v){var A=f==null?0:f.length;return A?(p=v||p===t?1:ut(p),zn(f,p<0?0:p,A)):[]}function Hb(f,p,v){var A=f==null?0:f.length;return A?(p=v||p===t?1:ut(p),p=A-p,zn(f,0,p<0?0:p)):[]}function Xb(f,p){return f&&f.length?Gc(f,Ve(p,3),!0,!0):[]}function Yb(f,p){return f&&f.length?Gc(f,Ve(p,3),!0):[]}function Vb(f,p,v,A){var R=f==null?0:f.length;return R?(v&&typeof v!="number"&&Gr(f,p,v)&&(v=0,A=R),NS(f,p,v,A)):[]}function Fv(f,p,v){var A=f==null?0:f.length;if(!A)return-1;var R=v==null?0:ut(v);return R<0&&(R=lr(A+R,0)),xa(f,Ve(p,3),R)}function Ov(f,p,v){var A=f==null?0:f.length;if(!A)return-1;var R=A-1;return v!==t&&(R=ut(v),R=v<0?lr(A+R,0):Ar(R,A-1)),xa(f,Ve(p,3),R,!0)}function kv(f){var p=f==null?0:f.length;return p?vr(f,1):[]}function qb(f){var p=f==null?0:f.length;return p?vr(f,I):[]}function $b(f,p){var v=f==null?0:f.length;return v?(p=p===t?1:ut(p),vr(f,p)):[]}function Kb(f){for(var p=-1,v=f==null?0:f.length,A={};++p<v;){var R=f[p];A[R[0]]=R[1]}return A}function Pv(f){return f&&f.length?f[0]:t}function Jb(f,p,v){var A=f==null?0:f.length;if(!A)return-1;var R=v==null?0:ut(v);return R<0&&(R=lr(A+R,0)),rn(f,p,R)}function Qb(f){var p=f==null?0:f.length;return p?zn(f,0,-1):[]}var Zb=ft(function(f){var p=kt(f,_d);return p.length&&p[0]===f[0]?cd(p):[]}),ex=ft(function(f){var p=Wn(f),v=kt(f,_d);return p===Wn(v)?p=t:v.pop(),v.length&&v[0]===f[0]?cd(v,Ve(p,2)):[]}),tx=ft(function(f){var p=Wn(f),v=kt(f,_d);return p=typeof p=="function"?p:t,p&&v.pop(),v.length&&v[0]===f[0]?cd(v,t,p):[]});function rx(f,p){return f==null?"":es.call(f,p)}function Wn(f){var p=f==null?0:f.length;return p?f[p-1]:t}function nx(f,p,v){var A=f==null?0:f.length;if(!A)return-1;var R=A;return v!==t&&(R=ut(v),R=R<0?lr(A+R,0):Ar(R,A-1)),p===p?$f(f,p,R):xa(f,Uu,R,!0)}function ix(f,p){return f&&f.length?Gm(f,ut(p)):t}var sx=ft(Iv);function Iv(f,p){return f&&f.length&&p&&p.length?pd(f,p):f}function ox(f,p,v){return f&&f.length&&p&&p.length?pd(f,p,Ve(v,2)):f}function ax(f,p,v){return f&&f.length&&p&&p.length?pd(f,p,t,v):f}var ux=ss(function(f,p){var v=f==null?0:f.length,A=od(f,p);return Ym(f,kt(p,function(R){return os(R,v)?+R:R}).sort(rv)),A});function lx(f,p){var v=[];if(!(f&&f.length))return v;var A=-1,R=[],K=f.length;for(p=Ve(p,3);++A<K;){var ie=f[A];p(ie,A,f)&&(v.push(ie),R.push(A))}return Ym(f,R),v}function Bd(f){return f==null?f:rS.call(f)}function cx(f,p,v){var A=f==null?0:f.length;return A?(v&&typeof v!="number"&&Gr(f,p,v)?(p=0,v=A):(p=p==null?0:ut(p),v=v===t?A:ut(v)),zn(f,p,v)):[]}function hx(f,p){return Wc(f,p)}function fx(f,p,v){return vd(f,p,Ve(v,2))}function dx(f,p){var v=f==null?0:f.length;if(v){var A=Wc(f,p);if(A<v&&ci(f[A],p))return A}return-1}function px(f,p){return Wc(f,p,!0)}function gx(f,p,v){return vd(f,p,Ve(v,2),!0)}function mx(f,p){var v=f==null?0:f.length;if(v){var A=Wc(f,p,!0)-1;if(ci(f[A],p))return A}return-1}function vx(f){return f&&f.length?qm(f):[]}function yx(f,p){return f&&f.length?qm(f,Ve(p,2)):[]}function Cx(f){var p=f==null?0:f.length;return p?zn(f,1,p):[]}function _x(f,p,v){return f&&f.length?(p=v||p===t?1:ut(p),zn(f,0,p<0?0:p)):[]}function wx(f,p,v){var A=f==null?0:f.length;return A?(p=v||p===t?1:ut(p),p=A-p,zn(f,p<0?0:p,A)):[]}function Sx(f,p){return f&&f.length?Gc(f,Ve(p,3),!1,!0):[]}function bx(f,p){return f&&f.length?Gc(f,Ve(p,3)):[]}var xx=ft(function(f){return js(vr(f,1,rr,!0))}),Dx=ft(function(f){var p=Wn(f);return rr(p)&&(p=t),js(vr(f,1,rr,!0),Ve(p,2))}),Ex=ft(function(f){var p=Wn(f);return p=typeof p=="function"?p:t,js(vr(f,1,rr,!0),t,p)});function Ax(f){return f&&f.length?js(f):[]}function Tx(f,p){return f&&f.length?js(f,Ve(p,2)):[]}function Fx(f,p){return p=typeof p=="function"?p:t,f&&f.length?js(f,t,p):[]}function Ld(f){if(!(f&&f.length))return[];var p=0;return f=It(f,function(v){if(rr(v))return p=lr(v.length,p),!0}),Ea(p,function(v){return kt(f,Bs(v))})}function Bv(f,p){if(!(f&&f.length))return[];var v=Ld(f);return p==null?v:kt(v,function(A){return yt(p,t,A)})}var Ox=ft(function(f,p){return rr(f)?Zu(f,p):[]}),kx=ft(function(f){return Cd(It(f,rr))}),Px=ft(function(f){var p=Wn(f);return rr(p)&&(p=t),Cd(It(f,rr),Ve(p,2))}),Ix=ft(function(f){var p=Wn(f);return p=typeof p=="function"?p:t,Cd(It(f,rr),t,p)}),Bx=ft(Ld);function Lx(f,p){return Qm(f||[],p||[],Qu)}function Mx(f,p){return Qm(f||[],p||[],rl)}var Rx=ft(function(f){var p=f.length,v=p>1?f[p-1]:t;return v=typeof v=="function"?(f.pop(),v):t,Bv(f,v)});function Lv(f){var p=G(f);return p.__chain__=!0,p}function jx(f,p){return p(f),f}function Qc(f,p){return p(f)}var Nx=ss(function(f){var p=f.length,v=p?f[0]:0,A=this.__wrapped__,R=function(K){return od(K,f)};return p>1||this.__actions__.length||!(A instanceof pt)||!os(v)?this.thru(R):(A=A.slice(v,+v+(p?1:0)),A.__actions__.push({func:Qc,args:[R],thisArg:t}),new Nn(A,this.__chain__).thru(function(K){return p&&!K.length&&K.push(t),K}))});function Ux(){return Lv(this)}function zx(){return new Nn(this.value(),this.__chain__)}function Wx(){this.__values__===t&&(this.__values__=$v(this.value()));var f=this.__index__>=this.__values__.length,p=f?t:this.__values__[this.__index__++];return{done:f,value:p}}function Gx(){return this}function Hx(f){for(var p,v=this;v instanceof Rc;){var A=Tv(v);A.__index__=0,A.__values__=t,p?R.__wrapped__=A:p=A;var R=A;v=v.__wrapped__}return R.__wrapped__=f,p}function Xx(){var f=this.__wrapped__;if(f instanceof pt){var p=f;return this.__actions__.length&&(p=new pt(this)),p=p.reverse(),p.__actions__.push({func:Qc,args:[Bd],thisArg:t}),new Nn(p,this.__chain__)}return this.thru(Bd)}function Yx(){return Jm(this.__wrapped__,this.__actions__)}var Vx=Hc(function(f,p,v){bt.call(f,v)?++f[v]:ns(f,v,1)});function qx(f,p,v){var A=it(f)?tn:jS;return v&&Gr(f,p,v)&&(p=t),A(f,Ve(p,3))}function $x(f,p){var v=it(f)?It:Bm;return v(f,Ve(p,3))}var Kx=uv(Fv),Jx=uv(Ov);function Qx(f,p){return vr(Zc(f,p),1)}function Zx(f,p){return vr(Zc(f,p),I)}function eD(f,p,v){return v=v===t?1:ut(v),vr(Zc(f,p),v)}function Mv(f,p){var v=it(f)?or:Rs;return v(f,Ve(p,3))}function Rv(f,p){var v=it(f)?en:Im;return v(f,Ve(p,3))}var tD=Hc(function(f,p,v){bt.call(f,v)?f[v].push(p):ns(f,v,[p])});function rD(f,p,v,A){f=sn(f)?f:Na(f),v=v&&!A?ut(v):0;var R=f.length;return v<0&&(v=lr(R+v,0)),ih(f)?v<=R&&f.indexOf(p,v)>-1:!!R&&rn(f,p,v)>-1}var nD=ft(function(f,p,v){var A=-1,R=typeof p=="function",K=sn(f)?me(f.length):[];return Rs(f,function(ie){K[++A]=R?yt(p,ie,v):el(ie,p,v)}),K}),iD=Hc(function(f,p,v){ns(f,v,p)});function Zc(f,p){var v=it(f)?kt:Um;return v(f,Ve(p,3))}function sD(f,p,v,A){return f==null?[]:(it(p)||(p=p==null?[]:[p]),v=A?t:v,it(v)||(v=v==null?[]:[v]),Hm(f,p,v))}var oD=Hc(function(f,p,v){f[v?0:1].push(p)},function(){return[[],[]]});function aD(f,p,v){var A=it(f)?Sa:Dc,R=arguments.length<3;return A(f,Ve(p,4),v,R,Rs)}function uD(f,p,v){var A=it(f)?Sc:Dc,R=arguments.length<3;return A(f,Ve(p,4),v,R,Im)}function lD(f,p){var v=it(f)?It:Bm;return v(f,rh(Ve(p,3)))}function cD(f){var p=it(f)?Fm:rb;return p(f)}function hD(f,p,v){(v?Gr(f,p,v):p===t)?p=1:p=ut(p);var A=it(f)?IS:nb;return A(f,p)}function fD(f){var p=it(f)?BS:sb;return p(f)}function dD(f){if(f==null)return 0;if(sn(f))return ih(f)?Ms(f):f.length;var p=Tr(f);return p==ce||p==Ue?f.size:fd(f).length}function pD(f,p,v){var A=it(f)?ba:ob;return v&&Gr(f,p,v)&&(p=t),A(f,Ve(p,3))}var gD=ft(function(f,p){if(f==null)return[];var v=p.length;return v>1&&Gr(f,p[0],p[1])?p=[]:v>2&&Gr(p[0],p[1],p[2])&&(p=[p[0]]),Hm(f,vr(p,1),[])}),eh=He||function(){return Ot.Date.now()};function mD(f,p){if(typeof p!="function")throw new ur(n);return f=ut(f),function(){if(--f<1)return p.apply(this,arguments)}}function jv(f,p,v){return p=v?t:p,p=f&&p==null?f.length:p,is(f,M,t,t,t,t,p)}function Nv(f,p){var v;if(typeof p!="function")throw new ur(n);return f=ut(f),function(){return--f>0&&(v=p.apply(this,arguments)),f<=1&&(p=t),v}}var Md=ft(function(f,p,v){var A=m;if(v.length){var R=ui(v,Ra(Md));A|=L}return is(f,A,p,v,R)}),Uv=ft(function(f,p,v){var A=m|y;if(v.length){var R=ui(v,Ra(Uv));A|=L}return is(p,A,f,v,R)});function zv(f,p,v){p=v?t:p;var A=is(f,b,t,t,t,t,t,p);return A.placeholder=zv.placeholder,A}function Wv(f,p,v){p=v?t:p;var A=is(f,k,t,t,t,t,t,p);return A.placeholder=Wv.placeholder,A}function Gv(f,p,v){var A,R,K,ie,ue,fe,be=0,xe=!1,Ae=!1,je=!0;if(typeof f!="function")throw new ur(n);p=Gn(p)||0,Ht(v)&&(xe=!!v.leading,Ae="maxWait"in v,K=Ae?lr(Gn(v.maxWait)||0,p):K,je="trailing"in v?!!v.trailing:je);function Ge(nr){var hi=A,ls=R;return A=R=t,be=nr,ie=f.apply(ls,hi),ie}function qe(nr){return be=nr,ue=sl(dt,p),xe?Ge(nr):ie}function lt(nr){var hi=nr-fe,ls=nr-be,u1=p-hi;return Ae?Ar(u1,K-ls):u1}function $e(nr){var hi=nr-fe,ls=nr-be;return fe===t||hi>=p||hi<0||Ae&&ls>=K}function dt(){var nr=eh();if($e(nr))return mt(nr);ue=sl(dt,lt(nr))}function mt(nr){return ue=t,je&&A?Ge(nr):(A=R=t,ie)}function Dn(){ue!==t&&Zm(ue),be=0,A=fe=R=ue=t}function Hr(){return ue===t?ie:mt(eh())}function En(){var nr=eh(),hi=$e(nr);if(A=arguments,R=this,fe=nr,hi){if(ue===t)return qe(fe);if(Ae)return Zm(ue),ue=sl(dt,p),Ge(fe)}return ue===t&&(ue=sl(dt,p)),ie}return En.cancel=Dn,En.flush=Hr,En}var vD=ft(function(f,p){return Pm(f,1,p)}),yD=ft(function(f,p,v){return Pm(f,Gn(p)||0,v)});function CD(f){return is(f,Y)}function th(f,p){if(typeof f!="function"||p!=null&&typeof p!="function")throw new ur(n);var v=function(){var A=arguments,R=p?p.apply(this,A):A[0],K=v.cache;if(K.has(R))return K.get(R);var ie=f.apply(this,A);return v.cache=K.set(R,ie)||K,ie};return v.cache=new(th.Cache||rs),v}th.Cache=rs;function rh(f){if(typeof f!="function")throw new ur(n);return function(){var p=arguments;switch(p.length){case 0:return!f.call(this);case 1:return!f.call(this,p[0]);case 2:return!f.call(this,p[0],p[1]);case 3:return!f.call(this,p[0],p[1],p[2])}return!f.apply(this,p)}}function _D(f){return Nv(2,f)}var wD=ab(function(f,p){p=p.length==1&&it(p[0])?kt(p[0],Ur(Ve())):kt(vr(p,1),Ur(Ve()));var v=p.length;return ft(function(A){for(var R=-1,K=Ar(A.length,v);++R<K;)A[R]=p[R].call(this,A[R]);return yt(f,this,A)})}),Rd=ft(function(f,p){var v=ui(p,Ra(Rd));return is(f,L,t,p,v)}),Hv=ft(function(f,p){var v=ui(p,Ra(Hv));return is(f,N,t,p,v)}),SD=ss(function(f,p){return is(f,W,t,t,t,p)});function bD(f,p){if(typeof f!="function")throw new ur(n);return p=p===t?p:ut(p),ft(f,p)}function xD(f,p){if(typeof f!="function")throw new ur(n);return p=p==null?0:lr(ut(p),0),ft(function(v){var A=v[p],R=Us(v,0,p);return A&&ai(R,A),yt(f,this,R)})}function DD(f,p,v){var A=!0,R=!0;if(typeof f!="function")throw new ur(n);return Ht(v)&&(A="leading"in v?!!v.leading:A,R="trailing"in v?!!v.trailing:R),Gv(f,p,{leading:A,maxWait:p,trailing:R})}function ED(f){return jv(f,1)}function AD(f,p){return Rd(wd(p),f)}function TD(){if(!arguments.length)return[];var f=arguments[0];return it(f)?f:[f]}function FD(f){return Un(f,h)}function OD(f,p){return p=typeof p=="function"?p:t,Un(f,h,p)}function kD(f){return Un(f,u|h)}function PD(f,p){return p=typeof p=="function"?p:t,Un(f,u|h,p)}function ID(f,p){return p==null||km(f,p,dr(p))}function ci(f,p){return f===p||f!==f&&p!==p}var BD=qc(ld),LD=qc(function(f,p){return f>=p}),Wo=Rm(function(){return arguments}())?Rm:function(f){return Kt(f)&&bt.call(f,"callee")&&!ge.call(f,"callee")},it=me.isArray,MD=wa?Ur(wa):HS;function sn(f){return f!=null&&nh(f.length)&&!as(f)}function rr(f){return Kt(f)&&sn(f)}function RD(f){return f===!0||f===!1||Kt(f)&&Wr(f)==$}var zs=$t||qd,jD=se?Ur(se):XS;function ND(f){return Kt(f)&&f.nodeType===1&&!ol(f)}function UD(f){if(f==null)return!0;if(sn(f)&&(it(f)||typeof f=="string"||typeof f.splice=="function"||zs(f)||ja(f)||Wo(f)))return!f.length;var p=Tr(f);if(p==ce||p==Ue)return!f.size;if(il(f))return!fd(f).length;for(var v in f)if(bt.call(f,v))return!1;return!0}function zD(f,p){return tl(f,p)}function WD(f,p,v){v=typeof v=="function"?v:t;var A=v?v(f,p):t;return A===t?tl(f,p,t,v):!!A}function jd(f){if(!Kt(f))return!1;var p=Wr(f);return p==ee||p==te||typeof f.message=="string"&&typeof f.name=="string"&&!ol(f)}function GD(f){return typeof f=="number"&&zr(f)}function as(f){if(!Ht(f))return!1;var p=Wr(f);return p==Q||p==ne||p==ae||p==Te}function Xv(f){return typeof f=="number"&&f==ut(f)}function nh(f){return typeof f=="number"&&f>-1&&f%1==0&&f<=H}function Ht(f){var p=typeof f;return f!=null&&(p=="object"||p=="function")}function Kt(f){return f!=null&&typeof f=="object"}var Yv=Oe?Ur(Oe):VS;function HD(f,p){return f===p||hd(f,p,Td(p))}function XD(f,p,v){return v=typeof v=="function"?v:t,hd(f,p,Td(p),v)}function YD(f){return Vv(f)&&f!=+f}function VD(f){if(Ob(f))throw new et(o);return jm(f)}function qD(f){return f===null}function $D(f){return f==null}function Vv(f){return typeof f=="number"||Kt(f)&&Wr(f)==Ee}function ol(f){if(!Kt(f)||Wr(f)!=re)return!1;var p=Z(f);if(p===null)return!0;var v=bt.call(p,"constructor")&&p.constructor;return typeof v=="function"&&v instanceof v&&Bo.call(v)==rd}var Nd=Fe?Ur(Fe):qS;function KD(f){return Xv(f)&&f>=-H&&f<=H}var qv=Je?Ur(Je):$S;function ih(f){return typeof f=="string"||!it(f)&&Kt(f)&&Wr(f)==Me}function xn(f){return typeof f=="symbol"||Kt(f)&&Wr(f)==at}var ja=Pt?Ur(Pt):KS;function JD(f){return f===t}function QD(f){return Kt(f)&&Tr(f)==Lt}function ZD(f){return Kt(f)&&Wr(f)==Zt}var e5=qc(dd),t5=qc(function(f,p){return f<=p});function $v(f){if(!f)return[];if(sn(f))return ih(f)?Sn(f):nn(f);if(Ie&&f[Ie])return Fc(f[Ie]());var p=Tr(f),v=p==ce?Xu:p==Ue?Qi:Na;return v(f)}function us(f){if(!f)return f===0?f:0;if(f=Gn(f),f===I||f===-I){var p=f<0?-1:1;return p*S}return f===f?f:0}function ut(f){var p=us(f),v=p%1;return p===p?v?p-v:p:0}function Kv(f){return f?jo(ut(f),0,O):0}function Gn(f){if(typeof f=="number")return f;if(xn(f))return _;if(Ht(f)){var p=typeof f.valueOf=="function"?f.valueOf():f;f=Ht(p)?p+"":p}if(typeof f!="string")return f===0?f:+f;f=Gu(f);var v=Vt.test(f);return v||Wi.test(f)?_a(f.slice(2),v?2:8):In.test(f)?_:+f}function Jv(f){return Ai(f,on(f))}function r5(f){return f?jo(ut(f),-H,H):f===0?f:0}function Et(f){return f==null?"":bn(f)}var n5=La(function(f,p){if(il(p)||sn(p)){Ai(p,dr(p),f);return}for(var v in p)bt.call(p,v)&&Qu(f,v,p[v])}),Qv=La(function(f,p){Ai(p,on(p),f)}),sh=La(function(f,p,v,A){Ai(p,on(p),f,A)}),i5=La(function(f,p,v,A){Ai(p,dr(p),f,A)}),s5=ss(od);function o5(f,p){var v=Ba(f);return p==null?v:Om(v,p)}var a5=ft(function(f,p){f=Tt(f);var v=-1,A=p.length,R=A>2?p[2]:t;for(R&&Gr(p[0],p[1],R)&&(A=1);++v<A;)for(var K=p[v],ie=on(K),ue=-1,fe=ie.length;++ue<fe;){var be=ie[ue],xe=f[be];(xe===t||ci(xe,Zi[be])&&!bt.call(f,be))&&(f[be]=K[be])}return f}),u5=ft(function(f){return f.push(t,gv),yt(Zv,t,f)});function l5(f,p){return bc(f,Ve(p,3),Ei)}function c5(f,p){return bc(f,Ve(p,3),ud)}function h5(f,p){return f==null?f:ad(f,Ve(p,3),on)}function f5(f,p){return f==null?f:Lm(f,Ve(p,3),on)}function d5(f,p){return f&&Ei(f,Ve(p,3))}function p5(f,p){return f&&ud(f,Ve(p,3))}function g5(f){return f==null?[]:Uc(f,dr(f))}function m5(f){return f==null?[]:Uc(f,on(f))}function Ud(f,p,v){var A=f==null?t:No(f,p);return A===t?v:A}function v5(f,p){return f!=null&&yv(f,p,US)}function zd(f,p){return f!=null&&yv(f,p,zS)}var y5=cv(function(f,p,v){p!=null&&typeof p.toString!="function"&&(p=Oa.call(p)),f[p]=v},Gd(an)),C5=cv(function(f,p,v){p!=null&&typeof p.toString!="function"&&(p=Oa.call(p)),bt.call(f,p)?f[p].push(v):f[p]=[v]},Ve),_5=ft(el);function dr(f){return sn(f)?Tm(f):fd(f)}function on(f){return sn(f)?Tm(f,!0):JS(f)}function w5(f,p){var v={};return p=Ve(p,3),Ei(f,function(A,R,K){ns(v,p(A,R,K),A)}),v}function S5(f,p){var v={};return p=Ve(p,3),Ei(f,function(A,R,K){ns(v,R,p(A,R,K))}),v}var b5=La(function(f,p,v){zc(f,p,v)}),Zv=La(function(f,p,v,A){zc(f,p,v,A)}),x5=ss(function(f,p){var v={};if(f==null)return v;var A=!1;p=kt(p,function(K){return K=Ns(K,f),A||(A=K.length>1),K}),Ai(f,Ed(f),v),A&&(v=Un(v,u|c|h,yb));for(var R=p.length;R--;)yd(v,p[R]);return v});function D5(f,p){return e1(f,rh(Ve(p)))}var E5=ss(function(f,p){return f==null?{}:ZS(f,p)});function e1(f,p){if(f==null)return{};var v=kt(Ed(f),function(A){return[A]});return p=Ve(p),Xm(f,v,function(A,R){return p(A,R[0])})}function A5(f,p,v){p=Ns(p,f);var A=-1,R=p.length;for(R||(R=1,f=t);++A<R;){var K=f==null?t:f[Ti(p[A])];K===t&&(A=R,K=v),f=as(K)?K.call(f):K}return f}function T5(f,p,v){return f==null?f:rl(f,p,v)}function F5(f,p,v,A){return A=typeof A=="function"?A:t,f==null?f:rl(f,p,v,A)}var t1=dv(dr),r1=dv(on);function O5(f,p,v){var A=it(f),R=A||zs(f)||ja(f);if(p=Ve(p,4),v==null){var K=f&&f.constructor;R?v=A?new K:[]:Ht(f)?v=as(K)?Ba(Z(f)):{}:v={}}return(R?or:Ei)(f,function(ie,ue,fe){return p(v,ie,ue,fe)}),v}function k5(f,p){return f==null?!0:yd(f,p)}function P5(f,p,v){return f==null?f:Km(f,p,wd(v))}function I5(f,p,v,A){return A=typeof A=="function"?A:t,f==null?f:Km(f,p,wd(v),A)}function Na(f){return f==null?[]:ko(f,dr(f))}function B5(f){return f==null?[]:ko(f,on(f))}function L5(f,p,v){return v===t&&(v=p,p=t),v!==t&&(v=Gn(v),v=v===v?v:0),p!==t&&(p=Gn(p),p=p===p?p:0),jo(Gn(f),p,v)}function M5(f,p,v){return p=us(p),v===t?(v=p,p=0):v=us(v),f=Gn(f),WS(f,p,v)}function R5(f,p,v){if(v&&typeof v!="boolean"&&Gr(f,p,v)&&(p=v=t),v===t&&(typeof p=="boolean"?(v=p,p=t):typeof f=="boolean"&&(v=f,f=t)),f===t&&p===t?(f=0,p=1):(f=us(f),p===t?(p=f,f=0):p=us(p)),f>p){var A=f;f=p,p=A}if(v||f%1||p%1){var R=Em();return Ar(f+R*(p-f+Ps("1e-"+((R+"").length-1))),p)}return gd(f,p)}var j5=Ma(function(f,p,v){return p=p.toLowerCase(),f+(v?n1(p):p)});function n1(f){return Wd(Et(f).toLowerCase())}function i1(f){return f=Et(f),f&&f.replace(Lu,Hf).replace(ks,"")}function N5(f,p,v){f=Et(f),p=bn(p);var A=f.length;v=v===t?A:jo(ut(v),0,A);var R=v;return v-=p.length,v>=0&&f.slice(v,R)==p}function U5(f){return f=Et(f),f&&Ou.test(f)?f.replace(mo,Xf):f}function z5(f){return f=Et(f),f&&vo.test(f)?f.replace(ti,"\\$&"):f}var W5=Ma(function(f,p,v){return f+(v?"-":"")+p.toLowerCase()}),G5=Ma(function(f,p,v){return f+(v?" ":"")+p.toLowerCase()}),H5=av("toLowerCase");function X5(f,p,v){f=Et(f),p=ut(p);var A=p?Ms(f):0;if(!p||A>=p)return f;var R=(p-A)/2;return Vc(ht(R),v)+f+Vc(Ke(R),v)}function Y5(f,p,v){f=Et(f),p=ut(p);var A=p?Ms(f):0;return p&&A<p?f+Vc(p-A,v):f}function V5(f,p,v){f=Et(f),p=ut(p);var A=p?Ms(f):0;return p&&A<p?Vc(p-A,v)+f:f}function q5(f,p,v){return v||p==null?p=0:p&&(p=+p),tS(Et(f).replace(Yt,""),p||0)}function $5(f,p,v){return(v?Gr(f,p,v):p===t)?p=1:p=ut(p),md(Et(f),p)}function K5(){var f=arguments,p=Et(f[0]);return f.length<3?p:p.replace(f[1],f[2])}var J5=Ma(function(f,p,v){return f+(v?"_":"")+p.toLowerCase()});function Q5(f,p,v){return v&&typeof v!="number"&&Gr(f,p,v)&&(p=v=t),v=v===t?O:v>>>0,v?(f=Et(f),f&&(typeof p=="string"||p!=null&&!Nd(p))&&(p=bn(p),!p&&Ls(f))?Us(Sn(f),0,v):f.split(p,v)):[]}var Z5=Ma(function(f,p,v){return f+(v?" ":"")+Wd(p)});function eE(f,p,v){return f=Et(f),v=v==null?0:jo(ut(v),0,f.length),p=bn(p),f.slice(v,v+p.length)==p}function tE(f,p,v){var A=G.templateSettings;v&&Gr(f,p,v)&&(p=t),f=Et(f),p=sh({},p,A,pv);var R=sh({},p.imports,A.imports,pv),K=dr(R),ie=ko(R,K),ue,fe,be=0,xe=p.interpolate||Ss,Ae="__p += '",je=Yu((p.escape||Ss).source+"|"+xe.source+"|"+(xe===Ui?Co:Ss).source+"|"+(p.evaluate||Ss).source+"|$","g"),Ge="//# sourceURL="+(bt.call(p,"sourceURL")?(p.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ki+"]")+`
`;f.replace(je,function($e,dt,mt,Dn,Hr,En){return mt||(mt=Dn),Ae+=f.slice(be,En).replace(ma,Yf),dt&&(ue=!0,Ae+=`' +
__e(`+dt+`) +
'`),Hr&&(fe=!0,Ae+=`';
`+Hr+`;
__p += '`),mt&&(Ae+=`' +
((__t = (`+mt+`)) == null ? '' : __t) +
'`),be=En+$e.length,$e}),Ae+=`';
`;var qe=bt.call(p,"variable")&&p.variable;if(!qe)Ae=`with (obj) {
`+Ae+`
}
`;else if(Bu.test(qe))throw new et(s);Ae=(fe?Ae.replace(ar,""):Ae).replace(er,"$1").replace(Ni,"$1;"),Ae="function("+(qe||"obj")+`) {
`+(qe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ue?", __e = _.escape":"")+(fe?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Ae+`return __p
}`;var lt=o1(function(){return Ct(K,Ge+"return "+Ae).apply(t,ie)});if(lt.source=Ae,jd(lt))throw lt;return lt}function rE(f){return Et(f).toLowerCase()}function nE(f){return Et(f).toUpperCase()}function iE(f,p,v){if(f=Et(f),f&&(v||p===t))return Gu(f);if(!f||!(p=bn(p)))return f;var A=Sn(f),R=Sn(p),K=Ac(A,R),ie=Aa(A,R)+1;return Us(A,K,ie).join("")}function sE(f,p,v){if(f=Et(f),f&&(v||p===t))return f.slice(0,Pc(f)+1);if(!f||!(p=bn(p)))return f;var A=Sn(f),R=Aa(A,Sn(p))+1;return Us(A,0,R).join("")}function oE(f,p,v){if(f=Et(f),f&&(v||p===t))return f.replace(Yt,"");if(!f||!(p=bn(p)))return f;var A=Sn(f),R=Ac(A,Sn(p));return Us(A,R).join("")}function aE(f,p){var v=J,A=oe;if(Ht(p)){var R="separator"in p?p.separator:R;v="length"in p?ut(p.length):v,A="omission"in p?bn(p.omission):A}f=Et(f);var K=f.length;if(Ls(f)){var ie=Sn(f);K=ie.length}if(v>=K)return f;var ue=v-Ms(A);if(ue<1)return A;var fe=ie?Us(ie,0,ue).join(""):f.slice(0,ue);if(R===t)return fe+A;if(ie&&(ue+=fe.length-ue),Nd(R)){if(f.slice(ue).search(R)){var be,xe=fe;for(R.global||(R=Yu(R.source,Et(Er.exec(R))+"g")),R.lastIndex=0;be=R.exec(xe);)var Ae=be.index;fe=fe.slice(0,Ae===t?ue:Ae)}}else if(f.indexOf(bn(R),ue)!=ue){var je=fe.lastIndexOf(R);je>-1&&(fe=fe.slice(0,je))}return fe+A}function uE(f){return f=Et(f),f&&Fu.test(f)?f.replace(_i,Kf):f}var lE=Ma(function(f,p,v){return f+(v?" ":"")+p.toUpperCase()}),Wd=av("toUpperCase");function s1(f,p,v){return f=Et(f),p=v?t:p,p===t?Tc(f)?Zf(f):Wf(f):f.match(p)||[]}var o1=ft(function(f,p){try{return yt(f,t,p)}catch(v){return jd(v)?v:new et(v)}}),cE=ss(function(f,p){return or(p,function(v){v=Ti(v),ns(f,v,Md(f[v],f))}),f});function hE(f){var p=f==null?0:f.length,v=Ve();return f=p?kt(f,function(A){if(typeof A[1]!="function")throw new ur(n);return[v(A[0]),A[1]]}):[],ft(function(A){for(var R=-1;++R<p;){var K=f[R];if(yt(K[0],this,A))return yt(K[1],this,A)}})}function fE(f){return RS(Un(f,u))}function Gd(f){return function(){return f}}function dE(f,p){return f==null||f!==f?p:f}var pE=lv(),gE=lv(!0);function an(f){return f}function Hd(f){return Nm(typeof f=="function"?f:Un(f,u))}function mE(f){return zm(Un(f,u))}function vE(f,p){return Wm(f,Un(p,u))}var yE=ft(function(f,p){return function(v){return el(v,f,p)}}),CE=ft(function(f,p){return function(v){return el(f,v,p)}});function Xd(f,p,v){var A=dr(p),R=Uc(p,A);v==null&&!(Ht(p)&&(R.length||!A.length))&&(v=p,p=f,f=this,R=Uc(p,dr(p)));var K=!(Ht(v)&&"chain"in v)||!!v.chain,ie=as(f);return or(R,function(ue){var fe=p[ue];f[ue]=fe,ie&&(f.prototype[ue]=function(){var be=this.__chain__;if(K||be){var xe=f(this.__wrapped__),Ae=xe.__actions__=nn(this.__actions__);return Ae.push({func:fe,args:arguments,thisArg:f}),xe.__chain__=be,xe}return fe.apply(f,ai([this.value()],arguments))})}),f}function _E(){return Ot._===this&&(Ot._=ka),this}function Yd(){}function wE(f){return f=ut(f),ft(function(p){return Gm(p,f)})}var SE=bd(kt),bE=bd(tn),xE=bd(ba);function a1(f){return Od(f)?Bs(Ti(f)):eb(f)}function DE(f){return function(p){return f==null?t:No(f,p)}}var EE=hv(),AE=hv(!0);function Vd(){return[]}function qd(){return!1}function TE(){return{}}function FE(){return""}function OE(){return!0}function kE(f,p){if(f=ut(f),f<1||f>H)return[];var v=O,A=Ar(f,O);p=Ve(p),f-=O;for(var R=Ea(A,p);++v<f;)p(v);return R}function PE(f){return it(f)?kt(f,Ti):xn(f)?[f]:nn(Av(Et(f)))}function IE(f){var p=++td;return Et(f)+p}var BE=Yc(function(f,p){return f+p},0),LE=xd("ceil"),ME=Yc(function(f,p){return f/p},1),RE=xd("floor");function jE(f){return f&&f.length?Nc(f,an,ld):t}function NE(f,p){return f&&f.length?Nc(f,Ve(p,2),ld):t}function UE(f){return zu(f,an)}function zE(f,p){return zu(f,Ve(p,2))}function WE(f){return f&&f.length?Nc(f,an,dd):t}function GE(f,p){return f&&f.length?Nc(f,Ve(p,2),dd):t}var HE=Yc(function(f,p){return f*p},1),XE=xd("round"),YE=Yc(function(f,p){return f-p},0);function VE(f){return f&&f.length?Wu(f,an):0}function qE(f,p){return f&&f.length?Wu(f,Ve(p,2)):0}return G.after=mD,G.ary=jv,G.assign=n5,G.assignIn=Qv,G.assignInWith=sh,G.assignWith=i5,G.at=s5,G.before=Nv,G.bind=Md,G.bindAll=cE,G.bindKey=Uv,G.castArray=TD,G.chain=Lv,G.chunk=Rb,G.compact=jb,G.concat=Nb,G.cond=hE,G.conforms=fE,G.constant=Gd,G.countBy=Vx,G.create=o5,G.curry=zv,G.curryRight=Wv,G.debounce=Gv,G.defaults=a5,G.defaultsDeep=u5,G.defer=vD,G.delay=yD,G.difference=Ub,G.differenceBy=zb,G.differenceWith=Wb,G.drop=Gb,G.dropRight=Hb,G.dropRightWhile=Xb,G.dropWhile=Yb,G.fill=Vb,G.filter=$x,G.flatMap=Qx,G.flatMapDeep=Zx,G.flatMapDepth=eD,G.flatten=kv,G.flattenDeep=qb,G.flattenDepth=$b,G.flip=CD,G.flow=pE,G.flowRight=gE,G.fromPairs=Kb,G.functions=g5,G.functionsIn=m5,G.groupBy=tD,G.initial=Qb,G.intersection=Zb,G.intersectionBy=ex,G.intersectionWith=tx,G.invert=y5,G.invertBy=C5,G.invokeMap=nD,G.iteratee=Hd,G.keyBy=iD,G.keys=dr,G.keysIn=on,G.map=Zc,G.mapKeys=w5,G.mapValues=S5,G.matches=mE,G.matchesProperty=vE,G.memoize=th,G.merge=b5,G.mergeWith=Zv,G.method=yE,G.methodOf=CE,G.mixin=Xd,G.negate=rh,G.nthArg=wE,G.omit=x5,G.omitBy=D5,G.once=_D,G.orderBy=sD,G.over=SE,G.overArgs=wD,G.overEvery=bE,G.overSome=xE,G.partial=Rd,G.partialRight=Hv,G.partition=oD,G.pick=E5,G.pickBy=e1,G.property=a1,G.propertyOf=DE,G.pull=sx,G.pullAll=Iv,G.pullAllBy=ox,G.pullAllWith=ax,G.pullAt=ux,G.range=EE,G.rangeRight=AE,G.rearg=SD,G.reject=lD,G.remove=lx,G.rest=bD,G.reverse=Bd,G.sampleSize=hD,G.set=T5,G.setWith=F5,G.shuffle=fD,G.slice=cx,G.sortBy=gD,G.sortedUniq=vx,G.sortedUniqBy=yx,G.split=Q5,G.spread=xD,G.tail=Cx,G.take=_x,G.takeRight=wx,G.takeRightWhile=Sx,G.takeWhile=bx,G.tap=jx,G.throttle=DD,G.thru=Qc,G.toArray=$v,G.toPairs=t1,G.toPairsIn=r1,G.toPath=PE,G.toPlainObject=Jv,G.transform=O5,G.unary=ED,G.union=xx,G.unionBy=Dx,G.unionWith=Ex,G.uniq=Ax,G.uniqBy=Tx,G.uniqWith=Fx,G.unset=k5,G.unzip=Ld,G.unzipWith=Bv,G.update=P5,G.updateWith=I5,G.values=Na,G.valuesIn=B5,G.without=Ox,G.words=s1,G.wrap=AD,G.xor=kx,G.xorBy=Px,G.xorWith=Ix,G.zip=Bx,G.zipObject=Lx,G.zipObjectDeep=Mx,G.zipWith=Rx,G.entries=t1,G.entriesIn=r1,G.extend=Qv,G.extendWith=sh,Xd(G,G),G.add=BE,G.attempt=o1,G.camelCase=j5,G.capitalize=n1,G.ceil=LE,G.clamp=L5,G.clone=FD,G.cloneDeep=kD,G.cloneDeepWith=PD,G.cloneWith=OD,G.conformsTo=ID,G.deburr=i1,G.defaultTo=dE,G.divide=ME,G.endsWith=N5,G.eq=ci,G.escape=U5,G.escapeRegExp=z5,G.every=qx,G.find=Kx,G.findIndex=Fv,G.findKey=l5,G.findLast=Jx,G.findLastIndex=Ov,G.findLastKey=c5,G.floor=RE,G.forEach=Mv,G.forEachRight=Rv,G.forIn=h5,G.forInRight=f5,G.forOwn=d5,G.forOwnRight=p5,G.get=Ud,G.gt=BD,G.gte=LD,G.has=v5,G.hasIn=zd,G.head=Pv,G.identity=an,G.includes=rD,G.indexOf=Jb,G.inRange=M5,G.invoke=_5,G.isArguments=Wo,G.isArray=it,G.isArrayBuffer=MD,G.isArrayLike=sn,G.isArrayLikeObject=rr,G.isBoolean=RD,G.isBuffer=zs,G.isDate=jD,G.isElement=ND,G.isEmpty=UD,G.isEqual=zD,G.isEqualWith=WD,G.isError=jd,G.isFinite=GD,G.isFunction=as,G.isInteger=Xv,G.isLength=nh,G.isMap=Yv,G.isMatch=HD,G.isMatchWith=XD,G.isNaN=YD,G.isNative=VD,G.isNil=$D,G.isNull=qD,G.isNumber=Vv,G.isObject=Ht,G.isObjectLike=Kt,G.isPlainObject=ol,G.isRegExp=Nd,G.isSafeInteger=KD,G.isSet=qv,G.isString=ih,G.isSymbol=xn,G.isTypedArray=ja,G.isUndefined=JD,G.isWeakMap=QD,G.isWeakSet=ZD,G.join=rx,G.kebabCase=W5,G.last=Wn,G.lastIndexOf=nx,G.lowerCase=G5,G.lowerFirst=H5,G.lt=e5,G.lte=t5,G.max=jE,G.maxBy=NE,G.mean=UE,G.meanBy=zE,G.min=WE,G.minBy=GE,G.stubArray=Vd,G.stubFalse=qd,G.stubObject=TE,G.stubString=FE,G.stubTrue=OE,G.multiply=HE,G.nth=ix,G.noConflict=_E,G.noop=Yd,G.now=eh,G.pad=X5,G.padEnd=Y5,G.padStart=V5,G.parseInt=q5,G.random=R5,G.reduce=aD,G.reduceRight=uD,G.repeat=$5,G.replace=K5,G.result=A5,G.round=XE,G.runInContext=he,G.sample=cD,G.size=dD,G.snakeCase=J5,G.some=pD,G.sortedIndex=hx,G.sortedIndexBy=fx,G.sortedIndexOf=dx,G.sortedLastIndex=px,G.sortedLastIndexBy=gx,G.sortedLastIndexOf=mx,G.startCase=Z5,G.startsWith=eE,G.subtract=YE,G.sum=VE,G.sumBy=qE,G.template=tE,G.times=kE,G.toFinite=us,G.toInteger=ut,G.toLength=Kv,G.toLower=rE,G.toNumber=Gn,G.toSafeInteger=r5,G.toString=Et,G.toUpper=nE,G.trim=iE,G.trimEnd=sE,G.trimStart=oE,G.truncate=aE,G.unescape=uE,G.uniqueId=IE,G.upperCase=lE,G.upperFirst=Wd,G.each=Mv,G.eachRight=Rv,G.first=Pv,Xd(G,function(){var f={};return Ei(G,function(p,v){bt.call(G.prototype,v)||(f[v]=p)}),f}(),{chain:!1}),G.VERSION=e,or(["bind","bindKey","curry","curryRight","partial","partialRight"],function(f){G[f].placeholder=G}),or(["drop","take"],function(f,p){pt.prototype[f]=function(v){v=v===t?1:lr(ut(v),0);var A=this.__filtered__&&!p?new pt(this):this.clone();return A.__filtered__?A.__takeCount__=Ar(v,A.__takeCount__):A.__views__.push({size:Ar(v,O),type:f+(A.__dir__<0?"Right":"")}),A},pt.prototype[f+"Right"]=function(v){return this.reverse()[f](v).reverse()}}),or(["filter","map","takeWhile"],function(f,p){var v=p+1,A=v==w||v==P;pt.prototype[f]=function(R){var K=this.clone();return K.__iteratees__.push({iteratee:Ve(R,3),type:v}),K.__filtered__=K.__filtered__||A,K}}),or(["head","last"],function(f,p){var v="take"+(p?"Right":"");pt.prototype[f]=function(){return this[v](1).value()[0]}}),or(["initial","tail"],function(f,p){var v="drop"+(p?"":"Right");pt.prototype[f]=function(){return this.__filtered__?new pt(this):this[v](1)}}),pt.prototype.compact=function(){return this.filter(an)},pt.prototype.find=function(f){return this.filter(f).head()},pt.prototype.findLast=function(f){return this.reverse().find(f)},pt.prototype.invokeMap=ft(function(f,p){return typeof f=="function"?new pt(this):this.map(function(v){return el(v,f,p)})}),pt.prototype.reject=function(f){return this.filter(rh(Ve(f)))},pt.prototype.slice=function(f,p){f=ut(f);var v=this;return v.__filtered__&&(f>0||p<0)?new pt(v):(f<0?v=v.takeRight(-f):f&&(v=v.drop(f)),p!==t&&(p=ut(p),v=p<0?v.dropRight(-p):v.take(p-f)),v)},pt.prototype.takeRightWhile=function(f){return this.reverse().takeWhile(f).reverse()},pt.prototype.toArray=function(){return this.take(O)},Ei(pt.prototype,function(f,p){var v=/^(?:filter|find|map|reject)|While$/.test(p),A=/^(?:head|last)$/.test(p),R=G[A?"take"+(p=="last"?"Right":""):p],K=A||/^find/.test(p);R&&(G.prototype[p]=function(){var ie=this.__wrapped__,ue=A?[1]:arguments,fe=ie instanceof pt,be=ue[0],xe=fe||it(ie),Ae=function(dt){var mt=R.apply(G,ai([dt],ue));return A&&je?mt[0]:mt};xe&&v&&typeof be=="function"&&be.length!=1&&(fe=xe=!1);var je=this.__chain__,Ge=!!this.__actions__.length,qe=K&&!je,lt=fe&&!Ge;if(!K&&xe){ie=lt?ie:new pt(this);var $e=f.apply(ie,ue);return $e.__actions__.push({func:Qc,args:[Ae],thisArg:t}),new Nn($e,je)}return qe&&lt?f.apply(this,ue):($e=this.thru(Ae),qe?A?$e.value()[0]:$e.value():$e)})}),or(["pop","push","shift","sort","splice","unshift"],function(f){var p=Io[f],v=/^(?:push|sort|unshift)$/.test(f)?"tap":"thru",A=/^(?:pop|shift)$/.test(f);G.prototype[f]=function(){var R=arguments;if(A&&!this.__chain__){var K=this.value();return p.apply(it(K)?K:[],R)}return this[v](function(ie){return p.apply(it(ie)?ie:[],R)})}}),Ei(pt.prototype,function(f,p){var v=G[p];if(v){var A=v.name+"";bt.call(Ia,A)||(Ia[A]=[]),Ia[A].push({name:p,func:v})}}),Ia[Xc(t,y).name]=[{name:"wrapper",func:t}],pt.prototype.clone=uS,pt.prototype.reverse=lS,pt.prototype.value=cS,G.prototype.at=Nx,G.prototype.chain=Ux,G.prototype.commit=zx,G.prototype.next=Wx,G.prototype.plant=Hx,G.prototype.reverse=Xx,G.prototype.toJSON=G.prototype.valueOf=G.prototype.value=Yx,G.prototype.first=G.prototype.head,Ie&&(G.prototype[Ie]=Gx),G},Di=ed();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Ot._=Di,define(function(){return Di})):jn?((jn.exports=Di)._=Di,Nr._=Di):Ot._=Di}).call(Wa)});var I1=tt(_e=>{var D=D||{version:"5.2.4"};typeof _e<"u"?_e.fabric=D:typeof define=="function"&&define.amd&&define([],function(){return D});typeof document<"u"&&typeof window<"u"?(document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?D.document=document:D.document=document.implementation.createHTMLDocument(""),D.window=window):(P1=$d(),up=new P1.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window,D.document=up.document,D.jsdomImplForWrapper=Kd().implForWrapper,D.nodeCanvas=Jd().Canvas,D.window=up,DOMParser=D.window.DOMParser);var P1,up;D.isTouchSupported="ontouchstart"in D.window||"ontouchstart"in D.document||D.window&&D.window.navigator&&D.window.navigator.maxTouchPoints>0;D.isLikelyNode=typeof Buffer<"u"&&typeof window>"u";D.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];D.DPI=96;D.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)";D.commaWsp="(?:\\s+,?\\s*|,\\s*)";D.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig;D.reNonWord=/[ \n\.,;!\?\-]/;D.fontPaths={};D.iMatrix=[1,0,0,1,0,0];D.svgNS="http://www.w3.org/2000/svg";D.perfLimitSizeTotal=2097152;D.maxCacheSideLimit=4096;D.minCacheSideLimit=256;D.charWidthsCache={};D.textureSize=2048;D.disableStyleCopyPaste=!1;D.enableGLFiltering=!0;D.devicePixelRatio=D.window.devicePixelRatio||D.window.webkitDevicePixelRatio||D.window.mozDevicePixelRatio||1;D.browserShadowBlurConstant=1;D.arcToSegmentsCache={};D.boundsOfCurveCache={};D.cachesBoundsOfCurve=!0;D.forceGLPutImageData=!1;D.initFilterBackend=function(){if(D.enableGLFiltering&&D.isWebglSupported&&D.isWebglSupported(D.textureSize))return console.log("max texture size: "+D.maxTextureSize),new D.WebglFilterBackend({tileSize:D.textureSize});if(D.Canvas2dFilterBackend)return new D.Canvas2dFilterBackend};typeof document<"u"&&typeof window<"u"&&(window.fabric=D);(function(){function t(i,a){if(this.__eventListeners[i]){var l=this.__eventListeners[i];a?l[l.indexOf(a)]=!1:D.util.array.fill(l,!1)}}function e(i,a){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var l in i)this.on(l,i[l]);else this.__eventListeners[i]||(this.__eventListeners[i]=[]),this.__eventListeners[i].push(a);return this}function r(i,a){var l=function(){a.apply(this,arguments),this.off(i,l)}.bind(this);this.on(i,l)}function o(i,a){if(arguments.length===1)for(var l in i)r.call(this,l,i[l]);else r.call(this,i,a);return this}function n(i,a){if(!this.__eventListeners)return this;if(arguments.length===0)for(i in this.__eventListeners)t.call(this,i);else if(arguments.length===1&&typeof arguments[0]=="object")for(var l in i)t.call(this,l,i[l]);else t.call(this,i,a);return this}function s(i,a){if(!this.__eventListeners)return this;var l=this.__eventListeners[i];if(!l)return this;for(var u=0,c=l.length;u<c;u++)l[u]&&l[u].call(this,a||{});return this.__eventListeners[i]=l.filter(function(h){return h!==!1}),this}D.Observable={fire:s,on:e,once:o,off:n}})();D.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(t,e,r){var o=this._objects;return r?o[e]=t:o.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var t=this._objects,e,r=!1,o=0,n=arguments.length;o<n;o++)e=t.indexOf(arguments[o]),e!==-1&&(r=!0,t.splice(e,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[o]));return this.renderOnAddRemove&&r&&this.requestRenderAll(),this},forEachObject:function(t,e){for(var r=this.getObjects(),o=0,n=r.length;o<n;o++)t.call(e,r[o],o,r);return this},getObjects:function(t){return typeof t>"u"?this._objects.concat():this._objects.filter(function(e){return e.type===t})},item:function(t){return this._objects[t]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(t,e){return this._objects.indexOf(t)>-1?!0:e?this._objects.some(function(r){return typeof r.contains=="function"&&r.contains(t,!0)}):!1},complexity:function(){return this._objects.reduce(function(t,e){return t+=e.complexity?e.complexity():0,t},0)}};D.CommonMethods={_setOptions:function(t){for(var e in t)this.set(e,t[e])},_initGradient:function(t,e){t&&t.colorStops&&!(t instanceof D.Gradient)&&this.set(e,new D.Gradient(t))},_initPattern:function(t,e,r){t&&t.source&&!(t instanceof D.Pattern)?this.set(e,new D.Pattern(t,r)):r&&r()},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return typeof t=="object"?this._setObject(t):this._set(t,e),this},_set:function(t,e){this[t]=e},toggle:function(t){var e=this.get(t);return typeof e=="boolean"&&this.set(t,!e),this},get:function(t){return this[t]}};(function(t){var e=Math.sqrt,r=Math.atan2,o=Math.pow,n=Math.PI/180,s=Math.PI/2;D.util={cos:function(i){if(i===0)return 1;i<0&&(i=-i);var a=i/s;switch(a){case 1:case 3:return 0;case 2:return-1}return Math.cos(i)},sin:function(i){if(i===0)return 0;var a=i/s,l=1;switch(i<0&&(l=-1),a){case 1:return l;case 2:return 0;case 3:return-l}return Math.sin(i)},removeFromArray:function(i,a){var l=i.indexOf(a);return l!==-1&&i.splice(l,1),i},getRandomInt:function(i,a){return Math.floor(Math.random()*(a-i+1))+i},degreesToRadians:function(i){return i*n},radiansToDegrees:function(i){return i/n},rotatePoint:function(i,a,l){var u=new D.Point(i.x-a.x,i.y-a.y),c=D.util.rotateVector(u,l);return new D.Point(c.x,c.y).addEquals(a)},rotateVector:function(i,a){var l=D.util.sin(a),u=D.util.cos(a),c=i.x*u-i.y*l,h=i.x*l+i.y*u;return{x:c,y:h}},createVector:function(i,a){return new D.Point(a.x-i.x,a.y-i.y)},calcAngleBetweenVectors:function(i,a){return Math.acos((i.x*a.x+i.y*a.y)/(Math.hypot(i.x,i.y)*Math.hypot(a.x,a.y)))},getHatVector:function(i){return new D.Point(i.x,i.y).multiply(1/Math.hypot(i.x,i.y))},getBisector:function(i,a,l){var u=D.util.createVector(i,a),c=D.util.createVector(i,l),h=D.util.calcAngleBetweenVectors(u,c),d=D.util.calcAngleBetweenVectors(D.util.rotateVector(u,h),c),g=h*(d===0?1:-1)/2;return{vector:D.util.getHatVector(D.util.rotateVector(u,g)),angle:h}},projectStrokeOnPoints:function(i,a,l){var u=[],c=a.strokeWidth/2,h=a.strokeUniform?new D.Point(1/a.scaleX,1/a.scaleY):new D.Point(1,1),d=function(g){var m=c/Math.hypot(g.x,g.y);return new D.Point(g.x*m*h.x,g.y*m*h.y)};return i.length<=1||i.forEach(function(g,m){var y=new D.Point(g.x,g.y),C,b;m===0?(b=i[m+1],C=l?d(D.util.createVector(b,y)).addEquals(y):i[i.length-1]):m===i.length-1?(C=i[m-1],b=l?d(D.util.createVector(C,y)).addEquals(y):i[0]):(C=i[m-1],b=i[m+1]);var k=D.util.getBisector(y,C,b),L=k.vector,N=k.angle,M,W;if(a.strokeLineJoin==="miter"&&(M=-c/Math.sin(N/2),W=new D.Point(L.x*M*h.x,L.y*M*h.y),Math.hypot(W.x,W.y)/c<=a.strokeMiterLimit)){u.push(y.add(W)),u.push(y.subtract(W));return}M=-c*Math.SQRT2,W=new D.Point(L.x*M*h.x,L.y*M*h.y),u.push(y.add(W)),u.push(y.subtract(W))}),u},transformPoint:function(i,a,l){return l?new D.Point(a[0]*i.x+a[2]*i.y,a[1]*i.x+a[3]*i.y):new D.Point(a[0]*i.x+a[2]*i.y+a[4],a[1]*i.x+a[3]*i.y+a[5])},makeBoundingBoxFromPoints:function(i,a){if(a)for(var l=0;l<i.length;l++)i[l]=D.util.transformPoint(i[l],a);var u=[i[0].x,i[1].x,i[2].x,i[3].x],c=D.util.array.min(u),h=D.util.array.max(u),d=h-c,g=[i[0].y,i[1].y,i[2].y,i[3].y],m=D.util.array.min(g),y=D.util.array.max(g),C=y-m;return{left:c,top:m,width:d,height:C}},invertTransform:function(i){var a=1/(i[0]*i[3]-i[1]*i[2]),l=[a*i[3],-a*i[1],-a*i[2],a*i[0]],u=D.util.transformPoint({x:i[4],y:i[5]},l,!0);return l[4]=-u.x,l[5]=-u.y,l},toFixed:function(i,a){return parseFloat(Number(i).toFixed(a))},parseUnit:function(i,a){var l=/\D{0,2}$/.exec(i),u=parseFloat(i);switch(a||(a=D.Text.DEFAULT_SVG_FONT_SIZE),l[0]){case"mm":return u*D.DPI/25.4;case"cm":return u*D.DPI/2.54;case"in":return u*D.DPI;case"pt":return u*D.DPI/72;case"pc":return u*D.DPI/72*12;case"em":return u*a;default:return u}},falseFunction:function(){return!1},getKlass:function(i,a){return i=D.util.string.camelize(i.charAt(0).toUpperCase()+i.slice(1)),D.util.resolveNamespace(a)[i]},getSvgAttributes:function(i){var a=["instantiated_by_use","style","id","class"];switch(i){case"linearGradient":a=a.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":a=a.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":a=a.concat(["offset","stop-color","stop-opacity"]);break}return a},resolveNamespace:function(i){if(!i)return D;var a=i.split("."),l=a.length,u,c=t||D.window;for(u=0;u<l;++u)c=c[a[u]];return c},loadImage:function(i,a,l,u){if(!i){a&&a.call(l,i);return}var c=D.util.createImage(),h=function(){a&&a.call(l,c,!1),c=c.onload=c.onerror=null};c.onload=h,c.onerror=function(){D.log("Error loading "+c.src),a&&a.call(l,null,!0),c=c.onload=c.onerror=null},i.indexOf("data")!==0&&u!==void 0&&u!==null&&(c.crossOrigin=u),i.substring(0,14)==="data:image/svg"&&(c.onload=null,D.util.loadImageInDom(c,h)),c.src=i},loadImageInDom:function(i,a){var l=D.document.createElement("div");l.style.width=l.style.height="1px",l.style.left=l.style.top="-100%",l.style.position="absolute",l.appendChild(i),D.document.querySelector("body").appendChild(l),i.onload=function(){a(),l.parentNode.removeChild(l),l=null}},enlivenObjects:function(i,a,l,u){i=i||[];var c=[],h=0,d=i.length;function g(){++h===d&&a&&a(c.filter(function(m){return m}))}if(!d){a&&a(c);return}i.forEach(function(m,y){if(!m||!m.type){g();return}var C=D.util.getKlass(m.type,l);C.fromObject(m,function(b,k){k||(c[y]=b),u&&u(m,b,k),g()})})},enlivenObjectEnlivables:function(i,a,l){var u=D.Object.ENLIVEN_PROPS.filter(function(c){return!!i[c]});D.util.enlivenObjects(u.map(function(c){return i[c]}),function(c){var h={};u.forEach(function(d,g){h[d]=c[g],a&&(a[d]=c[g])}),l&&l(h)})},enlivenPatterns:function(i,a){i=i||[];function l(){++c===h&&a&&a(u)}var u=[],c=0,h=i.length;if(!h){a&&a(u);return}i.forEach(function(d,g){d&&d.source?new D.Pattern(d,function(m){u[g]=m,l()}):(u[g]=d,l())})},groupSVGElements:function(i,a,l){var u;return i&&i.length===1?(typeof l<"u"&&(i[0].sourcePath=l),i[0]):(a&&(a.width&&a.height?a.centerPoint={x:a.width/2,y:a.height/2}:(delete a.width,delete a.height)),u=new D.Group(i,a),typeof l<"u"&&(u.sourcePath=l),u)},populateWithProperties:function(i,a,l){if(l&&Array.isArray(l))for(var u=0,c=l.length;u<c;u++)l[u]in i&&(a[l[u]]=i[l[u]])},createCanvasElement:function(){return D.document.createElement("canvas")},copyCanvasElement:function(i){var a=D.util.createCanvasElement();return a.width=i.width,a.height=i.height,a.getContext("2d").drawImage(i,0,0),a},toDataURL:function(i,a,l){return i.toDataURL("image/"+a,l)},createImage:function(){return D.document.createElement("img")},multiplyTransformMatrices:function(i,a,l){return[i[0]*a[0]+i[2]*a[1],i[1]*a[0]+i[3]*a[1],i[0]*a[2]+i[2]*a[3],i[1]*a[2]+i[3]*a[3],l?0:i[0]*a[4]+i[2]*a[5]+i[4],l?0:i[1]*a[4]+i[3]*a[5]+i[5]]},qrDecompose:function(i){var a=r(i[1],i[0]),l=o(i[0],2)+o(i[1],2),u=e(l),c=(i[0]*i[3]-i[2]*i[1])/u,h=r(i[0]*i[2]+i[1]*i[3],l);return{angle:a/n,scaleX:u,scaleY:c,skewX:h/n,skewY:0,translateX:i[4],translateY:i[5]}},calcRotateMatrix:function(i){if(!i.angle)return D.iMatrix.concat();var a=D.util.degreesToRadians(i.angle),l=D.util.cos(a),u=D.util.sin(a);return[l,u,-u,l,0,0]},calcDimensionsMatrix:function(i){var a=typeof i.scaleX>"u"?1:i.scaleX,l=typeof i.scaleY>"u"?1:i.scaleY,u=[i.flipX?-a:a,0,0,i.flipY?-l:l,0,0],c=D.util.multiplyTransformMatrices,h=D.util.degreesToRadians;return i.skewX&&(u=c(u,[1,0,Math.tan(h(i.skewX)),1],!0)),i.skewY&&(u=c(u,[1,Math.tan(h(i.skewY)),0,1],!0)),u},composeMatrix:function(i){var a=[1,0,0,1,i.translateX||0,i.translateY||0],l=D.util.multiplyTransformMatrices;return i.angle&&(a=l(a,D.util.calcRotateMatrix(i))),(i.scaleX!==1||i.scaleY!==1||i.skewX||i.skewY||i.flipX||i.flipY)&&(a=l(a,D.util.calcDimensionsMatrix(i))),a},resetObjectTransform:function(i){i.scaleX=1,i.scaleY=1,i.skewX=0,i.skewY=0,i.flipX=!1,i.flipY=!1,i.rotate(0)},saveObjectTransform:function(i){return{scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,angle:i.angle,left:i.left,flipX:i.flipX,flipY:i.flipY,top:i.top}},isTransparent:function(i,a,l,u){u>0&&(a>u?a-=u:a=0,l>u?l-=u:l=0);var c=!0,h,d,g=i.getImageData(a,l,u*2||1,u*2||1),m=g.data.length;for(h=3;h<m&&(d=g.data[h],c=d<=0,c!==!1);h+=4);return g=null,c},parsePreserveAspectRatioAttribute:function(i){var a="meet",l="Mid",u="Mid",c=i.split(" "),h;return c&&c.length&&(a=c.pop(),a!=="meet"&&a!=="slice"?(h=a,a="meet"):c.length&&(h=c.pop())),l=h!=="none"?h.slice(1,4):"none",u=h!=="none"?h.slice(5,8):"none",{meetOrSlice:a,alignX:l,alignY:u}},clearFabricFontCache:function(i){i=(i||"").toLowerCase(),i?D.charWidthsCache[i]&&delete D.charWidthsCache[i]:D.charWidthsCache={}},limitDimsByArea:function(i,a){var l=Math.sqrt(a*i),u=Math.floor(a/l);return{x:Math.floor(l),y:u}},capValue:function(i,a,l){return Math.max(i,Math.min(a,l))},findScaleToFit:function(i,a){return Math.min(a.width/i.width,a.height/i.height)},findScaleToCover:function(i,a){return Math.max(a.width/i.width,a.height/i.height)},matrixToSVG:function(i){return"matrix("+i.map(function(a){return D.util.toFixed(a,D.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(i,a){var l=D.util.invertTransform(a),u=D.util.multiplyTransformMatrices(l,i.calcOwnMatrix());D.util.applyTransformToObject(i,u)},addTransformToObject:function(i,a){D.util.applyTransformToObject(i,D.util.multiplyTransformMatrices(a,i.calcOwnMatrix()))},applyTransformToObject:function(i,a){var l=D.util.qrDecompose(a),u=new D.Point(l.translateX,l.translateY);i.flipX=!1,i.flipY=!1,i.set("scaleX",l.scaleX),i.set("scaleY",l.scaleY),i.skewX=l.skewX,i.skewY=l.skewY,i.angle=l.angle,i.setPositionByOrigin(u,"center","center")},sizeAfterTransform:function(i,a,l){var u=i/2,c=a/2,h=[{x:-u,y:-c},{x:u,y:-c},{x:-u,y:c},{x:u,y:c}],d=D.util.calcDimensionsMatrix(l),g=D.util.makeBoundingBoxFromPoints(h,d);return{x:g.width,y:g.height}},mergeClipPaths:function(i,a){var l=i,u=a;l.inverted&&!u.inverted&&(l=a,u=i),D.util.applyTransformToObject(u,D.util.multiplyTransformMatrices(D.util.invertTransform(l.calcTransformMatrix()),u.calcTransformMatrix()));var c=l.inverted&&u.inverted;return c&&(l.inverted=u.inverted=!1),new D.Group([l],{clipPath:u,inverted:c})},hasStyleChanged:function(i,a,l){return l=l||!1,i.fill!==a.fill||i.stroke!==a.stroke||i.strokeWidth!==a.strokeWidth||i.fontSize!==a.fontSize||i.fontFamily!==a.fontFamily||i.fontWeight!==a.fontWeight||i.fontStyle!==a.fontStyle||i.deltaY!==a.deltaY||l&&(i.overline!==a.overline||i.underline!==a.underline||i.linethrough!==a.linethrough)},stylesToArray:function(l,a){for(var l=D.util.object.clone(l,!0),u=a.split(`
`),c=-1,h={},d=[],g=0;g<u.length;g++){if(!l[g]){c+=u[g].length;continue}for(var m=0;m<u[g].length;m++){c++;var y=l[g][m];if(y){var C=D.util.hasStyleChanged(h,y,!0);C?d.push({start:c,end:c+1,style:y}):d[d.length-1].end++}h=y||{}}}return d},stylesFromArray:function(i,a){if(!Array.isArray(i))return i;for(var l=a.split(`
`),u=-1,c=0,h={},d=0;d<l.length;d++)for(var g=0;g<l[d].length;g++)u++,i[c]&&i[c].start<=u&&u<i[c].end&&(h[d]=h[d]||{},h[d][g]=Object.assign({},i[c].style),u===i[c].end-1&&c++);return h}}})(_e);(function(){var t=Array.prototype.join,e={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},r={m:"l",M:"L"};function o(w,F,P,I,H,S,_,O,j,V,z){var X=D.util.cos(w),q=D.util.sin(w),ae=D.util.cos(F),$=D.util.sin(F),U=P*H*ae-I*S*$+_,te=I*H*ae+P*S*$+O,ee=V+j*(-P*H*q-I*S*X),Q=z+j*(-I*H*q+P*S*X),ne=U+j*(P*H*$+I*S*ae),ce=te+j*(I*H*$-P*S*ae);return["C",ee,Q,ne,ce,U,te]}function n(w,F,P,I,H,S,_){var O=Math.PI,j=_*O/180,V=D.util.sin(j),z=D.util.cos(j),X=0,q=0;P=Math.abs(P),I=Math.abs(I);var ae=-z*w*.5-V*F*.5,$=-z*F*.5+V*w*.5,U=P*P,te=I*I,ee=$*$,Q=ae*ae,ne=U*te-U*ee-te*Q,ce=0;if(ne<0){var Ee=Math.sqrt(1-ne/(U*te));P*=Ee,I*=Ee}else ce=(H===S?-1:1)*Math.sqrt(ne/(U*ee+te*Q));var we=ce*P*$/I,re=-ce*I*ae/P,ye=z*we-V*re+w*.5,Te=V*we+z*re+F*.5,Be=s(1,0,(ae-we)/P,($-re)/I),Ue=s((ae-we)/P,($-re)/I,(-ae-we)/P,(-$-re)/I);S===0&&Ue>0?Ue-=2*O:S===1&&Ue<0&&(Ue+=2*O);for(var Me=Math.ceil(Math.abs(Ue/O*2)),at=[],Qe=Ue/Me,Lt=8/3*Math.sin(Qe/4)*Math.sin(Qe/4)/Math.sin(Qe/2),Zt=Be+Qe,wt=0;wt<Me;wt++)at[wt]=o(Be,Zt,z,V,P,I,ye,Te,Lt,X,q),X=at[wt][5],q=at[wt][6],Be=Zt,Zt+=Qe;return at}function s(w,F,P,I){var H=Math.atan2(F,w),S=Math.atan2(I,P);return S>=H?S-H:2*Math.PI-(H-S)}function i(w,F,P,I,H,S,_,O){var j;if(D.cachesBoundsOfCurve&&(j=t.call(arguments),D.boundsOfCurveCache[j]))return D.boundsOfCurveCache[j];var V=Math.sqrt,z=Math.min,X=Math.max,q=Math.abs,ae=[],$=[[],[]],U,te,ee,Q,ne,ce,Ee,we;te=6*w-12*P+6*H,U=-3*w+9*P-9*H+3*_,ee=3*P-3*w;for(var re=0;re<2;++re){if(re>0&&(te=6*F-12*I+6*S,U=-3*F+9*I-9*S+3*O,ee=3*I-3*F),q(U)<1e-12){if(q(te)<1e-12)continue;Q=-ee/te,0<Q&&Q<1&&ae.push(Q);continue}Ee=te*te-4*ee*U,!(Ee<0)&&(we=V(Ee),ne=(-te+we)/(2*U),0<ne&&ne<1&&ae.push(ne),ce=(-te-we)/(2*U),0<ce&&ce<1&&ae.push(ce))}for(var ye,Te,Be=ae.length,Ue=Be,Me;Be--;)Q=ae[Be],Me=1-Q,ye=Me*Me*Me*w+3*Me*Me*Q*P+3*Me*Q*Q*H+Q*Q*Q*_,$[0][Be]=ye,Te=Me*Me*Me*F+3*Me*Me*Q*I+3*Me*Q*Q*S+Q*Q*Q*O,$[1][Be]=Te;$[0][Ue]=w,$[1][Ue]=F,$[0][Ue+1]=_,$[1][Ue+1]=O;var at=[{x:z.apply(null,$[0]),y:z.apply(null,$[1])},{x:X.apply(null,$[0]),y:X.apply(null,$[1])}];return D.cachesBoundsOfCurve&&(D.boundsOfCurveCache[j]=at),at}function a(w,F,P){for(var I=P[1],H=P[2],S=P[3],_=P[4],O=P[5],j=P[6],V=P[7],z=n(j-w,V-F,I,H,_,O,S),X=0,q=z.length;X<q;X++)z[X][1]+=w,z[X][2]+=F,z[X][3]+=w,z[X][4]+=F,z[X][5]+=w,z[X][6]+=F;return z}function l(w){var F=0,P=0,I=w.length,H=0,S=0,_,O,j,V=[],z,X,q;for(O=0;O<I;++O){switch(j=!1,_=w[O].slice(0),_[0]){case"l":_[0]="L",_[1]+=F,_[2]+=P;case"L":F=_[1],P=_[2];break;case"h":_[1]+=F;case"H":_[0]="L",_[2]=P,F=_[1];break;case"v":_[1]+=P;case"V":_[0]="L",P=_[1],_[1]=F,_[2]=P;break;case"m":_[0]="M",_[1]+=F,_[2]+=P;case"M":F=_[1],P=_[2],H=_[1],S=_[2];break;case"c":_[0]="C",_[1]+=F,_[2]+=P,_[3]+=F,_[4]+=P,_[5]+=F,_[6]+=P;case"C":X=_[3],q=_[4],F=_[5],P=_[6];break;case"s":_[0]="S",_[1]+=F,_[2]+=P,_[3]+=F,_[4]+=P;case"S":z==="C"?(X=2*F-X,q=2*P-q):(X=F,q=P),F=_[3],P=_[4],_[0]="C",_[5]=_[3],_[6]=_[4],_[3]=_[1],_[4]=_[2],_[1]=X,_[2]=q,X=_[3],q=_[4];break;case"q":_[0]="Q",_[1]+=F,_[2]+=P,_[3]+=F,_[4]+=P;case"Q":X=_[1],q=_[2],F=_[3],P=_[4];break;case"t":_[0]="T",_[1]+=F,_[2]+=P;case"T":z==="Q"?(X=2*F-X,q=2*P-q):(X=F,q=P),_[0]="Q",F=_[1],P=_[2],_[1]=X,_[2]=q,_[3]=F,_[4]=P;break;case"a":_[0]="A",_[6]+=F,_[7]+=P;case"A":j=!0,V=V.concat(a(F,P,_)),F=_[6],P=_[7];break;case"z":case"Z":F=H,P=S;break;default:}j||V.push(_),z=_[0]}return V}function u(w,F,P,I){return Math.sqrt((P-w)*(P-w)+(I-F)*(I-F))}function c(w){return w*w*w}function h(w){return 3*w*w*(1-w)}function d(w){return 3*w*(1-w)*(1-w)}function g(w){return(1-w)*(1-w)*(1-w)}function m(w,F,P,I,H,S,_,O){return function(j){var V=c(j),z=h(j),X=d(j),q=g(j);return{x:_*V+H*z+P*X+w*q,y:O*V+S*z+I*X+F*q}}}function y(w,F,P,I,H,S,_,O){return function(j){var V=1-j,z=3*V*V*(P-w)+6*V*j*(H-P)+3*j*j*(_-H),X=3*V*V*(I-F)+6*V*j*(S-I)+3*j*j*(O-S);return Math.atan2(X,z)}}function C(w){return w*w}function b(w){return 2*w*(1-w)}function k(w){return(1-w)*(1-w)}function L(w,F,P,I,H,S){return function(_){var O=C(_),j=b(_),V=k(_);return{x:H*O+P*j+w*V,y:S*O+I*j+F*V}}}function N(w,F,P,I,H,S){return function(_){var O=1-_,j=2*O*(P-w)+2*_*(H-P),V=2*O*(I-F)+2*_*(S-I);return Math.atan2(V,j)}}function M(w,F,P){var I={x:F,y:P},H,S=0,_;for(_=1;_<=100;_+=1)H=w(_/100),S+=u(I.x,I.y,H.x,H.y),I=H;return S}function W(w,F){for(var P=0,I=0,H=w.iterator,S={x:w.x,y:w.y},_,O,j=.01,V=w.angleFinder,z;I<F&&j>1e-4;)_=H(P),z=P,O=u(S.x,S.y,_.x,_.y),O+I>F?(P-=j,j/=2):(S=_,P+=j,I+=O);return _.angle=V(z),_}function Y(w){for(var F=0,P=w.length,I,H=0,S=0,_=0,O=0,j=[],V,z,X,q=0;q<P;q++){switch(I=w[q],z={x:H,y:S,command:I[0]},I[0]){case"M":z.length=0,_=H=I[1],O=S=I[2];break;case"L":z.length=u(H,S,I[1],I[2]),H=I[1],S=I[2];break;case"C":V=m(H,S,I[1],I[2],I[3],I[4],I[5],I[6]),X=y(H,S,I[1],I[2],I[3],I[4],I[5],I[6]),z.iterator=V,z.angleFinder=X,z.length=M(V,H,S),H=I[5],S=I[6];break;case"Q":V=L(H,S,I[1],I[2],I[3],I[4]),X=N(H,S,I[1],I[2],I[3],I[4]),z.iterator=V,z.angleFinder=X,z.length=M(V,H,S),H=I[3],S=I[4];break;case"Z":case"z":z.destX=_,z.destY=O,z.length=u(H,S,_,O),H=_,S=O;break}F+=z.length,j.push(z)}return j.push({length:F,x:H,y:S}),j}function J(w,F,P){P||(P=Y(w));for(var I=0;F-P[I].length>0&&I<P.length-2;)F-=P[I].length,I++;var H=P[I],S=F/H.length,_=H.command,O=w[I],j;switch(_){case"M":return{x:H.x,y:H.y,angle:0};case"Z":case"z":return j=new D.Point(H.x,H.y).lerp(new D.Point(H.destX,H.destY),S),j.angle=Math.atan2(H.destY-H.y,H.destX-H.x),j;case"L":return j=new D.Point(H.x,H.y).lerp(new D.Point(O[1],O[2]),S),j.angle=Math.atan2(O[2]-H.y,O[1]-H.x),j;case"C":return W(H,F);case"Q":return W(H,F)}}function oe(w){var F=[],P=[],I,H,S=D.rePathCommand,_="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",O="("+_+")"+D.commaWsp,j="([01])"+D.commaWsp+"?",V=O+"?"+O+"?"+O+j+j+O+"?("+_+")",z=new RegExp(V,"g"),X,q,ae;if(!w||!w.match)return F;ae=w.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var $=0,U,te=ae.length;$<te;$++){I=ae[$],q=I.slice(1).trim(),P.length=0;var ee=I.charAt(0);if(U=[ee],ee.toLowerCase()==="a")for(var Q;Q=z.exec(q);)for(var ne=1;ne<Q.length;ne++)P.push(Q[ne]);else for(;X=S.exec(q);)P.push(X[0]);for(var ne=0,ce=P.length;ne<ce;ne++)H=parseFloat(P[ne]),isNaN(H)||U.push(H);var Ee=e[ee.toLowerCase()],we=r[ee]||ee;if(U.length-1>Ee)for(var re=1,ye=U.length;re<ye;re+=Ee)F.push([ee].concat(U.slice(re,re+Ee))),ee=we;else F.push(U)}return F}function pe(w,F){var P=[],I,H=new D.Point(w[0].x,w[0].y),S=new D.Point(w[1].x,w[1].y),_=w.length,O=1,j=0,V=_>2;for(F=F||0,V&&(O=w[2].x<S.x?-1:w[2].x===S.x?0:1,j=w[2].y<S.y?-1:w[2].y===S.y?0:1),P.push(["M",H.x-O*F,H.y-j*F]),I=1;I<_;I++){if(!H.eq(S)){var z=H.midPointFrom(S);P.push(["Q",H.x,H.y,z.x,z.y])}H=w[I],I+1<w.length&&(S=w[I+1])}return V&&(O=H.x>w[I-2].x?1:H.x===w[I-2].x?0:-1,j=H.y>w[I-2].y?1:H.y===w[I-2].y?0:-1),P.push(["L",H.x+O*F,H.y+j*F]),P}function le(w,F,P){return P&&(F=D.util.multiplyTransformMatrices(F,[1,0,0,1,-P.x,-P.y])),w.map(function(I){for(var H=I.slice(0),S={},_=1;_<I.length-1;_+=2)S.x=I[_],S.y=I[_+1],S=D.util.transformPoint(S,F),H[_]=S.x,H[_+1]=S.y;return H})}D.util.joinPath=function(w){return w.map(function(F){return F.join(" ")}).join(" ")},D.util.parsePath=oe,D.util.makePathSimpler=l,D.util.getSmoothPathFromPoints=pe,D.util.getPathSegmentsInfo=Y,D.util.getBoundsOfCurve=i,D.util.getPointOnPath=J,D.util.transformPath=le})();(function(){var t=Array.prototype.slice;function e(i,a){for(var l=t.call(arguments,2),u=[],c=0,h=i.length;c<h;c++)u[c]=l.length?i[c][a].apply(i[c],l):i[c][a].call(i[c]);return u}function r(i,a){return s(i,a,function(l,u){return l>=u})}function o(i,a){return s(i,a,function(l,u){return l<u})}function n(i,a){for(var l=i.length;l--;)i[l]=a;return i}function s(i,a,l){if(!(!i||i.length===0)){var u=i.length-1,c=a?i[u][a]:i[u];if(a)for(;u--;)l(i[u][a],c)&&(c=i[u][a]);else for(;u--;)l(i[u],c)&&(c=i[u]);return c}}D.util.array={fill:n,invoke:e,min:o,max:r}})();(function(){function t(r,o,n){if(n)if(!D.isLikelyNode&&o instanceof Element)r=o;else if(o instanceof Array){r=[];for(var s=0,i=o.length;s<i;s++)r[s]=t({},o[s],n)}else if(o&&typeof o=="object")for(var a in o)a==="canvas"||a==="group"?r[a]=null:o.hasOwnProperty(a)&&(r[a]=t({},o[a],n));else r=o;else for(var a in o)r[a]=o[a];return r}function e(r,o){return t({},r,o)}D.util.object={extend:t,clone:e},D.util.object.extend(D.util,D.Observable)})();(function(){function t(s){return s.replace(/-+(.)?/g,function(i,a){return a?a.toUpperCase():""})}function e(s,i){return s.charAt(0).toUpperCase()+(i?s.slice(1):s.slice(1).toLowerCase())}function r(s){return s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function o(s){var i=0,a,l=[];for(i=0,a;i<s.length;i++)(a=n(s,i))!==!1&&l.push(a);return l}function n(s,i){var a=s.charCodeAt(i);if(isNaN(a))return"";if(a<55296||a>57343)return s.charAt(i);if(55296<=a&&a<=56319){if(s.length<=i+1)throw"High surrogate without following low surrogate";var l=s.charCodeAt(i+1);if(56320>l||l>57343)throw"High surrogate without following low surrogate";return s.charAt(i)+s.charAt(i+1)}if(i===0)throw"Low surrogate without preceding high surrogate";var u=s.charCodeAt(i-1);if(55296>u||u>56319)throw"Low surrogate without preceding high surrogate";return!1}D.util.string={camelize:t,capitalize:e,escapeXml:r,graphemeSplit:o}})();(function(){var t=Array.prototype.slice,e=function(){},r=function(){for(var a in{toString:1})if(a==="toString")return!1;return!0}(),o=function(a,l,u){for(var c in l)c in a.prototype&&typeof a.prototype[c]=="function"&&(l[c]+"").indexOf("callSuper")>-1?a.prototype[c]=function(h){return function(){var d=this.constructor.superclass;this.constructor.superclass=u;var g=l[h].apply(this,arguments);if(this.constructor.superclass=d,h!=="initialize")return g}}(c):a.prototype[c]=l[c],r&&(l.toString!==Object.prototype.toString&&(a.prototype.toString=l.toString),l.valueOf!==Object.prototype.valueOf&&(a.prototype.valueOf=l.valueOf))};function n(){}function s(a){for(var l=null,u=this;u.constructor.superclass;){var c=u.constructor.superclass.prototype[a];if(u[a]!==c){l=c;break}u=u.constructor.superclass.prototype}return l?arguments.length>1?l.apply(this,t.call(arguments,1)):l.call(this):console.log("tried to callSuper "+a+", method not found in prototype chain",this)}function i(){var a=null,l=t.call(arguments,0);typeof l[0]=="function"&&(a=l.shift());function u(){this.initialize.apply(this,arguments)}u.superclass=a,u.subclasses=[],a&&(n.prototype=a.prototype,u.prototype=new n,a.subclasses.push(u));for(var c=0,h=l.length;c<h;c++)o(u,l[c],a);return u.prototype.initialize||(u.prototype.initialize=e),u.prototype.constructor=u,u.prototype.callSuper=s,u}D.util.createClass=i})();(function(){var t=!!D.document.createElement("div").attachEvent,e=["touchstart","touchmove","touchend"];D.util.addListener=function(o,n,s,i){o&&o.addEventListener(n,s,t?!1:i)},D.util.removeListener=function(o,n,s,i){o&&o.removeEventListener(n,s,t?!1:i)};function r(o){var n=o.changedTouches;return n&&n[0]?n[0]:o}D.util.getPointer=function(o){var n=o.target,s=D.util.getScrollLeftTop(n),i=r(o);return{x:i.clientX+s.left,y:i.clientY+s.top}},D.util.isTouchEvent=function(o){return e.indexOf(o.type)>-1||o.pointerType==="touch"}})();(function(){function t(i,a){var l=i.style;if(!l)return i;if(typeof a=="string")return i.style.cssText+=";"+a,a.indexOf("opacity")>-1?s(i,a.match(/opacity:\s*(\d?\.?\d*)/)[1]):i;for(var u in a)if(u==="opacity")s(i,a[u]);else{var c=u==="float"||u==="cssFloat"?typeof l.styleFloat>"u"?"cssFloat":"styleFloat":u;l.setProperty(c,a[u])}return i}var e=D.document.createElement("div"),r=typeof e.style.opacity=="string",o=typeof e.style.filter=="string",n=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,s=function(i){return i};r?s=function(i,a){return i.style.opacity=a,i}:o&&(s=function(i,a){var l=i.style;return i.currentStyle&&!i.currentStyle.hasLayout&&(l.zoom=1),n.test(l.filter)?(a=a>=.9999?"":"alpha(opacity="+a*100+")",l.filter=l.filter.replace(n,a)):l.filter+=" alpha(opacity="+a*100+")",i}),D.util.setStyle=t})();(function(){var t=Array.prototype.slice;function e(g){return typeof g=="string"?D.document.getElementById(g):g}var r,o=function(g){return t.call(g,0)};try{r=o(D.document.childNodes)instanceof Array}catch{}r||(o=function(g){for(var m=new Array(g.length),y=g.length;y--;)m[y]=g[y];return m});function n(g,m){var y=D.document.createElement(g);for(var C in m)C==="class"?y.className=m[C]:C==="for"?y.htmlFor=m[C]:y.setAttribute(C,m[C]);return y}function s(g,m){g&&(" "+g.className+" ").indexOf(" "+m+" ")===-1&&(g.className+=(g.className?" ":"")+m)}function i(g,m,y){return typeof m=="string"&&(m=n(m,y)),g.parentNode&&g.parentNode.replaceChild(m,g),m.appendChild(g),m}function a(g){for(var m=0,y=0,C=D.document.documentElement,b=D.document.body||{scrollLeft:0,scrollTop:0};g&&(g.parentNode||g.host)&&(g=g.parentNode||g.host,g===D.document?(m=b.scrollLeft||C.scrollLeft||0,y=b.scrollTop||C.scrollTop||0):(m+=g.scrollLeft||0,y+=g.scrollTop||0),!(g.nodeType===1&&g.style.position==="fixed")););return{left:m,top:y}}function l(g){var m,y=g&&g.ownerDocument,C={left:0,top:0},b={left:0,top:0},k,L={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!y)return b;for(var N in L)b[L[N]]+=parseInt(u(g,N),10)||0;return m=y.documentElement,typeof g.getBoundingClientRect<"u"&&(C=g.getBoundingClientRect()),k=a(g),{left:C.left+k.left-(m.clientLeft||0)+b.left,top:C.top+k.top-(m.clientTop||0)+b.top}}var u;D.document.defaultView&&D.document.defaultView.getComputedStyle?u=function(g,m){var y=D.document.defaultView.getComputedStyle(g,null);return y?y[m]:void 0}:u=function(g,m){var y=g.style[m];return!y&&g.currentStyle&&(y=g.currentStyle[m]),y},function(){var g=D.document.documentElement.style,m="userSelect"in g?"userSelect":"MozUserSelect"in g?"MozUserSelect":"WebkitUserSelect"in g?"WebkitUserSelect":"KhtmlUserSelect"in g?"KhtmlUserSelect":"";function y(b){return typeof b.onselectstart<"u"&&(b.onselectstart=D.util.falseFunction),m?b.style[m]="none":typeof b.unselectable=="string"&&(b.unselectable="on"),b}function C(b){return typeof b.onselectstart<"u"&&(b.onselectstart=null),m?b.style[m]="":typeof b.unselectable=="string"&&(b.unselectable=""),b}D.util.makeElementUnselectable=y,D.util.makeElementSelectable=C}();function c(g){var m=D.jsdomImplForWrapper(g);return m._canvas||m._image}function h(g){if(D.isLikelyNode){var m=D.jsdomImplForWrapper(g);m&&(m._image=null,m._canvas=null,m._currentSrc=null,m._attributes=null,m._classList=null)}}function d(g,m){g.imageSmoothingEnabled=g.imageSmoothingEnabled||g.webkitImageSmoothingEnabled||g.mozImageSmoothingEnabled||g.msImageSmoothingEnabled||g.oImageSmoothingEnabled,g.imageSmoothingEnabled=m}D.util.setImageSmoothing=d,D.util.getById=e,D.util.toArray=o,D.util.addClass=s,D.util.makeElement=n,D.util.wrapElement=i,D.util.getScrollLeftTop=a,D.util.getElementOffset=l,D.util.getNodeCanvas=c,D.util.cleanUpJsdomNode=h})();(function(){function t(o,n){return o+(/\?/.test(o)?"&":"?")+n}function e(){}function r(o,n){n||(n={});var s=n.method?n.method.toUpperCase():"GET",i=n.onComplete||function(){},a=new D.window.XMLHttpRequest,l=n.body||n.parameters;return a.onreadystatechange=function(){a.readyState===4&&(i(a),a.onreadystatechange=e)},s==="GET"&&(l=null,typeof n.parameters=="string"&&(o=t(o,n.parameters))),a.open(s,o,!0),(s==="POST"||s==="PUT")&&a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(l),a}D.util.request=r})();D.log=console.log;D.warn=console.warn;(function(){var t=D.util.object.extend,e=D.util.object.clone,r=[];D.util.object.extend(r,{cancelAll:function(){var c=this.splice(0);return c.forEach(function(h){h.cancel()}),c},cancelByCanvas:function(c){if(!c)return[];var h=this.filter(function(d){return typeof d.target=="object"&&d.target.canvas===c});return h.forEach(function(d){d.cancel()}),h},cancelByTarget:function(c){var h=this.findAnimationsByTarget(c);return h.forEach(function(d){d.cancel()}),h},findAnimationIndex:function(c){return this.indexOf(this.findAnimation(c))},findAnimation:function(c){return this.find(function(h){return h.cancel===c})},findAnimationsByTarget:function(c){return c?this.filter(function(h){return h.target===c}):[]}});function o(){return!1}function n(c,h,d,g){return-d*Math.cos(c/g*(Math.PI/2))+d+h}function s(c){c||(c={});var h=!1,d,g=function(){var m=D.runningAnimations.indexOf(d);return m>-1&&D.runningAnimations.splice(m,1)[0]};return d=t(e(c),{cancel:function(){return h=!0,g()},currentValue:"startValue"in c?c.startValue:0,completionRate:0,durationRate:0}),D.runningAnimations.push(d),l(function(m){var y=m||+new Date,C=c.duration||500,b=y+C,k,L=c.onChange||o,N=c.abort||o,M=c.onComplete||o,W=c.easing||n,Y="startValue"in c?c.startValue.length>0:!1,J="startValue"in c?c.startValue:0,oe="endValue"in c?c.endValue:100,pe=c.byValue||(Y?J.map(function(le,w){return oe[w]-J[w]}):oe-J);c.onStart&&c.onStart(),function le(w){k=w||+new Date;var F=k>b?C:k-y,P=F/C,I=Y?J.map(function(S,_){return W(F,J[_],pe[_],C)}):W(F,J,pe,C),H=Math.abs(Y?(I[0]-J[0])/pe[0]:(I-J)/pe);if(d.currentValue=Y?I.slice():I,d.completionRate=H,d.durationRate=P,!h){if(N(I,H,P)){g();return}if(k>b){d.currentValue=Y?oe.slice():oe,d.completionRate=1,d.durationRate=1,L(Y?oe.slice():oe,1,1),M(oe,1,1),g();return}else L(I,H,P),l(le)}}(y)}),d.cancel}var i=D.window.requestAnimationFrame||D.window.webkitRequestAnimationFrame||D.window.mozRequestAnimationFrame||D.window.oRequestAnimationFrame||D.window.msRequestAnimationFrame||function(c){return D.window.setTimeout(c,1e3/60)},a=D.window.cancelAnimationFrame||D.window.clearTimeout;function l(){return i.apply(D.window,arguments)}function u(){return a.apply(D.window,arguments)}D.util.animate=s,D.util.requestAnimFrame=l,D.util.cancelAnimFrame=u,D.runningAnimations=r})();(function(){function t(r,o,n){var s="rgba("+parseInt(r[0]+n*(o[0]-r[0]),10)+","+parseInt(r[1]+n*(o[1]-r[1]),10)+","+parseInt(r[2]+n*(o[2]-r[2]),10);return s+=","+(r&&o?parseFloat(r[3]+n*(o[3]-r[3])):1),s+=")",s}function e(r,o,n,s){var i=new D.Color(r).getSource(),a=new D.Color(o).getSource(),l=s.onComplete,u=s.onChange;return s=s||{},D.util.animate(D.util.object.extend(s,{duration:n||500,startValue:i,endValue:a,byValue:a,easing:function(c,h,d,g){var m=s.colorEasing?s.colorEasing(c,g):1-Math.cos(c/g*(Math.PI/2));return t(h,d,m)},onComplete:function(c,h,d){if(l)return l(t(a,a,0),h,d)},onChange:function(c,h,d){if(u){if(Array.isArray(c))return u(t(c,c,0),h,d);u(c,h,d)}}}))}D.util.animateColor=e})();(function(){function t(w,F,P,I){return w<Math.abs(F)?(w=F,I=P/4):F===0&&w===0?I=P/(2*Math.PI)*Math.asin(1):I=P/(2*Math.PI)*Math.asin(F/w),{a:w,c:F,p:P,s:I}}function e(w,F,P){return w.a*Math.pow(2,10*(F-=1))*Math.sin((F*P-w.s)*(2*Math.PI)/w.p)}function r(w,F,P,I){return P*((w=w/I-1)*w*w+1)+F}function o(w,F,P,I){return w/=I/2,w<1?P/2*w*w*w+F:P/2*((w-=2)*w*w+2)+F}function n(w,F,P,I){return P*(w/=I)*w*w*w+F}function s(w,F,P,I){return-P*((w=w/I-1)*w*w*w-1)+F}function i(w,F,P,I){return w/=I/2,w<1?P/2*w*w*w*w+F:-P/2*((w-=2)*w*w*w-2)+F}function a(w,F,P,I){return P*(w/=I)*w*w*w*w+F}function l(w,F,P,I){return P*((w=w/I-1)*w*w*w*w+1)+F}function u(w,F,P,I){return w/=I/2,w<1?P/2*w*w*w*w*w+F:P/2*((w-=2)*w*w*w*w+2)+F}function c(w,F,P,I){return-P*Math.cos(w/I*(Math.PI/2))+P+F}function h(w,F,P,I){return P*Math.sin(w/I*(Math.PI/2))+F}function d(w,F,P,I){return-P/2*(Math.cos(Math.PI*w/I)-1)+F}function g(w,F,P,I){return w===0?F:P*Math.pow(2,10*(w/I-1))+F}function m(w,F,P,I){return w===I?F+P:P*(-Math.pow(2,-10*w/I)+1)+F}function y(w,F,P,I){return w===0?F:w===I?F+P:(w/=I/2,w<1?P/2*Math.pow(2,10*(w-1))+F:P/2*(-Math.pow(2,-10*--w)+2)+F)}function C(w,F,P,I){return-P*(Math.sqrt(1-(w/=I)*w)-1)+F}function b(w,F,P,I){return P*Math.sqrt(1-(w=w/I-1)*w)+F}function k(w,F,P,I){return w/=I/2,w<1?-P/2*(Math.sqrt(1-w*w)-1)+F:P/2*(Math.sqrt(1-(w-=2)*w)+1)+F}function L(w,F,P,I){var H=1.70158,S=0,_=P;if(w===0)return F;if(w/=I,w===1)return F+P;S||(S=I*.3);var O=t(_,P,S,H);return-e(O,w,I)+F}function N(w,F,P,I){var H=1.70158,S=0,_=P;if(w===0)return F;if(w/=I,w===1)return F+P;S||(S=I*.3);var O=t(_,P,S,H);return O.a*Math.pow(2,-10*w)*Math.sin((w*I-O.s)*(2*Math.PI)/O.p)+O.c+F}function M(w,F,P,I){var H=1.70158,S=0,_=P;if(w===0)return F;if(w/=I/2,w===2)return F+P;S||(S=I*(.3*1.5));var O=t(_,P,S,H);return w<1?-.5*e(O,w,I)+F:O.a*Math.pow(2,-10*(w-=1))*Math.sin((w*I-O.s)*(2*Math.PI)/O.p)*.5+O.c+F}function W(w,F,P,I,H){return H===void 0&&(H=1.70158),P*(w/=I)*w*((H+1)*w-H)+F}function Y(w,F,P,I,H){return H===void 0&&(H=1.70158),P*((w=w/I-1)*w*((H+1)*w+H)+1)+F}function J(w,F,P,I,H){return H===void 0&&(H=1.70158),w/=I/2,w<1?P/2*(w*w*(((H*=1.525)+1)*w-H))+F:P/2*((w-=2)*w*(((H*=1.525)+1)*w+H)+2)+F}function oe(w,F,P,I){return P-pe(I-w,0,P,I)+F}function pe(w,F,P,I){return(w/=I)<1/2.75?P*(7.5625*w*w)+F:w<2/2.75?P*(7.5625*(w-=1.5/2.75)*w+.75)+F:w<2.5/2.75?P*(7.5625*(w-=2.25/2.75)*w+.9375)+F:P*(7.5625*(w-=2.625/2.75)*w+.984375)+F}function le(w,F,P,I){return w<I/2?oe(w*2,0,P,I)*.5+F:pe(w*2-I,0,P,I)*.5+P*.5+F}D.util.ease={easeInQuad:function(w,F,P,I){return P*(w/=I)*w+F},easeOutQuad:function(w,F,P,I){return-P*(w/=I)*(w-2)+F},easeInOutQuad:function(w,F,P,I){return w/=I/2,w<1?P/2*w*w+F:-P/2*(--w*(w-2)-1)+F},easeInCubic:function(w,F,P,I){return P*(w/=I)*w*w+F},easeOutCubic:r,easeInOutCubic:o,easeInQuart:n,easeOutQuart:s,easeInOutQuart:i,easeInQuint:a,easeOutQuint:l,easeInOutQuint:u,easeInSine:c,easeOutSine:h,easeInOutSine:d,easeInExpo:g,easeOutExpo:m,easeInOutExpo:y,easeInCirc:C,easeOutCirc:b,easeInOutCirc:k,easeInElastic:L,easeOutElastic:N,easeInOutElastic:M,easeInBack:W,easeOutBack:Y,easeInOutBack:J,easeInBounce:oe,easeOutBounce:pe,easeInOutBounce:le}})();(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,o=e.util.object.clone,n=e.util.toFixed,s=e.util.parseUnit,i=e.util.multiplyTransformMatrices,a=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],l=["symbol","image","marker","pattern","view","svg"],u=["pattern","defs","symbol","metadata","clipPath","mask","desc"],c=["symbol","g","a","svg","clipPath","defs"],h={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},d={stroke:"strokeOpacity",fill:"fillOpacity"},g="font-size",m="clip-path";e.svgValidTagNamesRegEx=b(a),e.svgViewBoxElementsRegEx=b(l),e.svgInvalidAncestorsRegEx=b(u),e.svgValidParentsRegEx=b(c),e.cssRules={},e.gradientDefs={},e.clipPaths={};function y(S){return S in h?h[S]:S}function C(S,_,O,j){var V=Array.isArray(_),z;if((S==="fill"||S==="stroke")&&_==="none")_="";else{if(S==="strokeUniform")return _==="non-scaling-stroke";if(S==="strokeDashArray")_==="none"?_=null:_=_.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(S==="transformMatrix")O&&O.transformMatrix?_=i(O.transformMatrix,e.parseTransformAttribute(_)):_=e.parseTransformAttribute(_);else if(S==="visible")_=_!=="none"&&_!=="hidden",O&&O.visible===!1&&(_=!1);else if(S==="opacity")_=parseFloat(_),O&&typeof O.opacity<"u"&&(_*=O.opacity);else if(S==="textAnchor")_=_==="start"?"left":_==="end"?"right":"center";else if(S==="charSpacing")z=s(_,j)/j*1e3;else if(S==="paintFirst"){var X=_.indexOf("fill"),q=_.indexOf("stroke"),_="fill";(X>-1&&q>-1&&q<X||X===-1&&q>-1)&&(_="stroke")}else{if(S==="href"||S==="xlink:href"||S==="font")return _;if(S==="imageSmoothing")return _==="optimizeQuality";z=V?_.map(s):s(_,j)}}return!V&&isNaN(z)?_:z}function b(S){return new RegExp("^("+S.join("|")+")\\b","i")}function k(S){for(var _ in d)if(!(typeof S[d[_]]>"u"||S[_]==="")){if(typeof S[_]>"u"){if(!e.Object.prototype[_])continue;S[_]=e.Object.prototype[_]}if(S[_].indexOf("url(")!==0){var O=new e.Color(S[_]);S[_]=O.setAlpha(n(O.getAlpha()*S[d[_]],2)).toRgba()}}return S}function L(S,_){var O,j=[],V,z,X;for(z=0,X=_.length;z<X;z++)O=_[z],V=S.getElementsByTagName(O),j=j.concat(Array.prototype.slice.call(V));return j}e.parseTransformAttribute=function(){function S(re,ye){var Te=e.util.cos(ye[0]),Be=e.util.sin(ye[0]),Ue=0,Me=0;ye.length===3&&(Ue=ye[1],Me=ye[2]),re[0]=Te,re[1]=Be,re[2]=-Be,re[3]=Te,re[4]=Ue-(Te*Ue-Be*Me),re[5]=Me-(Be*Ue+Te*Me)}function _(re,ye){var Te=ye[0],Be=ye.length===2?ye[1]:ye[0];re[0]=Te,re[3]=Be}function O(re,ye,Te){re[Te]=Math.tan(e.util.degreesToRadians(ye[0]))}function j(re,ye){re[4]=ye[0],ye.length===2&&(re[5]=ye[1])}var V=e.iMatrix,z=e.reNum,X=e.commaWsp,q="(?:(skewX)\\s*\\(\\s*("+z+")\\s*\\))",ae="(?:(skewY)\\s*\\(\\s*("+z+")\\s*\\))",$="(?:(rotate)\\s*\\(\\s*("+z+")(?:"+X+"("+z+")"+X+"("+z+"))?\\s*\\))",U="(?:(scale)\\s*\\(\\s*("+z+")(?:"+X+"("+z+"))?\\s*\\))",te="(?:(translate)\\s*\\(\\s*("+z+")(?:"+X+"("+z+"))?\\s*\\))",ee="(?:(matrix)\\s*\\(\\s*("+z+")"+X+"("+z+")"+X+"("+z+")"+X+"("+z+")"+X+"("+z+")"+X+"("+z+")\\s*\\))",Q="(?:"+ee+"|"+te+"|"+U+"|"+$+"|"+q+"|"+ae+")",ne="(?:"+Q+"(?:"+X+"*"+Q+")*)",ce="^\\s*(?:"+ne+"?)\\s*$",Ee=new RegExp(ce),we=new RegExp(Q,"g");return function(re){var ye=V.concat(),Te=[];if(!re||re&&!Ee.test(re))return ye;re.replace(we,function(Ue){var Me=new RegExp(Q).exec(Ue).filter(function(Lt){return!!Lt}),at=Me[1],Qe=Me.slice(2).map(parseFloat);switch(at){case"translate":j(ye,Qe);break;case"rotate":Qe[0]=e.util.degreesToRadians(Qe[0]),S(ye,Qe);break;case"scale":_(ye,Qe);break;case"skewX":O(ye,Qe,2);break;case"skewY":O(ye,Qe,1);break;case"matrix":ye=Qe;break}Te.push(ye.concat()),ye=V.concat()});for(var Be=Te[0];Te.length>1;)Te.shift(),Be=e.util.multiplyTransformMatrices(Be,Te[0]);return Be}}();function N(S,_){var O,j;S.replace(/;\s*$/,"").split(";").forEach(function(V){var z=V.split(":");O=z[0].trim().toLowerCase(),j=z[1].trim(),_[O]=j})}function M(S,_){var O,j;for(var V in S)typeof S[V]>"u"||(O=V.toLowerCase(),j=S[V],_[O]=j)}function W(S,_){var O={};for(var j in e.cssRules[_])if(Y(S,j.split(" ")))for(var V in e.cssRules[_][j])O[V]=e.cssRules[_][j][V];return O}function Y(S,_){var O,j=!0;return O=oe(S,_.pop()),O&&_.length&&(j=J(S,_)),O&&j&&_.length===0}function J(S,_){for(var O,j=!0;S.parentNode&&S.parentNode.nodeType===1&&_.length;)j&&(O=_.pop()),S=S.parentNode,j=oe(S,O);return _.length===0}function oe(S,_){var O=S.nodeName,j=S.getAttribute("class"),V=S.getAttribute("id"),z,X;if(z=new RegExp("^"+O,"i"),_=_.replace(z,""),V&&_.length&&(z=new RegExp("#"+V+"(?![a-zA-Z\\-]+)","i"),_=_.replace(z,"")),j&&_.length)for(j=j.split(" "),X=j.length;X--;)z=new RegExp("\\."+j[X]+"(?![a-zA-Z\\-]+)","i"),_=_.replace(z,"");return _.length===0}function pe(S,_){var O;if(S.getElementById&&(O=S.getElementById(_)),O)return O;var j,V,z,X=S.getElementsByTagName("*");for(V=0,z=X.length;V<z;V++)if(j=X[V],_===j.getAttribute("id"))return j}function le(S){for(var _=L(S,["use","svg:use"]),O=0;_.length&&O<_.length;){var j=_[O],V=j.getAttribute("xlink:href")||j.getAttribute("href");if(V===null)return;var z=V.slice(1),X=j.getAttribute("x")||0,q=j.getAttribute("y")||0,ae=pe(S,z).cloneNode(!0),$=(ae.getAttribute("transform")||"")+" translate("+X+", "+q+")",U,te=_.length,ee,Q,ne,ce,Ee=e.svgNS;if(F(ae),/^svg$/i.test(ae.nodeName)){var we=ae.ownerDocument.createElementNS(Ee,"g");for(Q=0,ne=ae.attributes,ce=ne.length;Q<ce;Q++)ee=ne.item(Q),we.setAttributeNS(Ee,ee.nodeName,ee.nodeValue);for(;ae.firstChild;)we.appendChild(ae.firstChild);ae=we}for(Q=0,ne=j.attributes,ce=ne.length;Q<ce;Q++)ee=ne.item(Q),!(ee.nodeName==="x"||ee.nodeName==="y"||ee.nodeName==="xlink:href"||ee.nodeName==="href")&&(ee.nodeName==="transform"?$=ee.nodeValue+" "+$:ae.setAttribute(ee.nodeName,ee.nodeValue));ae.setAttribute("transform",$),ae.setAttribute("instantiated_by_use","1"),ae.removeAttribute("id"),U=j.parentNode,U.replaceChild(ae,j),_.length===te&&O++}}var w=new RegExp("^\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*$");function F(S){if(!e.svgViewBoxElementsRegEx.test(S.nodeName))return{};var _=S.getAttribute("viewBox"),O=1,j=1,V=0,z=0,X,q,ae,$,U=S.getAttribute("width"),te=S.getAttribute("height"),ee=S.getAttribute("x")||0,Q=S.getAttribute("y")||0,ne=S.getAttribute("preserveAspectRatio")||"",ce=!_||!(_=_.match(w)),Ee=!U||!te||U==="100%"||te==="100%",we=ce&&Ee,re={},ye="",Te=0,Be=0;if(re.width=0,re.height=0,re.toBeParsed=we,ce&&(ee||Q)&&S.parentNode&&S.parentNode.nodeName!=="#document"&&(ye=" translate("+s(ee)+" "+s(Q)+") ",ae=(S.getAttribute("transform")||"")+ye,S.setAttribute("transform",ae),S.removeAttribute("x"),S.removeAttribute("y")),we)return re;if(ce)return re.width=s(U),re.height=s(te),re;if(V=-parseFloat(_[1]),z=-parseFloat(_[2]),X=parseFloat(_[3]),q=parseFloat(_[4]),re.minX=V,re.minY=z,re.viewBoxWidth=X,re.viewBoxHeight=q,Ee?(re.width=X,re.height=q):(re.width=s(U),re.height=s(te),O=re.width/X,j=re.height/q),ne=e.util.parsePreserveAspectRatioAttribute(ne),ne.alignX!=="none"&&(ne.meetOrSlice==="meet"&&(j=O=O>j?j:O),ne.meetOrSlice==="slice"&&(j=O=O>j?O:j),Te=re.width-X*O,Be=re.height-q*O,ne.alignX==="Mid"&&(Te/=2),ne.alignY==="Mid"&&(Be/=2),ne.alignX==="Min"&&(Te=0),ne.alignY==="Min"&&(Be=0)),O===1&&j===1&&V===0&&z===0&&ee===0&&Q===0)return re;if((ee||Q)&&S.parentNode.nodeName!=="#document"&&(ye=" translate("+s(ee)+" "+s(Q)+") "),ae=ye+" matrix("+O+" 0 0 "+j+" "+(V*O+Te)+" "+(z*j+Be)+") ",S.nodeName==="svg"){for($=S.ownerDocument.createElementNS(e.svgNS,"g");S.firstChild;)$.appendChild(S.firstChild);S.appendChild($)}else $=S,$.removeAttribute("x"),$.removeAttribute("y"),ae=$.getAttribute("transform")+ae;return $.setAttribute("transform",ae),re}function P(S,_){for(;S&&(S=S.parentNode);)if(S.nodeName&&_.test(S.nodeName.replace("svg:",""))&&!S.getAttribute("instantiated_by_use"))return!0;return!1}e.parseSVGDocument=function(S,_,O,j){if(S){le(S);var V=e.Object.__uid++,z,X,q=F(S),ae=e.util.toArray(S.getElementsByTagName("*"));if(q.crossOrigin=j&&j.crossOrigin,q.svgUid=V,ae.length===0&&e.isLikelyNode){ae=S.selectNodes('//*[name(.)!="svg"]');var $=[];for(z=0,X=ae.length;z<X;z++)$[z]=ae[z];ae=$}var U=ae.filter(function(ee){return F(ee),e.svgValidTagNamesRegEx.test(ee.nodeName.replace("svg:",""))&&!P(ee,e.svgInvalidAncestorsRegEx)});if(!U||U&&!U.length){_&&_([],{});return}var te={};ae.filter(function(ee){return ee.nodeName.replace("svg:","")==="clipPath"}).forEach(function(ee){var Q=ee.getAttribute("id");te[Q]=e.util.toArray(ee.getElementsByTagName("*")).filter(function(ne){return e.svgValidTagNamesRegEx.test(ne.nodeName.replace("svg:",""))})}),e.gradientDefs[V]=e.getGradientDefs(S),e.cssRules[V]=e.getCSSRules(S),e.clipPaths[V]=te,e.parseElements(U,function(ee,Q){_&&(_(ee,q,Q,ae),delete e.gradientDefs[V],delete e.cssRules[V],delete e.clipPaths[V])},o(q),O,j)}};function I(S,_){var O=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],j="xlink:href",V=_.getAttribute(j).slice(1),z=pe(S,V);if(z&&z.getAttribute(j)&&I(S,z),O.forEach(function(q){z&&!_.hasAttribute(q)&&z.hasAttribute(q)&&_.setAttribute(q,z.getAttribute(q))}),!_.children.length)for(var X=z.cloneNode(!0);X.firstChild;)_.appendChild(X.firstChild);_.removeAttribute(j)}var H=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+e.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+e.reNum+"))?\\s+(.*)");r(e,{parseFontDeclaration:function(S,_){var O=S.match(H);if(O){var j=O[1],V=O[3],z=O[4],X=O[5],q=O[6];j&&(_.fontStyle=j),V&&(_.fontWeight=isNaN(parseFloat(V))?V:parseFloat(V)),z&&(_.fontSize=s(z)),q&&(_.fontFamily=q),X&&(_.lineHeight=X==="normal"?1:X)}},getGradientDefs:function(S){var _=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],O=L(S,_),j,V=0,z={};for(V=O.length;V--;)j=O[V],j.getAttribute("xlink:href")&&I(S,j),z[j.getAttribute("id")]=j;return z},parseAttributes:function(S,_,O){if(S){var j,V={},z,X;typeof O>"u"&&(O=S.getAttribute("svgUid")),S.parentNode&&e.svgValidParentsRegEx.test(S.parentNode.nodeName)&&(V=e.parseAttributes(S.parentNode,_,O));var q=_.reduce(function(ne,ce){return j=S.getAttribute(ce),j&&(ne[ce]=j),ne},{}),ae=r(W(S,O),e.parseStyleAttribute(S));q=r(q,ae),ae[m]&&S.setAttribute(m,ae[m]),z=X=V.fontSize||e.Text.DEFAULT_SVG_FONT_SIZE,q[g]&&(q[g]=z=s(q[g],X));var $,U,te={};for(var ee in q)$=y(ee),U=C($,q[ee],V,z),te[$]=U;te&&te.font&&e.parseFontDeclaration(te.font,te);var Q=r(V,te);return e.svgValidParentsRegEx.test(S.nodeName)?Q:k(Q)}},parseElements:function(S,_,O,j,V){new e.ElementsParser(S,_,O,j,V).parse()},parseStyleAttribute:function(S){var _={},O=S.getAttribute("style");return O&&(typeof O=="string"?N(O,_):M(O,_)),_},parsePointsAttribute:function(S){if(!S)return null;S=S.replace(/,/g," ").trim(),S=S.split(/\s+/);var _=[],O,j;for(O=0,j=S.length;O<j;O+=2)_.push({x:parseFloat(S[O]),y:parseFloat(S[O+1])});return _},getCSSRules:function(S){var _=S.getElementsByTagName("style"),O,j,V={},z;for(O=0,j=_.length;O<j;O++){var X=_[O].textContent;X=X.replace(/\/\*[\s\S]*?\*\//g,""),X.trim()!==""&&(z=X.split("}"),z=z.filter(function(q){return q.trim()}),z.forEach(function(q){var ae=q.split("{"),$={},U=ae[1].trim(),te=U.split(";").filter(function(ce){return ce.trim()});for(O=0,j=te.length;O<j;O++){var ee=te[O].split(":"),Q=ee[0].trim(),ne=ee[1].trim();$[Q]=ne}q=ae[0].trim(),q.split(",").forEach(function(ce){ce=ce.replace(/^svg/i,"").trim(),ce!==""&&(V[ce]?e.util.object.extend(V[ce],$):V[ce]=e.util.object.clone($))})}))}return V},loadSVGFromURL:function(S,_,O,j){S=S.replace(/^\n\s*/,"").trim(),new e.util.request(S,{method:"get",onComplete:V});function V(z){var X=z.responseXML;if(!X||!X.documentElement)return _&&_(null),!1;e.parseSVGDocument(X.documentElement,function(q,ae,$,U){_&&_(q,ae,$,U)},O,j)}},loadSVGFromString:function(S,_,O,j){var V=new e.window.DOMParser,z=V.parseFromString(S.trim(),"text/xml");e.parseSVGDocument(z.documentElement,function(X,q,ae,$){_(X,q,ae,$)},O,j)}})})(_e);D.ElementsParser=function(t,e,r,o,n,s){this.elements=t,this.callback=e,this.options=r,this.reviver=o,this.svgUid=r&&r.svgUid||0,this.parsingOptions=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=s};(function(t){t.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},t.createObjects=function(){var e=this;this.elements.forEach(function(r,o){r.setAttribute("svgUid",e.svgUid),e.createObject(r,o)})},t.findTag=function(e){return D[D.util.string.capitalize(e.tagName.replace("svg:",""))]},t.createObject=function(e,r){var o=this.findTag(e);if(o&&o.fromElement)try{o.fromElement(e,this.createCallback(r,e),this.options)}catch(n){D.log(n)}else this.checkIfDone()},t.createCallback=function(e,r){var o=this;return function(n){var s;o.resolveGradient(n,r,"fill"),o.resolveGradient(n,r,"stroke"),n instanceof D.Image&&n._originalElement&&(s=n.parsePreserveAspectRatioAttribute(r)),n._removeTransformMatrix(s),o.resolveClipPath(n,r),o.reviver&&o.reviver(r,n),o.instances[e]=n,o.checkIfDone()}},t.extractPropertyDefinition=function(e,r,o){var n=e[r],s=this.regexUrl;if(s.test(n)){s.lastIndex=0;var i=s.exec(n)[1];return s.lastIndex=0,D[o][this.svgUid][i]}},t.resolveGradient=function(e,r,o){var n=this.extractPropertyDefinition(e,o,"gradientDefs");if(n){var s=r.getAttribute(o+"-opacity"),i=D.Gradient.fromElement(n,e,s,this.options);e.set(o,i)}},t.createClipPathCallback=function(e,r){return function(o){o._removeTransformMatrix(),o.fillRule=o.clipRule,r.push(o)}},t.resolveClipPath=function(e,r){var o=this.extractPropertyDefinition(e,"clipPath","clipPaths"),n,s,i,a,l,u;if(o){a=[],i=D.util.invertTransform(e.calcTransformMatrix());for(var c=o[0].parentNode,h=r;h.parentNode&&h.getAttribute("clip-path")!==e.clipPath;)h=h.parentNode;h.parentNode.appendChild(c);for(var d=0;d<o.length;d++)n=o[d],s=this.findTag(n),s.fromElement(n,this.createClipPathCallback(e,a),this.options);a.length===1?o=a[0]:o=new D.Group(a),l=D.util.multiplyTransformMatrices(i,o.calcTransformMatrix()),o.clipPath&&this.resolveClipPath(o,h);var u=D.util.qrDecompose(l);o.flipX=!1,o.flipY=!1,o.set("scaleX",u.scaleX),o.set("scaleY",u.scaleY),o.angle=u.angle,o.skewX=u.skewX,o.skewY=0,o.setPositionByOrigin({x:u.translateX,y:u.translateY},"center","center"),e.clipPath=o}else delete e.clipPath},t.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(e){return e!=null}),this.callback(this.instances,this.elements))}})(D.ElementsParser.prototype);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Point){e.warn("fabric.Point is already defined");return}e.Point=r;function r(o,n){this.x=o,this.y=n}r.prototype={type:"point",constructor:r,add:function(o){return new r(this.x+o.x,this.y+o.y)},addEquals:function(o){return this.x+=o.x,this.y+=o.y,this},scalarAdd:function(o){return new r(this.x+o,this.y+o)},scalarAddEquals:function(o){return this.x+=o,this.y+=o,this},subtract:function(o){return new r(this.x-o.x,this.y-o.y)},subtractEquals:function(o){return this.x-=o.x,this.y-=o.y,this},scalarSubtract:function(o){return new r(this.x-o,this.y-o)},scalarSubtractEquals:function(o){return this.x-=o,this.y-=o,this},multiply:function(o){return new r(this.x*o,this.y*o)},multiplyEquals:function(o){return this.x*=o,this.y*=o,this},divide:function(o){return new r(this.x/o,this.y/o)},divideEquals:function(o){return this.x/=o,this.y/=o,this},eq:function(o){return this.x===o.x&&this.y===o.y},lt:function(o){return this.x<o.x&&this.y<o.y},lte:function(o){return this.x<=o.x&&this.y<=o.y},gt:function(o){return this.x>o.x&&this.y>o.y},gte:function(o){return this.x>=o.x&&this.y>=o.y},lerp:function(o,n){return typeof n>"u"&&(n=.5),n=Math.max(Math.min(1,n),0),new r(this.x+(o.x-this.x)*n,this.y+(o.y-this.y)*n)},distanceFrom:function(o){var n=this.x-o.x,s=this.y-o.y;return Math.sqrt(n*n+s*s)},midPointFrom:function(o){return this.lerp(o)},min:function(o){return new r(Math.min(this.x,o.x),Math.min(this.y,o.y))},max:function(o){return new r(Math.max(this.x,o.x),Math.max(this.y,o.y))},toString:function(){return this.x+","+this.y},setXY:function(o,n){return this.x=o,this.y=n,this},setX:function(o){return this.x=o,this},setY:function(o){return this.y=o,this},setFromPoint:function(o){return this.x=o.x,this.y=o.y,this},swap:function(o){var n=this.x,s=this.y;this.x=o.x,this.y=o.y,o.x=n,o.y=s},clone:function(){return new r(this.x,this.y)}}})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Intersection){e.warn("fabric.Intersection is already defined");return}function r(o){this.status=o,this.points=[]}e.Intersection=r,e.Intersection.prototype={constructor:r,appendPoint:function(o){return this.points.push(o),this},appendPoints:function(o){return this.points=this.points.concat(o),this}},e.Intersection.intersectLineLine=function(o,n,s,i){var a,l=(i.x-s.x)*(o.y-s.y)-(i.y-s.y)*(o.x-s.x),u=(n.x-o.x)*(o.y-s.y)-(n.y-o.y)*(o.x-s.x),c=(i.y-s.y)*(n.x-o.x)-(i.x-s.x)*(n.y-o.y);if(c!==0){var h=l/c,d=u/c;0<=h&&h<=1&&0<=d&&d<=1?(a=new r("Intersection"),a.appendPoint(new e.Point(o.x+h*(n.x-o.x),o.y+h*(n.y-o.y)))):a=new r}else l===0||u===0?a=new r("Coincident"):a=new r("Parallel");return a},e.Intersection.intersectLinePolygon=function(o,n,s){var i=new r,a=s.length,l,u,c,h;for(h=0;h<a;h++)l=s[h],u=s[(h+1)%a],c=r.intersectLineLine(o,n,l,u),i.appendPoints(c.points);return i.points.length>0&&(i.status="Intersection"),i},e.Intersection.intersectPolygonPolygon=function(o,n){var s=new r,i=o.length,a;for(a=0;a<i;a++){var l=o[a],u=o[(a+1)%i],c=r.intersectLinePolygon(l,u,n);s.appendPoints(c.points)}return s.points.length>0&&(s.status="Intersection"),s},e.Intersection.intersectPolygonRectangle=function(o,n,s){var i=n.min(s),a=n.max(s),l=new e.Point(a.x,i.y),u=new e.Point(i.x,a.y),c=r.intersectLinePolygon(i,l,o),h=r.intersectLinePolygon(l,a,o),d=r.intersectLinePolygon(a,u,o),g=r.intersectLinePolygon(u,i,o),m=new r;return m.appendPoints(c.points),m.appendPoints(h.points),m.appendPoints(d.points),m.appendPoints(g.points),m.points.length>0&&(m.status="Intersection"),m}})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Color){e.warn("fabric.Color is already defined.");return}function r(n){n?this._tryParsingColor(n):this.setSource([0,0,0,1])}e.Color=r,e.Color.prototype={_tryParsingColor:function(n){var s;n in r.colorNameMap&&(n=r.colorNameMap[n]),n==="transparent"&&(s=[255,255,255,0]),s||(s=r.sourceFromHex(n)),s||(s=r.sourceFromRgb(n)),s||(s=r.sourceFromHsl(n)),s||(s=[0,0,0,1]),s&&this.setSource(s)},_rgbToHsl:function(n,s,i){n/=255,s/=255,i/=255;var a,l,u,c=e.util.array.max([n,s,i]),h=e.util.array.min([n,s,i]);if(u=(c+h)/2,c===h)a=l=0;else{var d=c-h;switch(l=u>.5?d/(2-c-h):d/(c+h),c){case n:a=(s-i)/d+(s<i?6:0);break;case s:a=(i-n)/d+2;break;case i:a=(n-s)/d+4;break}a/=6}return[Math.round(a*360),Math.round(l*100),Math.round(u*100)]},getSource:function(){return this._source},setSource:function(n){this._source=n},toRgb:function(){var n=this.getSource();return"rgb("+n[0]+","+n[1]+","+n[2]+")"},toRgba:function(){var n=this.getSource();return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},toHsl:function(){var n=this.getSource(),s=this._rgbToHsl(n[0],n[1],n[2]);return"hsl("+s[0]+","+s[1]+"%,"+s[2]+"%)"},toHsla:function(){var n=this.getSource(),s=this._rgbToHsl(n[0],n[1],n[2]);return"hsla("+s[0]+","+s[1]+"%,"+s[2]+"%,"+n[3]+")"},toHex:function(){var n=this.getSource(),s,i,a;return s=n[0].toString(16),s=s.length===1?"0"+s:s,i=n[1].toString(16),i=i.length===1?"0"+i:i,a=n[2].toString(16),a=a.length===1?"0"+a:a,s.toUpperCase()+i.toUpperCase()+a.toUpperCase()},toHexa:function(){var n=this.getSource(),s;return s=Math.round(n[3]*255),s=s.toString(16),s=s.length===1?"0"+s:s,this.toHex()+s.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(n){var s=this.getSource();return s[3]=n,this.setSource(s),this},toGrayscale:function(){var n=this.getSource(),s=parseInt((n[0]*.3+n[1]*.59+n[2]*.11).toFixed(0),10),i=n[3];return this.setSource([s,s,s,i]),this},toBlackWhite:function(n){var s=this.getSource(),i=(s[0]*.3+s[1]*.59+s[2]*.11).toFixed(0),a=s[3];return n=n||127,i=Number(i)<Number(n)?0:255,this.setSource([i,i,i,a]),this},overlayWith:function(n){n instanceof r||(n=new r(n));var s=[],i=this.getAlpha(),a=.5,l=this.getSource(),u=n.getSource(),c;for(c=0;c<3;c++)s.push(Math.round(l[c]*(1-a)+u[c]*a));return s[3]=i,this.setSource(s),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function o(n,s,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?n+(s-n)*6*i:i<1/2?s:i<2/3?n+(s-n)*(2/3-i)*6:n}e.Color.fromRgb=function(n){return r.fromSource(r.sourceFromRgb(n))},e.Color.sourceFromRgb=function(n){var s=n.match(r.reRGBa);if(s){var i=parseInt(s[1],10)/(/%$/.test(s[1])?100:1)*(/%$/.test(s[1])?255:1),a=parseInt(s[2],10)/(/%$/.test(s[2])?100:1)*(/%$/.test(s[2])?255:1),l=parseInt(s[3],10)/(/%$/.test(s[3])?100:1)*(/%$/.test(s[3])?255:1);return[parseInt(i,10),parseInt(a,10),parseInt(l,10),s[4]?parseFloat(s[4]):1]}},e.Color.fromRgba=r.fromRgb,e.Color.fromHsl=function(n){return r.fromSource(r.sourceFromHsl(n))},e.Color.sourceFromHsl=function(n){var s=n.match(r.reHSLa);if(s){var i=(parseFloat(s[1])%360+360)%360/360,a=parseFloat(s[2])/(/%$/.test(s[2])?100:1),l=parseFloat(s[3])/(/%$/.test(s[3])?100:1),u,c,h;if(a===0)u=c=h=l;else{var d=l<=.5?l*(a+1):l+a-l*a,g=l*2-d;u=o(g,d,i+1/3),c=o(g,d,i),h=o(g,d,i-1/3)}return[Math.round(u*255),Math.round(c*255),Math.round(h*255),s[4]?parseFloat(s[4]):1]}},e.Color.fromHsla=r.fromHsl,e.Color.fromHex=function(n){return r.fromSource(r.sourceFromHex(n))},e.Color.sourceFromHex=function(n){if(n.match(r.reHex)){var s=n.slice(n.indexOf("#")+1),i=s.length===3||s.length===4,a=s.length===8||s.length===4,l=i?s.charAt(0)+s.charAt(0):s.substring(0,2),u=i?s.charAt(1)+s.charAt(1):s.substring(2,4),c=i?s.charAt(2)+s.charAt(2):s.substring(4,6),h=a?i?s.charAt(3)+s.charAt(3):s.substring(6,8):"FF";return[parseInt(l,16),parseInt(u,16),parseInt(c,16),parseFloat((parseInt(h,16)/255).toFixed(2))]}},e.Color.fromSource=function(n){var s=new r;return s.setSource(n),s}})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=["e","se","s","sw","w","nw","n","ne","e"],o=["ns","nesw","ew","nwse"],n={},s="left",i="top",a="right",l="bottom",u="center",c={top:l,bottom:i,left:a,right:s,center:u},h=e.util.radiansToDegrees,d=Math.sign||function($){return($>0)-($<0)||+$};function g($,U){var te=$.angle+h(Math.atan2(U.y,U.x))+360;return Math.round(te%360/45)}function m($,U){var te=U.transform.target,ee=te.canvas,Q=e.util.object.clone(U);Q.target=te,ee&&ee.fire("object:"+$,Q),te.fire($,U)}function y($,U){var te=U.canvas,ee=te.uniScaleKey,Q=$[ee];return te.uniformScaling&&!Q||!te.uniformScaling&&Q}function C($){return $.originX===u&&$.originY===u}function b($,U,te){var ee=$.lockScalingX,Q=$.lockScalingY;return!!(ee&&Q||!U&&(ee||Q)&&te||ee&&U==="x"||Q&&U==="y")}function k($,U,te){var ee="not-allowed",Q=y($,te),ne="";if(U.x!==0&&U.y===0?ne="x":U.x===0&&U.y!==0&&(ne="y"),b(te,ne,Q))return ee;var ce=g(te,U);return r[ce]+"-resize"}function L($,U,te){var ee="not-allowed";if(U.x!==0&&te.lockSkewingY||U.y!==0&&te.lockSkewingX)return ee;var Q=g(te,U)%4;return o[Q]+"-resize"}function N($,U,te){return $[te.canvas.altActionKey]?n.skewCursorStyleHandler($,U,te):n.scaleCursorStyleHandler($,U,te)}function M($,U,te){var ee=$[te.canvas.altActionKey];if(U.x===0)return ee?"skewX":"scaleY";if(U.y===0)return ee?"skewY":"scaleX"}function W($,U,te){return te.lockRotation?"not-allowed":U.cursorStyle}function Y($,U,te,ee){return{e:$,transform:U,pointer:{x:te,y:ee}}}function J($){return function(U,te,ee,Q){var ne=te.target,ce=ne.getCenterPoint(),Ee=ne.translateToOriginPoint(ce,te.originX,te.originY),we=$(U,te,ee,Q);return ne.setPositionByOrigin(Ee,te.originX,te.originY),we}}function oe($,U){return function(te,ee,Q,ne){var ce=U(te,ee,Q,ne);return ce&&m($,Y(te,ee,Q,ne)),ce}}function pe($,U,te,ee,Q){var ne=$.target,ce=ne.controls[$.corner],Ee=ne.canvas.getZoom(),we=ne.padding/Ee,re=ne.toLocalPoint(new e.Point(ee,Q),U,te);return re.x>=we&&(re.x-=we),re.x<=-we&&(re.x+=we),re.y>=we&&(re.y-=we),re.y<=we&&(re.y+=we),re.x-=ce.offsetX,re.y-=ce.offsetY,re}function le($){return $.flipX!==$.flipY}function w($,U,te,ee,Q){if($[U]!==0){var ne=$._getTransformedDimensions()[ee],ce=Q/ne*$[te];$.set(te,ce)}}function F($,U,te,ee){var Q=U.target,ne=Q._getTransformedDimensions(0,Q.skewY),ce=pe(U,U.originX,U.originY,te,ee),Ee=Math.abs(ce.x*2)-ne.x,we=Q.skewX,re;Ee<2?re=0:(re=h(Math.atan2(Ee/Q.scaleX,ne.y/Q.scaleY)),U.originX===s&&U.originY===l&&(re=-re),U.originX===a&&U.originY===i&&(re=-re),le(Q)&&(re=-re));var ye=we!==re;if(ye){var Te=Q._getTransformedDimensions().y;Q.set("skewX",re),w(Q,"skewY","scaleY","y",Te)}return ye}function P($,U,te,ee){var Q=U.target,ne=Q._getTransformedDimensions(Q.skewX,0),ce=pe(U,U.originX,U.originY,te,ee),Ee=Math.abs(ce.y*2)-ne.y,we=Q.skewY,re;Ee<2?re=0:(re=h(Math.atan2(Ee/Q.scaleY,ne.x/Q.scaleX)),U.originX===s&&U.originY===l&&(re=-re),U.originX===a&&U.originY===i&&(re=-re),le(Q)&&(re=-re));var ye=we!==re;if(ye){var Te=Q._getTransformedDimensions().x;Q.set("skewY",re),w(Q,"skewX","scaleX","x",Te)}return ye}function I($,U,te,ee){var Q=U.target,ne=Q.skewX,ce,Ee=U.originY;if(Q.lockSkewingX)return!1;if(ne===0){var we=pe(U,u,u,te,ee);we.x>0?ce=s:ce=a}else ne>0&&(ce=Ee===i?s:a),ne<0&&(ce=Ee===i?a:s),le(Q)&&(ce=ce===s?a:s);U.originX=ce;var re=oe("skewing",J(F));return re($,U,te,ee)}function H($,U,te,ee){var Q=U.target,ne=Q.skewY,ce,Ee=U.originX;if(Q.lockSkewingY)return!1;if(ne===0){var we=pe(U,u,u,te,ee);we.y>0?ce=i:ce=l}else ne>0&&(ce=Ee===s?i:l),ne<0&&(ce=Ee===s?l:i),le(Q)&&(ce=ce===i?l:i);U.originY=ce;var re=oe("skewing",J(P));return re($,U,te,ee)}function S($,U,te,ee){var Q=U,ne=Q.target,ce=ne.translateToOriginPoint(ne.getCenterPoint(),Q.originX,Q.originY);if(ne.lockRotation)return!1;var Ee=Math.atan2(Q.ey-ce.y,Q.ex-ce.x),we=Math.atan2(ee-ce.y,te-ce.x),re=h(we-Ee+Q.theta),ye=!0;if(ne.snapAngle>0){var Te=ne.snapAngle,Be=ne.snapThreshold||Te,Ue=Math.ceil(re/Te)*Te,Me=Math.floor(re/Te)*Te;Math.abs(re-Me)<Be?re=Me:Math.abs(re-Ue)<Be&&(re=Ue)}return re<0&&(re=360+re),re%=360,ye=ne.angle!==re,ne.angle=re,ye}function _($,U,te,ee,Q){Q=Q||{};var ne=U.target,ce=ne.lockScalingX,Ee=ne.lockScalingY,we=Q.by,re,ye,Te,Be,Ue=y($,ne),Me=b(ne,we,Ue),at,Qe,Lt=U.gestureScale;if(Me)return!1;if(Lt)ye=U.scaleX*Lt,Te=U.scaleY*Lt;else{if(re=pe(U,U.originX,U.originY,te,ee),at=we!=="y"?d(re.x):1,Qe=we!=="x"?d(re.y):1,U.signX||(U.signX=at),U.signY||(U.signY=Qe),ne.lockScalingFlip&&(U.signX!==at||U.signY!==Qe))return!1;if(Be=ne._getTransformedDimensions(),Ue&&!we){var Zt=Math.abs(re.x)+Math.abs(re.y),wt=U.original,Zr=Math.abs(Be.x*wt.scaleX/ne.scaleX)+Math.abs(Be.y*wt.scaleY/ne.scaleY),vn=Zt/Zr;ye=wt.scaleX*vn,Te=wt.scaleY*vn}else ye=Math.abs(re.x*ne.scaleX/Be.x),Te=Math.abs(re.y*ne.scaleY/Be.y);C(U)&&(ye*=2,Te*=2),U.signX!==at&&we!=="y"&&(U.originX=c[U.originX],ye*=-1,U.signX=at),U.signY!==Qe&&we!=="x"&&(U.originY=c[U.originY],Te*=-1,U.signY=Qe)}var Pn=ne.scaleX,Dr=ne.scaleY;return we?(we==="x"&&ne.set("scaleX",ye),we==="y"&&ne.set("scaleY",Te)):(!ce&&ne.set("scaleX",ye),!Ee&&ne.set("scaleY",Te)),Pn!==ne.scaleX||Dr!==ne.scaleY}function O($,U,te,ee){return _($,U,te,ee)}function j($,U,te,ee){return _($,U,te,ee,{by:"x"})}function V($,U,te,ee){return _($,U,te,ee,{by:"y"})}function z($,U,te,ee){return $[U.target.canvas.altActionKey]?n.skewHandlerX($,U,te,ee):n.scalingY($,U,te,ee)}function X($,U,te,ee){return $[U.target.canvas.altActionKey]?n.skewHandlerY($,U,te,ee):n.scalingX($,U,te,ee)}function q($,U,te,ee){var Q=U.target,ne=pe(U,U.originX,U.originY,te,ee),ce=Q.strokeWidth/(Q.strokeUniform?Q.scaleX:1),Ee=C(U)?2:1,we=Q.width,re=Math.abs(ne.x*Ee/Q.scaleX)-ce;return Q.set("width",Math.max(re,0)),we!==re}function ae($,U,te,ee){var Q=U.target,ne=te-U.offsetX,ce=ee-U.offsetY,Ee=!Q.get("lockMovementX")&&Q.left!==ne,we=!Q.get("lockMovementY")&&Q.top!==ce;return Ee&&Q.set("left",ne),we&&Q.set("top",ce),(Ee||we)&&m("moving",Y($,U,te,ee)),Ee||we}n.scaleCursorStyleHandler=k,n.skewCursorStyleHandler=L,n.scaleSkewCursorStyleHandler=N,n.rotationWithSnapping=oe("rotating",J(S)),n.scalingEqually=oe("scaling",J(O)),n.scalingX=oe("scaling",J(j)),n.scalingY=oe("scaling",J(V)),n.scalingYOrSkewingX=z,n.scalingXOrSkewingY=X,n.changeWidth=oe("resizing",J(q)),n.skewHandlerX=I,n.skewHandlerY=H,n.dragHandler=ae,n.scaleOrSkewActionName=M,n.rotationStyleHandler=W,n.fireEvent=m,n.wrapWithFixedAnchor=J,n.wrapWithFireEvent=oe,n.getLocalPoint=pe,e.controlsUtils=n})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.degreesToRadians,o=e.controlsUtils;function n(i,a,l,u,c){u=u||{};var h=this.sizeX||u.cornerSize||c.cornerSize,d=this.sizeY||u.cornerSize||c.cornerSize,g=typeof u.transparentCorners<"u"?u.transparentCorners:c.transparentCorners,m=g?"stroke":"fill",y=!g&&(u.cornerStrokeColor||c.cornerStrokeColor),C=a,b=l,k;i.save(),i.fillStyle=u.cornerColor||c.cornerColor,i.strokeStyle=u.cornerStrokeColor||c.cornerStrokeColor,h>d?(k=h,i.scale(1,d/h),b=l*h/d):d>h?(k=d,i.scale(h/d,1),C=a*d/h):k=h,i.lineWidth=1,i.beginPath(),i.arc(C,b,k/2,0,2*Math.PI,!1),i[m](),y&&i.stroke(),i.restore()}function s(i,a,l,u,c){u=u||{};var h=this.sizeX||u.cornerSize||c.cornerSize,d=this.sizeY||u.cornerSize||c.cornerSize,g=typeof u.transparentCorners<"u"?u.transparentCorners:c.transparentCorners,m=g?"stroke":"fill",y=!g&&(u.cornerStrokeColor||c.cornerStrokeColor),C=h/2,b=d/2;i.save(),i.fillStyle=u.cornerColor||c.cornerColor,i.strokeStyle=u.cornerStrokeColor||c.cornerStrokeColor,i.lineWidth=1,i.translate(a,l),i.rotate(r(c.angle)),i[m+"Rect"](-C,-b,h,d),y&&i.strokeRect(-C,-b,h,d),i.restore()}o.renderCircleControl=n,o.renderSquareControl=s})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={});function r(o){for(var n in o)this[n]=o[n]}e.Control=r,e.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(o,n){return n.cursorStyle},getActionName:function(o,n){return n.actionName},getVisibility:function(o,n){var s=o._controlsVisibility;return s&&typeof s[n]<"u"?s[n]:this.visible},setVisibility:function(o){this.visible=o},positionHandler:function(o,n){var s=e.util.transformPoint({x:this.x*o.x+this.offsetX,y:this.y*o.y+this.offsetY},n);return s},calcCornerCoords:function(o,n,s,i,a){var l,u,c,h,d=a?this.touchSizeX:this.sizeX,g=a?this.touchSizeY:this.sizeY;if(d&&g&&d!==g){var m=Math.atan2(g,d),y=Math.sqrt(d*d+g*g)/2,C=m-e.util.degreesToRadians(o),b=Math.PI/2-m-e.util.degreesToRadians(o);l=y*e.util.cos(C),u=y*e.util.sin(C),c=y*e.util.cos(b),h=y*e.util.sin(b)}else{var k=d&&g?d:n;y=k*.7071067812;var C=e.util.degreesToRadians(45-o);l=c=y*e.util.cos(C),u=h=y*e.util.sin(C)}return{tl:{x:s-h,y:i-c},tr:{x:s+l,y:i-u},bl:{x:s-l,y:i+u},br:{x:s+h,y:i+c}}},render:function(o,n,s,i,a){switch(i=i||{},i.cornerStyle||a.cornerStyle){case"circle":e.controlsUtils.renderCircleControl.call(this,o,n,s,i,a);break;default:e.controlsUtils.renderSquareControl.call(this,o,n,s,i,a)}}}})(_e);(function(){function t(s,i){var a=s.getAttribute("style"),l=s.getAttribute("offset")||0,u,c,h,d;if(l=parseFloat(l)/(/%$/.test(l)?100:1),l=l<0?0:l>1?1:l,a){var g=a.split(/\s*;\s*/);for(g[g.length-1]===""&&g.pop(),d=g.length;d--;){var m=g[d].split(/\s*:\s*/),y=m[0].trim(),C=m[1].trim();y==="stop-color"?u=C:y==="stop-opacity"&&(h=C)}}return u||(u=s.getAttribute("stop-color")||"rgb(0,0,0)"),h||(h=s.getAttribute("stop-opacity")),u=new D.Color(u),c=u.getAlpha(),h=isNaN(parseFloat(h))?1:parseFloat(h),h*=c*i,{offset:l,color:u.toRgb(),opacity:h}}function e(s){return{x1:s.getAttribute("x1")||0,y1:s.getAttribute("y1")||0,x2:s.getAttribute("x2")||"100%",y2:s.getAttribute("y2")||0}}function r(s){return{x1:s.getAttribute("fx")||s.getAttribute("cx")||"50%",y1:s.getAttribute("fy")||s.getAttribute("cy")||"50%",r1:0,x2:s.getAttribute("cx")||"50%",y2:s.getAttribute("cy")||"50%",r2:s.getAttribute("r")||"50%"}}var o=D.util.object.clone;D.Gradient=D.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(s){s||(s={}),s.coords||(s.coords={});var i,a=this;Object.keys(s).forEach(function(l){a[l]=s[l]}),this.id?this.id+="_"+D.Object.__uid++:this.id=D.Object.__uid++,i={x1:s.coords.x1||0,y1:s.coords.y1||0,x2:s.coords.x2||0,y2:s.coords.y2||0},this.type==="radial"&&(i.r1=s.coords.r1||0,i.r2=s.coords.r2||0),this.coords=i,this.colorStops=s.colorStops.slice()},addColorStop:function(s){for(var i in s){var a=new D.Color(s[i]);this.colorStops.push({offset:parseFloat(i),color:a.toRgb(),opacity:a.getAlpha()})}return this},toObject:function(s){var i={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return D.util.populateWithProperties(this,i,s),i},toSVG:function(s,c){var a=o(this.coords,!0),l,u,c=c||{},h,d,g=o(this.colorStops,!0),m=a.r1>a.r2,y=this.gradientTransform?this.gradientTransform.concat():D.iMatrix.concat(),C=-this.offsetX,b=-this.offsetY,k=!!c.additionalTransform,L=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(g.sort(function(J,oe){return J.offset-oe.offset}),L==="objectBoundingBox"?(C/=s.width,b/=s.height):(C+=s.width/2,b+=s.height/2),s.type==="path"&&this.gradientUnits!=="percentage"&&(C-=s.pathOffset.x,b-=s.pathOffset.y),y[4]-=C,y[5]-=b,d='id="SVGID_'+this.id+'" gradientUnits="'+L+'"',d+=' gradientTransform="'+(k?c.additionalTransform+" ":"")+D.util.matrixToSVG(y)+'" ',this.type==="linear"?h=["<linearGradient ",d,' x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,`">
`]:this.type==="radial"&&(h=["<radialGradient ",d,' cx="',m?a.x1:a.x2,'" cy="',m?a.y1:a.y2,'" r="',m?a.r1:a.r2,'" fx="',m?a.x2:a.x1,'" fy="',m?a.y2:a.y1,`">
`]),this.type==="radial"){if(m)for(g=g.concat(),g.reverse(),l=0,u=g.length;l<u;l++)g[l].offset=1-g[l].offset;var N=Math.min(a.r1,a.r2);if(N>0){var M=Math.max(a.r1,a.r2),W=N/M;for(l=0,u=g.length;l<u;l++)g[l].offset+=W*(1-g[l].offset)}}for(l=0,u=g.length;l<u;l++){var Y=g[l];h.push("<stop ",'offset="',Y.offset*100+"%",'" style="stop-color:',Y.color,typeof Y.opacity<"u"?";stop-opacity: "+Y.opacity:";",`"/>
`)}return h.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),h.join("")},toLive:function(s){var i,a=D.util.object.clone(this.coords),l,u;if(this.type){for(this.type==="linear"?i=s.createLinearGradient(a.x1,a.y1,a.x2,a.y2):this.type==="radial"&&(i=s.createRadialGradient(a.x1,a.y1,a.r1,a.x2,a.y2,a.r2)),l=0,u=this.colorStops.length;l<u;l++){var c=this.colorStops[l].color,h=this.colorStops[l].opacity,d=this.colorStops[l].offset;typeof h<"u"&&(c=new D.Color(c).setAlpha(h).toRgba()),i.addColorStop(d,c)}return i}}}),D.util.object.extend(D.Gradient,{fromElement:function(s,i,a,l){var u=parseFloat(a)/(/%$/.test(a)?100:1);u=u<0?0:u>1?1:u,isNaN(u)&&(u=1);var c=s.getElementsByTagName("stop"),h,d=s.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",g=s.getAttribute("gradientTransform")||"",m=[],y,C,b=0,k=0,L;for(s.nodeName==="linearGradient"||s.nodeName==="LINEARGRADIENT"?(h="linear",y=e(s)):(h="radial",y=r(s)),C=c.length;C--;)m.push(t(c[C],u));L=D.parseTransformAttribute(g),n(i,y,l,d),d==="pixels"&&(b=-i.left,k=-i.top);var N=new D.Gradient({id:s.getAttribute("id"),type:h,coords:y,colorStops:m,gradientUnits:d,gradientTransform:L,offsetX:b,offsetY:k});return N}});function n(s,i,a,l){var u,c;Object.keys(i).forEach(function(h){u=i[h],u==="Infinity"?c=1:u==="-Infinity"?c=0:(c=parseFloat(i[h],10),typeof u=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(u)&&(c*=.01,l==="pixels"&&((h==="x1"||h==="x2"||h==="r2")&&(c*=a.viewBoxWidth||a.width),(h==="y1"||h==="y2")&&(c*=a.viewBoxHeight||a.height)))),i[h]=c})}})();(function(){"use strict";var t=D.util.toFixed;D.Pattern=D.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(e,r){if(e||(e={}),this.id=D.Object.__uid++,this.setOptions(e),!e.source||e.source&&typeof e.source!="string"){r&&r(this);return}else{var o=this;this.source=D.util.createImage(),D.util.loadImage(e.source,function(n,s){o.source=n,r&&r(o,s)},null,this.crossOrigin)}},toObject:function(e){var r=D.Object.NUM_FRACTION_DIGITS,o,n;return typeof this.source.src=="string"?o=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(o=this.source.toDataURL()),n={type:"pattern",source:o,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:t(this.offsetX,r),offsetY:t(this.offsetY,r),patternTransform:this.patternTransform?this.patternTransform.concat():null},D.util.populateWithProperties(this,n,e),n},toSVG:function(e){var r=typeof this.source=="function"?this.source():this.source,o=r.width/e.width,n=r.height/e.height,s=this.offsetX/e.width,i=this.offsetY/e.height,a="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(n=1,i&&(n+=Math.abs(i))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(o=1,s&&(o+=Math.abs(s))),r.src?a=r.src:r.toDataURL&&(a=r.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+s+'" y="'+i+'" width="'+o+'" height="'+n+`">
<image x="0" y="0" width="`+r.width+'" height="'+r.height+'" xlink:href="'+a+`"></image>
</pattern>
`},setOptions:function(e){for(var r in e)this[r]=e[r]},toLive:function(e){var r=this.source;return!r||typeof r.src<"u"&&(!r.complete||r.naturalWidth===0||r.naturalHeight===0)?"":e.createPattern(r,this.repeat)}})})();(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.toFixed;if(e.Shadow){e.warn("fabric.Shadow is already defined.");return}e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(o){typeof o=="string"&&(o=this._parseShadow(o));for(var n in o)this[n]=o[n];this.id=e.Object.__uid++},_parseShadow:function(o){var n=o.trim(),s=e.Shadow.reOffsetsAndBlur.exec(n)||[],i=n.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:i.trim(),offsetX:parseFloat(s[1],10)||0,offsetY:parseFloat(s[2],10)||0,blur:parseFloat(s[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(o){var n=40,s=40,i=e.Object.NUM_FRACTION_DIGITS,a=e.util.rotateVector({x:this.offsetX,y:this.offsetY},e.util.degreesToRadians(-o.angle)),l=20,u=new e.Color(this.color);return o.width&&o.height&&(n=r((Math.abs(a.x)+this.blur)/o.width,i)*100+l,s=r((Math.abs(a.y)+this.blur)/o.height,i)*100+l),o.flipX&&(a.x*=-1),o.flipY&&(a.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+s+'%" height="'+(100+2*s)+'%" x="-'+n+'%" width="'+(100+2*n)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+r(this.blur?this.blur/2:0,i)+`"></feGaussianBlur>
	<feOffset dx="`+r(a.x,i)+'" dy="'+r(a.y,i)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+u.toRgb()+'" flood-opacity="'+u.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var o={},n=e.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(s){this[s]!==n[s]&&(o[s]=this[s])},this),o}}),e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/})(_e);(function(){"use strict";if(D.StaticCanvas){D.warn("fabric.StaticCanvas is already defined.");return}var t=D.util.object.extend,e=D.util.getElementOffset,r=D.util.removeFromArray,o=D.util.toFixed,n=D.util.transformPoint,s=D.util.invertTransform,i=D.util.getNodeCanvas,a=D.util.createCanvasElement,l=new Error("Could not initialize `canvas` element");D.StaticCanvas=D.util.createClass(D.CommonMethods,{initialize:function(u,c){c||(c={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(u,c)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:D.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(u,c){var h=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(u),this._initOptions(c),this.interactive||this._initRetinaScaling(),c.overlayImage&&this.setOverlayImage(c.overlayImage,h),c.backgroundImage&&this.setBackgroundImage(c.backgroundImage,h),c.backgroundColor&&this.setBackgroundColor(c.backgroundColor,h),c.overlayColor&&this.setOverlayColor(c.overlayColor,h),this.calcOffset()},_isRetinaScaling:function(){return D.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,D.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var u=D.devicePixelRatio;this.__initRetinaScaling(u,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(u,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(u,c,h){c.setAttribute("width",this.width*u),c.setAttribute("height",this.height*u),h.scale(u,u)},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(u,c,h){return this.__setBgOverlayImage("overlayImage",u,c,h)},setBackgroundImage:function(u,c,h){return this.__setBgOverlayImage("backgroundImage",u,c,h)},setOverlayColor:function(u,c){return this.__setBgOverlayColor("overlayColor",u,c)},setBackgroundColor:function(u,c){return this.__setBgOverlayColor("backgroundColor",u,c)},__setBgOverlayImage:function(u,c,h,d){return typeof c=="string"?D.util.loadImage(c,function(g,m){if(g){var y=new D.Image(g,d);this[u]=y,y.canvas=this}h&&h(g,m)},this,d&&d.crossOrigin):(d&&c.setOptions(d),this[u]=c,c&&(c.canvas=this),h&&h(c,!1)),this},__setBgOverlayColor:function(u,c,h){return this[u]=c,this._initGradient(c,u),this._initPattern(c,u,h),this},_createCanvasElement:function(){var u=a();if(!u||(u.style||(u.style={}),typeof u.getContext>"u"))throw l;return u},_initOptions:function(u){var c=this.lowerCanvasEl;this._setOptions(u),this.width=this.width||parseInt(c.width,10)||0,this.height=this.height||parseInt(c.height,10)||0,this.lowerCanvasEl.style&&(c.width=this.width,c.height=this.height,c.style.width=this.width+"px",c.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(u){u&&u.getContext?this.lowerCanvasEl=u:this.lowerCanvasEl=D.util.getById(u)||this._createCanvasElement(),D.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(u,c){return this.setDimensions({width:u},c)},setHeight:function(u,c){return this.setDimensions({height:u},c)},setDimensions:function(u,c){var h;c=c||{};for(var d in u)h=u[d],c.cssOnly||(this._setBackstoreDimension(d,u[d]),h+="px",this.hasLostContext=!0),c.backstoreOnly||this._setCssDimension(d,h);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),c.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(u,c){return this.lowerCanvasEl[u]=c,this.upperCanvasEl&&(this.upperCanvasEl[u]=c),this.cacheCanvasEl&&(this.cacheCanvasEl[u]=c),this[u]=c,this},_setCssDimension:function(u,c){return this.lowerCanvasEl.style[u]=c,this.upperCanvasEl&&(this.upperCanvasEl.style[u]=c),this.wrapperEl&&(this.wrapperEl.style[u]=c),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(u){var c=this._activeObject,h=this.backgroundImage,d=this.overlayImage,g,m,y;for(this.viewportTransform=u,m=0,y=this._objects.length;m<y;m++)g=this._objects[m],g.group||g.setCoords(!0);return c&&c.setCoords(),h&&h.setCoords(!0),d&&d.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(u,c){var h=u,d=this.viewportTransform.slice(0);u=n(u,s(this.viewportTransform)),d[0]=c,d[3]=c;var g=n(u,d);return d[4]+=h.x-g.x,d[5]+=h.y-g.y,this.setViewportTransform(d)},setZoom:function(u){return this.zoomToPoint(new D.Point(0,0),u),this},absolutePan:function(u){var c=this.viewportTransform.slice(0);return c[4]=-u.x,c[5]=-u.y,this.setViewportTransform(c)},relativePan:function(u){return this.absolutePan(new D.Point(-u.x-this.viewportTransform[4],-u.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(u){this.stateful&&u.setupState(),u._set("canvas",this),u.setCoords(),this.fire("object:added",{target:u}),u.fire("added")},_onObjectRemoved:function(u){this.fire("object:removed",{target:u}),u.fire("removed"),delete u.canvas},clearContext:function(u){return u.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var u=this.contextContainer;return this.renderCanvas(u,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=D.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var u={},c=this.width,h=this.height,d=s(this.viewportTransform);return u.tl=n({x:0,y:0},d),u.br=n({x:c,y:h},d),u.tr=new D.Point(u.br.x,u.tl.y),u.bl=new D.Point(u.tl.x,u.br.y),this.vptCoords=u,u},cancelRequestedRender:function(){this.isRendering&&(D.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(u,c){var h=this.viewportTransform,d=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(u),D.util.setImageSmoothing(u,this.imageSmoothingEnabled),this.fire("before:render",{ctx:u}),this._renderBackground(u),u.save(),u.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._renderObjects(u,c),u.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(u),d&&(d.canvas=this,d.shouldCache(),d._transformDone=!0,d.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(u)),this._renderOverlay(u),this.controlsAboveOverlay&&this.interactive&&this.drawControls(u),this.fire("after:render",{ctx:u})},drawClipPathOnCanvas:function(u){var c=this.viewportTransform,h=this.clipPath;u.save(),u.transform(c[0],c[1],c[2],c[3],c[4],c[5]),u.globalCompositeOperation="destination-in",h.transform(u),u.scale(1/h.zoomX,1/h.zoomY),u.drawImage(h._cacheCanvas,-h.cacheTranslationX,-h.cacheTranslationY),u.restore()},_renderObjects:function(u,c){var h,d;for(h=0,d=c.length;h<d;++h)c[h]&&c[h].render(u)},_renderBackgroundOrOverlay:function(u,c){var h=this[c+"Color"],d=this[c+"Image"],g=this.viewportTransform,m=this[c+"Vpt"];if(!(!h&&!d)){if(h){u.save(),u.beginPath(),u.moveTo(0,0),u.lineTo(this.width,0),u.lineTo(this.width,this.height),u.lineTo(0,this.height),u.closePath(),u.fillStyle=h.toLive?h.toLive(u,this):h,m&&u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),u.transform(1,0,0,1,h.offsetX||0,h.offsetY||0);var y=h.gradientTransform||h.patternTransform;y&&u.transform(y[0],y[1],y[2],y[3],y[4],y[5]),u.fill(),u.restore()}d&&(u.save(),m&&u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),d.render(u),u.restore())}},_renderBackground:function(u){this._renderBackgroundOrOverlay(u,"background")},_renderOverlay:function(u){this._renderBackgroundOrOverlay(u,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new D.Point(this.width/2,this.height/2)},centerObjectH:function(u){return this._centerObject(u,new D.Point(this.getCenterPoint().x,u.getCenterPoint().y))},centerObjectV:function(u){return this._centerObject(u,new D.Point(u.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(u){var c=this.getCenterPoint();return this._centerObject(u,c)},viewportCenterObject:function(u){var c=this.getVpCenter();return this._centerObject(u,c)},viewportCenterObjectH:function(u){var c=this.getVpCenter();return this._centerObject(u,new D.Point(c.x,u.getCenterPoint().y)),this},viewportCenterObjectV:function(u){var c=this.getVpCenter();return this._centerObject(u,new D.Point(u.getCenterPoint().x,c.y))},getVpCenter:function(){var u=this.getCenterPoint(),c=s(this.viewportTransform);return n(u,c)},_centerObject:function(u,c){return u.setPositionByOrigin(c,"center","center"),u.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(u){return this.toDatalessObject(u)},toObject:function(u){return this._toObjectMethod("toObject",u)},toDatalessObject:function(u){return this._toObjectMethod("toDatalessObject",u)},_toObjectMethod:function(u,c){var h=this.clipPath,d={version:D.version,objects:this._toObjects(u,c)};return h&&!h.excludeFromExport&&(d.clipPath=this._toObject(this.clipPath,u,c)),t(d,this.__serializeBgOverlay(u,c)),D.util.populateWithProperties(this,d,c),d},_toObjects:function(u,c){return this._objects.filter(function(h){return!h.excludeFromExport}).map(function(h){return this._toObject(h,u,c)},this)},_toObject:function(u,c,h){var d;this.includeDefaultValues||(d=u.includeDefaultValues,u.includeDefaultValues=!1);var g=u[c](h);return this.includeDefaultValues||(u.includeDefaultValues=d),g},__serializeBgOverlay:function(u,c){var h={},d=this.backgroundImage,g=this.overlayImage,m=this.backgroundColor,y=this.overlayColor;return m&&m.toObject?m.excludeFromExport||(h.background=m.toObject(c)):m&&(h.background=m),y&&y.toObject?y.excludeFromExport||(h.overlay=y.toObject(c)):y&&(h.overlay=y),d&&!d.excludeFromExport&&(h.backgroundImage=this._toObject(d,u,c)),g&&!g.excludeFromExport&&(h.overlayImage=this._toObject(g,u,c)),h},svgViewportTransformation:!0,toSVG:function(u,c){u||(u={}),u.reviver=c;var h=[];return this._setSVGPreamble(h,u),this._setSVGHeader(h,u),this.clipPath&&h.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(h,"background"),this._setSVGBgOverlayImage(h,"backgroundImage",c),this._setSVGObjects(h,c),this.clipPath&&h.push(`</g>
`),this._setSVGBgOverlayColor(h,"overlay"),this._setSVGBgOverlayImage(h,"overlayImage",c),h.push("</svg>"),h.join("")},_setSVGPreamble:function(u,c){c.suppressPreamble||u.push('<?xml version="1.0" encoding="',c.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(u,c){var h=c.width||this.width,d=c.height||this.height,g,m='viewBox="0 0 '+this.width+" "+this.height+'" ',y=D.Object.NUM_FRACTION_DIGITS;c.viewBox?m='viewBox="'+c.viewBox.x+" "+c.viewBox.y+" "+c.viewBox.width+" "+c.viewBox.height+'" ':this.svgViewportTransformation&&(g=this.viewportTransform,m='viewBox="'+o(-g[4]/g[0],y)+" "+o(-g[5]/g[3],y)+" "+o(this.width/g[0],y)+" "+o(this.height/g[3],y)+'" '),u.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',h,'" ','height="',d,'" ',m,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",D.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(c),`</defs>
`)},createSVGClipPathMarkup:function(u){var c=this.clipPath;return c?(c.clipPathId="CLIPPATH_"+D.Object.__uid++,'<clipPath id="'+c.clipPathId+`" >
`+this.clipPath.toClipPathSVG(u.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var u=this,c=["background","overlay"].map(function(h){var d=u[h+"Color"];if(d&&d.toLive){var g=u[h+"Vpt"],m=u.viewportTransform,y={width:u.width/(g?m[0]:1),height:u.height/(g?m[3]:1)};return d.toSVG(y,{additionalTransform:g?D.util.matrixToSVG(m):""})}});return c.join("")},createSVGFontFacesMarkup:function(){var u="",c={},h,d,g,m,y,C,b,k,L,N=D.fontPaths,M=[];for(this._objects.forEach(function Y(J){M.push(J),J._objects&&J._objects.forEach(Y)}),k=0,L=M.length;k<L;k++)if(h=M[k],d=h.fontFamily,!(h.type.indexOf("text")===-1||c[d]||!N[d])&&(c[d]=!0,!!h.styles)){g=h.styles;for(y in g){m=g[y];for(b in m)C=m[b],d=C.fontFamily,!c[d]&&N[d]&&(c[d]=!0)}}for(var W in c)u+=[`		@font-face {
`,"			font-family: '",W,`';
`,"			src: url('",N[W],`');
`,`		}
`].join("");return u&&(u=['	<style type="text/css">',`<![CDATA[
`,u,"]]>",`</style>
`].join("")),u},_setSVGObjects:function(u,c){var h,d,g,m=this._objects;for(d=0,g=m.length;d<g;d++)h=m[d],!h.excludeFromExport&&this._setSVGObject(u,h,c)},_setSVGObject:function(u,c,h){u.push(c.toSVG(h))},_setSVGBgOverlayImage:function(u,c,h){this[c]&&!this[c].excludeFromExport&&this[c].toSVG&&u.push(this[c].toSVG(h))},_setSVGBgOverlayColor:function(u,c){var h=this[c+"Color"],d=this.viewportTransform,g=this.width,m=this.height;if(h)if(h.toLive){var y=h.repeat,C=D.util.invertTransform(d),b=this[c+"Vpt"],k=b?D.util.matrixToSVG(C):"";u.push('<rect transform="'+k+" translate(",g/2,",",m/2,')"',' x="',h.offsetX-g/2,'" y="',h.offsetY-m/2,'" ','width="',y==="repeat-y"||y==="no-repeat"?h.source.width:g,'" height="',y==="repeat-x"||y==="no-repeat"?h.source.height:m,'" fill="url(#SVGID_'+h.id+')"',`></rect>
`)}else u.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',h,'"',`></rect>
`)},sendToBack:function(u){if(!u)return this;var c=this._activeObject,h,d,g;if(u===c&&u.type==="activeSelection")for(g=c._objects,h=g.length;h--;)d=g[h],r(this._objects,d),this._objects.unshift(d);else r(this._objects,u),this._objects.unshift(u);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(u){if(!u)return this;var c=this._activeObject,h,d,g;if(u===c&&u.type==="activeSelection")for(g=c._objects,h=0;h<g.length;h++)d=g[h],r(this._objects,d),this._objects.push(d);else r(this._objects,u),this._objects.push(u);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(u,c){if(!u)return this;var h=this._activeObject,d,g,m,y,C,b=0;if(u===h&&u.type==="activeSelection")for(C=h._objects,d=0;d<C.length;d++)g=C[d],m=this._objects.indexOf(g),m>0+b&&(y=m-1,r(this._objects,g),this._objects.splice(y,0,g)),b++;else m=this._objects.indexOf(u),m!==0&&(y=this._findNewLowerIndex(u,m,c),r(this._objects,u),this._objects.splice(y,0,u));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(u,c,h){var d,g;if(h)for(d=c,g=c-1;g>=0;--g){var m=u.intersectsWithObject(this._objects[g])||u.isContainedWithinObject(this._objects[g])||this._objects[g].isContainedWithinObject(u);if(m){d=g;break}}else d=c-1;return d},bringForward:function(u,c){if(!u)return this;var h=this._activeObject,d,g,m,y,C,b=0;if(u===h&&u.type==="activeSelection")for(C=h._objects,d=C.length;d--;)g=C[d],m=this._objects.indexOf(g),m<this._objects.length-1-b&&(y=m+1,r(this._objects,g),this._objects.splice(y,0,g)),b++;else m=this._objects.indexOf(u),m!==this._objects.length-1&&(y=this._findNewUpperIndex(u,m,c),r(this._objects,u),this._objects.splice(y,0,u));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(u,c,h){var d,g,m;if(h)for(d=c,g=c+1,m=this._objects.length;g<m;++g){var y=u.intersectsWithObject(this._objects[g])||u.isContainedWithinObject(this._objects[g])||this._objects[g].isContainedWithinObject(u);if(y){d=g;break}}else d=c+1;return d},moveTo:function(u,c){return r(this._objects,u),this._objects.splice(c,0,u),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(D.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(u){u.dispose&&u.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),D.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),D.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),t(D.StaticCanvas.prototype,D.Observable),t(D.StaticCanvas.prototype,D.Collection),t(D.StaticCanvas.prototype,D.DataURLExporter),t(D.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(u){var c=a();if(!c||!c.getContext)return null;var h=c.getContext("2d");if(!h)return null;switch(u){case"setLineDash":return typeof h.setLineDash<"u";default:return null}}}),D.StaticCanvas.prototype.toJSON=D.StaticCanvas.prototype.toObject,D.isLikelyNode&&(D.StaticCanvas.prototype.createPNGStream=function(){var u=i(this.lowerCanvasEl);return u&&u.createPNGStream()},D.StaticCanvas.prototype.createJPEGStream=function(u){var c=i(this.lowerCanvasEl);return c&&c.createJPEGStream(u)})})();D.BaseBrush=D.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(t){t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,t.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(t){var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},_setShadow:function(){if(this.shadow){var t=this.canvas,e=this.shadow,r=t.contextTop,o=t.getZoom();t&&t._isRetinaScaling()&&(o*=D.devicePixelRatio),r.shadowColor=e.color,r.shadowBlur=e.blur*o,r.shadowOffsetX=e.offsetX*o,r.shadowOffsetY=e.offsetY*o}},needsFullRender:function(){var t=new D.Color(this.color);return t.getAlpha()<1||!!this.shadow},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0},_isOutSideCanvas:function(t){return t.x<0||t.x>this.canvas.getWidth()||t.y<0||t.y>this.canvas.getHeight()}});(function(){D.PencilBrush=D.util.createClass(D.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(t){this.canvas=t,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(t,e,r){var o=e.midPointFrom(r);return t.quadraticCurveTo(e.x,e.y,o.x,o.y),o},onMouseDown:function(t,e){this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],this._prepareForDrawing(t),this._captureDrawingPath(t),this._render())},onMouseMove:function(t,e){if(this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(t))&&this._captureDrawingPath(t)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var r=this._points,o=r.length,n=this.canvas.contextTop;this._saveAndTransform(n),this.oldEnd&&(n.beginPath(),n.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(n,r[o-2],r[o-1],!0),n.stroke(),n.restore()}},onMouseUp:function(t){return this.canvas._isMainEvent(t.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(t){var e=new D.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){return this._points.length>1&&t.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(t),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(t){var e=new D.Point(t.x,t.y);return this._addPoint(e)},_render:function(t){var e,r,o=this._points[0],n=this._points[1];if(t=t||this.canvas.contextTop,this._saveAndTransform(t),t.beginPath(),this._points.length===2&&o.x===n.x&&o.y===n.y){var s=this.width/1e3;o=new D.Point(o.x,o.y),n=new D.Point(n.x,n.y),o.x-=s,n.x+=s}for(t.moveTo(o.x,o.y),e=1,r=this._points.length;e<r;e++)this._drawSegment(t,o,n),o=this._points[e],n=this._points[e+1];t.lineTo(o.x,o.y),t.stroke(),t.restore()},convertPointsToSVGPath:function(t){var e=this.width/1e3;return D.util.getSmoothPathFromPoints(t,e)},_isEmptySVGPath:function(t){var e=D.util.joinPath(t);return e==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(t){var e=new D.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new D.Shadow(this.shadow)),e},decimatePoints:function(t,e){if(t.length<=2)return t;var r=this.canvas.getZoom(),o=Math.pow(e/r,2),n,s=t.length-1,i=t[0],a=[i],l;for(n=1;n<s-1;n++)l=Math.pow(i.x-t[n].x,2)+Math.pow(i.y-t[n].y,2),l>=o&&(i=t[n],a.push(i));return a.push(t[s]),a},_finalizeAndAddPath:function(){var t=this.canvas.contextTop;t.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var e=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(e)){this.canvas.requestRenderAll();return}var r=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:r}),this.canvas.add(r),this.canvas.requestRenderAll(),r.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:r})}})})();D.CircleBrush=D.util.createClass(D.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),r=this.canvas.contextTop;this._saveAndTransform(r),this.dot(r,e),r.restore()},dot:function(t,e){t.fillStyle=e.fill,t.beginPath(),t.arc(e.x,e.y,e.radius,0,Math.PI*2,!1),t.closePath(),t.fill()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},_render:function(){var t=this.canvas.contextTop,e,r,o=this.points;for(this._saveAndTransform(t),e=0,r=o.length;e<r;e++)this.dot(t,o[e]);t.restore()},onMouseMove:function(t){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(t)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(t),this._render()):this.drawDot(t))},onMouseUp:function(){var t=this.canvas.renderOnAddRemove,e,r;this.canvas.renderOnAddRemove=!1;var o=[];for(e=0,r=this.points.length;e<r;e++){var n=this.points[e],s=new D.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&(s.shadow=new D.Shadow(this.shadow)),o.push(s)}var i=new D.Group(o);i.canvas=this.canvas,this.canvas.fire("before:path:created",{path:i}),this.canvas.add(i),this.canvas.fire("path:created",{path:i}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},addPoint:function(t){var e=new D.Point(t.x,t.y),r=D.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,o=new D.Color(this.color).setAlpha(D.util.getRandomInt(0,100)/100).toRgba();return e.radius=r,e.fill=o,this.points.push(e),e}});D.SprayBrush=D.util.createClass(D.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseMove:function(t){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(t)||(this.addSprayChunk(t),this.render(this.sprayChunkPoints))},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],r=0,o=this.sprayChunks.length;r<o;r++)for(var n=this.sprayChunks[r],s=0,i=n.length;s<i;s++){var a=new D.Rect({width:n[s].width,height:n[s].width,left:n[s].x+1,top:n[s].y+1,originX:"center",originY:"center",fill:this.color});e.push(a)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var l=new D.Group(e);this.shadow&&l.set("shadow",new D.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:l}),this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},_getOptimizedRects:function(t){var e={},r,o,n;for(o=0,n=t.length;o<n;o++)r=t[o].left+""+t[o].top,e[r]||(e[r]=t[o]);var s=[];for(r in e)s.push(e[r]);return s},render:function(t){var e=this.canvas.contextTop,r,o;for(e.fillStyle=this.color,this._saveAndTransform(e),r=0,o=t.length;r<o;r++){var n=t[r];typeof n.opacity<"u"&&(e.globalAlpha=n.opacity),e.fillRect(n.x,n.y,n.width,n.width)}e.restore()},_render:function(){var t=this.canvas.contextTop,e,r;for(t.fillStyle=this.color,this._saveAndTransform(t),e=0,r=this.sprayChunks.length;e<r;e++)this.render(this.sprayChunks[e]);t.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];var e,r,o,n=this.width/2,s;for(s=0;s<this.density;s++){e=D.util.getRandomInt(t.x-n,t.x+n),r=D.util.getRandomInt(t.y-n,t.y+n),this.dotWidthVariance?o=D.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):o=this.dotWidth;var i=new D.Point(e,r);i.width=o,this.randomOpacity&&(i.opacity=D.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(i)}this.sprayChunks.push(this.sprayChunkPoints)}});D.PatternBrush=D.util.createClass(D.PencilBrush,{getPatternSrc:function(){var t=20,e=5,r=D.util.createCanvasElement(),o=r.getContext("2d");return r.width=r.height=t+e,o.fillStyle=this.color,o.beginPath(),o.arc(t/2,t/2,t/2,0,Math.PI*2,!1),o.closePath(),o.fill(),r},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(t){return t.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(t){this.callSuper("_setBrushStyles",t),t.strokeStyle=this.getPattern(t)},createPath:function(t){var e=this.callSuper("createPath",t),r=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new D.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-r.x,offsetY:-r.y}),e}});(function(){var t=D.util.getPointer,e=D.util.degreesToRadians,r=D.util.isTouchEvent;D.Canvas=D.util.createClass(D.StaticCanvas,{initialize:function(n,s){s||(s={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(n,s),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=D.PencilBrush&&new D.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var n=this.getActiveObjects(),s,i,a;if(n.length>0&&!this.preserveObjectStacking){i=[],a=[];for(var l=0,u=this._objects.length;l<u;l++)s=this._objects[l],n.indexOf(s)===-1?i.push(s):a.push(s);n.length>1&&(this._activeObject._objects=a),i.push.apply(i,a)}else i=this._objects;return i},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var n=this.contextContainer;return this.renderCanvas(n,this._chooseObjectsToRender()),this},renderTopLayer:function(n){n.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(n),this.contextTopDirty=!0),n.restore()},renderTop:function(){var n=this.contextTop;return this.clearContext(n),this.renderTopLayer(n),this.fire("after:render"),this},_normalizePointer:function(n,s){var i=n.calcTransformMatrix(),a=D.util.invertTransform(i),l=this.restorePointerVpt(s);return D.util.transformPoint(l,a)},isTargetTransparent:function(n,s,i){if(n.shouldCache()&&n._cacheCanvas&&n!==this._activeObject){var a=this._normalizePointer(n,{x:s,y:i}),l=Math.max(n.cacheTranslationX+a.x*n.zoomX,0),u=Math.max(n.cacheTranslationY+a.y*n.zoomY,0),g=D.util.isTransparent(n._cacheContext,Math.round(l),Math.round(u),this.targetFindTolerance);return g}var c=this.contextCache,h=n.selectionBackgroundColor,d=this.viewportTransform;n.selectionBackgroundColor="",this.clearContext(c),c.save(),c.transform(d[0],d[1],d[2],d[3],d[4],d[5]),n.render(c),c.restore(),n.selectionBackgroundColor=h;var g=D.util.isTransparent(c,s,i,this.targetFindTolerance);return g},_isSelectionKeyPressed:function(n){var s=!1;return Array.isArray(this.selectionKey)?s=!!this.selectionKey.find(function(i){return n[i]===!0}):s=n[this.selectionKey],s},_shouldClearSelection:function(n,s){var i=this.getActiveObjects(),a=this._activeObject;return!s||s&&a&&i.length>1&&i.indexOf(s)===-1&&a!==s&&!this._isSelectionKeyPressed(n)||s&&!s.evented||s&&!s.selectable&&a&&a!==s},_shouldCenterTransform:function(n,s,i){if(n){var a;return s==="scale"||s==="scaleX"||s==="scaleY"||s==="resizing"?a=this.centeredScaling||n.centeredScaling:s==="rotate"&&(a=this.centeredRotation||n.centeredRotation),a?!i:i}},_getOriginFromCorner:function(n,s){var i={x:n.originX,y:n.originY};return s==="ml"||s==="tl"||s==="bl"?i.x="right":(s==="mr"||s==="tr"||s==="br")&&(i.x="left"),s==="tl"||s==="mt"||s==="tr"?i.y="bottom":(s==="bl"||s==="mb"||s==="br")&&(i.y="top"),i},_getActionFromCorner:function(n,s,i,a){if(!s||!n)return"drag";var l=a.controls[s];return l.getActionName(i,l,a)},_setupCurrentTransform:function(n,s,i){if(s){var a=this.getPointer(n),l=s.__corner,u=s.controls[l],c=i&&l?u.getActionHandler(n,s,u):D.controlsUtils.dragHandler,h=this._getActionFromCorner(i,l,n,s),d=this._getOriginFromCorner(s,l),g=n[this.centeredKey],m={target:s,action:h,actionHandler:c,corner:l,scaleX:s.scaleX,scaleY:s.scaleY,skewX:s.skewX,skewY:s.skewY,offsetX:a.x-s.left,offsetY:a.y-s.top,originX:d.x,originY:d.y,ex:a.x,ey:a.y,lastX:a.x,lastY:a.y,theta:e(s.angle),width:s.width*s.scaleX,shiftKey:n.shiftKey,altKey:g,original:D.util.saveObjectTransform(s)};this._shouldCenterTransform(s,h,g)&&(m.originX="center",m.originY="center"),m.original.originX=d.x,m.original.originY=d.y,this._currentTransform=m,this._beforeTransform(n)}},setCursor:function(n){this.upperCanvasEl.style.cursor=n},_drawSelection:function(n){var s=this._groupSelector,i=new D.Point(s.ex,s.ey),a=D.util.transformPoint(i,this.viewportTransform),l=new D.Point(s.ex+s.left,s.ey+s.top),u=D.util.transformPoint(l,this.viewportTransform),c=Math.min(a.x,u.x),h=Math.min(a.y,u.y),d=Math.max(a.x,u.x),g=Math.max(a.y,u.y),m=this.selectionLineWidth/2;this.selectionColor&&(n.fillStyle=this.selectionColor,n.fillRect(c,h,d-c,g-h)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(n.lineWidth=this.selectionLineWidth,n.strokeStyle=this.selectionBorderColor,c+=m,h+=m,d-=m,g-=m,D.Object.prototype._setLineDash.call(this,n,this.selectionDashArray),n.strokeRect(c,h,d-c,g-h))},findTarget:function(n,s){if(!this.skipTargetFind){var i=!0,a=this.getPointer(n,i),l=this._activeObject,u=this.getActiveObjects(),c,h,d=r(n),g=u.length>1&&!s||u.length===1;if(this.targets=[],g&&l._findTargetCorner(a,d)||u.length>1&&!s&&l===this._searchPossibleTargets([l],a))return l;if(u.length===1&&l===this._searchPossibleTargets([l],a))if(this.preserveObjectStacking)c=l,h=this.targets,this.targets=[];else return l;var m=this._searchPossibleTargets(this._objects,a);return n[this.altSelectionKey]&&m&&c&&m!==c&&(m=c,this.targets=h),m}},_checkTarget:function(n,s,i){if(s&&s.visible&&s.evented&&s.containsPoint(n))if((this.perPixelTargetFind||s.perPixelTargetFind)&&!s.isEditing){var a=this.isTargetTransparent(s,i.x,i.y);if(!a)return!0}else return!0},_searchPossibleTargets:function(n,s){for(var i,a=n.length,l;a--;){var u=n[a],c=u.group?this._normalizePointer(u.group,s):s;if(this._checkTarget(c,u,s)){i=n[a],i.subTargetCheck&&i instanceof D.Group&&(l=this._searchPossibleTargets(i._objects,s),l&&this.targets.push(l));break}}return i},restorePointerVpt:function(n){return D.util.transformPoint(n,D.util.invertTransform(this.viewportTransform))},getPointer:function(n,s){if(this._absolutePointer&&!s)return this._absolutePointer;if(this._pointer&&s)return this._pointer;var i=t(n),a=this.upperCanvasEl,l=a.getBoundingClientRect(),u=l.width||0,c=l.height||0,h;(!u||!c)&&("top"in l&&"bottom"in l&&(c=Math.abs(l.top-l.bottom)),"right"in l&&"left"in l&&(u=Math.abs(l.right-l.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,s||(i=this.restorePointerVpt(i));var d=this.getRetinaScaling();return d!==1&&(i.x/=d,i.y/=d),u===0||c===0?h={width:1,height:1}:h={width:a.width/u,height:a.height/c},{x:i.x*h.width,y:i.y*h.height}},_createUpperCanvas:function(){var n=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),s=this.lowerCanvasEl,i=this.upperCanvasEl;i?i.className="":(i=this._createCanvasElement(),this.upperCanvasEl=i),D.util.addClass(i,"upper-canvas "+n),this.wrapperEl.appendChild(i),this._copyCanvasStyle(s,i),this._applyCanvasStyle(i),this.contextTop=i.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=D.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),D.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),D.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(n){var s=this.width||n.width,i=this.height||n.height;D.util.setStyle(n,{position:"absolute",width:s+"px",height:i+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),n.width=s,n.height=i,D.util.makeElementUnselectable(n)},_copyCanvasStyle:function(n,s){s.style.cssText=n.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var n=this._activeObject;return n?n.type==="activeSelection"&&n._objects?n._objects.slice(0):[n]:[]},_onObjectRemoved:function(n){n===this._activeObject&&(this.fire("before:selection:cleared",{target:n}),this._discardActiveObject(),this.fire("selection:cleared",{target:n}),n.fire("deselected")),n===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",n)},_fireSelectionEvents:function(n,s){var i=!1,a=this.getActiveObjects(),l=[],u=[];n.forEach(function(c){a.indexOf(c)===-1&&(i=!0,c.fire("deselected",{e:s,target:c}),u.push(c))}),a.forEach(function(c){n.indexOf(c)===-1&&(i=!0,c.fire("selected",{e:s,target:c}),l.push(c))}),n.length>0&&a.length>0?i&&this.fire("selection:updated",{e:s,selected:l,deselected:u}):a.length>0?this.fire("selection:created",{e:s,selected:l}):n.length>0&&this.fire("selection:cleared",{e:s,deselected:u})},setActiveObject:function(n,s){var i=this.getActiveObjects();return this._setActiveObject(n,s),this._fireSelectionEvents(i,s),this},_setActiveObject:function(n,s){return this._activeObject===n||!this._discardActiveObject(s,n)||n.onSelect({e:s})?!1:(this._activeObject=n,!0)},_discardActiveObject:function(n,s){var i=this._activeObject;if(i){if(i.onDeselect({e:n,object:s}))return!1;this._activeObject=null}return!0},discardActiveObject:function(n){var s=this.getActiveObjects(),i=this.getActiveObject();return s.length&&this.fire("before:selection:cleared",{target:i,e:n}),this._discardActiveObject(n),this._fireSelectionEvents(s,n),this},dispose:function(){var n=this.wrapperEl;return this.removeListeners(),n.removeChild(this.upperCanvasEl),n.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(s){D.util.cleanUpJsdomNode(this[s]),this[s]=void 0}.bind(this)),n.parentNode&&n.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,D.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(n){var s=this._activeObject;s&&s._renderControls(n)},_toObject:function(n,s,i){var a=this._realizeGroupTransformOnObject(n),l=this.callSuper("_toObject",n,s,i);return this._unwindGroupTransformOnObject(n,a),l},_realizeGroupTransformOnObject:function(n){if(n.group&&n.group.type==="activeSelection"&&this._activeObject===n.group){var s=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],i={};return s.forEach(function(a){i[a]=n[a]}),D.util.addTransformToObject(n,this._activeObject.calcOwnMatrix()),i}else return null},_unwindGroupTransformOnObject:function(n,s){s&&n.set(s)},_setSVGObject:function(n,s,i){var a=this._realizeGroupTransformOnObject(s);this.callSuper("_setSVGObject",n,s,i),this._unwindGroupTransformOnObject(s,a)},setViewportTransform:function(n){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),D.StaticCanvas.prototype.setViewportTransform.call(this,n)}});for(var o in D.StaticCanvas)o!=="prototype"&&(D.Canvas[o]=D.StaticCanvas[o])})();(function(){var t=D.util.addListener,e=D.util.removeListener,r=3,o=2,n=1,s={passive:!1};function i(a,l){return a.button&&a.button===l-1}D.util.object.extend(D.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(t,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(a,l){var u=this.upperCanvasEl,c=this._getEventPrefix();a(D.window,"resize",this._onResize),a(u,c+"down",this._onMouseDown),a(u,c+"move",this._onMouseMove,s),a(u,c+"out",this._onMouseOut),a(u,c+"enter",this._onMouseEnter),a(u,"wheel",this._onMouseWheel),a(u,"contextmenu",this._onContextMenu),a(u,"dblclick",this._onDoubleClick),a(u,"dragover",this._onDragOver),a(u,"dragenter",this._onDragEnter),a(u,"dragleave",this._onDragLeave),a(u,"drop",this._onDrop),this.enablePointerEvents||a(u,"touchstart",this._onTouchStart,s),typeof eventjs<"u"&&l in eventjs&&(eventjs[l](u,"gesture",this._onGesture),eventjs[l](u,"drag",this._onDrag),eventjs[l](u,"orientation",this._onOrientationChange),eventjs[l](u,"shake",this._onShake),eventjs[l](u,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(e,"remove");var a=this._getEventPrefix();e(D.document,a+"up",this._onMouseUp),e(D.document,"touchend",this._onTouchEnd,s),e(D.document,a+"move",this._onMouseMove,s),e(D.document,"touchmove",this._onMouseMove,s)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(a,l){this.__onTransformGesture&&this.__onTransformGesture(a,l)},_onDrag:function(a,l){this.__onDrag&&this.__onDrag(a,l)},_onMouseWheel:function(a){this.__onMouseWheel(a)},_onMouseOut:function(a){var l=this._hoveredTarget;this.fire("mouse:out",{target:l,e:a}),this._hoveredTarget=null,l&&l.fire("mouseout",{e:a});var u=this;this._hoveredTargets.forEach(function(c){u.fire("mouse:out",{target:l,e:a}),c&&l.fire("mouseout",{e:a})}),this._hoveredTargets=[]},_onMouseEnter:function(a){!this._currentTransform&&!this.findTarget(a)&&(this.fire("mouse:over",{target:null,e:a}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(a,l){this.__onOrientationChange&&this.__onOrientationChange(a,l)},_onShake:function(a,l){this.__onShake&&this.__onShake(a,l)},_onLongPress:function(a,l){this.__onLongPress&&this.__onLongPress(a,l)},_onDragOver:function(a){a.preventDefault();var l=this._simpleEventHandler("dragover",a);this._fireEnterLeaveEvents(l,a)},_onDrop:function(a){return this._simpleEventHandler("drop:before",a),this._simpleEventHandler("drop",a)},_onContextMenu:function(a){return this.stopContextMenu&&(a.stopPropagation(),a.preventDefault()),!1},_onDoubleClick:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"dblclick"),this._resetTransformEventData(a)},getPointerId:function(a){var l=a.changedTouches;return l?l[0]&&l[0].identifier:this.enablePointerEvents?a.pointerId:-1},_isMainEvent:function(a){return a.isPrimary===!0?!0:a.isPrimary===!1?!1:a.type==="touchend"&&a.touches.length===0?!0:a.changedTouches?a.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(a){a.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(a)),this.__onMouseDown(a),this._resetTransformEventData();var l=this.upperCanvasEl,u=this._getEventPrefix();t(D.document,"touchend",this._onTouchEnd,s),t(D.document,"touchmove",this._onMouseMove,s),e(l,u+"down",this._onMouseDown)},_onMouseDown:function(a){this.__onMouseDown(a),this._resetTransformEventData();var l=this.upperCanvasEl,u=this._getEventPrefix();e(l,u+"move",this._onMouseMove,s),t(D.document,u+"up",this._onMouseUp),t(D.document,u+"move",this._onMouseMove,s)},_onTouchEnd:function(a){if(!(a.touches.length>0)){this.__onMouseUp(a),this._resetTransformEventData(),this.mainTouchId=null;var l=this._getEventPrefix();e(D.document,"touchend",this._onTouchEnd,s),e(D.document,"touchmove",this._onMouseMove,s);var u=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){t(u.upperCanvasEl,l+"down",u._onMouseDown),u._willAddMouseDown=0},400)}},_onMouseUp:function(a){this.__onMouseUp(a),this._resetTransformEventData();var l=this.upperCanvasEl,u=this._getEventPrefix();this._isMainEvent(a)&&(e(D.document,u+"up",this._onMouseUp),e(D.document,u+"move",this._onMouseMove,s),t(l,u+"move",this._onMouseMove,s))},_onMouseMove:function(a){!this.allowTouchScrolling&&a.preventDefault&&a.preventDefault(),this.__onMouseMove(a)},_onResize:function(){this.calcOffset()},_shouldRender:function(a){var l=this._activeObject;return!!l!=!!a||l&&a&&l!==a?!0:(l&&l.isEditing,!1)},__onMouseUp:function(a){var l,u=this._currentTransform,c=this._groupSelector,h=!1,d=!c||c.left===0&&c.top===0;if(this._cacheTransformEventData(a),l=this._target,this._handleEvent(a,"up:before"),i(a,r)){this.fireRightClick&&this._handleEvent(a,"up",r,d);return}if(i(a,o)){this.fireMiddleClick&&this._handleEvent(a,"up",o,d),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(a);return}if(this._isMainEvent(a)){if(u&&(this._finalizeCurrentTransform(a),h=u.actionPerformed),!d){var g=l===this._activeObject;this._maybeGroupObjects(a),h||(h=this._shouldRender(l)||!g&&l===this._activeObject)}var m,y;if(l){if(m=l._findTargetCorner(this.getPointer(a,!0),D.util.isTouchEvent(a)),l.selectable&&l!==this._activeObject&&l.activeOn==="up")this.setActiveObject(l,a),h=!0;else{var C=l.controls[m],b=C&&C.getMouseUpHandler(a,l,C);b&&(y=this.getPointer(a),b(a,u,y.x,y.y))}l.isMoving=!1}if(u&&(u.target!==l||u.corner!==m)){var k=u.target&&u.target.controls[u.corner],L=k&&k.getMouseUpHandler(a,l,C);y=y||this.getPointer(a),L&&L(a,u,y.x,y.y)}this._setCursorFromEvent(a,l),this._handleEvent(a,"up",n,d),this._groupSelector=null,this._currentTransform=null,l&&(l.__corner=0),h?this.requestRenderAll():d||this.renderTop()}},_simpleEventHandler:function(a,l){var u=this.findTarget(l),c=this.targets,h={e:l,target:u,subTargets:c};if(this.fire(a,h),u&&u.fire(a,h),!c)return u;for(var d=0;d<c.length;d++)c[d].fire(a,h);return u},_handleEvent:function(a,l,u,c){var h=this._target,d=this.targets||[],g={e:a,target:h,subTargets:d,button:u||n,isClick:c||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};l==="up"&&(g.currentTarget=this.findTarget(a),g.currentSubTargets=this.targets),this.fire("mouse:"+l,g),h&&h.fire("mouse"+l,g);for(var m=0;m<d.length;m++)d[m].fire("mouse"+l,g)},_finalizeCurrentTransform:function(a){var l=this._currentTransform,u=l.target,c={e:a,target:u,transform:l,action:l.action};u._scaling&&(u._scaling=!1),u.setCoords(),(l.actionPerformed||this.stateful&&u.hasStateChanged())&&this._fire("modified",c)},_onMouseDownInDrawingMode:function(a){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(a).requestRenderAll();var l=this.getPointer(a);this.freeDrawingBrush.onMouseDown(l,{e:a,pointer:l}),this._handleEvent(a,"down")},_onMouseMoveInDrawingMode:function(a){if(this._isCurrentlyDrawing){var l=this.getPointer(a);this.freeDrawingBrush.onMouseMove(l,{e:a,pointer:l})}this.setCursor(this.freeDrawingCursor),this._handleEvent(a,"move")},_onMouseUpInDrawingMode:function(a){var l=this.getPointer(a);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:a,pointer:l}),this._handleEvent(a,"up")},__onMouseDown:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"down:before");var l=this._target;if(i(a,r)){this.fireRightClick&&this._handleEvent(a,"down",r);return}if(i(a,o)){this.fireMiddleClick&&this._handleEvent(a,"down",o);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(a);return}if(this._isMainEvent(a)&&!this._currentTransform){var u=this._pointer;this._previousPointer=u;var c=this._shouldRender(l),h=this._shouldGroup(a,l);if(this._shouldClearSelection(a,l)?this.discardActiveObject(a):h&&(this._handleGrouping(a,l),l=this._activeObject),this.selection&&(!l||!l.selectable&&!l.isEditing&&l!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),l){var d=l===this._activeObject;l.selectable&&l.activeOn==="down"&&this.setActiveObject(l,a);var g=l._findTargetCorner(this.getPointer(a,!0),D.util.isTouchEvent(a));if(l.__corner=g,l===this._activeObject&&(g||!h)){this._setupCurrentTransform(a,l,d);var m=l.controls[g],u=this.getPointer(a),y=m&&m.getMouseDownHandler(a,l,m);y&&y(a,this._currentTransform,u.x,u.y)}}this._handleEvent(a,"down"),(c||h)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(a){this._resetTransformEventData(),this._pointer=this.getPointer(a,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(a)||null},_beforeTransform:function(a){var l=this._currentTransform;this.stateful&&l.target.saveState(),this.fire("before:transform",{e:a,transform:l})},__onMouseMove:function(a){this._handleEvent(a,"move:before"),this._cacheTransformEventData(a);var l,u;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(a);return}if(this._isMainEvent(a)){var c=this._groupSelector;c?(u=this._absolutePointer,c.left=u.x-c.ex,c.top=u.y-c.ey,this.renderTop()):this._currentTransform?this._transformObject(a):(l=this.findTarget(a)||null,this._setCursorFromEvent(a,l),this._fireOverOutEvents(l,a)),this._handleEvent(a,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(a,l){var u=this._hoveredTarget,c=this._hoveredTargets,h=this.targets,d=Math.max(c.length,h.length);this.fireSyntheticInOutEvents(a,l,{oldTarget:u,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var g=0;g<d;g++)this.fireSyntheticInOutEvents(h[g],l,{oldTarget:c[g],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=a,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(a,l){var u=this._draggedoverTarget,c=this._hoveredTargets,h=this.targets,d=Math.max(c.length,h.length);this.fireSyntheticInOutEvents(a,l,{oldTarget:u,evtOut:"dragleave",evtIn:"dragenter"});for(var g=0;g<d;g++)this.fireSyntheticInOutEvents(h[g],l,{oldTarget:c[g],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=a},fireSyntheticInOutEvents:function(a,l,u){var c,h,d=u.oldTarget,g,m,y=d!==a,C=u.canvasEvtIn,b=u.canvasEvtOut;y&&(c={e:l,target:a,previousTarget:d},h={e:l,target:d,nextTarget:a}),m=a&&y,g=d&&y,g&&(b&&this.fire(b,h),d.fire(u.evtOut,h)),m&&(C&&this.fire(C,c),a.fire(u.evtIn,c))},__onMouseWheel:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"wheel"),this._resetTransformEventData()},_transformObject:function(a){var l=this.getPointer(a),u=this._currentTransform;u.reset=!1,u.shiftKey=a.shiftKey,u.altKey=a[this.centeredKey],this._performTransformAction(a,u,l),u.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(a,l,u){var c=u.x,h=u.y,d=l.action,g=!1,m=l.actionHandler;m&&(g=m(a,l,c,h)),d==="drag"&&g&&(l.target.isMoving=!0,this.setCursor(l.target.moveCursor||this.moveCursor)),l.actionPerformed=l.actionPerformed||g},_fire:D.controlsUtils.fireEvent,_setCursorFromEvent:function(a,l){if(!l)return this.setCursor(this.defaultCursor),!1;var u=l.hoverCursor||this.hoverCursor,c=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,h=(!c||!c.contains(l))&&l._findTargetCorner(this.getPointer(a,!0));h?this.setCursor(this.getCornerCursor(h,l,a)):(l.subTargetCheck&&this.targets.concat().reverse().map(function(d){u=d.hoverCursor||u}),this.setCursor(u))},getCornerCursor:function(a,l,u){var c=l.controls[a];return c.cursorStyleHandler(u,c,l)}})})();(function(){var t=Math.min,e=Math.max;D.util.object.extend(D.Canvas.prototype,{_shouldGroup:function(r,o){var n=this._activeObject;return n&&this._isSelectionKeyPressed(r)&&o&&o.selectable&&this.selection&&(n!==o||n.type==="activeSelection")&&!o.onSelect({e:r})},_handleGrouping:function(r,o){var n=this._activeObject;n.__corner||o===n&&(o=this.findTarget(r,!0),!o||!o.selectable)||(n&&n.type==="activeSelection"?this._updateActiveSelection(o,r):this._createActiveSelection(o,r))},_updateActiveSelection:function(r,o){var n=this._activeObject,s=n._objects.slice(0);n.contains(r)?(n.removeWithUpdate(r),this._hoveredTarget=r,this._hoveredTargets=this.targets.concat(),n.size()===1&&this._setActiveObject(n.item(0),o)):(n.addWithUpdate(r),this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(s,o)},_createActiveSelection:function(r,o){var n=this.getActiveObjects(),s=this._createGroup(r);this._hoveredTarget=s,this._setActiveObject(s,o),this._fireSelectionEvents(n,o)},_createGroup:function(r){var o=this._objects,n=o.indexOf(this._activeObject)<o.indexOf(r),s=n?[this._activeObject,r]:[r,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new D.ActiveSelection(s,{canvas:this})},_groupSelectedObjects:function(r){var o=this._collectObjects(r),n;o.length===1?this.setActiveObject(o[0],r):o.length>1&&(n=new D.ActiveSelection(o.reverse(),{canvas:this}),this.setActiveObject(n,r))},_collectObjects:function(r){for(var o=[],n,s=this._groupSelector.ex,i=this._groupSelector.ey,a=s+this._groupSelector.left,l=i+this._groupSelector.top,u=new D.Point(t(s,a),t(i,l)),c=new D.Point(e(s,a),e(i,l)),h=!this.selectionFullyContained,d=s===a&&i===l,g=this._objects.length;g--&&(n=this._objects[g],!(!(!n||!n.selectable||!n.visible)&&(h&&n.intersectsWithRect(u,c,!0)||n.isContainedWithinRect(u,c,!0)||h&&n.containsPoint(u,null,!0)||h&&n.containsPoint(c,null,!0))&&(o.push(n),d))););return o.length>1&&(o=o.filter(function(m){return!m.onSelect({e:r})})),o},_maybeGroupObjects:function(r){this.selection&&this._groupSelector&&this._groupSelectedObjects(r),this.setCursor(this.defaultCursor),this._groupSelector=null}})})();(function(){D.util.object.extend(D.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",r=t.quality||1,o=(t.multiplier||1)*(t.enableRetinaScaling?this.getRetinaScaling():1),n=this.toCanvasElement(o,t);return D.util.toDataURL(n,e,r)},toCanvasElement:function(t,e){t=t||1,e=e||{};var r=(e.width||this.width)*t,o=(e.height||this.height)*t,n=this.getZoom(),s=this.width,i=this.height,a=n*t,l=this.viewportTransform,u=(l[4]-(e.left||0))*t,c=(l[5]-(e.top||0))*t,h=this.interactive,d=[a,0,0,a,u,c],g=this.enableRetinaScaling,m=D.util.createCanvasElement(),y=this.contextTop;return m.width=r,m.height=o,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=d,this.width=r,this.height=o,this.calcViewportBoundaries(),this.renderCanvas(m.getContext("2d"),this._objects),this.viewportTransform=l,this.width=s,this.height=i,this.calcViewportBoundaries(),this.interactive=h,this.enableRetinaScaling=g,this.contextTop=y,m}})})();D.util.object.extend(D.StaticCanvas.prototype,{loadFromJSON:function(t,e,r){if(t){var o=typeof t=="string"?JSON.parse(t):D.util.object.clone(t),n=this,s=o.clipPath,i=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete o.clipPath,this._enlivenObjects(o.objects,function(a){n.clear(),n._setBgOverlay(o,function(){s?n._enlivenObjects([s],function(l){n.clipPath=l[0],n.__setupCanvas.call(n,o,a,i,e)}):n.__setupCanvas.call(n,o,a,i,e)})},r),this}},__setupCanvas:function(t,e,r,o){var n=this;e.forEach(function(s,i){n.insertAt(s,i)}),this.renderOnAddRemove=r,delete t.objects,delete t.backgroundImage,delete t.overlayImage,delete t.background,delete t.overlay,this._setOptions(t),this.renderAll(),o&&o()},_setBgOverlay:function(t,e){var r={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!t.backgroundImage&&!t.overlayImage&&!t.background&&!t.overlay){e&&e();return}var o=function(){r.backgroundImage&&r.overlayImage&&r.backgroundColor&&r.overlayColor&&e&&e()};this.__setBgOverlay("backgroundImage",t.backgroundImage,r,o),this.__setBgOverlay("overlayImage",t.overlayImage,r,o),this.__setBgOverlay("backgroundColor",t.background,r,o),this.__setBgOverlay("overlayColor",t.overlay,r,o)},__setBgOverlay:function(t,e,r,o){var n=this;if(!e){r[t]=!0,o&&o();return}t==="backgroundImage"||t==="overlayImage"?D.util.enlivenObjects([e],function(s){n[t]=s[0],r[t]=!0,o&&o()}):this["set"+D.util.string.capitalize(t,!0)](e,function(){r[t]=!0,o&&o()})},_enlivenObjects:function(t,e,r){if(!t||t.length===0){e&&e([]);return}D.util.enlivenObjects(t,function(o){e&&e(o)},null,r)},_toDataURL:function(t,e){this.clone(function(r){e(r.toDataURL(t))})},_toDataURLWithMultiplier:function(t,e,r){this.clone(function(o){r(o.toDataURLWithMultiplier(t,e))})},clone:function(t,e){var r=JSON.stringify(this.toJSON(e));this.cloneWithoutData(function(o){o.loadFromJSON(r,function(){t&&t(o)})})},cloneWithoutData:function(t){var e=D.util.createCanvasElement();e.width=this.width,e.height=this.height;var r=new D.Canvas(e);this.backgroundImage?(r.setBackgroundImage(this.backgroundImage.src,function(){r.renderAll(),t&&t(r)}),r.backgroundImageOpacity=this.backgroundImageOpacity,r.backgroundImageStretch=this.backgroundImageStretch):t&&t(r)}});(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,o=e.util.object.clone,n=e.util.toFixed,s=e.util.string.capitalize,i=e.util.degreesToRadians,a=!e.isLikelyNode,l=2;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:a,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(u){u&&this.setOptions(u)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(u){var c=e.perfLimitSizeTotal,h=u.width,d=u.height,g=e.maxCacheSideLimit,m=e.minCacheSideLimit;if(h<=g&&d<=g&&h*d<=c)return h<m&&(u.width=m),d<m&&(u.height=m),u;var y=h/d,C=e.util.limitDimsByArea(y,c),b=e.util.capValue,k=b(m,C.x,g),L=b(m,C.y,g);return h>k&&(u.zoomX/=h/k,u.width=k,u.capped=!0),d>L&&(u.zoomY/=d/L,u.height=L,u.capped=!0),u},_getCacheCanvasDimensions:function(){var u=this.getTotalObjectScaling(),c=this._getTransformedDimensions(0,0),h=c.x*u.scaleX/this.scaleX,d=c.y*u.scaleY/this.scaleY;return{width:h+l,height:d+l,zoomX:u.scaleX,zoomY:u.scaleY,x:h,y:d}},_updateCacheCanvas:function(){var u=this.canvas;if(this.noScaleCache&&u&&u._currentTransform){var c=u._currentTransform.target,h=u._currentTransform.action;if(this===c&&h.slice&&h.slice(0,5)==="scale")return!1}var d=this._cacheCanvas,g=this._limitCacheSize(this._getCacheCanvasDimensions()),m=e.minCacheSideLimit,y=g.width,C=g.height,b,k,L=g.zoomX,N=g.zoomY,M=y!==this.cacheWidth||C!==this.cacheHeight,W=this.zoomX!==L||this.zoomY!==N,Y=M||W,J=0,oe=0,pe=!1;if(M){var le=this._cacheCanvas.width,w=this._cacheCanvas.height,F=y>le||C>w,P=(y<le*.9||C<w*.9)&&le>m&&w>m;pe=F||P,F&&!g.capped&&(y>m||C>m)&&(J=y*.1,oe=C*.1)}return this instanceof e.Text&&this.path&&(Y=!0,pe=!0,J+=this.getHeightOfLine(0)*this.zoomX,oe+=this.getHeightOfLine(0)*this.zoomY),Y?(pe?(d.width=Math.ceil(y+J),d.height=Math.ceil(C+oe)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,d.width,d.height)),b=g.x/2,k=g.y/2,this.cacheTranslationX=Math.round(d.width/2-b)+b,this.cacheTranslationY=Math.round(d.height/2-k)+k,this.cacheWidth=y,this.cacheHeight=C,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(L,N),this.zoomX=L,this.zoomY=N,!0):!1},setOptions:function(u){this._setOptions(u),this._initGradient(u.fill,"fill"),this._initGradient(u.stroke,"stroke"),this._initPattern(u.fill,"fill"),this._initPattern(u.stroke,"stroke")},transform:function(u){var c=this.group&&!this.group._transformDone||this.group&&this.canvas&&u===this.canvas.contextTop,h=this.calcTransformMatrix(!c);u.transform(h[0],h[1],h[2],h[3],h[4],h[5])},toObject:function(u){var c=e.Object.NUM_FRACTION_DIGITS,h={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:n(this.left,c),top:n(this.top,c),width:n(this.width,c),height:n(this.height,c),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:n(this.strokeWidth,c),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:n(this.strokeMiterLimit,c),scaleX:n(this.scaleX,c),scaleY:n(this.scaleY,c),angle:n(this.angle,c),flipX:this.flipX,flipY:this.flipY,opacity:n(this.opacity,c),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:n(this.skewX,c),skewY:n(this.skewY,c)};return this.clipPath&&!this.clipPath.excludeFromExport&&(h.clipPath=this.clipPath.toObject(u),h.clipPath.inverted=this.clipPath.inverted,h.clipPath.absolutePositioned=this.clipPath.absolutePositioned),e.util.populateWithProperties(this,h,u),this.includeDefaultValues||(h=this._removeDefaultValues(h)),h},toDatalessObject:function(u){return this.toObject(u)},_removeDefaultValues:function(u){var c=e.util.getKlass(u.type).prototype,h=c.stateProperties;return h.forEach(function(d){d==="left"||d==="top"||(u[d]===c[d]&&delete u[d],Array.isArray(u[d])&&Array.isArray(c[d])&&u[d].length===0&&c[d].length===0&&delete u[d])}),u},toString:function(){return"#<fabric."+s(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var u=e.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(u.scaleX),scaleY:Math.abs(u.scaleY)}},getTotalObjectScaling:function(){var u=this.getObjectScaling(),c=u.scaleX,h=u.scaleY;if(this.canvas){var d=this.canvas.getZoom(),g=this.canvas.getRetinaScaling();c*=d*g,h*=d*g}return{scaleX:c,scaleY:h}},getObjectOpacity:function(){var u=this.opacity;return this.group&&(u*=this.group.getObjectOpacity()),u},_set:function(u,c){var h=u==="scaleX"||u==="scaleY",d=this[u]!==c,g=!1;return h&&(c=this._constrainScale(c)),u==="scaleX"&&c<0?(this.flipX=!this.flipX,c*=-1):u==="scaleY"&&c<0?(this.flipY=!this.flipY,c*=-1):u==="shadow"&&c&&!(c instanceof e.Shadow)?c=new e.Shadow(c):u==="dirty"&&this.group&&this.group.set("dirty",c),this[u]=c,d&&(g=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(u)>-1?(this.dirty=!0,g&&this.group.set("dirty",!0)):g&&this.stateProperties.indexOf(u)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(u){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(u.save(),this._setupCompositeOperation(u),this.drawSelectionBackground(u),this.transform(u),this._setOpacity(u),this._setShadow(u,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(u)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(u),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),u.restore())},renderCache:function(u){u=u||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,u.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(u,c){if(u.save(),c.inverted?u.globalCompositeOperation="destination-out":u.globalCompositeOperation="destination-in",c.absolutePositioned){var h=e.util.invertTransform(this.calcTransformMatrix());u.transform(h[0],h[1],h[2],h[3],h[4],h[5])}c.transform(u),u.scale(1/c.zoomX,1/c.zoomY),u.drawImage(c._cacheCanvas,-c.cacheTranslationX,-c.cacheTranslationY),u.restore()},drawObject:function(u,c){var h=this.fill,d=this.stroke;c?(this.fill="black",this.stroke="",this._setClippingProperties(u)):this._renderBackground(u),this._render(u),this._drawClipPath(u,this.clipPath),this.fill=h,this.stroke=d},_drawClipPath:function(u,c){c&&(c.canvas=this.canvas,c.shouldCache(),c._transformDone=!0,c.renderCache({forClipping:!0}),this.drawClipPathOnCache(u,c))},drawCacheOnCanvas:function(u){u.scale(1/this.zoomX,1/this.zoomY),u.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(u){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!u&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!u){var c=this.cacheWidth/this.zoomX,h=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-c/2,-h/2,c,h)}return!0}return!1},_renderBackground:function(u){if(this.backgroundColor){var c=this._getNonTransformedDimensions();u.fillStyle=this.backgroundColor,u.fillRect(-c.x/2,-c.y/2,c.x,c.y),this._removeShadow(u)}},_setOpacity:function(u){this.group&&!this.group._transformDone?u.globalAlpha=this.getObjectOpacity():u.globalAlpha*=this.opacity},_setStrokeStyles:function(u,c){var h=c.stroke;h&&(u.lineWidth=c.strokeWidth,u.lineCap=c.strokeLineCap,u.lineDashOffset=c.strokeDashOffset,u.lineJoin=c.strokeLineJoin,u.miterLimit=c.strokeMiterLimit,h.toLive?h.gradientUnits==="percentage"||h.gradientTransform||h.patternTransform?this._applyPatternForTransformedGradient(u,h):(u.strokeStyle=h.toLive(u,this),this._applyPatternGradientTransform(u,h)):u.strokeStyle=c.stroke)},_setFillStyles:function(u,c){var h=c.fill;h&&(h.toLive?(u.fillStyle=h.toLive(u,this),this._applyPatternGradientTransform(u,c.fill)):u.fillStyle=h)},_setClippingProperties:function(u){u.globalAlpha=1,u.strokeStyle="transparent",u.fillStyle="#000000"},_setLineDash:function(u,c){!c||c.length===0||(1&c.length&&c.push.apply(c,c),u.setLineDash(c))},_renderControls:function(u,c){var h=this.getViewportTransform(),d=this.calcTransformMatrix(),g,m,y;c=c||{},m=typeof c.hasBorders<"u"?c.hasBorders:this.hasBorders,y=typeof c.hasControls<"u"?c.hasControls:this.hasControls,d=e.util.multiplyTransformMatrices(h,d),g=e.util.qrDecompose(d),u.save(),u.translate(g.translateX,g.translateY),u.lineWidth=1*this.borderScaleFactor,this.group||(u.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(g.angle-=180),u.rotate(i(this.group?g.angle:this.angle)),c.forActiveSelection||this.group?m&&this.drawBordersInGroup(u,g,c):m&&this.drawBorders(u,c),y&&this.drawControls(u,c),u.restore()},_setShadow:function(u){if(this.shadow){var c=this.shadow,h=this.canvas,d,g=h&&h.viewportTransform[0]||1,m=h&&h.viewportTransform[3]||1;c.nonScaling?d={scaleX:1,scaleY:1}:d=this.getObjectScaling(),h&&h._isRetinaScaling()&&(g*=e.devicePixelRatio,m*=e.devicePixelRatio),u.shadowColor=c.color,u.shadowBlur=c.blur*e.browserShadowBlurConstant*(g+m)*(d.scaleX+d.scaleY)/4,u.shadowOffsetX=c.offsetX*g*d.scaleX,u.shadowOffsetY=c.offsetY*m*d.scaleY}},_removeShadow:function(u){this.shadow&&(u.shadowColor="",u.shadowBlur=u.shadowOffsetX=u.shadowOffsetY=0)},_applyPatternGradientTransform:function(u,c){if(!c||!c.toLive)return{offsetX:0,offsetY:0};var h=c.gradientTransform||c.patternTransform,d=-this.width/2+c.offsetX||0,g=-this.height/2+c.offsetY||0;return c.gradientUnits==="percentage"?u.transform(this.width,0,0,this.height,d,g):u.transform(1,0,0,1,d,g),h&&u.transform(h[0],h[1],h[2],h[3],h[4],h[5]),{offsetX:d,offsetY:g}},_renderPaintInOrder:function(u){this.paintFirst==="stroke"?(this._renderStroke(u),this._renderFill(u)):(this._renderFill(u),this._renderStroke(u))},_render:function(){},_renderFill:function(u){this.fill&&(u.save(),this._setFillStyles(u,this),this.fillRule==="evenodd"?u.fill("evenodd"):u.fill(),u.restore())},_renderStroke:function(u){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(u),u.save(),this.strokeUniform&&this.group){var c=this.getObjectScaling();u.scale(1/c.scaleX,1/c.scaleY)}else this.strokeUniform&&u.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(u,this.strokeDashArray),this._setStrokeStyles(u,this),u.stroke(),u.restore()}},_applyPatternForTransformedGradient:function(u,c){var h=this._limitCacheSize(this._getCacheCanvasDimensions()),d=e.util.createCanvasElement(),g,m=this.canvas.getRetinaScaling(),y=h.x/this.scaleX/m,C=h.y/this.scaleY/m;d.width=y,d.height=C,g=d.getContext("2d"),g.beginPath(),g.moveTo(0,0),g.lineTo(y,0),g.lineTo(y,C),g.lineTo(0,C),g.closePath(),g.translate(y/2,C/2),g.scale(h.zoomX/this.scaleX/m,h.zoomY/this.scaleY/m),this._applyPatternGradientTransform(g,c),g.fillStyle=c.toLive(u),g.fill(),u.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),u.scale(m*this.scaleX/h.zoomX,m*this.scaleY/h.zoomY),u.strokeStyle=g.createPattern(d,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var u=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",u.scaleX),this.set("scaleY",u.scaleY),this.angle=u.angle,this.skewX=u.skewX,this.skewY=0}},_removeTransformMatrix:function(u){var c=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),c=e.util.transformPoint(c,this.transformMatrix)),this.transformMatrix=null,u&&(this.scaleX*=u.scaleX,this.scaleY*=u.scaleY,this.cropX=u.cropX,this.cropY=u.cropY,c.x+=u.offsetLeft,c.y+=u.offsetTop,this.width=u.width,this.height=u.height),this.setPositionByOrigin(c,"center","center")},clone:function(u,c){var h=this.toObject(c);this.constructor.fromObject?this.constructor.fromObject(h,u):e.Object._fromObject("Object",h,u)},cloneAsImage:function(u,c){var h=this.toCanvasElement(c);return u&&u(new e.Image(h)),this},toCanvasElement:function(u){u||(u={});var c=e.util,h=c.saveObjectTransform(this),d=this.group,g=this.shadow,m=Math.abs,y=(u.multiplier||1)*(u.enableRetinaScaling?e.devicePixelRatio:1);delete this.group,u.withoutTransform&&c.resetObjectTransform(this),u.withoutShadow&&(this.shadow=null);var C=e.util.createCanvasElement(),b=this.getBoundingRect(!0,!0),k=this.shadow,L,N={x:0,y:0},M,W,Y;k&&(M=k.blur,k.nonScaling?L={scaleX:1,scaleY:1}:L=this.getObjectScaling(),N.x=2*Math.round(m(k.offsetX)+M)*m(L.scaleX),N.y=2*Math.round(m(k.offsetY)+M)*m(L.scaleY)),W=b.width+N.x,Y=b.height+N.y,C.width=Math.ceil(W),C.height=Math.ceil(Y);var J=new e.StaticCanvas(C,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});u.format==="jpeg"&&(J.backgroundColor="#fff"),this.setPositionByOrigin(new e.Point(J.width/2,J.height/2),"center","center");var oe=this.canvas;J.add(this);var pe=J.toCanvasElement(y||1,u);return this.shadow=g,this.set("canvas",oe),d&&(this.group=d),this.set(h).setCoords(),J._objects=[],J.dispose(),J=null,pe},toDataURL:function(u){return u||(u={}),e.util.toDataURL(this.toCanvasElement(u),u.format||"png",u.quality||1)},isType:function(u){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===u},complexity:function(){return 1},toJSON:function(u){return this.toObject(u)},rotate:function(u){var c=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return c&&this._setOriginToCenter(),this.set("angle",u),c&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(u,c){c=c||this.canvas.getPointer(u);var h=new e.Point(c.x,c.y),d=this._getLeftTopCoords();return this.angle&&(h=e.util.rotatePoint(h,d,i(-this.angle))),{x:h.x-d.x,y:h.y-d.y}},_setupCompositeOperation:function(u){this.globalCompositeOperation&&(u.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){e.runningAnimations&&e.runningAnimations.cancelByTarget(this)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),r(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object.ENLIVEN_PROPS=["clipPath"],e.Object._fromObject=function(u,c,h,d){var g=e[u];c=o(c,!0),e.util.enlivenPatterns([c.fill,c.stroke],function(m){typeof m[0]<"u"&&(c.fill=m[0]),typeof m[1]<"u"&&(c.stroke=m[1]),e.util.enlivenObjectEnlivables(c,c,function(){var y=d?new g(c[d],c):new g(c);h&&h(y)})})},e.Object.__uid=0)})(_e);(function(){var t=D.util.degreesToRadians,e={left:-.5,center:0,right:.5},r={top:-.5,center:0,bottom:.5};D.util.object.extend(D.Object.prototype,{translateToGivenOrigin:function(o,n,s,i,a){var l=o.x,u=o.y,c,h,d;return typeof n=="string"?n=e[n]:n-=.5,typeof i=="string"?i=e[i]:i-=.5,c=i-n,typeof s=="string"?s=r[s]:s-=.5,typeof a=="string"?a=r[a]:a-=.5,h=a-s,(c||h)&&(d=this._getTransformedDimensions(),l=o.x+c*d.x,u=o.y+h*d.y),new D.Point(l,u)},translateToCenterPoint:function(o,n,s){var i=this.translateToGivenOrigin(o,n,s,"center","center");return this.angle?D.util.rotatePoint(i,o,t(this.angle)):i},translateToOriginPoint:function(o,n,s){var i=this.translateToGivenOrigin(o,"center","center",n,s);return this.angle?D.util.rotatePoint(i,o,t(this.angle)):i},getCenterPoint:function(){var o=new D.Point(this.left,this.top);return this.translateToCenterPoint(o,this.originX,this.originY)},getPointByOrigin:function(o,n){var s=this.getCenterPoint();return this.translateToOriginPoint(s,o,n)},toLocalPoint:function(o,n,s){var i=this.getCenterPoint(),a,l;return typeof n<"u"&&typeof s<"u"?a=this.translateToGivenOrigin(i,"center","center",n,s):a=new D.Point(this.left,this.top),l=new D.Point(o.x,o.y),this.angle&&(l=D.util.rotatePoint(l,i,-t(this.angle))),l.subtractEquals(a)},setPositionByOrigin:function(o,n,s){var i=this.translateToCenterPoint(o,n,s),a=this.translateToOriginPoint(i,this.originX,this.originY);this.set("left",a.x),this.set("top",a.y)},adjustPosition:function(o){var n=t(this.angle),s=this.getScaledWidth(),i=D.util.cos(n)*s,a=D.util.sin(n)*s,l,u;typeof this.originX=="string"?l=e[this.originX]:l=this.originX-.5,typeof o=="string"?u=e[o]:u=o-.5,this.left+=i*(u-l),this.top+=a*(u-l),this.setCoords(),this.originX=o},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var o=this.getCenterPoint();this.originX="center",this.originY="center",this.left=o.x,this.top=o.y},_resetOrigin:function(){var o=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=o.x,this.top=o.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})})();(function(){function t(s){return[new D.Point(s.tl.x,s.tl.y),new D.Point(s.tr.x,s.tr.y),new D.Point(s.br.x,s.br.y),new D.Point(s.bl.x,s.bl.y)]}var e=D.util,r=e.degreesToRadians,o=e.multiplyTransformMatrices,n=e.transformPoint;e.object.extend(D.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(s,i){return i?s?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),s?this.aCoords:this.lineCoords)},getCoords:function(s,i){return t(this._getCoords(s,i))},intersectsWithRect:function(s,i,a,l){var u=this.getCoords(a,l),c=D.Intersection.intersectPolygonRectangle(u,s,i);return c.status==="Intersection"},intersectsWithObject:function(s,i,a){var l=D.Intersection.intersectPolygonPolygon(this.getCoords(i,a),s.getCoords(i,a));return l.status==="Intersection"||s.isContainedWithinObject(this,i,a)||this.isContainedWithinObject(s,i,a)},isContainedWithinObject:function(s,i,a){for(var l=this.getCoords(i,a),u=i?s.aCoords:s.lineCoords,c=0,h=s._getImageLines(u);c<4;c++)if(!s.containsPoint(l[c],h))return!1;return!0},isContainedWithinRect:function(s,i,a,l){var u=this.getBoundingRect(a,l);return u.left>=s.x&&u.left+u.width<=i.x&&u.top>=s.y&&u.top+u.height<=i.y},containsPoint:function(s,c,a,l){var u=this._getCoords(a,l),c=c||this._getImageLines(u),h=this._findCrossPoints(s,c);return h!==0&&h%2===1},isOnScreen:function(s){if(!this.canvas)return!1;var i=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br,l=this.getCoords(!0,s);return l.some(function(u){return u.x<=a.x&&u.x>=i.x&&u.y<=a.y&&u.y>=i.y})||this.intersectsWithRect(i,a,!0,s)?!0:this._containsCenterOfCanvas(i,a,s)},_containsCenterOfCanvas:function(s,i,a){var l={x:(s.x+i.x)/2,y:(s.y+i.y)/2};return!!this.containsPoint(l,null,!0,a)},isPartiallyOnScreen:function(s){if(!this.canvas)return!1;var i=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br;if(this.intersectsWithRect(i,a,!0,s))return!0;var l=this.getCoords(!0,s).every(function(u){return(u.x>=a.x||u.x<=i.x)&&(u.y>=a.y||u.y<=i.y)});return l&&this._containsCenterOfCanvas(i,a,s)},_getImageLines:function(s){var i={topline:{o:s.tl,d:s.tr},rightline:{o:s.tr,d:s.br},bottomline:{o:s.br,d:s.bl},leftline:{o:s.bl,d:s.tl}};return i},_findCrossPoints:function(s,i){var a,l,u,c,h,d=0,g;for(var m in i)if(g=i[m],!(g.o.y<s.y&&g.d.y<s.y)&&!(g.o.y>=s.y&&g.d.y>=s.y)&&(g.o.x===g.d.x&&g.o.x>=s.x?h=g.o.x:(a=0,l=(g.d.y-g.o.y)/(g.d.x-g.o.x),u=s.y-a*s.x,c=g.o.y-l*g.o.x,h=-(u-c)/(a-l)),h>=s.x&&(d+=1),d===2))break;return d},getBoundingRect:function(s,i){var a=this.getCoords(s,i);return e.makeBoundingBoxFromPoints(a)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(s){return Math.abs(s)<this.minScaleLimit?s<0?-this.minScaleLimit:this.minScaleLimit:s===0?1e-4:s},scale:function(s){return this._set("scaleX",s),this._set("scaleY",s),this.setCoords()},scaleToWidth:function(s,i){var a=this.getBoundingRect(i).width/this.getScaledWidth();return this.scale(s/this.width/a)},scaleToHeight:function(s,i){var a=this.getBoundingRect(i).height/this.getScaledHeight();return this.scale(s/this.height/a)},calcLineCoords:function(){var s=this.getViewportTransform(),i=this.padding,a=r(this.angle),l=e.cos(a),u=e.sin(a),c=l*i,h=u*i,d=c+h,g=c-h,m=this.calcACoords(),y={tl:n(m.tl,s),tr:n(m.tr,s),bl:n(m.bl,s),br:n(m.br,s)};return i&&(y.tl.x-=g,y.tl.y-=d,y.tr.x+=d,y.tr.y-=g,y.bl.x-=d,y.bl.y+=g,y.br.x+=g,y.br.y+=d),y},calcOCoords:function(){var s=this._calcRotateMatrix(),i=this._calcTranslateMatrix(),a=this.getViewportTransform(),l=o(a,i),u=o(l,s),u=o(u,[1/a[0],0,0,1/a[3],0,0]),c=this._calculateCurrentDimensions(),h={};return this.forEachControl(function(d,g,m){h[g]=d.positionHandler(c,u,m)}),h},calcACoords:function(){var s=this._calcRotateMatrix(),i=this._calcTranslateMatrix(),a=o(i,s),l=this._getTransformedDimensions(),u=l.x/2,c=l.y/2;return{tl:n({x:-u,y:-c},a),tr:n({x:u,y:-c},a),bl:n({x:-u,y:c},a),br:n({x:u,y:c},a)}},setCoords:function(s){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),s?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return e.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var s=this.getCenterPoint();return[1,0,0,1,s.x,s.y]},transformMatrixKey:function(s){var i="_",a="";return!s&&this.group&&(a=this.group.transformMatrixKey(s)+i),a+this.top+i+this.left+i+this.scaleX+i+this.scaleY+i+this.skewX+i+this.skewY+i+this.angle+i+this.originX+i+this.originY+i+this.width+i+this.height+i+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(s){var i=this.calcOwnMatrix();if(s||!this.group)return i;var a=this.transformMatrixKey(s),l=this.matrixCache||(this.matrixCache={});return l.key===a?l.value:(this.group&&(i=o(this.group.calcTransformMatrix(!1),i)),l.key=a,l.value=i,i)},calcOwnMatrix:function(){var s=this.transformMatrixKey(!0),i=this.ownMatrixCache||(this.ownMatrixCache={});if(i.key===s)return i.value;var a=this._calcTranslateMatrix(),l={angle:this.angle,translateX:a[4],translateY:a[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return i.key=s,i.value=e.composeMatrix(l),i.value},_getNonTransformedDimensions:function(){var s=this.strokeWidth,i=this.width+s,a=this.height+s;return{x:i,y:a}},_getTransformedDimensions:function(s,i){typeof s>"u"&&(s=this.skewX),typeof i>"u"&&(i=this.skewY);var a,l,u,c=s===0&&i===0;if(this.strokeUniform?(l=this.width,u=this.height):(a=this._getNonTransformedDimensions(),l=a.x,u=a.y),c)return this._finalizeDimensions(l*this.scaleX,u*this.scaleY);var h=e.sizeAfterTransform(l,u,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:s,skewY:i});return this._finalizeDimensions(h.x,h.y)},_finalizeDimensions:function(s,i){return this.strokeUniform?{x:s+this.strokeWidth,y:i+this.strokeWidth}:{x:s,y:i}},_calculateCurrentDimensions:function(){var s=this.getViewportTransform(),i=this._getTransformedDimensions(),a=n(i,s,!0);return a.scalarAdd(2*this.padding)}})})();D.util.object.extend(D.Object.prototype,{sendToBack:function(){return this.group?D.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?D.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?D.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas&&this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?D.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas&&this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group&&this.group.type!=="activeSelection"?D.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas&&this.canvas.moveTo(this,t),this}});(function(){function t(r,o){if(o){if(o.toLive)return r+": url(#SVGID_"+o.id+"); ";var n=new D.Color(o),s=r+": "+n.toRgb()+"; ",i=n.getAlpha();return i!==1&&(s+=r+"-opacity: "+i.toString()+"; "),s}else return r+": none; "}var e=D.util.toFixed;D.util.object.extend(D.Object.prototype,{getSvgStyles:function(r){var o=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):"none",i=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",l=this.strokeLineJoin?this.strokeLineJoin:"miter",u=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=typeof this.opacity<"u"?this.opacity:"1",h=this.visible?"":" visibility: hidden;",d=r?"":this.getSvgFilter(),g=t("fill",this.fill),m=t("stroke",this.stroke);return[m,"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",i,"; ","stroke-linejoin: ",l,"; ","stroke-miterlimit: ",u,"; ",g,"fill-rule: ",o,"; ","opacity: ",c,";",d,h].join("")},getSvgSpanStyles:function(r,o){var n="; ",i=r.fontFamily?"font-family: "+(r.fontFamily.indexOf("'")===-1&&r.fontFamily.indexOf('"')===-1?"'"+r.fontFamily+"'":r.fontFamily)+n:"",s=r.strokeWidth?"stroke-width: "+r.strokeWidth+n:"",i=i,a=r.fontSize?"font-size: "+r.fontSize+"px"+n:"",l=r.fontStyle?"font-style: "+r.fontStyle+n:"",u=r.fontWeight?"font-weight: "+r.fontWeight+n:"",c=r.fill?t("fill",r.fill):"",h=r.stroke?t("stroke",r.stroke):"",d=this.getSvgTextDecoration(r),g=r.deltaY?"baseline-shift: "+-r.deltaY+"; ":"";return d&&(d="text-decoration: "+d+n),[h,s,i,a,l,u,d,c,g,o?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(r){return["overline","underline","line-through"].filter(function(o){return r[o.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(r,o){var n=r?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'+D.util.matrixToSVG(n);return s+(o||"")+'" '},_setSVGBg:function(r){if(this.backgroundColor){var o=D.Object.NUM_FRACTION_DIGITS;r.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',e(-this.width/2,o),'" y="',e(-this.height/2,o),'" width="',e(this.width,o),'" height="',e(this.height,o),`"></rect>
`)}},toSVG:function(r){return this._createBaseSVGMarkup(this._toSVG(r),{reviver:r})},toClipPathSVG:function(r){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(r),{reviver:r})},_createBaseClipPathSVGMarkup:function(r,o){o=o||{};var n=o.reviver,s=o.additionalTransform||"",i=[this.getSvgTransform(!0,s),this.getSvgCommons()].join(""),a=r.indexOf("COMMON_PARTS");return r[a]=i,n?n(r.join("")):r.join("")},_createBaseSVGMarkup:function(r,o){o=o||{};var n=o.noStyle,s=o.reviver,i=n?"":'style="'+this.getSvgStyles()+'" ',a=o.withShadow?'style="'+this.getSvgFilter()+'" ':"",l=this.clipPath,u=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",c=l&&l.absolutePositioned,h=this.stroke,d=this.fill,g=this.shadow,m,y=[],C,b=r.indexOf("COMMON_PARTS"),k=o.additionalTransform;return l&&(l.clipPathId="CLIPPATH_"+D.Object.__uid++,C='<clipPath id="'+l.clipPathId+`" >
`+l.toClipPathSVG(s)+`</clipPath>
`),c&&y.push("<g ",a,this.getSvgCommons(),` >
`),y.push("<g ",this.getSvgTransform(!1),c?"":a+this.getSvgCommons(),` >
`),m=[i,u,n?"":this.addPaintOrder()," ",k?'transform="'+k+'" ':""].join(""),r[b]=m,d&&d.toLive&&y.push(d.toSVG(this)),h&&h.toLive&&y.push(h.toSVG(this)),g&&y.push(g.toSVG(this)),l&&y.push(C),y.push(r.join("")),y.push(`</g>
`),c&&y.push(`</g>
`),s?s(y.join("")):y.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})})();(function(){var t=D.util.object.extend,e="stateProperties";function r(n,s,i){var a={},l=!0;i.forEach(function(u){a[u]=n[u]}),t(n[s],a,l)}function o(n,s,i){if(n===s)return!0;if(Array.isArray(n)){if(!Array.isArray(s)||n.length!==s.length)return!1;for(var a=0,l=n.length;a<l;a++)if(!o(n[a],s[a]))return!1;return!0}else if(n&&typeof n=="object"){var u=Object.keys(n),c;if(!s||typeof s!="object"||!i&&u.length!==Object.keys(s).length)return!1;for(var a=0,l=u.length;a<l;a++)if(c=u[a],!(c==="canvas"||c==="group")&&!o(n[c],s[c]))return!1;return!0}}D.util.object.extend(D.Object.prototype,{hasStateChanged:function(n){n=n||e;var s="_"+n;return Object.keys(this[s]).length<this[n].length?!0:!o(this[s],this,!0)},saveState:function(n){var s=n&&n.propertySet||e,i="_"+s;return this[i]?(r(this,i,this[s]),n&&n.stateProperties&&r(this,i,n.stateProperties),this):this.setupState(n)},setupState:function(n){n=n||{};var s=n.propertySet||e;return n.propertySet=s,this["_"+s]={},this.saveState(n),this}})})();(function(){var t=D.util.degreesToRadians;D.util.object.extend(D.Object.prototype,{_findTargetCorner:function(e,r){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var o=e.x,n=e.y,s,i,a=Object.keys(this.oCoords),l=a.length-1,u;for(this.__corner=0;l>=0;l--)if(u=a[l],!!this.isControlVisible(u)&&(i=this._getImageLines(r?this.oCoords[u].touchCorner:this.oCoords[u].corner),s=this._findCrossPoints({x:o,y:n},i),s!==0&&s%2===1))return this.__corner=u,u;return!1},forEachControl:function(e){for(var r in this.controls)e(this.controls[r],r,this)},_setCornerCoords:function(){var e=this.oCoords;for(var r in e){var o=this.controls[r];e[r].corner=o.calcCornerCoords(this.angle,this.cornerSize,e[r].x,e[r].y,!1),e[r].touchCorner=o.calcCornerCoords(this.angle,this.touchCornerSize,e[r].x,e[r].y,!0)}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var r=this.getCenterPoint(),o=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return e.translate(r.x,r.y),e.scale(1/n[0],1/n[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-o.x/2,-o.y/2,o.x,o.y),e.restore(),this},drawBorders:function(e,r){r=r||{};var o=this._calculateCurrentDimensions(),n=this.borderScaleFactor,s=o.x+n,i=o.y+n,a=typeof r.hasControls<"u"?r.hasControls:this.hasControls,l=!1;return e.save(),e.strokeStyle=r.borderColor||this.borderColor,this._setLineDash(e,r.borderDashArray||this.borderDashArray),e.strokeRect(-s/2,-i/2,s,i),a&&(e.beginPath(),this.forEachControl(function(u,c,h){u.withConnection&&u.getVisibility(h,c)&&(l=!0,e.moveTo(u.x*s,u.y*i),e.lineTo(u.x*s+u.offsetX,u.y*i+u.offsetY))}),l&&e.stroke()),e.restore(),this},drawBordersInGroup:function(e,r,o){o=o||{};var n=D.util.sizeAfterTransform(this.width,this.height,r),s=this.strokeWidth,i=this.strokeUniform,a=this.borderScaleFactor,l=n.x+s*(i?this.canvas.getZoom():r.scaleX)+a,u=n.y+s*(i?this.canvas.getZoom():r.scaleY)+a;return e.save(),this._setLineDash(e,o.borderDashArray||this.borderDashArray),e.strokeStyle=o.borderColor||this.borderColor,e.strokeRect(-l/2,-u/2,l,u),e.restore(),this},drawControls:function(e,r){r=r||{},e.save();var o=this.canvas.getRetinaScaling(),n,s;return e.setTransform(o,0,0,o,0,0),e.strokeStyle=e.fillStyle=r.cornerColor||this.cornerColor,this.transparentCorners||(e.strokeStyle=r.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(e,r.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(n=this.group.calcTransformMatrix()),this.forEachControl(function(i,a,l){s=l.oCoords[a],i.getVisibility(l,a)&&(n&&(s=D.util.transformPoint(s,n)),i.render(e,s.x,s.y,r,l))}),e.restore(),this},isControlVisible:function(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)},setControlVisible:function(e,r){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=r,this},setControlsVisibility:function(e){e||(e={});for(var r in e)this.setControlVisible(r,e[r]);return this},onDeselect:function(){},onSelect:function(){}})})();D.util.object.extend(D.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){e=e||{};var r=function(){},o=e.onComplete||r,n=e.onChange||r,s=this;return D.util.animate({target:this,startValue:t.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(i){t.set("left",i),s.requestRenderAll(),n()},onComplete:function(){t.setCoords(),o()}})},fxCenterObjectV:function(t,e){e=e||{};var r=function(){},o=e.onComplete||r,n=e.onChange||r,s=this;return D.util.animate({target:this,startValue:t.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(i){t.set("top",i),s.requestRenderAll(),n()},onComplete:function(){t.setCoords(),o()}})},fxRemove:function(t,e){e=e||{};var r=function(){},o=e.onComplete||r,n=e.onChange||r,s=this;return D.util.animate({target:this,startValue:t.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(i){t.set("opacity",i),s.requestRenderAll(),n()},onComplete:function(){s.remove(t),o()}})}});D.util.object.extend(D.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var t=[],e,r,o=[];for(e in arguments[0])t.push(e);for(var n=0,s=t.length;n<s;n++)e=t[n],r=n!==s-1,o.push(this._animate(e,arguments[0][e],arguments[1],r));return o}else return this._animate.apply(this,arguments)},_animate:function(t,e,r,o){var n=this,s;e=e.toString(),r?r=D.util.object.clone(r):r={},~t.indexOf(".")&&(s=t.split("."));var i=n.colorProperties.indexOf(t)>-1||s&&n.colorProperties.indexOf(s[1])>-1,a=s?this.get(s[0])[s[1]]:this.get(t);"from"in r||(r.from=a),i||(~e.indexOf("=")?e=a+parseFloat(e.replace("=","")):e=parseFloat(e));var l={target:this,startValue:r.from,endValue:e,byValue:r.by,easing:r.easing,duration:r.duration,abort:r.abort&&function(u,c,h){return r.abort.call(n,u,c,h)},onChange:function(u,c,h){s?n[s[0]][s[1]]=u:n.set(t,u),!o&&r.onChange&&r.onChange(u,c,h)},onComplete:function(u,c,h){o||(n.setCoords(),r.onComplete&&r.onComplete(u,c,h))}};return i?D.util.animateColor(l.startValue,l.endValue,l.duration,l):D.util.animate(l)}});(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,o=e.util.object.clone,n={x1:1,x2:1,y1:1,y2:1};if(e.Line){e.warn("fabric.Line is already defined");return}e.Line=e.util.createClass(e.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:e.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(i,a){i||(i=[0,0,0,0]),this.callSuper("initialize",a),this.set("x1",i[0]),this.set("y1",i[1]),this.set("x2",i[2]),this.set("y2",i[3]),this._setWidthHeight(a)},_setWidthHeight:function(i){i||(i={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in i?i.left:this._getLeftToOriginX(),this.top="top"in i?i.top:this._getTopToOriginY()},_set:function(i,a){return this.callSuper("_set",i,a),typeof n[i]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:s({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:s({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(i){i.beginPath();var a=this.calcLinePoints();i.moveTo(a.x1,a.y1),i.lineTo(a.x2,a.y2),i.lineWidth=this.strokeWidth;var l=i.strokeStyle;i.strokeStyle=this.stroke||i.fillStyle,this.stroke&&this._renderStroke(i),i.strokeStyle=l},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(i){return r(this.callSuper("toObject",i),this.calcLinePoints())},_getNonTransformedDimensions:function(){var i=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(i.y-=this.strokeWidth),this.height===0&&(i.x-=this.strokeWidth)),i},calcLinePoints:function(){var i=this.x1<=this.x2?-1:1,a=this.y1<=this.y2?-1:1,l=i*this.width*.5,u=a*this.height*.5,c=i*this.width*-.5,h=a*this.height*-.5;return{x1:l,x2:c,y1:u,y2:h}},_toSVG:function(){var i=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',i.x1,'" y1="',i.y1,'" x2="',i.x2,'" y2="',i.y2,`" />
`]}}),e.Line.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),e.Line.fromElement=function(i,a,l){l=l||{};var u=e.parseAttributes(i,e.Line.ATTRIBUTE_NAMES),c=[u.x1||0,u.y1||0,u.x2||0,u.y2||0];a(new e.Line(c,r(u,l)))},e.Line.fromObject=function(i,a){function l(c){delete c.points,a&&a(c)}var u=o(i,!0);u.points=[i.x1,i.y1,i.x2,i.y2],e.Object._fromObject("Line",u,l,"points")};function s(i,a){var l=i.origin,u=i.axis1,c=i.axis2,h=i.dimension,d=a.nearest,g=a.center,m=a.farthest;return function(){switch(this.get(l)){case d:return Math.min(this.get(u),this.get(c));case g:return Math.min(this.get(u),this.get(c))+.5*this.get(h);case m:return Math.max(this.get(u),this.get(c))}}}})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.degreesToRadians;if(e.Circle){e.warn("fabric.Circle is already defined.");return}e.Circle=e.util.createClass(e.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:e.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(n,s){return this.callSuper("_set",n,s),n==="radius"&&this.setRadius(s),this},toObject:function(n){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(n))},_toSVG:function(){var n,s=0,i=0,a=(this.endAngle-this.startAngle)%360;if(a===0)n=["<circle ","COMMON_PARTS",'cx="'+s+'" cy="'+i+'" ','r="',this.radius,`" />
`];else{var l=r(this.startAngle),u=r(this.endAngle),c=this.radius,h=e.util.cos(l)*c,d=e.util.sin(l)*c,g=e.util.cos(u)*c,m=e.util.sin(u)*c,y=a>180?"1":"0";n=['<path d="M '+h+" "+d," A "+c+" "+c," 0 ",+y+" 1"," "+g+" "+m,'" ',"COMMON_PARTS",` />
`]}return n},_render:function(n){n.beginPath(),n.arc(0,0,this.radius,r(this.startAngle),r(this.endAngle),!1),this._renderPaintInOrder(n)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(n){return this.radius=n,this.set("width",n*2).set("height",n*2)}}),e.Circle.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),e.Circle.fromElement=function(n,s){var i=e.parseAttributes(n,e.Circle.ATTRIBUTE_NAMES);if(!o(i))throw new Error("value of `r` attribute is required and can not be negative");i.left=(i.left||0)-i.radius,i.top=(i.top||0)-i.radius,s(new e.Circle(i))};function o(n){return"radius"in n&&n.radius>=0}e.Circle.fromObject=function(n,s){e.Object._fromObject("Circle",n,s)}})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Triangle){e.warn("fabric.Triangle is already defined");return}e.Triangle=e.util.createClass(e.Object,{type:"triangle",width:100,height:100,_render:function(r){var o=this.width/2,n=this.height/2;r.beginPath(),r.moveTo(-o,n),r.lineTo(0,-n),r.lineTo(o,n),r.closePath(),this._renderPaintInOrder(r)},_toSVG:function(){var r=this.width/2,o=this.height/2,n=[-r+" "+o,"0 "+-o,r+" "+o].join(",");return["<polygon ","COMMON_PARTS",'points="',n,'" />']}}),e.Triangle.fromObject=function(r,o){return e.Object._fromObject("Triangle",r,o)}})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=Math.PI*2;if(e.Ellipse){e.warn("fabric.Ellipse is already defined.");return}e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this.set("rx",o&&o.rx||0),this.set("ry",o&&o.ry||0)},_set:function(o,n){switch(this.callSuper("_set",o,n),o){case"rx":this.rx=n,this.set("width",n*2);break;case"ry":this.ry=n,this.set("height",n*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(o){o.beginPath(),o.save(),o.transform(1,0,0,this.ry/this.rx,0,0),o.arc(0,0,this.rx,0,r,!1),o.restore(),this._renderPaintInOrder(o)}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(o,n){var s=e.parseAttributes(o,e.Ellipse.ATTRIBUTE_NAMES);s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,n(new e.Ellipse(s))},e.Ellipse.fromObject=function(o,n){e.Object._fromObject("Ellipse",o,n)}})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend;if(e.Rect){e.warn("fabric.Rect is already defined");return}e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(o){var n=this.rx?Math.min(this.rx,this.width/2):0,s=this.ry?Math.min(this.ry,this.height/2):0,i=this.width,a=this.height,l=-this.width/2,u=-this.height/2,c=n!==0||s!==0,h=1-.5522847498;o.beginPath(),o.moveTo(l+n,u),o.lineTo(l+i-n,u),c&&o.bezierCurveTo(l+i-h*n,u,l+i,u+h*s,l+i,u+s),o.lineTo(l+i,u+a-s),c&&o.bezierCurveTo(l+i,u+a-h*s,l+i-h*n,u+a,l+i-n,u+a),o.lineTo(l+n,u+a),c&&o.bezierCurveTo(l+h*n,u+a,l,u+a-h*s,l,u+a-s),o.lineTo(l,u+s),c&&o.bezierCurveTo(l,u+h*s,l+h*n,u,l+n,u),o.closePath(),this._renderPaintInOrder(o)},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){var o=-this.width/2,n=-this.height/2;return["<rect ","COMMON_PARTS",'x="',o,'" y="',n,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(o,n,s){if(!o)return n(null);s=s||{};var i=e.parseAttributes(o,e.Rect.ATTRIBUTE_NAMES);i.left=i.left||0,i.top=i.top||0,i.height=i.height||0,i.width=i.width||0;var a=new e.Rect(r(s?e.util.object.clone(s):{},i));a.visible=a.visible&&a.width>0&&a.height>0,n(a)},e.Rect.fromObject=function(o,n){return e.Object._fromObject("Rect",o,n)}})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,o=e.util.array.min,n=e.util.array.max,s=e.util.toFixed,i=e.util.projectStrokeOnPoints;if(e.Polyline){e.warn("fabric.Polyline is already defined");return}e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:e.Object.prototype.cacheProperties.concat("points"),initialize:function(a,l){l=l||{},this.points=a||[],this.callSuper("initialize",l),this._setPositionDimensions(l)},_projectStrokeOnPoints:function(){return i(this.points,this,!0)},_setPositionDimensions:function(a){var l=this._calcDimensions(a),u,c=this.exactBoundingBox?this.strokeWidth:0;this.width=l.width-c,this.height=l.height-c,a.fromSVG||(u=this.translateToGivenOrigin({x:l.left-this.strokeWidth/2+c/2,y:l.top-this.strokeWidth/2+c/2},"left","top",this.originX,this.originY)),typeof a.left>"u"&&(this.left=a.fromSVG?l.left:u.x),typeof a.top>"u"&&(this.top=a.fromSVG?l.top:u.y),this.pathOffset={x:l.left+this.width/2+c/2,y:l.top+this.height/2+c/2}},_calcDimensions:function(){var a=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,l=o(a,"x")||0,u=o(a,"y")||0,c=n(a,"x")||0,h=n(a,"y")||0,d=c-l,g=h-u;return{left:l,top:u,width:d,height:g}},toObject:function(a){return r(this.callSuper("toObject",a),{points:this.points.concat()})},_toSVG:function(){for(var a=[],l=this.pathOffset.x,u=this.pathOffset.y,c=e.Object.NUM_FRACTION_DIGITS,h=0,d=this.points.length;h<d;h++)a.push(s(this.points[h].x-l,c),",",s(this.points[h].y-u,c)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',a.join(""),`" />
`]},commonRender:function(a){var l,u=this.points.length,c=this.pathOffset.x,h=this.pathOffset.y;if(!u||isNaN(this.points[u-1].y))return!1;a.beginPath(),a.moveTo(this.points[0].x-c,this.points[0].y-h);for(var d=0;d<u;d++)l=this.points[d],a.lineTo(l.x-c,l.y-h);return!0},_render:function(a){this.commonRender(a)&&this._renderPaintInOrder(a)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElementGenerator=function(a){return function(l,u,c){if(!l)return u(null);c||(c={});var h=e.parsePointsAttribute(l.getAttribute("points")),d=e.parseAttributes(l,e[a].ATTRIBUTE_NAMES);d.fromSVG=!0,u(new e[a](h,r(d,c)))}},e.Polyline.fromElement=e.Polyline.fromElementGenerator("Polyline"),e.Polyline.fromObject=function(a,l){return e.Object._fromObject("Polyline",a,l,"points")}})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.projectStrokeOnPoints;if(e.Polygon){e.warn("fabric.Polygon is already defined");return}e.Polygon=e.util.createClass(e.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return r(this.points,this)},_render:function(o){this.commonRender(o)&&(o.closePath(),this._renderPaintInOrder(o))}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=e.Polyline.fromElementGenerator("Polygon"),e.Polygon.fromObject=function(o,n){e.Object._fromObject("Polygon",o,n,"points")}})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.array.min,o=e.util.array.max,n=e.util.object.extend,s=e.util.object.clone,i=e.util.toFixed;if(e.Path){e.warn("fabric.Path is already defined");return}e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(a,l){l=s(l||{}),delete l.path,this.callSuper("initialize",l),this._setPath(a||[],l)},_setPath:function(a,l){this.path=e.util.makePathSimpler(Array.isArray(a)?a:e.util.parsePath(a)),e.Polyline.prototype._setPositionDimensions.call(this,l||{})},_renderPathCommands:function(a){var l,u=0,c=0,h=0,d=0,g=0,m=0,y=-this.pathOffset.x,C=-this.pathOffset.y;a.beginPath();for(var b=0,k=this.path.length;b<k;++b)switch(l=this.path[b],l[0]){case"L":h=l[1],d=l[2],a.lineTo(h+y,d+C);break;case"M":h=l[1],d=l[2],u=h,c=d,a.moveTo(h+y,d+C);break;case"C":h=l[5],d=l[6],g=l[3],m=l[4],a.bezierCurveTo(l[1]+y,l[2]+C,g+y,m+C,h+y,d+C);break;case"Q":a.quadraticCurveTo(l[1]+y,l[2]+C,l[3]+y,l[4]+C),h=l[3],d=l[4],g=l[1],m=l[2];break;case"z":case"Z":h=u,d=c,a.closePath();break}},_render:function(a){this._renderPathCommands(a),this._renderPaintInOrder(a)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(a){return n(this.callSuper("toObject",a),{path:this.path.map(function(l){return l.slice()})})},toDatalessObject:function(a){var l=this.toObject(["sourcePath"].concat(a));return l.sourcePath&&delete l.path,l},_toSVG:function(){var a=e.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',a,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var a=e.Object.NUM_FRACTION_DIGITS;return" translate("+i(-this.pathOffset.x,a)+", "+i(-this.pathOffset.y,a)+")"},toClipPathSVG:function(a){var l=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:l})},toSVG:function(a){var l=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:l})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var a=[],l=[],u,c=0,h=0,d=0,g=0,m,y=0,C=this.path.length;y<C;++y){switch(u=this.path[y],u[0]){case"L":d=u[1],g=u[2],m=[];break;case"M":d=u[1],g=u[2],c=d,h=g,m=[];break;case"C":m=e.util.getBoundsOfCurve(d,g,u[1],u[2],u[3],u[4],u[5],u[6]),d=u[5],g=u[6];break;case"Q":m=e.util.getBoundsOfCurve(d,g,u[1],u[2],u[1],u[2],u[3],u[4]),d=u[3],g=u[4];break;case"z":case"Z":d=c,g=h;break}m.forEach(function(Y){a.push(Y.x),l.push(Y.y)}),a.push(d),l.push(g)}var b=r(a)||0,k=r(l)||0,L=o(a)||0,N=o(l)||0,M=L-b,W=N-k;return{left:b,top:k,width:M,height:W}}}),e.Path.fromObject=function(a,l){if(typeof a.sourcePath=="string"){var u=a.sourcePath;e.loadSVGFromURL(u,function(c){var h=c[0];h.setOptions(a),a.clipPath?e.util.enlivenObjects([a.clipPath],function(d){h.clipPath=d[0],l&&l(h)}):l&&l(h)})}else e.Object._fromObject("Path",a,l,"path")},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(a,l,u){var c=e.parseAttributes(a,e.Path.ATTRIBUTE_NAMES);c.fromSVG=!0,l(new e.Path(c.d,n(c,u)))}})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.array.min,o=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(n,s,i){s=s||{},this._objects=[],i&&this.callSuper("initialize",s),this._objects=n||[];for(var a=this._objects.length;a--;)this._objects[a].group=this;if(i)this._updateObjectsACoords();else{var l=s&&s.centerPoint;s.originX!==void 0&&(this.originX=s.originX),s.originY!==void 0&&(this.originY=s.originY),l||this._calcBounds(),this._updateObjectsCoords(l),delete s.centerPoint,this.callSuper("initialize",s)}this.setCoords()},_updateObjectsACoords:function(){for(var n=!0,s=this._objects.length;s--;)this._objects[s].setCoords(n)},_updateObjectsCoords:function(s){for(var s=s||this.getCenterPoint(),i=this._objects.length;i--;)this._updateObjectCoords(this._objects[i],s)},_updateObjectCoords:function(n,s){var i=n.left,a=n.top,l=!0;n.set({left:i-s.x,top:a-s.y}),n.group=this,n.setCoords(l)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(n){var s=!!this.group;return this._restoreObjectsState(),e.util.resetObjectTransform(this),n&&(s&&e.util.removeTransformFromObject(n,this.group.calcTransformMatrix()),this._objects.push(n),n.group=this,n._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,s?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(n){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(n),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(n){this.dirty=!0,n.group=this,n._set("canvas",this.canvas)},_onObjectRemoved:function(n){this.dirty=!0,delete n.group},_set:function(n,s){var i=this._objects.length;if(this.useSetOnGroup)for(;i--;)this._objects[i].setOnGroup(n,s);if(n==="canvas")for(;i--;)this._objects[i]._set(n,s);e.Object.prototype._set.call(this,n,s)},toObject:function(n){var s=this.includeDefaultValues,i=this._objects.filter(function(l){return!l.excludeFromExport}).map(function(l){var u=l.includeDefaultValues;l.includeDefaultValues=s;var c=l.toObject(n);return l.includeDefaultValues=u,c}),a=e.Object.prototype.toObject.call(this,n);return a.objects=i,a},toDatalessObject:function(n){var s,i=this.sourcePath;if(i)s=i;else{var a=this.includeDefaultValues;s=this._objects.map(function(u){var c=u.includeDefaultValues;u.includeDefaultValues=a;var h=u.toDatalessObject(n);return u.includeDefaultValues=c,h})}var l=e.Object.prototype.toDatalessObject.call(this,n);return l.objects=s,l},render:function(n){this._transformDone=!0,this.callSuper("render",n),this._transformDone=!1},shouldCache:function(){var n=e.Object.prototype.shouldCache.call(this);if(n){for(var s=0,i=this._objects.length;s<i;s++)if(this._objects[s].willDrawShadow())return this.ownCaching=!1,!1}return n},willDrawShadow:function(){if(e.Object.prototype.willDrawShadow.call(this))return!0;for(var n=0,s=this._objects.length;n<s;n++)if(this._objects[n].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(n){for(var s=0,i=this._objects.length;s<i;s++)this._objects[s].render(n);this._drawClipPath(n,this.clipPath)},isCacheDirty:function(n){if(this.callSuper("isCacheDirty",n))return!0;if(!this.statefullCache)return!1;for(var s=0,i=this._objects.length;s<i;s++)if(this._objects[s].isCacheDirty(!0)){if(this._cacheCanvas){var a=this.cacheWidth/this.zoomX,l=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-a/2,-l/2,a,l)}return!0}return!1},_restoreObjectsState:function(){var n=this.calcOwnMatrix();return this._objects.forEach(function(s){e.util.addTransformToObject(s,n),delete s.group,s.setCoords()}),this},destroy:function(){return this._objects.forEach(function(n){n.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(n){n.dispose&&n.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var n=this._objects,s=this.canvas;this._objects=[];var i=this.toObject();delete i.objects;var a=new e.ActiveSelection([]);return a.set(i),a.type="activeSelection",s.remove(this),n.forEach(function(l){l.group=a,l.dirty=!0,s.add(l)}),a.canvas=s,a._objects=n,s._activeObject=a,a.setCoords(),a}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var n=!0;return this.forEachObject(function(s){s.setCoords(n)}),this},_calcBounds:function(n){for(var s=[],i=[],a,l,u,c=["tr","br","bl","tl"],h=0,d=this._objects.length,g,m=c.length;h<d;++h){for(a=this._objects[h],u=a.calcACoords(),g=0;g<m;g++)l=c[g],s.push(u[l].x),i.push(u[l].y);a.aCoords=u}this._getBounds(s,i,n)},_getBounds:function(n,s,i){var a=new e.Point(r(n),r(s)),l=new e.Point(o(n),o(s)),u=a.y||0,c=a.x||0,h=l.x-a.x||0,d=l.y-a.y||0;this.width=h,this.height=d,i||this.setPositionByOrigin({x:c,y:u},"left","top")},_toSVG:function(n){for(var s=["<g ","COMMON_PARTS",` >
`],i=0,a=this._objects.length;i<a;i++)s.push("		",this._objects[i].toSVG(n));return s.push(`</g>
`),s},getSvgStyles:function(){var n=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",s=this.visible?"":" visibility: hidden;";return[n,this.getSvgFilter(),s].join("")},toClipPathSVG:function(n){for(var s=[],i=0,a=this._objects.length;i<a;i++)s.push("	",this._objects[i].toClipPathSVG(n));return this._createBaseClipPathSVGMarkup(s,{reviver:n})}}),e.Group.fromObject=function(n,s){var i=n.objects,a=e.util.object.clone(n,!0);if(delete a.objects,typeof i=="string"){e.loadSVGFromURL(i,function(l){var u=e.util.groupSVGElements(l,n,i),c=a.clipPath;delete a.clipPath,u.set(a),c?e.util.enlivenObjects([c],function(h){u.clipPath=h[0],s&&s(u)}):s&&s(u)});return}e.util.enlivenObjects(i,function(l){e.util.enlivenObjectEnlivables(n,a,function(){s&&s(new e.Group(l,a,!0))})})})})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(r,o){o=o||{},this._objects=r||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;o.originX&&(this.originX=o.originX),o.originY&&(this.originY=o.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,o),this.setCoords()},toGroup:function(){var r=this._objects.concat();this._objects=[];var o=e.Object.prototype.toObject.call(this),n=new e.Group([]);if(delete o.type,n.set(o),r.forEach(function(i){i.canvas.remove(i),i.group=n}),n._objects=r,!this.canvas)return n;var s=this.canvas;return s.add(n),s._activeObject=n,n.setCoords(),n},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(r,o,n){r.save(),r.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",r,o),n=n||{},typeof n.hasControls>"u"&&(n.hasControls=!1),n.forActiveSelection=!0;for(var s=0,i=this._objects.length;s<i;s++)this._objects[s]._renderControls(r,n);r.restore()}}),e.ActiveSelection.fromObject=function(r,o){e.util.enlivenObjects(r.objects,function(n){delete r.objects,o&&o(new e.ActiveSelection(n,r,!0))})})})(_e);(function(t){"use strict";var e=D.util.object.extend;if(t.fabric||(t.fabric={}),t.fabric.Image){D.warn("fabric.Image is already defined.");return}D.Image=D.util.createClass(D.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:D.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:D.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(r,o){o||(o={}),this.filters=[],this.cacheKey="texture"+D.Object.__uid++,this.callSuper("initialize",o),this._initElement(r,o)},getElement:function(){return this._element||{}},setElement:function(r,o){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=r,this._originalElement=r,this._initConfig(o),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(r){var o=D.filterBackend;o&&o.evictCachesForKey&&o.evictCachesForKey(r)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(r){D.util.cleanUpJsdomNode(this[r]),this[r]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var r=this.getElement();return{width:r.naturalWidth||r.width,height:r.naturalHeight||r.height}},_stroke:function(r){if(!(!this.stroke||this.strokeWidth===0)){var o=this.width/2,n=this.height/2;r.beginPath(),r.moveTo(-o,-n),r.lineTo(o,-n),r.lineTo(o,n),r.lineTo(-o,n),r.lineTo(-o,-n),r.closePath()}},toObject:function(r){var o=[];this.filters.forEach(function(s){s&&o.push(s.toObject())});var n=e(this.callSuper("toObject",["cropX","cropY"].concat(r)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:o});return this.resizeFilter&&(n.resizeFilter=this.resizeFilter.toObject()),n},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var r=[],o=[],n,s=this._element,i=-this.width/2,a=-this.height/2,l="",u="";if(!s)return[];if(this.hasCrop()){var c=D.Object.__uid++;r.push('<clipPath id="imageCrop_'+c+`">
`,'	<rect x="'+i+'" y="'+a+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),l=' clip-path="url(#imageCrop_'+c+')" '}if(this.imageSmoothing||(u='" image-rendering="optimizeSpeed'),o.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',i-this.cropX,'" y="',a-this.cropY,'" width="',s.width||s.naturalWidth,'" height="',s.height||s.height,u,'"',l,`></image>
`),this.stroke||this.strokeDashArray){var h=this.fill;this.fill=null,n=["	<rect ",'x="',i,'" y="',a,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=h}return this.paintFirst!=="fill"?r=r.concat(n,o):r=r.concat(o,n),r},getSrc:function(r){var o=r?this._element:this._originalElement;return o?o.toDataURL?o.toDataURL():this.srcFromAttribute?o.getAttribute("src"):o.src:this.src||""},setSrc:function(r,o,n){return D.util.loadImage(r,function(s,i){this.setElement(s,n),this._setWidthHeight(),o&&o(this,i)},this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var r=this.resizeFilter,o=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.scaleX,i=n.scaleY,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!r||s>o&&i>o){this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,this._lastScaleY=i;return}D.filterBackend||(D.filterBackend=D.initFilterBackend());var l=D.util.createCanvasElement(),u=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,c=a.width,h=a.height;l.width=c,l.height=h,this._element=l,this._lastScaleX=r.scaleX=s,this._lastScaleY=r.scaleY=i,D.filterBackend.applyFilters([r],a,c,h,this._element,u),this._filterScalingX=l.width/this._originalElement.width,this._filterScalingY=l.height/this._originalElement.height},applyFilters:function(r){if(r=r||this.filters||[],r=r.filter(function(a){return a&&!a.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),r.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var o=this._originalElement,n=o.naturalWidth||o.width,s=o.naturalHeight||o.height;if(this._element===this._originalElement){var i=D.util.createCanvasElement();i.width=n,i.height=s,this._element=i,this._filteredEl=i}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1;return D.filterBackend||(D.filterBackend=D.initFilterBackend()),D.filterBackend.applyFilters(r,this._originalElement,n,s,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(r){D.util.setImageSmoothing(r,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(r),this._renderPaintInOrder(r)},drawCacheOnCanvas:function(r){D.util.setImageSmoothing(r,this.imageSmoothing),D.Object.prototype.drawCacheOnCanvas.call(this,r)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(r){var o=this._element;if(o){var n=this._filterScalingX,s=this._filterScalingY,i=this.width,a=this.height,l=Math.min,u=Math.max,c=u(this.cropX,0),h=u(this.cropY,0),d=o.naturalWidth||o.width,g=o.naturalHeight||o.height,m=c*n,y=h*s,C=l(i*n,d-m),b=l(a*s,g-y),k=-i/2,L=-a/2,N=l(i,d/n-c),M=l(a,g/s-h);o&&r.drawImage(o,m,y,C,b,k,L,N,M)}},_needsResize:function(){var r=this.getTotalObjectScaling();return r.scaleX!==this._lastScaleX||r.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(r,o){this.setElement(D.util.getById(r),o),D.util.addClass(this.getElement(),D.Image.CSS_CANVAS)},_initConfig:function(r){r||(r={}),this.setOptions(r),this._setWidthHeight(r)},_initFilters:function(r,o){r&&r.length?D.util.enlivenObjects(r,function(n){o&&o(n)},"fabric.Image.filters"):o&&o()},_setWidthHeight:function(r){r||(r={});var o=this.getElement();this.width=r.width||o.naturalWidth||o.width||0,this.height=r.height||o.naturalHeight||o.height||0},parsePreserveAspectRatioAttribute:function(){var r=D.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),o=this._element.width,n=this._element.height,s=1,i=1,a=0,l=0,u=0,c=0,h,d=this.width,g=this.height,m={width:d,height:g};return r&&(r.alignX!=="none"||r.alignY!=="none")?(r.meetOrSlice==="meet"&&(s=i=D.util.findScaleToFit(this._element,m),h=(d-o*s)/2,r.alignX==="Min"&&(a=-h),r.alignX==="Max"&&(a=h),h=(g-n*i)/2,r.alignY==="Min"&&(l=-h),r.alignY==="Max"&&(l=h)),r.meetOrSlice==="slice"&&(s=i=D.util.findScaleToCover(this._element,m),h=o-d/s,r.alignX==="Mid"&&(u=h/2),r.alignX==="Max"&&(u=h),h=n-g/i,r.alignY==="Mid"&&(c=h/2),r.alignY==="Max"&&(c=h),o=d/s,n=g/i)):(s=d/o,i=g/n),{width:o,height:n,scaleX:s,scaleY:i,offsetLeft:a,offsetTop:l,cropX:u,cropY:c}}}),D.Image.CSS_CANVAS="canvas-img",D.Image.prototype.getSvgSrc=D.Image.prototype.getSrc,D.Image.fromObject=function(r,o){var n=D.util.object.clone(r);D.util.loadImage(n.src,function(s,i){if(i){o&&o(null,!0);return}D.Image.prototype._initFilters.call(n,n.filters,function(a){n.filters=a||[],D.Image.prototype._initFilters.call(n,[n.resizeFilter],function(l){n.resizeFilter=l[0],D.util.enlivenObjectEnlivables(n,n,function(){var u=new D.Image(s,n);o(u,!1)})})})},null,n.crossOrigin)},D.Image.fromURL=function(r,o,n){D.util.loadImage(r,function(s,i){o&&o(new D.Image(s,n),i)},null,n&&n.crossOrigin)},D.Image.ATTRIBUTE_NAMES=D.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),D.Image.fromElement=function(r,o,n){var s=D.parseAttributes(r,D.Image.ATTRIBUTE_NAMES);D.Image.fromURL(s["xlink:href"],o,e(n?D.util.object.clone(n):{},s))}})(_e);D.util.object.extend(D.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.angle%360;return t>0?Math.round((t-1)/90)*90:Math.round(t/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(t){t=t||{};var e=function(){},r=t.onComplete||e,o=t.onChange||e,n=this;return D.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(s){n.rotate(s),o()},onComplete:function(){n.setCoords(),r()}})}});D.util.object.extend(D.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.requestRenderAllBound})}});(function(){"use strict";function t(r,o){var n="precision "+o+` float;
void main(){}`,s=r.createShader(r.FRAGMENT_SHADER);return r.shaderSource(s,n),r.compileShader(s),!!r.getShaderParameter(s,r.COMPILE_STATUS)}D.isWebglSupported=function(r){if(D.isLikelyNode)return!1;r=r||D.WebglFilterBackend.prototype.tileSize;var o=document.createElement("canvas"),n=o.getContext("webgl")||o.getContext("experimental-webgl"),s=!1;if(n){D.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),s=D.maxTextureSize>=r;for(var i=["highp","mediump","lowp"],a=0;a<3;a++)if(t(n,i[a])){D.webGlPrecision=i[a];break}}return this.isSupported=s,s},D.WebglFilterBackend=e;function e(r){r&&r.tileSize&&(this.tileSize=r.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}e.prototype={tileSize:2048,resources:{},setupGLContext:function(r,o){this.dispose(),this.createWebGLCanvas(r,o),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(r,o)},chooseFastestCopyGLTo2DMethod:function(r,o){var n=typeof window.performance<"u",s;try{new ImageData(1,1),s=!0}catch{s=!1}var i=typeof ArrayBuffer<"u",a=typeof Uint8ClampedArray<"u";if(n&&s&&i&&a){var l=D.util.createCanvasElement(),u=new ArrayBuffer(r*o*4);if(D.forceGLPutImageData){this.imageBuffer=u,this.copyGLTo2D=cp;return}var c={imageBuffer:u,destinationWidth:r,destinationHeight:o,targetCanvas:l},h,d,g;l.width=r,l.height=o,h=window.performance.now(),lp.call(c,this.gl,c),d=window.performance.now()-h,h=window.performance.now(),cp.call(c,this.gl,c),g=window.performance.now()-h,d>g?(this.imageBuffer=u,this.copyGLTo2D=cp):this.copyGLTo2D=lp}},createWebGLCanvas:function(r,o){var n=D.util.createCanvasElement();n.width=r,n.height=o;var s={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},i=n.getContext("webgl",s);i||(i=n.getContext("experimental-webgl",s)),i&&(i.clearColor(0,0,0,0),this.canvas=n,this.gl=i)},applyFilters:function(r,o,n,s,i,a){var l=this.gl,u;a&&(u=this.getCachedTexture(a,o));var c={originalWidth:o.width||o.originalWidth,originalHeight:o.height||o.originalHeight,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:l,sourceTexture:this.createTexture(l,n,s,!u&&o),targetTexture:this.createTexture(l,n,s),originalTexture:u||this.createTexture(l,n,s,!u&&o),passes:r.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},h=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,h),r.forEach(function(d){d&&d.applyTo(c)}),hA(c),this.copyGLTo2D(l,c),l.bindTexture(l.TEXTURE_2D,null),l.deleteTexture(c.sourceTexture),l.deleteTexture(c.targetTexture),l.deleteFramebuffer(h),i.getContext("2d").setTransform(1,0,0,1,0,0),c},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(r,o,n,s){var i=r.createTexture();return r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),s?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,s):r.texImage2D(r.TEXTURE_2D,0,r.RGBA,o,n,0,r.RGBA,r.UNSIGNED_BYTE,null),i},getCachedTexture:function(r,o){if(this.textureCache[r])return this.textureCache[r];var n=this.createTexture(this.gl,o.width,o.height,o);return this.textureCache[r]=n,n},evictCachesForKey:function(r){this.textureCache[r]&&(this.gl.deleteTexture(this.textureCache[r]),delete this.textureCache[r])},copyGLTo2D:lp,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var r=this.gl,o={renderer:"",vendor:""};if(!r)return o;var n=r.getExtension("WEBGL_debug_renderer_info");if(n){var s=r.getParameter(n.UNMASKED_RENDERER_WEBGL),i=r.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(o.renderer=s.toLowerCase()),i&&(o.vendor=i.toLowerCase())}return this.gpuInfo=o,o}}})();function hA(t){var e=t.targetCanvas,r=e.width,o=e.height,n=t.destinationWidth,s=t.destinationHeight;(r!==n||o!==s)&&(e.width=n,e.height=s)}function lp(t,e){var r=t.canvas,o=e.targetCanvas,n=o.getContext("2d");n.translate(0,o.height),n.scale(1,-1);var s=r.height-o.height;n.drawImage(r,0,s,o.width,o.height,0,0,o.width,o.height)}function cp(t,e){var r=e.targetCanvas,o=r.getContext("2d"),n=e.destinationWidth,s=e.destinationHeight,i=n*s*4,a=new Uint8Array(this.imageBuffer,0,i),l=new Uint8ClampedArray(this.imageBuffer,0,i);t.readPixels(0,0,n,s,t.RGBA,t.UNSIGNED_BYTE,a);var u=new ImageData(l,n,s);o.putImageData(u,0,0)}(function(){"use strict";var t=function(){};D.Canvas2dFilterBackend=e;function e(){}e.prototype={evictCachesForKey:t,dispose:t,clearWebGLCaches:t,resources:{},applyFilters:function(r,o,n,s,i){var a=i.getContext("2d");a.drawImage(o,0,0,n,s);var l=a.getImageData(0,0,n,s),u=a.getImageData(0,0,n,s),c={sourceWidth:n,sourceHeight:s,imageData:l,originalEl:o,originalImageData:u,canvasEl:i,ctx:a,filterBackend:this};return r.forEach(function(h){h.applyTo(c)}),(c.imageData.width!==n||c.imageData.height!==s)&&(i.width=c.imageData.width,i.height=c.imageData.height),a.putImageData(c.imageData,0,0),c}}})();D.Image=D.Image||{};D.Image.filters=D.Image.filters||{};D.Image.filters.BaseFilter=D.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},createProgram:function(t,e,r){e=e||this.fragmentSource,r=r||this.vertexSource,D.webGlPrecision!=="highp"&&(e=e.replace(/precision highp float/g,"precision "+D.webGlPrecision+" float"));var o=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(o,r),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+t.getShaderInfoLog(o));var n=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+t.getShaderInfoLog(n));var s=t.createProgram();if(t.attachShader(s,o),t.attachShader(s,n),t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+t.getProgramInfoLog(s));var i=this.getAttributeLocations(t,s),a=this.getUniformLocations(t,s)||{};return a.uStepW=t.getUniformLocation(s,"uStepW"),a.uStepH=t.getUniformLocation(s,"uStepH"),{program:s,attributeLocations:i,uniformLocations:a}},getAttributeLocations:function(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(t,e,r){var o=e.aPosition,n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.enableVertexAttribArray(o),t.vertexAttribPointer(o,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW)},_setupFrameBuffer:function(t){var e=t.context,r,o;t.passes>1?(r=t.destinationWidth,o=t.destinationHeight,(t.sourceWidth!==r||t.sourceHeight!==o)&&(e.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(e,r,o)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.targetTexture,0)):(e.bindFramebuffer(e.FRAMEBUFFER,null),e.finish())},_swapTextures:function(t){t.passes--,t.pass++;var e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e},isNeutralState:function(){var t=this.mainParameter,e=D.Image.filters[this.type].prototype;if(t)if(Array.isArray(e[t])){for(var r=e[t].length;r--;)if(this[t][r]!==e[t][r])return!1;return!0}else return e[t]===this[t];else return!1},applyTo:function(t){t.webgl?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},retrieveShader:function(t){return t.programCache.hasOwnProperty(this.type)||(t.programCache[this.type]=this.createProgram(t.context)),t.programCache[this.type]},applyToWebGL:function(t){var e=t.context,r=this.retrieveShader(t);t.pass===0&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(r.program),this.sendAttributeData(e,r.attributeLocations,t.aPosition),e.uniform1f(r.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(r.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,r.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(t,e,r){t.activeTexture(r),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)},unbindAdditionalTexture:function(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(t){this[this.mainParameter]=t},sendUniformData:function(){},createHelpLayer:function(t){if(!t.helpLayer){var e=document.createElement("canvas");e.width=t.sourceWidth,e.height=t.sourceHeight,t.helpLayer=e}},toObject:function(){var t={type:this.type},e=this.mainParameter;return e&&(t[e]=this[e]),t},toJSON:function(){return this.toObject()}});D.Image.filters.BaseFilter.fromObject=function(t,e){var r=new D.Image.filters[t.type](t);return e&&e(r),r};(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.ColorMatrix=o(r.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(n){this.callSuper("initialize",n),this.matrix=this.matrix.slice(0)},applyTo2d:function(n){var s=n.imageData,i=s.data,a=i.length,l=this.matrix,u,c,h,d,g,m=this.colorsOnly;for(g=0;g<a;g+=4)u=i[g],c=i[g+1],h=i[g+2],m?(i[g]=u*l[0]+c*l[1]+h*l[2]+l[4]*255,i[g+1]=u*l[5]+c*l[6]+h*l[7]+l[9]*255,i[g+2]=u*l[10]+c*l[11]+h*l[12]+l[14]*255):(d=i[g+3],i[g]=u*l[0]+c*l[1]+h*l[2]+d*l[3]+l[4]*255,i[g+1]=u*l[5]+c*l[6]+h*l[7]+d*l[8]+l[9]*255,i[g+2]=u*l[10]+c*l[11]+h*l[12]+d*l[13]+l[14]*255,i[g+3]=u*l[15]+c*l[16]+h*l[17]+d*l[18]+l[19]*255)},getUniformLocations:function(n,s){return{uColorMatrix:n.getUniformLocation(s,"uColorMatrix"),uConstants:n.getUniformLocation(s,"uConstants")}},sendUniformData:function(n,s){var i=this.matrix,a=[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]],l=[i[4],i[9],i[14],i[19]];n.uniformMatrix4fv(s.uColorMatrix,!1,a),n.uniform4fv(s.uConstants,l)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Brightness=o(r.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(n){if(this.brightness!==0){var s=n.imageData,i=s.data,a,l=i.length,u=Math.round(this.brightness*255);for(a=0;a<l;a+=4)i[a]=i[a]+u,i[a+1]=i[a+1]+u,i[a+2]=i[a+2]+u}},getUniformLocations:function(n,s){return{uBrightness:n.getUniformLocation(s,"uBrightness")}},sendUniformData:function(n,s){n.uniform1f(s.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,o=e.Image.filters,n=e.util.createClass;o.Convolute=n(o.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(s){var i=Math.sqrt(this.matrix.length),a=this.type+"_"+i+"_"+(this.opaque?1:0),l=this.fragmentSource[a];return s.programCache.hasOwnProperty(a)||(s.programCache[a]=this.createProgram(s.context,l)),s.programCache[a]},applyTo2d:function(s){var i=s.imageData,a=i.data,l=this.matrix,u=Math.round(Math.sqrt(l.length)),c=Math.floor(u/2),h=i.width,d=i.height,g=s.ctx.createImageData(h,d),m=g.data,y=this.opaque?1:0,C,b,k,L,N,M,W,Y,J,oe,pe,le,w;for(pe=0;pe<d;pe++)for(oe=0;oe<h;oe++){for(N=(pe*h+oe)*4,C=0,b=0,k=0,L=0,w=0;w<u;w++)for(le=0;le<u;le++)W=pe+w-c,M=oe+le-c,!(W<0||W>=d||M<0||M>=h)&&(Y=(W*h+M)*4,J=l[w*u+le],C+=a[Y]*J,b+=a[Y+1]*J,k+=a[Y+2]*J,y||(L+=a[Y+3]*J));m[N]=C,m[N+1]=b,m[N+2]=k,y?m[N+3]=a[N+3]:m[N+3]=L}s.imageData=g},getUniformLocations:function(s,i){return{uMatrix:s.getUniformLocation(i,"uMatrix"),uOpaque:s.getUniformLocation(i,"uOpaque"),uHalfSize:s.getUniformLocation(i,"uHalfSize"),uSize:s.getUniformLocation(i,"uSize")}},sendUniformData:function(s,i){s.uniform1fv(i.uMatrix,this.matrix)},toObject:function(){return r(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Grayscale=o(r.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(n){var s=n.imageData,i=s.data,a,l=i.length,u,c=this.mode;for(a=0;a<l;a+=4)c==="average"?u=(i[a]+i[a+1]+i[a+2])/3:c==="lightness"?u=(Math.min(i[a],i[a+1],i[a+2])+Math.max(i[a],i[a+1],i[a+2]))/2:c==="luminosity"&&(u=.21*i[a]+.72*i[a+1]+.07*i[a+2]),i[a]=u,i[a+1]=u,i[a+2]=u},retrieveShader:function(n){var s=this.type+"_"+this.mode;if(!n.programCache.hasOwnProperty(s)){var i=this.fragmentSource[this.mode];n.programCache[s]=this.createProgram(n.context,i)}return n.programCache[s]},getUniformLocations:function(n,s){return{uMode:n.getUniformLocation(s,"uMode")}},sendUniformData:function(n,s){var i=1;n.uniform1i(s.uMode,i)},isNeutralState:function(){return!1}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Invert=o(r.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(n){var s=n.imageData,i=s.data,a,l=i.length;for(a=0;a<l;a+=4)i[a]=255-i[a],i[a+1]=255-i[a+1],i[a+2]=255-i[a+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(n,s){return{uInvert:n.getUniformLocation(s,"uInvert")}},sendUniformData:function(n,s){n.uniform1i(s.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,o=e.Image.filters,n=e.util.createClass;o.Noise=n(o.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(s){if(this.noise!==0){var i=s.imageData,a=i.data,l,u=a.length,c=this.noise,h;for(l=0,u=a.length;l<u;l+=4)h=(.5-Math.random())*c,a[l]+=h,a[l+1]+=h,a[l+2]+=h}},getUniformLocations:function(s,i){return{uNoise:s.getUniformLocation(i,"uNoise"),uSeed:s.getUniformLocation(i,"uSeed")}},sendUniformData:function(s,i){s.uniform1f(i.uNoise,this.noise/255),s.uniform1f(i.uSeed,Math.random())},toObject:function(){return r(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Pixelate=o(r.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(n){var s=n.imageData,i=s.data,a=s.height,l=s.width,u,c,h,d,g,m,y,C,b,k,L;for(c=0;c<a;c+=this.blocksize)for(h=0;h<l;h+=this.blocksize)for(u=c*4*l+h*4,d=i[u],g=i[u+1],m=i[u+2],y=i[u+3],k=Math.min(c+this.blocksize,a),L=Math.min(h+this.blocksize,l),C=c;C<k;C++)for(b=h;b<L;b++)u=C*4*l+b*4,i[u]=d,i[u+1]=g,i[u+2]=m,i[u+3]=y},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(n,s){return{uBlocksize:n.getUniformLocation(s,"uBlocksize"),uStepW:n.getUniformLocation(s,"uStepW"),uStepH:n.getUniformLocation(s,"uStepH")}},sendUniformData:function(n,s){n.uniform1f(s.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,o=e.Image.filters,n=e.util.createClass;o.RemoveColor=n(o.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(s){var i=s.imageData,a=i.data,l,u=this.distance*255,c,h,d,g=new e.Color(this.color).getSource(),m=[g[0]-u,g[1]-u,g[2]-u],y=[g[0]+u,g[1]+u,g[2]+u];for(l=0;l<a.length;l+=4)c=a[l],h=a[l+1],d=a[l+2],c>m[0]&&h>m[1]&&d>m[2]&&c<y[0]&&h<y[1]&&d<y[2]&&(a[l+3]=0)},getUniformLocations:function(s,i){return{uLow:s.getUniformLocation(i,"uLow"),uHigh:s.getUniformLocation(i,"uHigh")}},sendUniformData:function(s,i){var a=new e.Color(this.color).getSource(),l=parseFloat(this.distance),u=[0+a[0]/255-l,0+a[1]/255-l,0+a[2]/255-l,1],c=[a[0]/255+l,a[1]/255+l,a[2]/255+l,1];s.uniform4fv(i.uLow,u),s.uniform4fv(i.uHigh,c)},toObject:function(){return r(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),e.Image.filters.RemoveColor.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass,n={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var s in n)r[s]=o(r.ColorMatrix,{type:s,matrix:n[s],mainParameter:!1,colorsOnly:!0}),e.Image.filters[s].fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric,r=e.Image.filters,o=e.util.createClass;r.BlendColor=o(r.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(n){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[n]+`}
}`},retrieveShader:function(n){var s=this.type+"_"+this.mode,i;return n.programCache.hasOwnProperty(s)||(i=this.buildSource(this.mode),n.programCache[s]=this.createProgram(n.context,i)),n.programCache[s]},applyTo2d:function(n){var s=n.imageData,i=s.data,a=i.length,l,u,c,h,d,g,m,y=1-this.alpha;m=new e.Color(this.color).getSource(),l=m[0]*this.alpha,u=m[1]*this.alpha,c=m[2]*this.alpha;for(var C=0;C<a;C+=4)switch(h=i[C],d=i[C+1],g=i[C+2],this.mode){case"multiply":i[C]=h*l/255,i[C+1]=d*u/255,i[C+2]=g*c/255;break;case"screen":i[C]=255-(255-h)*(255-l)/255,i[C+1]=255-(255-d)*(255-u)/255,i[C+2]=255-(255-g)*(255-c)/255;break;case"add":i[C]=h+l,i[C+1]=d+u,i[C+2]=g+c;break;case"diff":case"difference":i[C]=Math.abs(h-l),i[C+1]=Math.abs(d-u),i[C+2]=Math.abs(g-c);break;case"subtract":i[C]=h-l,i[C+1]=d-u,i[C+2]=g-c;break;case"darken":i[C]=Math.min(h,l),i[C+1]=Math.min(d,u),i[C+2]=Math.min(g,c);break;case"lighten":i[C]=Math.max(h,l),i[C+1]=Math.max(d,u),i[C+2]=Math.max(g,c);break;case"overlay":i[C]=l<128?2*h*l/255:255-2*(255-h)*(255-l)/255,i[C+1]=u<128?2*d*u/255:255-2*(255-d)*(255-u)/255,i[C+2]=c<128?2*g*c/255:255-2*(255-g)*(255-c)/255;break;case"exclusion":i[C]=l+h-2*l*h/255,i[C+1]=u+d-2*u*d/255,i[C+2]=c+g-2*c*g/255;break;case"tint":i[C]=l+h*y,i[C+1]=u+d*y,i[C+2]=c+g*y}},getUniformLocations:function(n,s){return{uColor:n.getUniformLocation(s,"uColor")}},sendUniformData:function(n,s){var i=new e.Color(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,n.uniform4fv(s.uColor,i)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendColor.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric,r=e.Image.filters,o=e.util.createClass;r.BlendImage=o(r.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(n){var s=this.type+"_"+this.mode,i=this.fragmentSource[this.mode];return n.programCache.hasOwnProperty(s)||(n.programCache[s]=this.createProgram(n.context,i)),n.programCache[s]},applyToWebGL:function(n){var s=n.context,i=this.createTexture(n.filterBackend,this.image);this.bindAdditionalTexture(s,i,s.TEXTURE1),this.callSuper("applyToWebGL",n),this.unbindAdditionalTexture(s,s.TEXTURE1)},createTexture:function(n,s){return n.getCachedTexture(s.cacheKey,s._element)},calculateMatrix:function(){var n=this.image,s=n._element.width,i=n._element.height;return[1/n.scaleX,0,0,0,1/n.scaleY,0,-n.left/s,-n.top/i,1]},applyTo2d:function(n){var s=n.imageData,i=n.filterBackend.resources,a=s.data,l=a.length,u=s.width,c=s.height,h,d,g,m,y,C,b,k,L,N,M=this.image,W;i.blendImage||(i.blendImage=e.util.createCanvasElement()),L=i.blendImage,N=L.getContext("2d"),L.width!==u||L.height!==c?(L.width=u,L.height=c):N.clearRect(0,0,u,c),N.setTransform(M.scaleX,0,0,M.scaleY,M.left,M.top),N.drawImage(M._element,0,0,u,c),W=N.getImageData(0,0,u,c).data;for(var Y=0;Y<l;Y+=4)switch(y=a[Y],C=a[Y+1],b=a[Y+2],k=a[Y+3],h=W[Y],d=W[Y+1],g=W[Y+2],m=W[Y+3],this.mode){case"multiply":a[Y]=y*h/255,a[Y+1]=C*d/255,a[Y+2]=b*g/255,a[Y+3]=k*m/255;break;case"mask":a[Y+3]=m;break}},getUniformLocations:function(n,s){return{uTransformMatrix:n.getUniformLocation(s,"uTransformMatrix"),uImage:n.getUniformLocation(s,"uImage")}},sendUniformData:function(n,s){var i=this.calculateMatrix();n.uniform1i(s.uImage,1),n.uniformMatrix3fv(s.uTransformMatrix,!1,i)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendImage.fromObject=function(n,s){e.Image.fromObject(n.image,function(i){var a=e.util.object.clone(n);a.image=i,s(new e.Image.filters.BlendImage(a))})}})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=Math.pow,o=Math.floor,n=Math.sqrt,s=Math.abs,i=Math.round,a=Math.sin,l=Math.ceil,u=e.Image.filters,c=e.util.createClass;u.Resize=c(u.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(h,d){return{uDelta:h.getUniformLocation(d,"uDelta"),uTaps:h.getUniformLocation(d,"uTaps")}},sendUniformData:function(h,d){h.uniform2fv(d.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),h.uniform1fv(d.uTaps,this.taps)},retrieveShader:function(h){var d=this.getFilterWindow(),g=this.type+"_"+d;if(!h.programCache.hasOwnProperty(g)){var m=this.generateShader(d);h.programCache[g]=this.createProgram(h.context,m)}return h.programCache[g]},getFilterWindow:function(){var h=this.tempScale;return Math.ceil(this.lanczosLobes/h)},getTaps:function(){for(var h=this.lanczosCreate(this.lanczosLobes),d=this.tempScale,g=this.getFilterWindow(),m=new Array(g),y=1;y<=g;y++)m[y-1]=h(y*d);return m},generateShader:function(m){for(var d=new Array(m),g=this.fragmentSourceTOP,m,y=1;y<=m;y++)d[y-1]=y+".0 * uDelta";return g+="uniform float uTaps["+m+`];
`,g+=`void main() {
`,g+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,g+=`  float sum = 1.0;
`,d.forEach(function(C,b){g+="  color += texture2D(uTexture, vTexCoord + "+C+") * uTaps["+b+`];
`,g+="  color += texture2D(uTexture, vTexCoord - "+C+") * uTaps["+b+`];
`,g+="  sum += 2.0 * uTaps["+b+`];
`}),g+=`  gl_FragColor = color / sum;
`,g+="}",g},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(h){h.webgl?(h.passes++,this.width=h.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=h.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),h.destinationWidth=this.dW,this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h),h.sourceWidth=h.destinationWidth,this.height=h.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),h.destinationHeight=this.dH,this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h),h.sourceHeight=h.destinationHeight):this.applyTo2d(h)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(h){return function(d){if(d>=h||d<=-h)return 0;if(d<11920929e-14&&d>-11920929e-14)return 1;d*=Math.PI;var g=d/h;return a(d)/d*a(g)/g}},applyTo2d:function(h){var d=h.imageData,g=this.scaleX,m=this.scaleY;this.rcpScaleX=1/g,this.rcpScaleY=1/m;var y=d.width,C=d.height,b=i(y*g),k=i(C*m),L;this.resizeType==="sliceHack"?L=this.sliceByTwo(h,y,C,b,k):this.resizeType==="hermite"?L=this.hermiteFastResize(h,y,C,b,k):this.resizeType==="bilinear"?L=this.bilinearFiltering(h,y,C,b,k):this.resizeType==="lanczos"&&(L=this.lanczosResize(h,y,C,b,k)),h.imageData=L},sliceByTwo:function(h,d,g,m,y){var C=h.imageData,b=.5,k=!1,L=!1,N=d*b,M=g*b,W=e.filterBackend.resources,Y,J,oe=0,pe=0,le=d,w=0;for(W.sliceByTwo||(W.sliceByTwo=document.createElement("canvas")),Y=W.sliceByTwo,(Y.width<d*1.5||Y.height<g)&&(Y.width=d*1.5,Y.height=g),J=Y.getContext("2d"),J.clearRect(0,0,d*1.5,g),J.putImageData(C,0,0),m=o(m),y=o(y);!k||!L;)d=N,g=M,m<o(N*b)?N=o(N*b):(N=m,k=!0),y<o(M*b)?M=o(M*b):(M=y,L=!0),J.drawImage(Y,oe,pe,d,g,le,w,N,M),oe=le,pe=w,w+=M;return J.getImageData(oe,pe,m,y)},lanczosResize:function(h,d,g,m,y){function C(P){var I,H,S,_,O,j,V,z,X,q,ae;for(w.x=(P+.5)*M,F.x=o(w.x),I=0;I<y;I++){for(w.y=(I+.5)*W,F.y=o(w.y),O=0,j=0,V=0,z=0,X=0,H=F.x-oe;H<=F.x+oe;H++)if(!(H<0||H>=d)){q=o(1e3*s(H-w.x)),le[q]||(le[q]={});for(var $=F.y-pe;$<=F.y+pe;$++)$<0||$>=g||(ae=o(1e3*s($-w.y)),le[q][ae]||(le[q][ae]=N(n(r(q*Y,2)+r(ae*J,2))/1e3)),S=le[q][ae],S>0&&(_=($*d+H)*4,O+=S,j+=S*b[_],V+=S*b[_+1],z+=S*b[_+2],X+=S*b[_+3]))}_=(I*m+P)*4,L[_]=j/O,L[_+1]=V/O,L[_+2]=z/O,L[_+3]=X/O}return++P<m?C(P):k}var b=h.imageData.data,k=h.ctx.createImageData(m,y),L=k.data,N=this.lanczosCreate(this.lanczosLobes),M=this.rcpScaleX,W=this.rcpScaleY,Y=2/this.rcpScaleX,J=2/this.rcpScaleY,oe=l(M*this.lanczosLobes/2),pe=l(W*this.lanczosLobes/2),le={},w={},F={};return C(0)},bilinearFiltering:function(h,d,g,m,y){var C,b,k,L,N,M,W,Y,J,oe,pe,le,w=0,F,P=this.rcpScaleX,I=this.rcpScaleY,H=4*(d-1),S=h.imageData,_=S.data,O=h.ctx.createImageData(m,y),j=O.data;for(W=0;W<y;W++)for(Y=0;Y<m;Y++)for(N=o(P*Y),M=o(I*W),J=P*Y-N,oe=I*W-M,F=4*(M*d+N),pe=0;pe<4;pe++)C=_[F+pe],b=_[F+4+pe],k=_[F+H+pe],L=_[F+H+4+pe],le=C*(1-J)*(1-oe)+b*J*(1-oe)+k*oe*(1-J)+L*J*oe,j[w++]=le;return O},hermiteFastResize:function(h,d,g,m,y){for(var C=this.rcpScaleX,b=this.rcpScaleY,k=l(C/2),L=l(b/2),N=h.imageData,M=N.data,W=h.ctx.createImageData(m,y),Y=W.data,J=0;J<y;J++)for(var oe=0;oe<m;oe++){for(var pe=(oe+J*m)*4,le=0,w=0,F=0,P=0,I=0,H=0,S=0,_=(J+.5)*b,O=o(J*b);O<(J+1)*b;O++)for(var j=s(_-(O+.5))/L,V=(oe+.5)*C,z=j*j,X=o(oe*C);X<(oe+1)*C;X++){var q=s(V-(X+.5))/k,ae=n(z+q*q);ae>1&&ae<-1||(le=2*ae*ae*ae-3*ae*ae+1,le>0&&(q=4*(X+O*d),S+=le*M[q+3],F+=le,M[q+3]<255&&(le=le*M[q+3]/250),P+=le*M[q],I+=le*M[q+1],H+=le*M[q+2],w+=le))}Y[pe]=P/w,Y[pe+1]=I/w,Y[pe+2]=H/w,Y[pe+3]=S/F}return W},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Contrast=o(r.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(n){if(this.contrast!==0){var s=n.imageData,i,l,a=s.data,l=a.length,u=Math.floor(this.contrast*255),c=259*(u+255)/(255*(259-u));for(i=0;i<l;i+=4)a[i]=c*(a[i]-128)+128,a[i+1]=c*(a[i+1]-128)+128,a[i+2]=c*(a[i+2]-128)+128}},getUniformLocations:function(n,s){return{uContrast:n.getUniformLocation(s,"uContrast")}},sendUniformData:function(n,s){n.uniform1f(s.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Saturation=o(r.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(n){if(this.saturation!==0){var s=n.imageData,i=s.data,a=i.length,l=-this.saturation,u,c;for(u=0;u<a;u+=4)c=Math.max(i[u],i[u+1],i[u+2]),i[u]+=c!==i[u]?(c-i[u])*l:0,i[u+1]+=c!==i[u+1]?(c-i[u+1])*l:0,i[u+2]+=c!==i[u+2]?(c-i[u+2])*l:0}},getUniformLocations:function(n,s){return{uSaturation:n.getUniformLocation(s,"uSaturation")}},sendUniformData:function(n,s){n.uniform1f(s.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Vibrance=o(r.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(n){if(this.vibrance!==0){var s=n.imageData,i=s.data,a=i.length,l=-this.vibrance,u,c,h,d;for(u=0;u<a;u+=4)c=Math.max(i[u],i[u+1],i[u+2]),h=(i[u]+i[u+1]+i[u+2])/3,d=Math.abs(c-h)*2/255*l,i[u]+=c!==i[u]?(c-i[u])*d:0,i[u+1]+=c!==i[u+1]?(c-i[u+1])*d:0,i[u+2]+=c!==i[u+2]?(c-i[u+2])*d:0}},getUniformLocations:function(n,s){return{uVibrance:n.getUniformLocation(s,"uVibrance")}},sendUniformData:function(n,s){n.uniform1f(s.uVibrance,-this.vibrance)}}),e.Image.filters.Vibrance.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Blur=o(r.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(n){n.webgl?(this.aspectRatio=n.sourceWidth/n.sourceHeight,n.passes++,this._setupFrameBuffer(n),this.horizontal=!0,this.applyToWebGL(n),this._swapTextures(n),this._setupFrameBuffer(n),this.horizontal=!1,this.applyToWebGL(n),this._swapTextures(n)):this.applyTo2d(n)},applyTo2d:function(n){n.imageData=this.simpleBlur(n)},simpleBlur:function(n){var s=n.filterBackend.resources,i,a,l=n.imageData.width,u=n.imageData.height;s.blurLayer1||(s.blurLayer1=e.util.createCanvasElement(),s.blurLayer2=e.util.createCanvasElement()),i=s.blurLayer1,a=s.blurLayer2,(i.width!==l||i.height!==u)&&(a.width=i.width=l,a.height=i.height=u);var c=i.getContext("2d"),h=a.getContext("2d"),d=15,g,m,y,C,b=this.blur*.06*.5;for(c.putImageData(n.imageData,0,0),h.clearRect(0,0,l,u),C=-d;C<=d;C++)g=(Math.random()-.5)/4,m=C/d,y=b*m*l+g,h.globalAlpha=1-Math.abs(m),h.drawImage(i,y,g),c.drawImage(a,0,0),h.globalAlpha=1,h.clearRect(0,0,a.width,a.height);for(C=-d;C<=d;C++)g=(Math.random()-.5)/4,m=C/d,y=b*m*u+g,h.globalAlpha=1-Math.abs(m),h.drawImage(i,g,y),c.drawImage(a,0,0),h.globalAlpha=1,h.clearRect(0,0,a.width,a.height);n.ctx.drawImage(i,0,0);var k=n.ctx.getImageData(0,0,i.width,i.height);return c.globalAlpha=1,c.clearRect(0,0,i.width,i.height),k},getUniformLocations:function(n,s){return{delta:n.getUniformLocation(s,"uDelta")}},sendUniformData:function(n,s){var i=this.chooseRightDelta();n.uniform2fv(s.delta,i)},chooseRightDelta:function(){var n=1,s=[0,0],i;return this.horizontal?this.aspectRatio>1&&(n=1/this.aspectRatio):this.aspectRatio<1&&(n=this.aspectRatio),i=n*this.blur*.12,this.horizontal?s[0]=i:s[1]=i,s}}),r.Blur.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Gamma=o(r.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(n){this.gamma=[1,1,1],r.BaseFilter.prototype.initialize.call(this,n)},applyTo2d:function(n){var s=n.imageData,i=s.data,a=this.gamma,l=i.length,u=1/a[0],c=1/a[1],h=1/a[2],d;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),d=0,l=256;d<l;d++)this.rVals[d]=Math.pow(d/255,u)*255,this.gVals[d]=Math.pow(d/255,c)*255,this.bVals[d]=Math.pow(d/255,h)*255;for(d=0,l=i.length;d<l;d+=4)i[d]=this.rVals[i[d]],i[d+1]=this.gVals[i[d+1]],i[d+2]=this.bVals[i[d+2]]},getUniformLocations:function(n,s){return{uGamma:n.getUniformLocation(s,"uGamma")}},sendUniformData:function(n,s){n.uniform3fv(s.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.Composed=o(r.BaseFilter,{type:"Composed",subFilters:[],initialize:function(n){this.callSuper("initialize",n),this.subFilters=this.subFilters.slice(0)},applyTo:function(n){n.passes+=this.subFilters.length-1,this.subFilters.forEach(function(s){s.applyTo(n)})},toObject:function(){return e.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(n){return n.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(n){return!n.isNeutralState()})}}),e.Image.filters.Composed.fromObject=function(n,s){var i=n.subFilters||[],a=i.map(function(u){return new e.Image.filters[u.type](u)}),l=new e.Image.filters.Composed({subFilters:a});return s&&s(l),l}})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,o=e.util.createClass;r.HueRotation=o(r.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var n=this.rotation*Math.PI,s=e.util.cos(n),i=e.util.sin(n),a=1/3,l=Math.sqrt(a)*i,u=1-s;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=s+u/3,this.matrix[1]=a*u-l,this.matrix[2]=a*u+l,this.matrix[5]=a*u+l,this.matrix[6]=s+a*u,this.matrix[7]=a*u-l,this.matrix[10]=a*u-l,this.matrix[11]=a*u+l,this.matrix[12]=s+a*u},isNeutralState:function(n){return this.calculateMatrix(),r.BaseFilter.prototype.isNeutralState.call(this,n)},applyTo:function(n){this.calculateMatrix(),r.BaseFilter.prototype.applyTo.call(this,n)}}),e.Image.filters.HueRotation.fromObject=e.Image.filters.BaseFilter.fromObject})(_e);(function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.clone;if(e.Text){e.warn("fabric.Text is already defined");return}var o="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:e.Object.prototype.stateProperties.concat(o),cacheProperties:e.Object.prototype.cacheProperties.concat(o),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(n,s){this.styles=s?s.styles||{}:{},this.text=n,this.__skipDimension=!0,this.callSuper("initialize",s),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var n=this.path;n&&(n.segmentsInfo=e.util.getPathSegmentsInfo(n.path))},getMeasuringContext:function(){return e._measuringContext||(e._measuringContext=this.canvas&&this.canvas.contextCache||e.util.createCanvasElement().getContext("2d")),e._measuringContext},_splitText:function(){var n=this._splitTextIntoLines(this.text);return this.textLines=n.lines,this._textLines=n.graphemeLines,this._unwrappedTextLines=n._unwrappedLines,this._text=n.graphemeText,n},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var n,s,i,a,l,u,c,h=0,d=this._textLines.length;h<d;h++)if(!(this.textAlign!=="justify"&&(h===d-1||this.isEndOfWrapping(h)))&&(a=0,l=this._textLines[h],s=this.getLineWidth(h),s<this.width&&(c=this.textLines[h].match(this._reSpacesAndTabs)))){i=c.length,n=(this.width-s)/i;for(var g=0,m=l.length;g<=m;g++)u=this.__charBounds[h][g],this._reSpaceAndTab.test(l[g])?(u.width+=n,u.kernedWidth+=n,u.left+=a,a+=n):u.left+=a}},isEndOfWrapping:function(n){return n===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var n=this.callSuper("_getCacheCanvasDimensions"),s=this.fontSize;return n.width+=s*n.zoomX,n.height+=s*n.zoomY,n},_render:function(n){var s=this.path;s&&!s.isNotVisible()&&s._render(n),this._setTextStyles(n),this._renderTextLinesBackground(n),this._renderTextDecoration(n,"underline"),this._renderText(n),this._renderTextDecoration(n,"overline"),this._renderTextDecoration(n,"linethrough")},_renderText:function(n){this.paintFirst==="stroke"?(this._renderTextStroke(n),this._renderTextFill(n)):(this._renderTextFill(n),this._renderTextStroke(n))},_setTextStyles:function(n,s,i){if(n.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":n.textBaseline="middle";break;case"ascender":n.textBaseline="top";break;case"descender":n.textBaseline="bottom";break}n.font=this._getFontDeclaration(s,i)},calcTextWidth:function(){for(var n=this.getLineWidth(0),s=1,i=this._textLines.length;s<i;s++){var a=this.getLineWidth(s);a>n&&(n=a)}return n},_renderTextLine:function(n,s,i,a,l,u){this._renderChars(n,s,i,a,l,u)},_renderTextLinesBackground:function(n){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var s,i,a=n.fillStyle,l,u,c=this._getLeftOffset(),h=this._getTopOffset(),d=0,g=0,m,y,C=this.path,b,k=0,L=this._textLines.length;k<L;k++){if(s=this.getHeightOfLine(k),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",k)){h+=s;continue}l=this._textLines[k],i=this._getLineLeftOffset(k),g=0,d=0,u=this.getValueOfPropertyAt(k,0,"textBackgroundColor");for(var N=0,M=l.length;N<M;N++)m=this.__charBounds[k][N],y=this.getValueOfPropertyAt(k,N,"textBackgroundColor"),C?(n.save(),n.translate(m.renderLeft,m.renderTop),n.rotate(m.angle),n.fillStyle=y,y&&n.fillRect(-m.width/2,-s/this.lineHeight*(1-this._fontSizeFraction),m.width,s/this.lineHeight),n.restore()):y!==u?(b=c+i+d,this.direction==="rtl"&&(b=this.width-b-g),n.fillStyle=u,u&&n.fillRect(b,h,g,s/this.lineHeight),d=m.left,g=m.width,u=y):g+=m.kernedWidth;y&&!C&&(b=c+i+d,this.direction==="rtl"&&(b=this.width-b-g),n.fillStyle=y,n.fillRect(b,h,g,s/this.lineHeight)),h+=s}n.fillStyle=a,this._removeShadow(n)}},getFontCache:function(n){var s=n.fontFamily.toLowerCase();e.charWidthsCache[s]||(e.charWidthsCache[s]={});var i=e.charWidthsCache[s],a=n.fontStyle.toLowerCase()+"_"+(n.fontWeight+"").toLowerCase();return i[a]||(i[a]={}),i[a]},_measureChar:function(n,s,i,a){var l=this.getFontCache(s),u=this._getFontDeclaration(s),c=this._getFontDeclaration(a),h=i+n,d=u===c,g,m,y,C=s.fontSize/this.CACHE_FONT_SIZE,b;if(i&&l[i]!==void 0&&(y=l[i]),l[n]!==void 0&&(b=g=l[n]),d&&l[h]!==void 0&&(m=l[h],b=m-y),g===void 0||y===void 0||m===void 0){var k=this.getMeasuringContext();this._setTextStyles(k,s,!0)}return g===void 0&&(b=g=k.measureText(n).width,l[n]=g),y===void 0&&d&&i&&(y=k.measureText(i).width,l[i]=y),d&&m===void 0&&(m=k.measureText(h).width,l[h]=m,b=m-y),{width:g*C,kernedWidth:b*C}},getHeightOfChar:function(n,s){return this.getValueOfPropertyAt(n,s,"fontSize")},measureLine:function(n){var s=this._measureLine(n);return this.charSpacing!==0&&(s.width-=this._getWidthOfCharSpacing()),s.width<0&&(s.width=0),s},_measureLine:function(n){var s=0,i,a,l=this._textLines[n],u,c,h=0,d=new Array(l.length),g=0,m,y,C=this.path,b=this.pathSide==="right";for(this.__charBounds[n]=d,i=0;i<l.length;i++)a=l[i],c=this._getGraphemeBox(a,n,i,u),d[i]=c,s+=c.kernedWidth,u=a;if(d[i]={left:c?c.left+c.width:0,width:0,kernedWidth:0,height:this.fontSize},C){switch(y=C.segmentsInfo[C.segmentsInfo.length-1].length,m=e.util.getPointOnPath(C.path,0,C.segmentsInfo),m.x+=C.pathOffset.x,m.y+=C.pathOffset.y,this.textAlign){case"left":g=b?y-s:0;break;case"center":g=(y-s)/2;break;case"right":g=b?0:y-s;break}for(g+=this.pathStartOffset*(b?-1:1),i=b?l.length-1:0;b?i>=0:i<l.length;b?i--:i++)c=d[i],g>y?g%=y:g<0&&(g+=y),this._setGraphemeOnPath(g,c,m),g+=c.kernedWidth}return{width:s,numOfSpaces:h}},_setGraphemeOnPath:function(n,s,i){var a=n+s.kernedWidth/2,l=this.path,u=e.util.getPointOnPath(l.path,a,l.segmentsInfo);s.renderLeft=u.x-i.x,s.renderTop=u.y-i.y,s.angle=u.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(n,s,i,a,l){var u=this.getCompleteStyleDeclaration(s,i),c=a?this.getCompleteStyleDeclaration(s,i-1):{},h=this._measureChar(n,u,a,c),d=h.kernedWidth,g=h.width,m;this.charSpacing!==0&&(m=this._getWidthOfCharSpacing(),g+=m,d+=m);var y={width:g,left:0,height:u.fontSize,kernedWidth:d,deltaY:u.deltaY};if(i>0&&!l){var C=this.__charBounds[s][i-1];y.left=C.left+C.width+h.kernedWidth-h.width}return y},getHeightOfLine:function(n){if(this.__lineHeights[n])return this.__lineHeights[n];for(var s=this._textLines[n],i=this.getHeightOfChar(n,0),a=1,l=s.length;a<l;a++)i=Math.max(this.getHeightOfChar(n,a),i);return this.__lineHeights[n]=i*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var n,s=0,i=0,a=this._textLines.length;i<a;i++)n=this.getHeightOfLine(i),s+=i===a-1?n/this.lineHeight:n;return s},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(n,s){n.save();for(var i=0,a=this._getLeftOffset(),l=this._getTopOffset(),u=0,c=this._textLines.length;u<c;u++){var h=this.getHeightOfLine(u),d=h/this.lineHeight,g=this._getLineLeftOffset(u);this._renderTextLine(s,n,this._textLines[u],a+g,l+i+d,u),i+=h}n.restore()},_renderTextFill:function(n){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(n,"fillText")},_renderTextStroke:function(n){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(n),n.save(),this._setLineDash(n,this.strokeDashArray),n.beginPath(),this._renderTextCommon(n,"strokeText"),n.closePath(),n.restore())},_renderChars:function(n,s,i,a,l,u){var c=this.getHeightOfLine(u),h=this.textAlign.indexOf("justify")!==-1,d,g,m="",y,C=0,b,k=this.path,L=!h&&this.charSpacing===0&&this.isEmptyStyles(u)&&!k,N=this.direction==="ltr",M=this.direction==="ltr"?1:-1,W,Y=s.canvas.getAttribute("dir");if(s.save(),Y!==this.direction&&(s.canvas.setAttribute("dir",N?"ltr":"rtl"),s.direction=N?"ltr":"rtl",s.textAlign=N?"left":"right"),l-=c*this._fontSizeFraction/this.lineHeight,L){this._renderChar(n,s,u,0,i.join(""),a,l,c),s.restore();return}for(var J=0,oe=i.length-1;J<=oe;J++)b=J===oe||this.charSpacing||k,m+=i[J],y=this.__charBounds[u][J],C===0?(a+=M*(y.kernedWidth-y.width),C+=y.width):C+=y.kernedWidth,h&&!b&&this._reSpaceAndTab.test(i[J])&&(b=!0),b||(d=d||this.getCompleteStyleDeclaration(u,J),g=this.getCompleteStyleDeclaration(u,J+1),b=e.util.hasStyleChanged(d,g,!1)),b&&(k?(s.save(),s.translate(y.renderLeft,y.renderTop),s.rotate(y.angle),this._renderChar(n,s,u,J,m,-C/2,0,c),s.restore()):(W=a,this._renderChar(n,s,u,J,m,W,l,c)),m="",d=g,a+=M*C,C=0);s.restore()},_applyPatternGradientTransformText:function(n){var s=e.util.createCanvasElement(),i,a=this.width+this.strokeWidth,l=this.height+this.strokeWidth;return s.width=a,s.height=l,i=s.getContext("2d"),i.beginPath(),i.moveTo(0,0),i.lineTo(a,0),i.lineTo(a,l),i.lineTo(0,l),i.closePath(),i.translate(a/2,l/2),i.fillStyle=n.toLive(i),this._applyPatternGradientTransform(i,n),i.fill(),i.createPattern(s,"no-repeat")},handleFiller:function(n,s,i){var a,l;return i.toLive?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?(a=-this.width/2,l=-this.height/2,n.translate(a,l),n[s]=this._applyPatternGradientTransformText(i),{offsetX:a,offsetY:l}):(n[s]=i.toLive(n,this),this._applyPatternGradientTransform(n,i)):(n[s]=i,{offsetX:0,offsetY:0})},_setStrokeStyles:function(n,s){return n.lineWidth=s.strokeWidth,n.lineCap=this.strokeLineCap,n.lineDashOffset=this.strokeDashOffset,n.lineJoin=this.strokeLineJoin,n.miterLimit=this.strokeMiterLimit,this.handleFiller(n,"strokeStyle",s.stroke)},_setFillStyles:function(n,s){return this.handleFiller(n,"fillStyle",s.fill)},_renderChar:function(n,s,i,a,l,u,c){var h=this._getStyleDeclaration(i,a),d=this.getCompleteStyleDeclaration(i,a),g=n==="fillText"&&d.fill,m=n==="strokeText"&&d.stroke&&d.strokeWidth,y,C;!m&&!g||(s.save(),g&&(y=this._setFillStyles(s,d)),m&&(C=this._setStrokeStyles(s,d)),s.font=this._getFontDeclaration(d),h&&h.textBackgroundColor&&this._removeShadow(s),h&&h.deltaY&&(c+=h.deltaY),g&&s.fillText(l,u-y.offsetX,c-y.offsetY),m&&s.strokeText(l,u-C.offsetX,c-C.offsetY),s.restore())},setSuperscript:function(n,s){return this._setScript(n,s,this.superscript)},setSubscript:function(n,s){return this._setScript(n,s,this.subscript)},_setScript:function(n,s,i){var a=this.get2DCursorLocation(n,!0),l=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"fontSize"),u=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"deltaY"),c={fontSize:l*i.size,deltaY:u+l*i.baseline};return this.setSelectionStyles(c,n,s),this},_getLineLeftOffset:function(n){var s=this.getLineWidth(n),i=this.width-s,a=this.textAlign,l=this.direction,c,u=0,c=this.isEndOfWrapping(n);return a==="justify"||a==="justify-center"&&!c||a==="justify-right"&&!c||a==="justify-left"&&!c?0:(a==="center"&&(u=i/2),a==="right"&&(u=i),a==="justify-center"&&(u=i/2),a==="justify-right"&&(u=i),l==="rtl"&&(u-=i),u)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var n=this._forceClearCache;return n||(n=this.hasStateChanged("_dimensionAffectingProps")),n&&(this.dirty=!0,this._forceClearCache=!1),n},getLineWidth:function(n){if(this.__lineWidths[n]!==void 0)return this.__lineWidths[n];var s=this.measureLine(n),i=s.width;return this.__lineWidths[n]=i,i},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(n,s,i){var a=this._getStyleDeclaration(n,s);return a&&typeof a[i]<"u"?a[i]:this[i]},_renderTextDecoration:function(n,s){if(!(!this[s]&&!this.styleHas(s))){for(var i,a,l,u,c,h,d,g,m=this._getLeftOffset(),y=this._getTopOffset(),C,b,k,L,N,M,W,Y,J=this.path,oe=this._getWidthOfCharSpacing(),pe=this.offsets[s],le=0,w=this._textLines.length;le<w;le++){if(i=this.getHeightOfLine(le),!this[s]&&!this.styleHas(s,le)){y+=i;continue}d=this._textLines[le],M=i/this.lineHeight,u=this._getLineLeftOffset(le),b=0,k=0,g=this.getValueOfPropertyAt(le,0,s),Y=this.getValueOfPropertyAt(le,0,"fill"),C=y+M*(1-this._fontSizeFraction),a=this.getHeightOfChar(le,0),c=this.getValueOfPropertyAt(le,0,"deltaY");for(var F=0,P=d.length;F<P;F++)if(L=this.__charBounds[le][F],N=this.getValueOfPropertyAt(le,F,s),W=this.getValueOfPropertyAt(le,F,"fill"),l=this.getHeightOfChar(le,F),h=this.getValueOfPropertyAt(le,F,"deltaY"),J&&N&&W)n.save(),n.fillStyle=Y,n.translate(L.renderLeft,L.renderTop),n.rotate(L.angle),n.fillRect(-L.kernedWidth/2,pe*l+h,L.kernedWidth,this.fontSize/15),n.restore();else if((N!==g||W!==Y||l!==a||h!==c)&&k>0){var I=m+u+b;this.direction==="rtl"&&(I=this.width-I-k),g&&Y&&(n.fillStyle=Y,n.fillRect(I,C+pe*a+c,k,this.fontSize/15)),b=L.left,k=L.width,g=N,Y=W,a=l,c=h}else k+=L.kernedWidth;var I=m+u+b;this.direction==="rtl"&&(I=this.width-I-k),n.fillStyle=W,N&&W&&n.fillRect(I,C+pe*a+c,k-oe,this.fontSize/15),y+=i}this._removeShadow(n)}},_getFontDeclaration:function(n,s){var i=n||this,a=this.fontFamily,l=e.Text.genericFonts.indexOf(a.toLowerCase())>-1,u=a===void 0||a.indexOf("'")>-1||a.indexOf(",")>-1||a.indexOf('"')>-1||l?i.fontFamily:'"'+i.fontFamily+'"';return[e.isLikelyNode?i.fontWeight:i.fontStyle,e.isLikelyNode?i.fontStyle:i.fontWeight,s?this.CACHE_FONT_SIZE+"px":i.fontSize+"px",u].join(" ")},render:function(n){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",n)))},_splitTextIntoLines:function(n){for(var s=n.split(this._reNewline),i=new Array(s.length),a=[`
`],l=[],u=0;u<s.length;u++)i[u]=e.util.string.graphemeSplit(s[u]),l=l.concat(i[u],a);return l.pop(),{_unwrappedLines:i,lines:s,graphemeText:l,graphemeLines:i}},toObject:function(n){var s=o.concat(n),i=this.callSuper("toObject",s);return i.styles=e.util.stylesToArray(this.styles,this.text),i.path&&(i.path=this.path.toObject()),i},set:function(n,s){this.callSuper("set",n,s);var i=!1,a=!1;if(typeof n=="object")for(var l in n)l==="path"&&this.setPathInfo(),i=i||this._dimensionAffectingProps.indexOf(l)!==-1,a=a||l==="path";else i=this._dimensionAffectingProps.indexOf(n)!==-1,a=n==="path";return a&&this.setPathInfo(),i&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(n,s,i){if(!n)return s(null);var a=e.parseAttributes(n,e.Text.ATTRIBUTE_NAMES),l=a.textAnchor||"left";if(i=e.util.object.extend(i?r(i):{},a),i.top=i.top||0,i.left=i.left||0,a.textDecoration){var u=a.textDecoration;u.indexOf("underline")!==-1&&(i.underline=!0),u.indexOf("overline")!==-1&&(i.overline=!0),u.indexOf("line-through")!==-1&&(i.linethrough=!0),delete i.textDecoration}"dx"in a&&(i.left+=a.dx),"dy"in a&&(i.top+=a.dy),"fontSize"in i||(i.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE);var c="";"textContent"in n?c=n.textContent:"firstChild"in n&&n.firstChild!==null&&"data"in n.firstChild&&n.firstChild.data!==null&&(c=n.firstChild.data),c=c.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var h=i.strokeWidth;i.strokeWidth=0;var d=new e.Text(c,i),g=d.getScaledHeight()/d.height,m=(d.height+d.strokeWidth)*d.lineHeight-d.height,y=m*g,C=d.getScaledHeight()+y,b=0;l==="center"&&(b=d.getScaledWidth()/2),l==="right"&&(b=d.getScaledWidth()),d.set({left:d.left-b,top:d.top-(C-d.fontSize*(.07+d._fontSizeFraction))/d.lineHeight,strokeWidth:typeof h<"u"?h:1}),s(d)},e.Text.fromObject=function(n,s){var i=r(n),a=n.path;return delete i.path,e.Object._fromObject("Text",i,function(l){l.styles=e.util.stylesFromArray(n.styles,n.text),a?e.Object._fromObject("Path",a,function(u){l.set("path",u),s(l)},"path"):s(l)},"text")},e.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],e.util.createAccessors&&e.util.createAccessors(e.Text)})(_e);(function(){D.util.object.extend(D.Text.prototype,{isEmptyStyles:function(t){if(!this.styles||typeof t<"u"&&!this.styles[t])return!0;var e=typeof t>"u"?this.styles:{line:this.styles[t]};for(var r in e)for(var o in e[r])for(var n in e[r][o])return!1;return!0},styleHas:function(t,e){if(!this.styles||!t||t===""||typeof e<"u"&&!this.styles[e])return!1;var r=typeof e>"u"?this.styles:{0:this.styles[e]};for(var o in r)for(var n in r[o])if(typeof r[o][n][t]<"u")return!0;return!1},cleanStyle:function(t){if(!this.styles||!t||t==="")return!1;var e=this.styles,r=0,o,n,s=!0,i=0,a;for(var l in e){o=0;for(var u in e[l]){var a=e[l][u],c=a.hasOwnProperty(t);r++,c?(n?a[t]!==n&&(s=!1):n=a[t],a[t]===this[t]&&delete a[t]):s=!1,Object.keys(a).length!==0?o++:delete e[l][u]}o===0&&delete e[l]}for(var h=0;h<this._textLines.length;h++)i+=this._textLines[h].length;s&&r===i&&(this[t]=n,this.removeStyle(t))},removeStyle:function(t){if(!(!this.styles||!t||t==="")){var e=this.styles,r,o,n;for(o in e){r=e[o];for(n in r)delete r[n][t],Object.keys(r[n]).length===0&&delete r[n];Object.keys(r).length===0&&delete e[o]}}},_extendStyles:function(t,e){var r=this.get2DCursorLocation(t);this._getLineStyle(r.lineIndex)||this._setLineStyle(r.lineIndex),this._getStyleDeclaration(r.lineIndex,r.charIndex)||this._setStyleDeclaration(r.lineIndex,r.charIndex,{}),D.util.object.extend(this._getStyleDeclaration(r.lineIndex,r.charIndex),e)},get2DCursorLocation:function(t,e){typeof t>"u"&&(t=this.selectionStart);for(var r=e?this._unwrappedTextLines:this._textLines,o=r.length,n=0;n<o;n++){if(t<=r[n].length)return{lineIndex:n,charIndex:t};t-=r[n].length+this.missingNewlineOffset(n)}return{lineIndex:n-1,charIndex:r[n-1].length<t?r[n-1].length:t}},getSelectionStyles:function(t,e,r){typeof t>"u"&&(t=this.selectionStart||0),typeof e>"u"&&(e=this.selectionEnd||t);for(var o=[],n=t;n<e;n++)o.push(this.getStyleAtPosition(n,r));return o},getStyleAtPosition:function(t,e){var r=this.get2DCursorLocation(t),o=e?this.getCompleteStyleDeclaration(r.lineIndex,r.charIndex):this._getStyleDeclaration(r.lineIndex,r.charIndex);return o||{}},setSelectionStyles:function(t,e,r){typeof e>"u"&&(e=this.selectionStart||0),typeof r>"u"&&(r=this.selectionEnd||e);for(var o=e;o<r;o++)this._extendStyles(o,t);return this._forceClearCache=!0,this},_getStyleDeclaration:function(t,e){var r=this.styles&&this.styles[t];return r?r[e]:null},getCompleteStyleDeclaration:function(t,e){for(var r=this._getStyleDeclaration(t,e)||{},o={},n,s=0;s<this._styleProperties.length;s++)n=this._styleProperties[s],o[n]=typeof r[n]>"u"?this[n]:r[n];return o},_setStyleDeclaration:function(t,e,r){this.styles[t][e]=r},_deleteStyleDeclaration:function(t,e){delete this.styles[t][e]},_getLineStyle:function(t){return!!this.styles[t]},_setLineStyle:function(t){this.styles[t]={}},_deleteLineStyle:function(t){delete this.styles[t]}})})();(function(){function t(e){e.textDecoration&&(e.textDecoration.indexOf("underline")>-1&&(e.underline=!0),e.textDecoration.indexOf("line-through")>-1&&(e.linethrough=!0),e.textDecoration.indexOf("overline")>-1&&(e.overline=!0),delete e.textDecoration)}D.IText=D.util.createClass(D.Text,D.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(e,r){this.callSuper("initialize",e,r),this.initBehavior()},setSelectionStart:function(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)},setSelectionEnd:function(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)},_updateAndFire:function(e,r){this[e]!==r&&(this._fireSelectionChanged(),this[e]=r),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(e){this.clearContextTop(),this.callSuper("render",e),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(e){this.callSuper("_render",e)},clearContextTop:function(e){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var r=this.canvas.contextTop,o=this.canvas.viewportTransform;r.save(),r.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this.transform(r),this._clearTextArea(r),e||r.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var e=this._getCursorBoundaries(),r=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(e,r):this.renderSelection(e,r),r.restore()}},_clearTextArea:function(e){var r=this.width+4,o=this.height+4;e.clearRect(-r/2,-o/2,r,o)},_getCursorBoundaries:function(e){typeof e>"u"&&(e=this.selectionStart);var r=this._getLeftOffset(),o=this._getTopOffset(),n=this._getCursorBoundariesOffsets(e);return{left:r,top:o,leftOffset:n.left,topOffset:n.top}},_getCursorBoundariesOffsets:function(e){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var r,o,n,s=0,i=0,a,l=this.get2DCursorLocation(e);n=l.charIndex,o=l.lineIndex;for(var u=0;u<o;u++)s+=this.getHeightOfLine(u);r=this._getLineLeftOffset(o);var c=this.__charBounds[o][n];return c&&(i=c.left),this.charSpacing!==0&&n===this._textLines[o].length&&(i-=this._getWidthOfCharSpacing()),a={top:s,left:r+(i>0?i:0)},this.direction==="rtl"&&(a.left*=-1),this.cursorOffsetCache=a,this.cursorOffsetCache},renderCursor:function(e,r){var o=this.get2DCursorLocation(),n=o.lineIndex,s=o.charIndex>0?o.charIndex-1:0,i=this.getValueOfPropertyAt(n,s,"fontSize"),a=this.scaleX*this.canvas.getZoom(),l=this.cursorWidth/a,u=e.topOffset,c=this.getValueOfPropertyAt(n,s,"deltaY");u+=(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-i*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(e,r),r.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,s,"fill"),r.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,r.fillRect(e.left+e.leftOffset-l/2,u+e.top+c,l,i)},renderSelection:function(e,r){for(var o=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,n=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,s=this.textAlign.indexOf("justify")!==-1,i=this.get2DCursorLocation(o),a=this.get2DCursorLocation(n),l=i.lineIndex,u=a.lineIndex,c=i.charIndex<0?0:i.charIndex,h=a.charIndex<0?0:a.charIndex,d=l;d<=u;d++){var g=this._getLineLeftOffset(d)||0,m=this.getHeightOfLine(d),y=0,C=0,b=0;if(d===l&&(C=this.__charBounds[l][c].left),d>=l&&d<u)b=s&&!this.isEndOfWrapping(d)?this.width:this.getLineWidth(d)||5;else if(d===u)if(h===0)b=this.__charBounds[u][h].left;else{var k=this._getWidthOfCharSpacing();b=this.__charBounds[u][h-1].left+this.__charBounds[u][h-1].width-k}y=m,(this.lineHeight<1||d===u&&this.lineHeight>1)&&(m/=this.lineHeight);var L=e.left+g+C,N=b-C,M=m,W=0;this.inCompositionMode?(r.fillStyle=this.compositionColor||"black",M=1,W=m):r.fillStyle=this.selectionColor,this.direction==="rtl"&&(L=this.width-L-N),r.fillRect(L,e.top+e.topOffset+W,N,M),e.topOffset+=y}},getCurrentCharFontSize:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")},getCurrentCharColor:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fill")},_getCurrentCharIndex:function(){var e=this.get2DCursorLocation(this.selectionStart,!0),r=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:r}}}),D.IText.fromObject=function(e,r){var o=D.util.stylesFromArray(e.styles,e.text),n=Object.assign({},e,{styles:o});if(t(n),n.styles)for(var s in n.styles)for(var i in n.styles[s])t(n.styles[s][i]);D.Object._fromObject("IText",n,r,"text")}})();(function(){var t=D.util.object.clone;D.util.object.extend(D.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var e=this;this.on("added",function(){var r=e.canvas;r&&(r._hasITextHandlers||(r._hasITextHandlers=!0,e._initCanvasHandlers(r)),r._iTextInstances=r._iTextInstances||[],r._iTextInstances.push(e))})},initRemovedHandler:function(){var e=this;this.on("removed",function(){var r=e.canvas;r&&(r._iTextInstances=r._iTextInstances||[],D.util.removeFromArray(r._iTextInstances,e),r._iTextInstances.length===0&&(r._hasITextHandlers=!1,e._removeCanvasHandlers(r)))})},_initCanvasHandlers:function(e){e._mouseUpITextHandler=function(){e._iTextInstances&&e._iTextInstances.forEach(function(r){r.__isMousedown=!1})},e.on("mouse:up",e._mouseUpITextHandler)},_removeCanvasHandlers:function(e){e.off("mouse:up",e._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(e,r,o,n){var s;return s={isAborted:!1,abort:function(){this.isAborted=!0}},e.animate("_currentCursorOpacity",r,{duration:o,onComplete:function(){s.isAborted||e[n]()},onChange:function(){e.canvas&&e.selectionStart===e.selectionEnd&&e.renderCursorOrSelection()},abort:function(){return s.isAborted}}),s},_onTickComplete:function(){var e=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){e._currentTickCompleteState=e._animateCursor(e,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(e){var r=this,o=e?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){r._tick()},o)},abortCursorAnimation:function(){var e=this._currentTickState||this._currentTickCompleteState,r=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,e&&r&&r.clearContext(r.contextTop||r.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(e){var r=0,o=e-1;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)r++,o--;for(;/\S/.test(this._text[o])&&o>-1;)r++,o--;return e-r},findWordBoundaryRight:function(e){var r=0,o=e;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)r++,o++;for(;/\S/.test(this._text[o])&&o<this._text.length;)r++,o++;return e+r},findLineBoundaryLeft:function(e){for(var r=0,o=e-1;!/\n/.test(this._text[o])&&o>-1;)r++,o--;return e-r},findLineBoundaryRight:function(e){for(var r=0,o=e;!/\n/.test(this._text[o])&&o<this._text.length;)r++,o++;return e+r},searchWordBoundary:function(e,r){for(var o=this._text,n=this._reSpace.test(o[e])?e-1:e,s=o[n],i=D.reNonWord;!i.test(s)&&n>0&&n<o.length;)n+=r,s=o[n];return i.test(s)&&(n+=r===1?0:1),n},selectWord:function(e){e=e||this.selectionStart;var r=this.searchWordBoundary(e,-1),o=this.searchWordBoundary(e,1);this.selectionStart=r,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(e){e=e||this.selectionStart;var r=this.findLineBoundaryLeft(e),o=this.findLineBoundaryRight(e);return this.selectionStart=r,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(e){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(e),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(e){e._iTextInstances&&e._iTextInstances.forEach(function(r){r.selected=!1,r.isEditing&&r.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(e){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var r=this.getSelectionStartFromPointer(e.e),o=this.selectionStart,n=this.selectionEnd;(r!==this.__selectionStartOnMouseDown||o===n)&&(o===r||n===r)||(r>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=r):(this.selectionStart=r,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==o||this.selectionEnd!==n)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(e,r,o){var n=o.slice(0,e),s=D.util.string.graphemeSplit(n).length;if(e===r)return{selectionStart:s,selectionEnd:s};var i=o.slice(e,r),a=D.util.string.graphemeSplit(i).length;return{selectionStart:s,selectionEnd:s+a}},fromGraphemeToStringSelection:function(e,r,o){var n=o.slice(0,e),s=n.join("").length;if(e===r)return{selectionStart:s,selectionEnd:s};var i=o.slice(e,r),a=i.join("").length;return{selectionStart:s,selectionEnd:s+a}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var e=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=e.selectionEnd,this.inCompositionMode||(this.selectionStart=e.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var e=this.inCompositionMode?this.compositionStart:this.selectionStart,r=this._getCursorBoundaries(e),o=this.get2DCursorLocation(e),n=o.lineIndex,s=o.charIndex,i=this.getValueOfPropertyAt(n,s,"fontSize")*this.lineHeight,a=r.leftOffset,l=this.calcTransformMatrix(),u={x:r.left+a,y:r.top+r.topOffset+i},c=this.canvas.getRetinaScaling(),h=this.canvas.upperCanvasEl,d=h.width/c,g=h.height/c,m=d-i,y=g-i,C=h.clientWidth/d,b=h.clientHeight/g;return u=D.util.transformPoint(u,l),u=D.util.transformPoint(u,this.canvas.viewportTransform),u.x*=C,u.y*=b,u.x<0&&(u.x=0),u.x>m&&(u.x=m),u.y<0&&(u.y=0),u.y>y&&(u.y=y),u.x+=this.canvas._offset.left,u.y+=this.canvas._offset.top,{left:u.x+"px",top:u.y+"px",fontSize:i+"px",charHeight:i}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var e=this._textBeforeEdit!==this.text,r=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,r&&(r.blur&&r.blur(),r.parentNode&&r.parentNode.removeChild(r)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),e&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var e in this.styles)this._textLines[e]||delete this.styles[e]},removeStyleFromTo:function(e,r){var o=this.get2DCursorLocation(e,!0),n=this.get2DCursorLocation(r,!0),s=o.lineIndex,i=o.charIndex,a=n.lineIndex,l=n.charIndex,u,c;if(s!==a){if(this.styles[s])for(u=i;u<this._unwrappedTextLines[s].length;u++)delete this.styles[s][u];if(this.styles[a])for(u=l;u<this._unwrappedTextLines[a].length;u++)c=this.styles[a][u],c&&(this.styles[s]||(this.styles[s]={}),this.styles[s][i+u-l]=c);for(u=s+1;u<=a;u++)delete this.styles[u];this.shiftLineStyles(a,s-a)}else if(this.styles[s]){c=this.styles[s];var h=l-i,d,g;for(u=i;u<l;u++)delete c[u];for(g in this.styles[s])d=parseInt(g,10),d>=l&&(c[d-h]=c[g],delete c[g])}},shiftLineStyles:function(e,r){var o=t(this.styles);for(var n in this.styles){var s=parseInt(n,10);s>e&&(this.styles[s+r]=o[s],o[s-r]||delete this.styles[s])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(e,r,o,n){var s,i={},a=!1,l=this._unwrappedTextLines[e].length===r;o||(o=1),this.shiftLineStyles(e,o),this.styles[e]&&(s=this.styles[e][r===0?r:r-1]);for(var u in this.styles[e]){var c=parseInt(u,10);c>=r&&(a=!0,i[c-r]=this.styles[e][u],l&&r===0||delete this.styles[e][u])}var h=!1;for(a&&!l&&(this.styles[e+o]=i,h=!0),h&&o--;o>0;)n&&n[o-1]?this.styles[e+o]={0:t(n[o-1])}:s?this.styles[e+o]={0:t(s)}:delete this.styles[e+o],o--;this._forceClearCache=!0},insertCharStyleObject:function(e,r,o,n){this.styles||(this.styles={});var s=this.styles[e],i=s?t(s):{};o||(o=1);for(var a in i){var l=parseInt(a,10);l>=r&&(s[l+o]=i[l],i[l-o]||delete s[l])}if(this._forceClearCache=!0,n){for(;o--;)Object.keys(n[o]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][r+o]=t(n[o]));return}if(s)for(var u=s[r?r-1:1];u&&o--;)this.styles[e][r+o]=t(u)},insertNewStyleBlock:function(e,r,o){for(var n=this.get2DCursorLocation(r,!0),s=[0],i=0,a=0;a<e.length;a++)e[a]===`
`?(i++,s[i]=0):s[i]++;s[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,s[0],o),o=o&&o.slice(s[0]+1)),i&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+s[0],i);for(var a=1;a<i;a++)s[a]>0?this.insertCharStyleObject(n.lineIndex+a,0,s[a],o):o&&this.styles[n.lineIndex+a]&&o[0]&&(this.styles[n.lineIndex+a][0]=o[0]),o=o&&o.slice(s[a]+1);s[a]>0&&this.insertCharStyleObject(n.lineIndex+a,0,s[a],o)},setSelectionStartEndWithShift:function(e,r,o){o<=e?(r===e?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=e),this.selectionStart=o):o>e&&o<r?this._selectionDirection==="right"?this.selectionEnd=o:this.selectionStart=o:(r===e?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=r),this.selectionEnd=o)},setSelectionInBoundaries:function(){var e=this.text.length;this.selectionStart>e?this.selectionStart=e:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>e?this.selectionEnd=e:this.selectionEnd<0&&(this.selectionEnd=0)}})})();D.util.object.extend(D.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(t){if(this.canvas){this.__newClickTime=+new Date;var e=t.pointer;this.isTripleClick(e)&&(this.fire("tripleclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(t){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(t.e))},tripleClickHandler:function(t){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(t.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(t){!this.canvas||!this.editable||t.e.button&&t.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(t){!this.canvas||!this.editable||t.e.button&&t.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(t){if(this.__isMousedown=!1,!(!this.editable||this.group||t.transform&&t.transform.actionPerformed||t.e.button&&t.e.button!==1)){if(this.canvas){var e=this.canvas._activeObject;if(e&&e!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t),r=this.selectionStart,o=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(r,o,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(t){for(var e=this.getLocalPointer(t),r=0,o=0,n=0,s=0,i=0,a,l,u=0,c=this._textLines.length;u<c&&n<=e.y;u++)n+=this.getHeightOfLine(u)*this.scaleY,i=u,u>0&&(s+=this._textLines[u-1].length+this.missingNewlineOffset(u-1));a=this._getLineLeftOffset(i),o=a*this.scaleX,l=this._textLines[i],this.direction==="rtl"&&(e.x=this.width*this.scaleX-e.x+o);for(var h=0,d=l.length;h<d&&(r=o,o+=this.__charBounds[i][h].kernedWidth*this.scaleX,o<=e.x);h++)s++;return this._getNewSelectionStartFromOffset(e,r,o,s,d)},_getNewSelectionStartFromOffset:function(t,e,r,o,n){var s=t.x-e,i=r-t.x,a=i>s||i<0?0:1,l=o+a;return this.flipX&&(l=n-l),l>this._text.length&&(l=this._text.length),l}});D.util.object.extend(D.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=D.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var t=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+t.top+"; left: "+t.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uFF70top: "+t.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):D.document.body.appendChild(this.hiddenTextarea),D.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),D.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),D.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),D.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),D.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),D.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),D.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),D.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),D.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(D.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing){var e=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else if(t.keyCode in this.ctrlKeysMapDown&&(t.ctrlKey||t.metaKey))this[this.ctrlKeysMapDown[t.keyCode]](t);else return;t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(t){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey))this[this.ctrlKeysMapUp[t.keyCode]](t);else return;t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(t){var e=this.fromPaste;if(this.fromPaste=!1,t&&t.stopPropagation(),!!this.isEditing){var r=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,o=this._text.length,n=r.length,s,i,a=n-o,l=this.selectionStart,u=this.selectionEnd,c=l!==u,h,d,g;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var m=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),y=l>m.selectionStart;c?(s=this._text.slice(l,u),a+=u-l):n<o&&(y?s=this._text.slice(u+a,u):s=this._text.slice(l,l-a)),i=r.slice(m.selectionEnd-a,m.selectionEnd),s&&s.length&&(i.length&&(h=this.getSelectionStyles(l,l+1,!1),h=i.map(function(){return h[0]})),c?(d=l,g=u):y?(d=u-s.length,g=u):(d=u,g=u+s.length),this.removeStyleFromTo(d,g)),i.length&&(e&&i.join("")===D.copiedText&&!D.disableStyleCopyPaste&&(h=D.copiedTextStyle),this.insertNewStyleBlock(i,l,h)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(t){this.compositionStart=t.target.selectionStart,this.compositionEnd=t.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(D.copiedText=this.getSelectedText(),D.disableStyleCopyPaste?D.copiedTextStyle=null:D.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(t){return t&&t.clipboardData||D.window.clipboardData},_getWidthBeforeCursor:function(t,e){var r=this._getLineLeftOffset(t),o;return e>0&&(o=this.__charBounds[t][e-1],r+=o.left+o.width),r},getDownCursorOffset:function(t,e){var r=this._getSelectionForOffset(t,e),o=this.get2DCursorLocation(r),n=o.lineIndex;if(n===this._textLines.length-1||t.metaKey||t.keyCode===34)return this._text.length-r;var s=o.charIndex,i=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n+1,i),l=this._textLines[n].slice(s);return l.length+a+1+this.missingNewlineOffset(n)},_getSelectionForOffset:function(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(t,e){var r=this._getSelectionForOffset(t,e),o=this.get2DCursorLocation(r),n=o.lineIndex;if(n===0||t.metaKey||t.keyCode===33)return-r;var s=o.charIndex,i=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n-1,i),l=this._textLines[n].slice(0,s),u=this.missingNewlineOffset(n-1);return-this._textLines[n-1].length+a-l.length+(1-u)},_getIndexOnLine:function(t,e){for(var r=this._textLines[t],o=this._getLineLeftOffset(t),n=o,s=0,i,a,l=0,u=r.length;l<u;l++)if(i=this.__charBounds[t][l].width,n+=i,n>e){a=!0;var c=n-i,h=n,d=Math.abs(c-e),g=Math.abs(h-e);s=g<d?l:l-1;break}return a||(s=r.length-1),s},moveCursorDown:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)},moveCursorUp:function(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",t)},_moveCursorUpOrDown:function(t,e){var r="get"+t+"CursorOffset",o=this[r](e,this._selectionDirection==="right");e.shiftKey?this.moveCursorWithShift(o):this.moveCursorWithoutShift(o),o!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(t){var e=this._selectionDirection==="left"?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),t!==0},moveCursorWithoutShift:function(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),t!==0},moveCursorLeft:function(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",t)},_move:function(t,e,r){var o;if(t.altKey)o=this["findWordBoundary"+r](this[e]);else if(t.metaKey||t.keyCode===35||t.keyCode===36)o=this["findLineBoundary"+r](this[e]);else return this[e]+=r==="Left"?-1:1,!0;if(typeof o<"u"&&this[e]!==o)return this[e]=o,!0},_moveLeft:function(t,e){return this._move(t,e,"Left")},_moveRight:function(t,e){return this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(t){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(t,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(t,"selectionStart")},moveCursorRight:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)},_moveCursorLeftOrRight:function(t,e){var r="moveCursor"+t+"With";this._currentCursorOpacity=1,e.shiftKey?r+="Shift":r+="outShift",this[r](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(t){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(t,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(t,"selectionEnd")},moveCursorRightWithoutShift:function(t){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(t,e){typeof e>"u"&&(e=t+1),this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(t,e,r,o){typeof o>"u"&&(o=r),o>r&&this.removeStyleFromTo(r,o);var n=D.util.string.graphemeSplit(t);this.insertNewStyleBlock(n,r,e),this._text=[].concat(this._text.slice(0,r),n,this._text.slice(o)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}});(function(){var t=D.util.toFixed,e=/  +/g;D.util.object.extend(D.Text.prototype,{_toSVG:function(){var r=this._getSVGLeftTopOffsets(),o=this._getSVGTextAndBg(r.textTop,r.textLeft);return this._wrapSVGTextAndBg(o)},toSVG:function(r){return this._createBaseSVGMarkup(this._toSVG(),{reviver:r,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(r){var o=!0,n=this.getSvgTextDecoration(this);return[r.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",n?'text-decoration="'+n+'" ':"",'style="',this.getSvgStyles(o),'"',this.addPaintOrder()," >",r.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(r,o){var n=[],s=[],i=r,a;this._setSVGBg(s);for(var l=0,u=this._textLines.length;l<u;l++)a=this._getLineLeftOffset(l),(this.textBackgroundColor||this.styleHas("textBackgroundColor",l))&&this._setSVGTextLineBg(s,l,o+a,i),this._setSVGTextLineText(n,l,o+a,i),i+=this.getHeightOfLine(l);return{textSpans:n,textBgRects:s}},_createTextCharSpan:function(r,o,n,s){var i=r!==r.trim()||r.match(e),a=this.getSvgSpanStyles(o,i),l=a?'style="'+a+'"':"",u=o.deltaY,c="",h=D.Object.NUM_FRACTION_DIGITS;return u&&(c=' dy="'+t(u,h)+'" '),['<tspan x="',t(n,h),'" y="',t(s,h),'" ',c,l,">",D.util.string.escapeXml(r),"</tspan>"].join("")},_setSVGTextLineText:function(r,o,n,s){var i=this.getHeightOfLine(o),a=this.textAlign.indexOf("justify")!==-1,l,u,c="",h,d,g=0,m=this._textLines[o],y;s+=i*(1-this._fontSizeFraction)/this.lineHeight;for(var C=0,b=m.length-1;C<=b;C++)y=C===b||this.charSpacing,c+=m[C],h=this.__charBounds[o][C],g===0?(n+=h.kernedWidth-h.width,g+=h.width):g+=h.kernedWidth,a&&!y&&this._reSpaceAndTab.test(m[C])&&(y=!0),y||(l=l||this.getCompleteStyleDeclaration(o,C),u=this.getCompleteStyleDeclaration(o,C+1),y=D.util.hasStyleChanged(l,u,!0)),y&&(d=this._getStyleDeclaration(o,C)||{},r.push(this._createTextCharSpan(c,d,n,s)),c="",l=u,n+=g,g=0)},_pushTextBgRect:function(r,o,n,s,i,a){var l=D.Object.NUM_FRACTION_DIGITS;r.push("		<rect ",this._getFillAttributes(o),' x="',t(n,l),'" y="',t(s,l),'" width="',t(i,l),'" height="',t(a,l),`"></rect>
`)},_setSVGTextLineBg:function(r,o,n,s){for(var i=this._textLines[o],a=this.getHeightOfLine(o)/this.lineHeight,l=0,u=0,c,h,d=this.getValueOfPropertyAt(o,0,"textBackgroundColor"),g=0,m=i.length;g<m;g++)c=this.__charBounds[o][g],h=this.getValueOfPropertyAt(o,g,"textBackgroundColor"),h!==d?(d&&this._pushTextBgRect(r,d,n+u,s,l,a),u=c.left,l=c.width,d=h):l+=c.kernedWidth;h&&this._pushTextBgRect(r,h,n+u,s,l,a)},_getFillAttributes:function(r){var o=r&&typeof r=="string"?new D.Color(r):"";return!o||!o.getSource()||o.getAlpha()===1?'fill="'+r+'"':'opacity="'+o.getAlpha()+'" fill="'+o.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(r){for(var o=0,n=0,s=0;s<r;s++)o+=this.getHeightOfLine(s);return n=this.getHeightOfLine(s),{lineTop:o,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(r){var o=D.Object.prototype.getSvgStyles.call(this,r);return o+" white-space: pre;"}})})();(function(t){"use strict";var e=t.fabric||(t.fabric={});e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:e.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(r){for(var o=0,n=0,s=0,i={},a=0;a<r.graphemeLines.length;a++)r.graphemeText[s]===`
`&&a>0?(n=0,s++,o++):!this.splitByGrapheme&&this._reSpaceAndTab.test(r.graphemeText[s])&&a>0&&(n++,s++),i[a]={line:o,offset:n},s+=r.graphemeLines[a].length,n+=r.graphemeLines[a].length;return i},styleHas:function(r,o){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[o];n&&(o=n.line)}return e.Text.prototype.styleHas.call(this,r,o)},isEmptyStyles:function(r){if(!this.styles)return!0;var o=0,n=r+1,s,i,a=!1,l=this._styleMap[r],u=this._styleMap[r+1];l&&(r=l.line,o=l.offset),u&&(n=u.line,a=n===r,s=u.offset),i=typeof r>"u"?this.styles:{line:this.styles[r]};for(var c in i)for(var h in i[c])if(h>=o&&(!a||h<s))for(var d in i[c][h])return!1;return!0},_getStyleDeclaration:function(r,o){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[r];if(!n)return null;r=n.line,o=n.offset+o}return this.callSuper("_getStyleDeclaration",r,o)},_setStyleDeclaration:function(r,o,n){var s=this._styleMap[r];r=s.line,o=s.offset+o,this.styles[r][o]=n},_deleteStyleDeclaration:function(r,o){var n=this._styleMap[r];r=n.line,o=n.offset+o,delete this.styles[r][o]},_getLineStyle:function(r){var o=this._styleMap[r];return!!this.styles[o.line]},_setLineStyle:function(r){var o=this._styleMap[r];this.styles[o.line]={}},_wrapText:function(r,o){var n=[],s;for(this.isWrapping=!0,s=0;s<r.length;s++)n=n.concat(this._wrapLine(r[s],s,o));return this.isWrapping=!1,n},_measureWord:function(r,o,n){var s=0,i,a=!0;n=n||0;for(var l=0,u=r.length;l<u;l++){var c=this._getGraphemeBox(r[l],o,l+n,i,a);s+=c.kernedWidth,i=r[l]}return s},_wrapLine:function(r,o,n,L){var i=0,a=this.splitByGrapheme,l=[],u=[],c=a?e.util.string.graphemeSplit(r):r.split(this._wordJoiners),h="",d=0,g=a?"":" ",m=0,y=0,C=0,b=!0,k=this._getWidthOfCharSpacing(),L=L||0;c.length===0&&c.push([]),n-=L;for(var N=0;N<c.length;N++)h=a?c[N]:e.util.string.graphemeSplit(c[N]),m=this._measureWord(h,o,d),d+=h.length,i+=y+m-k,i>n&&!b?(l.push(u),u=[],i=m,b=!0):i+=k,!b&&!a&&u.push(g),u=u.concat(h),y=a?0:this._measureWord([g],o,d),d++,b=!1,m>C&&(C=m);return N&&l.push(u),C+L>this.dynamicMinWidth&&(this.dynamicMinWidth=C-k+L),l},isEndOfWrapping:function(r){return!this._styleMap[r+1]||this._styleMap[r+1].line!==this._styleMap[r].line},missingNewlineOffset:function(r){return this.splitByGrapheme?this.isEndOfWrapping(r)?1:0:1},_splitTextIntoLines:function(r){for(var o=e.Text.prototype._splitTextIntoLines.call(this,r),n=this._wrapText(o.lines,this.width),s=new Array(n.length),i=0;i<n.length;i++)s[i]=n[i].join("");return o.lines=s,o.graphemeLines=n,o},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var r={};for(var o in this._styleMap)this._textLines[o]&&(r[this._styleMap[o].line]=1);for(var o in this.styles)r[o]||delete this.styles[o]},toObject:function(r){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(r))}}),e.Textbox.fromObject=function(r,o){var n=e.util.stylesFromArray(r.styles,r.text),s=Object.assign({},r,{styles:n});return e.Object._fromObject("Textbox",s,o,"text")}})(_e);(function(){var t=D.controlsUtils,e=t.scaleSkewCursorStyleHandler,r=t.scaleCursorStyleHandler,o=t.scalingEqually,n=t.scalingYOrSkewingX,s=t.scalingXOrSkewingY,i=t.scaleOrSkewActionName,a=D.Object.prototype.controls;if(a.ml=new D.Control({x:-.5,y:0,cursorStyleHandler:e,actionHandler:s,getActionName:i}),a.mr=new D.Control({x:.5,y:0,cursorStyleHandler:e,actionHandler:s,getActionName:i}),a.mb=new D.Control({x:0,y:.5,cursorStyleHandler:e,actionHandler:n,getActionName:i}),a.mt=new D.Control({x:0,y:-.5,cursorStyleHandler:e,actionHandler:n,getActionName:i}),a.tl=new D.Control({x:-.5,y:-.5,cursorStyleHandler:r,actionHandler:o}),a.tr=new D.Control({x:.5,y:-.5,cursorStyleHandler:r,actionHandler:o}),a.bl=new D.Control({x:-.5,y:.5,cursorStyleHandler:r,actionHandler:o}),a.br=new D.Control({x:.5,y:.5,cursorStyleHandler:r,actionHandler:o}),a.mtr=new D.Control({x:0,y:-.5,actionHandler:t.rotationWithSnapping,cursorStyleHandler:t.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),D.Textbox){var l=D.Textbox.prototype.controls={};l.mtr=a.mtr,l.tr=a.tr,l.br=a.br,l.tl=a.tl,l.bl=a.bl,l.mt=a.mt,l.mb=a.mb,l.mr=new D.Control({x:.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"}),l.ml=new D.Control({x:-.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"})}})()});var hp=tt((YP,L1)=>{"use strict";function Fi(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function B1(t,e){for(var r="",o=0,n=-1,s=0,i,a=0;a<=t.length;++a){if(a<t.length)i=t.charCodeAt(a);else{if(i===47)break;i=47}if(i===47){if(!(n===a-1||s===1))if(n!==a-1&&s===2){if(r.length<2||o!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){var l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",o=0):(r=r.slice(0,l),o=r.length-1-r.lastIndexOf("/")),n=a,s=0;continue}}else if(r.length===2||r.length===1){r="",o=0,n=a,s=0;continue}}e&&(r.length>0?r+="/..":r="..",o=2)}else r.length>0?r+="/"+t.slice(n+1,a):r=t.slice(n+1,a),o=a-n-1;n=a,s=0}else i===46&&s!==-1?++s:s=-1}return r}function fA(t,e){var r=e.dir||e.root,o=e.base||(e.name||"")+(e.ext||"");return r?r===e.root?r+o:r+t+o:o}var Ga={resolve:function(){for(var e="",r=!1,o,n=arguments.length-1;n>=-1&&!r;n--){var s;n>=0?s=arguments[n]:(o===void 0&&(o=process.cwd()),s=o),Fi(s),s.length!==0&&(e=s+"/"+e,r=s.charCodeAt(0)===47)}return e=B1(e,!r),r?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Fi(e),e.length===0)return".";var r=e.charCodeAt(0)===47,o=e.charCodeAt(e.length-1)===47;return e=B1(e,!r),e.length===0&&!r&&(e="."),e.length>0&&o&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return Fi(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,r=0;r<arguments.length;++r){var o=arguments[r];Fi(o),o.length>0&&(e===void 0?e=o:e+="/"+o)}return e===void 0?".":Ga.normalize(e)},relative:function(e,r){if(Fi(e),Fi(r),e===r||(e=Ga.resolve(e),r=Ga.resolve(r),e===r))return"";for(var o=1;o<e.length&&e.charCodeAt(o)===47;++o);for(var n=e.length,s=n-o,i=1;i<r.length&&r.charCodeAt(i)===47;++i);for(var a=r.length,l=a-i,u=s<l?s:l,c=-1,h=0;h<=u;++h){if(h===u){if(l>u){if(r.charCodeAt(i+h)===47)return r.slice(i+h+1);if(h===0)return r.slice(i+h)}else s>u&&(e.charCodeAt(o+h)===47?c=h:h===0&&(c=0));break}var d=e.charCodeAt(o+h),g=r.charCodeAt(i+h);if(d!==g)break;d===47&&(c=h)}var m="";for(h=o+c+1;h<=n;++h)(h===n||e.charCodeAt(h)===47)&&(m.length===0?m+="..":m+="/..");return m.length>0?m+r.slice(i+c):(i+=c,r.charCodeAt(i)===47&&++i,r.slice(i))},_makeLong:function(e){return e},dirname:function(e){if(Fi(e),e.length===0)return".";for(var r=e.charCodeAt(0),o=r===47,n=-1,s=!0,i=e.length-1;i>=1;--i)if(r=e.charCodeAt(i),r===47){if(!s){n=i;break}}else s=!1;return n===-1?o?"/":".":o&&n===1?"//":e.slice(0,n)},basename:function(e,r){if(r!==void 0&&typeof r!="string")throw new TypeError('"ext" argument must be a string');Fi(e);var o=0,n=-1,s=!0,i;if(r!==void 0&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var a=r.length-1,l=-1;for(i=e.length-1;i>=0;--i){var u=e.charCodeAt(i);if(u===47){if(!s){o=i+1;break}}else l===-1&&(s=!1,l=i+1),a>=0&&(u===r.charCodeAt(a)?--a===-1&&(n=i):(a=-1,n=l))}return o===n?n=l:n===-1&&(n=e.length),e.slice(o,n)}else{for(i=e.length-1;i>=0;--i)if(e.charCodeAt(i)===47){if(!s){o=i+1;break}}else n===-1&&(s=!1,n=i+1);return n===-1?"":e.slice(o,n)}},extname:function(e){Fi(e);for(var r=-1,o=0,n=-1,s=!0,i=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!s){o=a+1;break}continue}n===-1&&(s=!1,n=a+1),l===46?r===-1?r=a:i!==1&&(i=1):r!==-1&&(i=-1)}return r===-1||n===-1||i===0||i===1&&r===n-1&&r===o+1?"":e.slice(r,n)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return fA("/",e)},parse:function(e){Fi(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return r;var o=e.charCodeAt(0),n=o===47,s;n?(r.root="/",s=1):s=0;for(var i=-1,a=0,l=-1,u=!0,c=e.length-1,h=0;c>=s;--c){if(o=e.charCodeAt(c),o===47){if(!u){a=c+1;break}continue}l===-1&&(u=!1,l=c+1),o===46?i===-1?i=c:h!==1&&(h=1):i!==-1&&(h=-1)}return i===-1||l===-1||h===0||h===1&&i===l-1&&i===a+1?l!==-1&&(a===0&&n?r.base=r.name=e.slice(1,l):r.base=r.name=e.slice(a,l)):(a===0&&n?(r.name=e.slice(1,i),r.base=e.slice(1,l)):(r.name=e.slice(a,i),r.base=e.slice(a,l)),r.ext=e.slice(i,l)),a>0?r.dir=e.slice(0,a-1):n&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};Ga.posix=Ga;L1.exports=Ga});var xy=tt((ZP,by)=>{"use strict";var HF="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";by.exports=HF});var Ty=tt((e4,Ay)=>{"use strict";var XF=xy();function Dy(){}function Ey(){}Ey.resetWarningCache=Dy;Ay.exports=function(){function t(o,n,s,i,a,l){if(l!==XF){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Ey,resetWarningCache:Dy};return r.PropTypes=r,r}});var Oy=tt((n4,Fy)=>{Fy.exports=Ty()();var t4,r4});var Kp=tt($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});var Py=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],mh=Py.join(","),Iy=typeof Element>"u",qo=Iy?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,vh=!Iy&&Element.prototype.getRootNode?function(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}:function(t){return t?.ownerDocument},yh=function t(e,r){var o;r===void 0&&(r=!0);var n=e==null||(o=e.getAttribute)===null||o===void 0?void 0:o.call(e,"inert"),s=n===""||n==="true",i=s||r&&e&&t(e.parentNode);return i},YF=function(e){var r,o=e==null||(r=e.getAttribute)===null||r===void 0?void 0:r.call(e,"contenteditable");return o===""||o==="true"},By=function(e,r,o){if(yh(e))return[];var n=Array.prototype.slice.apply(e.querySelectorAll(mh));return r&&qo.call(e,mh)&&n.unshift(e),n=n.filter(o),n},Ly=function t(e,r,o){for(var n=[],s=Array.from(e);s.length;){var i=s.shift();if(!yh(i,!1))if(i.tagName==="SLOT"){var a=i.assignedElements(),l=a.length?a:i.children,u=t(l,!0,o);o.flatten?n.push.apply(n,u):n.push({scopeParent:i,candidates:u})}else{var c=qo.call(i,mh);c&&o.filter(i)&&(r||!e.includes(i))&&n.push(i);var h=i.shadowRoot||typeof o.getShadowRoot=="function"&&o.getShadowRoot(i),d=!yh(h,!1)&&(!o.shadowRootFilter||o.shadowRootFilter(i));if(h&&d){var g=t(h===!0?i.children:h.children,!0,o);o.flatten?n.push.apply(n,g):n.push({scopeParent:i,candidates:g})}else s.unshift.apply(s,i.children)}}return n},My=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},$p=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||YF(e))&&!My(e)?0:e.tabIndex},VF=function(e,r){var o=$p(e);return o<0&&r&&!My(e)?0:o},qF=function(e,r){return e.tabIndex===r.tabIndex?e.documentOrder-r.documentOrder:e.tabIndex-r.tabIndex},Ry=function(e){return e.tagName==="INPUT"},$F=function(e){return Ry(e)&&e.type==="hidden"},KF=function(e){var r=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(o){return o.tagName==="SUMMARY"});return r},JF=function(e,r){for(var o=0;o<e.length;o++)if(e[o].checked&&e[o].form===r)return e[o]},QF=function(e){if(!e.name)return!0;var r=e.form||vh(e),o=function(a){return r.querySelectorAll('input[type="radio"][name="'+a+'"]')},n;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")n=o(window.CSS.escape(e.name));else try{n=o(e.name)}catch(i){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",i.message),!1}var s=JF(n,e.form);return!s||s===e},ZF=function(e){return Ry(e)&&e.type==="radio"},eO=function(e){return ZF(e)&&!QF(e)},tO=function(e){var r,o=e&&vh(e),n=(r=o)===null||r===void 0?void 0:r.host,s=!1;if(o&&o!==e){var i,a,l;for(s=!!((i=n)!==null&&i!==void 0&&(a=i.ownerDocument)!==null&&a!==void 0&&a.contains(n)||e!=null&&(l=e.ownerDocument)!==null&&l!==void 0&&l.contains(e));!s&&n;){var u,c,h;o=vh(n),n=(u=o)===null||u===void 0?void 0:u.host,s=!!((c=n)!==null&&c!==void 0&&(h=c.ownerDocument)!==null&&h!==void 0&&h.contains(n))}}return s},ky=function(e){var r=e.getBoundingClientRect(),o=r.width,n=r.height;return o===0&&n===0},rO=function(e,r){var o=r.displayCheck,n=r.getShadowRoot;if(getComputedStyle(e).visibility==="hidden")return!0;var s=qo.call(e,"details>summary:first-of-type"),i=s?e.parentElement:e;if(qo.call(i,"details:not([open]) *"))return!0;if(!o||o==="full"||o==="legacy-full"){if(typeof n=="function"){for(var a=e;e;){var l=e.parentElement,u=vh(e);if(l&&!l.shadowRoot&&n(l)===!0)return ky(e);e.assignedSlot?e=e.assignedSlot:!l&&u!==e.ownerDocument?e=u.host:e=l}e=a}if(tO(e))return!e.getClientRects().length;if(o!=="legacy-full")return!0}else if(o==="non-zero-area")return ky(e);return!1},nO=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var r=e.parentElement;r;){if(r.tagName==="FIELDSET"&&r.disabled){for(var o=0;o<r.children.length;o++){var n=r.children.item(o);if(n.tagName==="LEGEND")return qo.call(r,"fieldset[disabled] *")?!0:!n.contains(e)}return!0}r=r.parentElement}return!1},Ch=function(e,r){return!(r.disabled||yh(r)||$F(r)||rO(r,e)||KF(r)||nO(r))},qp=function(e,r){return!(eO(r)||$p(r)<0||!Ch(e,r))},iO=function(e){var r=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(r)||r>=0)},sO=function t(e){var r=[],o=[];return e.forEach(function(n,s){var i=!!n.scopeParent,a=i?n.scopeParent:n,l=VF(a,i),u=i?t(n.candidates):a;l===0?i?r.push.apply(r,u):r.push(a):o.push({documentOrder:s,tabIndex:l,item:n,isScope:i,content:u})}),o.sort(qF).reduce(function(n,s){return s.isScope?n.push.apply(n,s.content):n.push(s.content),n},[]).concat(r)},oO=function(e,r){r=r||{};var o;return r.getShadowRoot?o=Ly([e],r.includeContainer,{filter:qp.bind(null,r),flatten:!1,getShadowRoot:r.getShadowRoot,shadowRootFilter:iO}):o=By(e,r.includeContainer,qp.bind(null,r)),sO(o)},aO=function(e,r){r=r||{};var o;return r.getShadowRoot?o=Ly([e],r.includeContainer,{filter:Ch.bind(null,r),flatten:!0,getShadowRoot:r.getShadowRoot}):o=By(e,r.includeContainer,Ch.bind(null,r)),o},uO=function(e,r){if(r=r||{},!e)throw new Error("No node provided");return qo.call(e,mh)===!1?!1:qp(r,e)},lO=Py.concat("iframe").join(","),cO=function(e,r){if(r=r||{},!e)throw new Error("No node provided");return qo.call(e,lO)===!1?!1:Ch(r,e)};$o.focusable=aO;$o.getTabIndex=$p;$o.isFocusable=cO;$o.isTabbable=uO;$o.tabbable=oO});var Gy=tt(Jp=>{"use strict";Object.defineProperty(Jp,"__esModule",{value:!0});var Pr=Kp();function jy(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,o)}return r}function Ny(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jy(Object(r),!0).forEach(function(o){hO(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jy(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}function hO(t,e,r){return e=dO(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fO(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var o=r.call(t,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dO(t){var e=fO(t,"string");return typeof e=="symbol"?e:String(e)}var Uy={activateTrap:function(e,r){if(e.length>0){var o=e[e.length-1];o!==r&&o.pause()}var n=e.indexOf(r);n===-1||e.splice(n,1),e.push(r)},deactivateTrap:function(e,r){var o=e.indexOf(r);o!==-1&&e.splice(o,1),e.length>0&&e[e.length-1].unpause()}},pO=function(e){return e.tagName&&e.tagName.toLowerCase()==="input"&&typeof e.select=="function"},gO=function(e){return e?.key==="Escape"||e?.key==="Esc"||e?.keyCode===27},vl=function(e){return e?.key==="Tab"||e?.keyCode===9},mO=function(e){return vl(e)&&!e.shiftKey},vO=function(e){return vl(e)&&e.shiftKey},zy=function(e){return setTimeout(e,0)},Wy=function(e,r){var o=-1;return e.every(function(n,s){return r(n)?(o=s,!1):!0}),o},ml=function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return typeof e=="function"?e.apply(void 0,o):e},_h=function(e){return e.target.shadowRoot&&typeof e.composedPath=="function"?e.composedPath()[0]:e.target},yO=[],CO=function(e,r){var o=r?.document||document,n=r?.trapStack||yO,s=Ny({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:mO,isKeyBackward:vO},r),i={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},a,l=function(w,F,P){return w&&w[F]!==void 0?w[F]:s[P||F]},u=function(w,F){var P=typeof F?.composedPath=="function"?F.composedPath():void 0;return i.containerGroups.findIndex(function(I){var H=I.container,S=I.tabbableNodes;return H.contains(w)||P?.includes(H)||S.find(function(_){return _===w})})},c=function(w){var F=s[w];if(typeof F=="function"){for(var P=arguments.length,I=new Array(P>1?P-1:0),H=1;H<P;H++)I[H-1]=arguments[H];F=F.apply(void 0,I)}if(F===!0&&(F=void 0),!F){if(F===void 0||F===!1)return F;throw new Error("`".concat(w,"` was specified but was not a node, or did not return a node"))}var S=F;if(typeof F=="string"&&(S=o.querySelector(F),!S))throw new Error("`".concat(w,"` as selector refers to no known node"));return S},h=function(){var w=c("initialFocus");if(w===!1)return!1;if(w===void 0||!Pr.isFocusable(w,s.tabbableOptions))if(u(o.activeElement)>=0)w=o.activeElement;else{var F=i.tabbableGroups[0],P=F&&F.firstTabbableNode;w=P||c("fallbackFocus")}if(!w)throw new Error("Your focus-trap needs to have at least one focusable element");return w},d=function(){if(i.containerGroups=i.containers.map(function(w){var F=Pr.tabbable(w,s.tabbableOptions),P=Pr.focusable(w,s.tabbableOptions),I=F.length>0?F[0]:void 0,H=F.length>0?F[F.length-1]:void 0,S=P.find(function(j){return Pr.isTabbable(j)}),_=P.slice().reverse().find(function(j){return Pr.isTabbable(j)}),O=!!F.find(function(j){return Pr.getTabIndex(j)>0});return{container:w,tabbableNodes:F,focusableNodes:P,posTabIndexesFound:O,firstTabbableNode:I,lastTabbableNode:H,firstDomTabbableNode:S,lastDomTabbableNode:_,nextTabbableNode:function(V){var z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,X=F.indexOf(V);return X<0?z?P.slice(P.indexOf(V)+1).find(function(q){return Pr.isTabbable(q)}):P.slice(0,P.indexOf(V)).reverse().find(function(q){return Pr.isTabbable(q)}):F[X+(z?1:-1)]}}}),i.tabbableGroups=i.containerGroups.filter(function(w){return w.tabbableNodes.length>0}),i.tabbableGroups.length<=0&&!c("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(i.containerGroups.find(function(w){return w.posTabIndexesFound})&&i.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},g=function le(w){var F=w.activeElement;if(F)return F.shadowRoot&&F.shadowRoot.activeElement!==null?le(F.shadowRoot):F},m=function le(w){if(w!==!1&&w!==g(document)){if(!w||!w.focus){le(h());return}w.focus({preventScroll:!!s.preventScroll}),i.mostRecentlyFocusedNode=w,pO(w)&&w.select()}},y=function(w){var F=c("setReturnFocus",w);return F||(F===!1?!1:w)},C=function(w){var F=w.target,P=w.event,I=w.isBackward,H=I===void 0?!1:I;F=F||_h(P),d();var S=null;if(i.tabbableGroups.length>0){var _=u(F,P),O=_>=0?i.containerGroups[_]:void 0;if(_<0)H?S=i.tabbableGroups[i.tabbableGroups.length-1].lastTabbableNode:S=i.tabbableGroups[0].firstTabbableNode;else if(H){var j=Wy(i.tabbableGroups,function($){var U=$.firstTabbableNode;return F===U});if(j<0&&(O.container===F||Pr.isFocusable(F,s.tabbableOptions)&&!Pr.isTabbable(F,s.tabbableOptions)&&!O.nextTabbableNode(F,!1))&&(j=_),j>=0){var V=j===0?i.tabbableGroups.length-1:j-1,z=i.tabbableGroups[V];S=Pr.getTabIndex(F)>=0?z.lastTabbableNode:z.lastDomTabbableNode}else vl(P)||(S=O.nextTabbableNode(F,!1))}else{var X=Wy(i.tabbableGroups,function($){var U=$.lastTabbableNode;return F===U});if(X<0&&(O.container===F||Pr.isFocusable(F,s.tabbableOptions)&&!Pr.isTabbable(F,s.tabbableOptions)&&!O.nextTabbableNode(F))&&(X=_),X>=0){var q=X===i.tabbableGroups.length-1?0:X+1,ae=i.tabbableGroups[q];S=Pr.getTabIndex(F)>=0?ae.firstTabbableNode:ae.firstDomTabbableNode}else vl(P)||(S=O.nextTabbableNode(F))}}else S=c("fallbackFocus");return S},b=function(w){var F=_h(w);if(!(u(F,w)>=0)){if(ml(s.clickOutsideDeactivates,w)){a.deactivate({returnFocus:s.returnFocusOnDeactivate});return}ml(s.allowOutsideClick,w)||w.preventDefault()}},k=function(w){var F=_h(w),P=u(F,w)>=0;if(P||F instanceof Document)P&&(i.mostRecentlyFocusedNode=F);else{w.stopImmediatePropagation();var I,H=!0;if(i.mostRecentlyFocusedNode)if(Pr.getTabIndex(i.mostRecentlyFocusedNode)>0){var S=u(i.mostRecentlyFocusedNode),_=i.containerGroups[S].tabbableNodes;if(_.length>0){var O=_.findIndex(function(j){return j===i.mostRecentlyFocusedNode});O>=0&&(s.isKeyForward(i.recentNavEvent)?O+1<_.length&&(I=_[O+1],H=!1):O-1>=0&&(I=_[O-1],H=!1))}}else i.containerGroups.some(function(j){return j.tabbableNodes.some(function(V){return Pr.getTabIndex(V)>0})})||(H=!1);else H=!1;H&&(I=C({target:i.mostRecentlyFocusedNode,isBackward:s.isKeyBackward(i.recentNavEvent)})),m(I||i.mostRecentlyFocusedNode||h())}i.recentNavEvent=void 0},L=function(w){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;i.recentNavEvent=w;var P=C({event:w,isBackward:F});P&&(vl(w)&&w.preventDefault(),m(P))},N=function(w){if(gO(w)&&ml(s.escapeDeactivates,w)!==!1){w.preventDefault(),a.deactivate();return}(s.isKeyForward(w)||s.isKeyBackward(w))&&L(w,s.isKeyBackward(w))},M=function(w){var F=_h(w);u(F,w)>=0||ml(s.clickOutsideDeactivates,w)||ml(s.allowOutsideClick,w)||(w.preventDefault(),w.stopImmediatePropagation())},W=function(){if(i.active)return Uy.activateTrap(n,a),i.delayInitialFocusTimer=s.delayInitialFocus?zy(function(){m(h())}):m(h()),o.addEventListener("focusin",k,!0),o.addEventListener("mousedown",b,{capture:!0,passive:!1}),o.addEventListener("touchstart",b,{capture:!0,passive:!1}),o.addEventListener("click",M,{capture:!0,passive:!1}),o.addEventListener("keydown",N,{capture:!0,passive:!1}),a},Y=function(){if(i.active)return o.removeEventListener("focusin",k,!0),o.removeEventListener("mousedown",b,!0),o.removeEventListener("touchstart",b,!0),o.removeEventListener("click",M,!0),o.removeEventListener("keydown",N,!0),a},J=function(w){var F=w.some(function(P){var I=Array.from(P.removedNodes);return I.some(function(H){return H===i.mostRecentlyFocusedNode})});F&&m(h())},oe=typeof window<"u"&&"MutationObserver"in window?new MutationObserver(J):void 0,pe=function(){oe&&(oe.disconnect(),i.active&&!i.paused&&i.containers.map(function(w){oe.observe(w,{subtree:!0,childList:!0})}))};return a={get active(){return i.active},get paused(){return i.paused},activate:function(w){if(i.active)return this;var F=l(w,"onActivate"),P=l(w,"onPostActivate"),I=l(w,"checkCanFocusTrap");I||d(),i.active=!0,i.paused=!1,i.nodeFocusedBeforeActivation=o.activeElement,F?.();var H=function(){I&&d(),W(),pe(),P?.()};return I?(I(i.containers.concat()).then(H,H),this):(H(),this)},deactivate:function(w){if(!i.active)return this;var F=Ny({onDeactivate:s.onDeactivate,onPostDeactivate:s.onPostDeactivate,checkCanReturnFocus:s.checkCanReturnFocus},w);clearTimeout(i.delayInitialFocusTimer),i.delayInitialFocusTimer=void 0,Y(),i.active=!1,i.paused=!1,pe(),Uy.deactivateTrap(n,a);var P=l(F,"onDeactivate"),I=l(F,"onPostDeactivate"),H=l(F,"checkCanReturnFocus"),S=l(F,"returnFocus","returnFocusOnDeactivate");P?.();var _=function(){zy(function(){S&&m(y(i.nodeFocusedBeforeActivation)),I?.()})};return S&&H?(H(y(i.nodeFocusedBeforeActivation)).then(_,_),this):(_(),this)},pause:function(w){if(i.paused||!i.active)return this;var F=l(w,"onPause"),P=l(w,"onPostPause");return i.paused=!0,F?.(),Y(),pe(),P?.(),this},unpause:function(w){if(!i.paused||!i.active)return this;var F=l(w,"onUnpause"),P=l(w,"onPostUnpause");return i.paused=!1,F?.(),d(),W(),pe(),P?.(),this},updateContainerElements:function(w){var F=[].concat(w).filter(Boolean);return i.containers=F.map(function(P){return typeof P=="string"?o.querySelector(P):P}),i.active&&d(),pe(),this}},a.updateContainerElements(e),a};Jp.createFocusTrap=CO});var Vy=tt((o4,Yy)=>{"use strict";function $a(t){"@babel/helpers - typeof";return $a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$a(t)}function _O(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hy(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Xy(o.key),o)}}function wO(t,e,r){return e&&Hy(t.prototype,e),r&&Hy(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function SO(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qp(t,e)}function Qp(t,e){return Qp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,n){return o.__proto__=n,o},Qp(t,e)}function bO(t){var e=DO();return function(){var o=Sh(t),n;if(e){var s=Sh(this).constructor;n=Reflect.construct(o,arguments,s)}else n=o.apply(this,arguments);return xO(this,n)}}function xO(t,e){if(e&&($a(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cl(t)}function Cl(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function DO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sh(t){return Sh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sh(t)}function EO(t,e,r){return e=Xy(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xy(t){var e=AO(t,"string");return $a(e)==="symbol"?e:String(e)}function AO(t,e){if($a(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var o=r.call(t,e||"default");if($a(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wh=Go(),Ye=Oy(),TO=Gy(),FO=TO.createFocusTrap,OO=Kp(),kO=OO.isFocusable,Zp=function(t){SO(r,t);var e=bO(r);function r(o){var n;_O(this,r),n=e.call(this,o),EO(Cl(n),"getNodeForOption",function(a){var l,u=(l=this.internalOptions[a])!==null&&l!==void 0?l:this.originalOptions[a];if(typeof u=="function"){for(var c=arguments.length,h=new Array(c>1?c-1:0),d=1;d<c;d++)h[d-1]=arguments[d];u=u.apply(void 0,h)}if(u===!0&&(u=void 0),!u){if(u===void 0||u===!1)return u;throw new Error("`".concat(a,"` was specified but was not a node, or did not return a node"))}var g=u;if(typeof u=="string"){var m;if(g=(m=this.getDocument())===null||m===void 0?void 0:m.querySelector(u),!g)throw new Error("`".concat(a,"` as selector refers to no known node"))}return g}),n.handleDeactivate=n.handleDeactivate.bind(Cl(n)),n.handlePostDeactivate=n.handlePostDeactivate.bind(Cl(n)),n.handleClickOutsideDeactivates=n.handleClickOutsideDeactivates.bind(Cl(n)),n.internalOptions={returnFocusOnDeactivate:!1,checkCanReturnFocus:null,onDeactivate:n.handleDeactivate,onPostDeactivate:n.handlePostDeactivate,clickOutsideDeactivates:n.handleClickOutsideDeactivates},n.originalOptions={returnFocusOnDeactivate:!0,onDeactivate:null,onPostDeactivate:null,checkCanReturnFocus:null,clickOutsideDeactivates:!1};var s=o.focusTrapOptions;for(var i in s)if(Object.prototype.hasOwnProperty.call(s,i)){if(i==="returnFocusOnDeactivate"||i==="onDeactivate"||i==="onPostDeactivate"||i==="checkCanReturnFocus"||i==="clickOutsideDeactivates"){n.originalOptions[i]=s[i];continue}n.internalOptions[i]=s[i]}return n.outsideClick=null,n.focusTrapElements=o.containerElements||[],n.updatePreviousElement(),n}return wO(r,[{key:"getDocument",value:function(){return this.props.focusTrapOptions.document||(typeof document<"u"?document:void 0)}},{key:"getReturnFocusNode",value:function(){var n=this.getNodeForOption("setReturnFocus",this.previouslyFocusedElement);return n||(n===!1?!1:this.previouslyFocusedElement)}},{key:"updatePreviousElement",value:function(){var n=this.getDocument();n&&(this.previouslyFocusedElement=n.activeElement)}},{key:"deactivateTrap",value:function(){!this.focusTrap||!this.focusTrap.active||this.focusTrap.deactivate({returnFocus:!1,checkCanReturnFocus:null,onDeactivate:this.originalOptions.onDeactivate})}},{key:"handleClickOutsideDeactivates",value:function(n){var s=typeof this.originalOptions.clickOutsideDeactivates=="function"?this.originalOptions.clickOutsideDeactivates.call(null,n):this.originalOptions.clickOutsideDeactivates;return s&&(this.outsideClick={target:n.target,allowDeactivation:s}),s}},{key:"handleDeactivate",value:function(){this.originalOptions.onDeactivate&&this.originalOptions.onDeactivate.call(null),this.deactivateTrap()}},{key:"handlePostDeactivate",value:function(){var n=this,s=function(){var a=n.getReturnFocusNode(),l=!!(n.originalOptions.returnFocusOnDeactivate&&a!==null&&a!==void 0&&a.focus&&(!n.outsideClick||n.outsideClick.allowDeactivation&&!kO(n.outsideClick.target,n.internalOptions.tabbableOptions))),u=n.internalOptions.preventScroll,c=u===void 0?!1:u;l&&a.focus({preventScroll:c}),n.originalOptions.onPostDeactivate&&n.originalOptions.onPostDeactivate.call(null),n.outsideClick=null};this.originalOptions.checkCanReturnFocus?this.originalOptions.checkCanReturnFocus.call(null,this.getReturnFocusNode()).then(s,s):s()}},{key:"setupFocusTrap",value:function(){if(this.focusTrap)this.props.active&&!this.focusTrap.active&&(this.focusTrap.activate(),this.props.paused&&this.focusTrap.pause());else{var n=this.focusTrapElements.some(Boolean);n&&(this.focusTrap=this.props._createFocusTrap(this.focusTrapElements,this.internalOptions),this.props.active&&this.focusTrap.activate(),this.props.paused&&this.focusTrap.pause())}}},{key:"componentDidMount",value:function(){this.props.active&&this.setupFocusTrap()}},{key:"componentDidUpdate",value:function(n){if(this.focusTrap){n.containerElements!==this.props.containerElements&&this.focusTrap.updateContainerElements(this.props.containerElements);var s=!n.active&&this.props.active,i=n.active&&!this.props.active,a=!n.paused&&this.props.paused,l=n.paused&&!this.props.paused;if(s&&(this.updatePreviousElement(),this.focusTrap.activate()),i){this.deactivateTrap();return}a&&this.focusTrap.pause(),l&&this.focusTrap.unpause()}else n.containerElements!==this.props.containerElements&&(this.focusTrapElements=this.props.containerElements),this.props.active&&(this.updatePreviousElement(),this.setupFocusTrap())}},{key:"componentWillUnmount",value:function(){this.deactivateTrap()}},{key:"render",value:function(){var n=this,s=this.props.children?wh.Children.only(this.props.children):void 0;if(s){if(s.type&&s.type===wh.Fragment)throw new Error("A focus-trap cannot use a Fragment as its child container. Try replacing it with a <div> element.");var i=function(u){var c=n.props.containerElements;s&&(typeof s.ref=="function"?s.ref(u):s.ref&&(s.ref.current=u)),n.focusTrapElements=c||[u]},a=wh.cloneElement(s,{ref:i});return a}return null}}]),r}(wh.Component),yl=typeof Element>"u"?Function:Element;Zp.propTypes={active:Ye.bool,paused:Ye.bool,focusTrapOptions:Ye.shape({document:Ye.object,onActivate:Ye.func,onPostActivate:Ye.func,checkCanFocusTrap:Ye.func,onPause:Ye.func,onPostPause:Ye.func,onUnpause:Ye.func,onPostUnpause:Ye.func,onDeactivate:Ye.func,onPostDeactivate:Ye.func,checkCanReturnFocus:Ye.func,initialFocus:Ye.oneOfType([Ye.instanceOf(yl),Ye.string,Ye.bool,Ye.func]),fallbackFocus:Ye.oneOfType([Ye.instanceOf(yl),Ye.string,Ye.func]),escapeDeactivates:Ye.oneOfType([Ye.bool,Ye.func]),clickOutsideDeactivates:Ye.oneOfType([Ye.bool,Ye.func]),returnFocusOnDeactivate:Ye.bool,setReturnFocus:Ye.oneOfType([Ye.instanceOf(yl),Ye.string,Ye.bool,Ye.func]),allowOutsideClick:Ye.oneOfType([Ye.bool,Ye.func]),preventScroll:Ye.bool,tabbableOptions:Ye.shape({displayCheck:Ye.oneOf(["full","legacy-full","non-zero-area","none"]),getShadowRoot:Ye.oneOfType([Ye.bool,Ye.func])}),trapStack:Ye.array,isKeyForward:Ye.func,isKeyBackward:Ye.func}),containerElements:Ye.arrayOf(Ye.instanceOf(yl)),children:Ye.oneOfType([Ye.element,Ye.instanceOf(yl)])};Zp.defaultProps={active:!0,paused:!1,focusTrapOptions:{},_createFocusTrap:FO};Yy.exports=Zp});var $y=tt((p4,tg)=>{var eg=function(t){"use strict";var e=Object.prototype,r=e.hasOwnProperty,o=Object.defineProperty||function(S,_,O){S[_]=O.value},n,s=typeof Symbol=="function"?Symbol:{},i=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function u(S,_,O){return Object.defineProperty(S,_,{value:O,enumerable:!0,configurable:!0,writable:!0}),S[_]}try{u({},"")}catch{u=function(_,O,j){return _[O]=j}}function c(S,_,O,j){var V=_&&_.prototype instanceof b?_:b,z=Object.create(V.prototype),X=new P(j||[]);return o(z,"_invoke",{value:pe(S,O,X)}),z}t.wrap=c;function h(S,_,O){try{return{type:"normal",arg:S.call(_,O)}}catch(j){return{type:"throw",arg:j}}}var d="suspendedStart",g="suspendedYield",m="executing",y="completed",C={};function b(){}function k(){}function L(){}var N={};u(N,i,function(){return this});var M=Object.getPrototypeOf,W=M&&M(M(I([])));W&&W!==e&&r.call(W,i)&&(N=W);var Y=L.prototype=b.prototype=Object.create(N);k.prototype=L,o(Y,"constructor",{value:L,configurable:!0}),o(L,"constructor",{value:k,configurable:!0}),k.displayName=u(L,l,"GeneratorFunction");function J(S){["next","throw","return"].forEach(function(_){u(S,_,function(O){return this._invoke(_,O)})})}t.isGeneratorFunction=function(S){var _=typeof S=="function"&&S.constructor;return _?_===k||(_.displayName||_.name)==="GeneratorFunction":!1},t.mark=function(S){return Object.setPrototypeOf?Object.setPrototypeOf(S,L):(S.__proto__=L,u(S,l,"GeneratorFunction")),S.prototype=Object.create(Y),S},t.awrap=function(S){return{__await:S}};function oe(S,_){function O(z,X,q,ae){var $=h(S[z],S,X);if($.type==="throw")ae($.arg);else{var U=$.arg,te=U.value;return te&&typeof te=="object"&&r.call(te,"__await")?_.resolve(te.__await).then(function(ee){O("next",ee,q,ae)},function(ee){O("throw",ee,q,ae)}):_.resolve(te).then(function(ee){U.value=ee,q(U)},function(ee){return O("throw",ee,q,ae)})}}var j;function V(z,X){function q(){return new _(function(ae,$){O(z,X,ae,$)})}return j=j?j.then(q,q):q()}o(this,"_invoke",{value:V})}J(oe.prototype),u(oe.prototype,a,function(){return this}),t.AsyncIterator=oe,t.async=function(S,_,O,j,V){V===void 0&&(V=Promise);var z=new oe(c(S,_,O,j),V);return t.isGeneratorFunction(_)?z:z.next().then(function(X){return X.done?X.value:z.next()})};function pe(S,_,O){var j=d;return function(z,X){if(j===m)throw new Error("Generator is already running");if(j===y){if(z==="throw")throw X;return H()}for(O.method=z,O.arg=X;;){var q=O.delegate;if(q){var ae=le(q,O);if(ae){if(ae===C)continue;return ae}}if(O.method==="next")O.sent=O._sent=O.arg;else if(O.method==="throw"){if(j===d)throw j=y,O.arg;O.dispatchException(O.arg)}else O.method==="return"&&O.abrupt("return",O.arg);j=m;var $=h(S,_,O);if($.type==="normal"){if(j=O.done?y:g,$.arg===C)continue;return{value:$.arg,done:O.done}}else $.type==="throw"&&(j=y,O.method="throw",O.arg=$.arg)}}}function le(S,_){var O=_.method,j=S.iterator[O];if(j===n)return _.delegate=null,O==="throw"&&S.iterator.return&&(_.method="return",_.arg=n,le(S,_),_.method==="throw")||O!=="return"&&(_.method="throw",_.arg=new TypeError("The iterator does not provide a '"+O+"' method")),C;var V=h(j,S.iterator,_.arg);if(V.type==="throw")return _.method="throw",_.arg=V.arg,_.delegate=null,C;var z=V.arg;if(!z)return _.method="throw",_.arg=new TypeError("iterator result is not an object"),_.delegate=null,C;if(z.done)_[S.resultName]=z.value,_.next=S.nextLoc,_.method!=="return"&&(_.method="next",_.arg=n);else return z;return _.delegate=null,C}J(Y),u(Y,l,"Generator"),u(Y,i,function(){return this}),u(Y,"toString",function(){return"[object Generator]"});function w(S){var _={tryLoc:S[0]};1 in S&&(_.catchLoc=S[1]),2 in S&&(_.finallyLoc=S[2],_.afterLoc=S[3]),this.tryEntries.push(_)}function F(S){var _=S.completion||{};_.type="normal",delete _.arg,S.completion=_}function P(S){this.tryEntries=[{tryLoc:"root"}],S.forEach(w,this),this.reset(!0)}t.keys=function(S){var _=Object(S),O=[];for(var j in _)O.push(j);return O.reverse(),function V(){for(;O.length;){var z=O.pop();if(z in _)return V.value=z,V.done=!1,V}return V.done=!0,V}};function I(S){if(S){var _=S[i];if(_)return _.call(S);if(typeof S.next=="function")return S;if(!isNaN(S.length)){var O=-1,j=function V(){for(;++O<S.length;)if(r.call(S,O))return V.value=S[O],V.done=!1,V;return V.value=n,V.done=!0,V};return j.next=j}}return{next:H}}t.values=I;function H(){return{value:n,done:!0}}return P.prototype={constructor:P,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(F),!S)for(var _ in this)_.charAt(0)==="t"&&r.call(this,_)&&!isNaN(+_.slice(1))&&(this[_]=n)},stop:function(){this.done=!0;var S=this.tryEntries[0],_=S.completion;if(_.type==="throw")throw _.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var _=this;function O(ae,$){return z.type="throw",z.arg=S,_.next=ae,$&&(_.method="next",_.arg=n),!!$}for(var j=this.tryEntries.length-1;j>=0;--j){var V=this.tryEntries[j],z=V.completion;if(V.tryLoc==="root")return O("end");if(V.tryLoc<=this.prev){var X=r.call(V,"catchLoc"),q=r.call(V,"finallyLoc");if(X&&q){if(this.prev<V.catchLoc)return O(V.catchLoc,!0);if(this.prev<V.finallyLoc)return O(V.finallyLoc)}else if(X){if(this.prev<V.catchLoc)return O(V.catchLoc,!0)}else if(q){if(this.prev<V.finallyLoc)return O(V.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(S,_){for(var O=this.tryEntries.length-1;O>=0;--O){var j=this.tryEntries[O];if(j.tryLoc<=this.prev&&r.call(j,"finallyLoc")&&this.prev<j.finallyLoc){var V=j;break}}V&&(S==="break"||S==="continue")&&V.tryLoc<=_&&_<=V.finallyLoc&&(V=null);var z=V?V.completion:{};return z.type=S,z.arg=_,V?(this.method="next",this.next=V.finallyLoc,C):this.complete(z)},complete:function(S,_){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&_&&(this.next=_),C},finish:function(S){for(var _=this.tryEntries.length-1;_>=0;--_){var O=this.tryEntries[_];if(O.finallyLoc===S)return this.complete(O.completion,O.afterLoc),F(O),C}},catch:function(S){for(var _=this.tryEntries.length-1;_>=0;--_){var O=this.tryEntries[_];if(O.tryLoc===S){var j=O.completion;if(j.type==="throw"){var V=j.arg;F(O)}return V}}throw new Error("illegal catch attempt")},delegateYield:function(S,_,O){return this.delegate={iterator:I(S),resultName:_,nextLoc:O},this.method==="next"&&(this.arg=n),C}},t}(typeof tg=="object"?tg.exports:{});try{regeneratorRuntime=eg}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=eg:Function("r","regeneratorRuntime = r")(eg)}});var bh=tt((g4,Ky)=>{Ky.exports=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`});var rg=tt((m4,Qy)=>{var LO=bh(),Jy=0;Qy.exports=({id:t,action:e,payload:r={}})=>{let o=t;return typeof o>"u"&&(o=LO("Job",Jy),Jy+=1),{id:o,action:e,payload:r}}});var xh=tt(_l=>{var ng=!1;_l.logging=ng;_l.setLogging=t=>{ng=t};_l.log=(...t)=>ng?console.log.apply(_l,t):null});var rC=tt((eC,tC)=>{var MO=rg(),{log:Dh}=xh(),RO=bh(),Zy=0;tC.exports=()=>{let t=RO("Scheduler",Zy),e={},r={},o=[];Zy+=1;let n=()=>o.length,s=()=>Object.keys(e).length,i=()=>{if(o.length!==0){let h=Object.keys(e);for(let d=0;d<h.length;d+=1)if(typeof r[h[d]]>"u"){o[0](e[h[d]]);break}}},a=(h,d)=>new Promise((g,m)=>{let y=MO({action:h,payload:d});o.push(async C=>{o.shift(),r[C.id]=y;try{g(await C[h].apply(eC,[...d,y.id]))}catch(b){m(b)}finally{delete r[C.id],i()}}),Dh(`[${t}]: Add ${y.id} to JobQueue`),Dh(`[${t}]: JobQueue length=${o.length}`),i()});return{addWorker:h=>(e[h.id]=h,Dh(`[${t}]: Add ${h.id}`),Dh(`[${t}]: Number of workers=${s()}`),i(),h.id),addJob:async(h,...d)=>{if(s()===0)throw Error(`[${t}]: You need to have at least one worker before adding jobs`);return a(h,d)},terminate:async()=>{Object.keys(e).forEach(async h=>{await e[h].terminate()}),o=[]},getQueueLen:n,getNumWorkers:s}}});var iC=tt((y4,nC)=>{function jO(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}nC.exports=jO});var oC=tt((C4,sC)=>{var NO=iC();sC.exports=t=>{let e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":NO()?e.type="electron":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof c1=="function"&&(e.type="node"),typeof t>"u"?e:e[t]}});var uC=tt((w4,aC)=>{var UO=oC()("type")==="browser",zO=UO?t=>new URL(t,window.location.href).href:t=>t;aC.exports=t=>{let e={...t};return["corePath","workerPath","langPath"].forEach(r=>{t[r]&&(e[r]=zO(e[r]))}),e}});var cC=tt((S4,lC)=>{lC.exports=t=>{let e=[],r=[],o=[],n=[],s=[];return t.blocks&&t.blocks.forEach(i=>{i.paragraphs.forEach(a=>{a.lines.forEach(l=>{l.words.forEach(u=>{u.symbols.forEach(c=>{s.push({...c,page:t,block:i,paragraph:a,line:l,word:u})}),n.push({...u,page:t,block:i,paragraph:a,line:l})}),o.push({...l,page:t,block:i,paragraph:a})}),r.push({...a,page:t,block:i})}),e.push({...i,page:t})}),{...t,blocks:e,paragraphs:r,lines:o,words:n,symbols:s}}});var ig=tt((b4,hC)=>{hC.exports={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}});var fC=tt((x4,WO)=>{WO.exports={name:"tesseract.js",version:"5.0.5",description:"Pure Javascript Multilingual OCR",main:"src/index.js",types:"src/index.d.ts",unpkg:"dist/tesseract.min.js",jsdelivr:"dist/tesseract.min.js",scripts:{start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:* test:node:all","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser-tpl":"mocha-headless-chrome -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:detect":"npm run test:browser-tpl -- -f ./tests/detect.test.html","test:browser:recognize":"npm run test:browser-tpl -- -f ./tests/recognize.test.html","test:browser:scheduler":"npm run test:browser-tpl -- -f ./tests/scheduler.test.html","test:browser:FS":"npm run test:browser-tpl -- -f ./tests/FS.test.html",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},browser:{"./src/worker/node/index.js":"./src/worker/browser/index.js"},author:"",contributors:["jeromewu"],license:"Apache-2.0",devDependencies:{"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","mocha-headless-chrome":"^4.0.0","npm-run-all":"^4.1.5",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},dependencies:{"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-electron":"^2.2.2","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^5.0.0","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},overrides:{"@rollup/pluginutils":"^5.0.2"},repository:{type:"git",url:"https://github.com/naptha/tesseract.js.git"},bugs:{url:"https://github.com/naptha/tesseract.js/issues"},homepage:"https://github.com/naptha/tesseract.js",collective:{type:"opencollective",url:"https://opencollective.com/tesseractjs"}}});var pC=tt((D4,dC)=>{dC.exports={workerBlobURL:!0,logger:()=>{}}});var mC=tt((E4,gC)=>{var GO=fC().version,HO=pC();gC.exports={...HO,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${GO}/dist/worker.min.js`}});var yC=tt((A4,vC)=>{vC.exports=({workerPath:t,workerBlobURL:e})=>{let r;if(Blob&&URL&&e){let o=new Blob([`importScripts("${t}");`],{type:"application/javascript"});r=new Worker(URL.createObjectURL(o))}else r=new Worker(t);return r}});var _C=tt((T4,CC)=>{CC.exports=t=>{t.terminate()}});var SC=tt((F4,wC)=>{wC.exports=(t,e)=>{t.onmessage=({data:r})=>{e(r)}}});var xC=tt((O4,bC)=>{bC.exports=async(t,e)=>{t.postMessage(e)}});var EC=tt((k4,DC)=>{var sg=t=>new Promise((e,r)=>{let o=new FileReader;o.onload=()=>{e(o.result)},o.onerror=({target:{error:{code:n}}})=>{r(Error(`File could not be read! Code=${n}`))},o.readAsArrayBuffer(t)}),og=async t=>{let e=t;if(typeof t>"u")return"undefined";if(typeof t=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(t)?e=atob(t.split(",")[1]).split("").map(r=>r.charCodeAt(0)):e=await(await fetch(t)).arrayBuffer();else if(typeof HTMLElement<"u"&&t instanceof HTMLElement)t.tagName==="IMG"&&(e=await og(t.src)),t.tagName==="VIDEO"&&(e=await og(t.poster)),t.tagName==="CANVAS"&&await new Promise(r=>{t.toBlob(async o=>{e=await sg(o),r()})});else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas){let r=await t.convertToBlob();e=await sg(r)}else(t instanceof File||t instanceof Blob)&&(e=await sg(t));return new Uint8Array(e)};DC.exports=og});var TC=tt((P4,AC)=>{var XO=mC(),YO=yC(),VO=_C(),qO=SC(),$O=xC(),KO=EC();AC.exports={defaultOptions:XO,spawnWorker:YO,terminateWorker:VO,onMessage:qO,send:$O,loadImage:KO}});var ag=tt((I4,PC)=>{var JO=uC(),QO=cC(),pi=rg(),{log:FC}=xh(),ZO=bh(),Ko=ig(),{defaultOptions:e3,spawnWorker:t3,terminateWorker:r3,onMessage:n3,loadImage:OC,send:i3}=TC(),kC=0;PC.exports=async(t="eng",e=Ko.LSTM_ONLY,r={},o={})=>{let n=ZO("Worker",kC),{logger:s,errorHandler:i,...a}=JO({...e3,...r}),l={},u={},c=typeof t=="string"?t.split("+"):t,h=e,d=o,g=[Ko.DEFAULT,Ko.LSTM_ONLY].includes(e)&&!a.legacyCore,m,y,C=new Promise((X,q)=>{y=X,m=q}),b=X=>{m(X.message)},k=t3(a);k.onerror=b,kC+=1;let L=(X,q)=>{l[X]=q},N=(X,q)=>{u[X]=q},M=({id:X,action:q,payload:ae})=>new Promise(($,U)=>{FC(`[${n}]: Start ${X}, action=${q}`);let te=`${q}-${X}`;L(te,$),N(te,U),i3(k,{workerId:n,jobId:X,action:q,payload:ae})}),W=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),Y=X=>M(pi({id:X,action:"load",payload:{options:{lstmOnly:g,corePath:a.corePath,logging:a.logging}}})),J=(X,q,ae)=>M(pi({id:ae,action:"FS",payload:{method:"writeFile",args:[X,q]}})),oe=(X,q)=>M(pi({id:q,action:"FS",payload:{method:"readFile",args:[X,{encoding:"utf8"}]}})),pe=(X,q)=>M(pi({id:q,action:"FS",payload:{method:"unlink",args:[X]}})),le=(X,q,ae)=>M(pi({id:ae,action:"FS",payload:{method:X,args:q}})),w=()=>console.warn("`loadLanguage` is depreciated and should be removed from code (workers now come with language pre-loaded)"),F=(X,q)=>M(pi({id:q,action:"loadLanguage",payload:{langs:X,options:{langPath:a.langPath,dataPath:a.dataPath,cachePath:a.cachePath,cacheMethod:a.cacheMethod,gzip:a.gzip,lstmOnly:[Ko.LSTM_ONLY,Ko.TESSERACT_LSTM_COMBINED].includes(h)&&!a.legacyLang}}})),P=()=>console.warn("`initialize` is depreciated and should be removed from code (workers now come pre-initialized)"),I=(X,q,ae,$)=>M(pi({id:$,action:"initialize",payload:{langs:X,oem:q,config:ae}})),H=(X="eng",q,ae,$)=>{if(g&&[Ko.TESSERACT_ONLY,Ko.TESSERACT_LSTM_COMBINED].includes(q))throw Error("Legacy model requested but code missing.");let U=q||h;h=U;let te=ae||d;d=te;let Q=(typeof X=="string"?X.split("+"):X).filter(ne=>!c.includes(ne));return c.push(...Q),Q.length>0?F(Q,$).then(()=>I(X,U,te,$)):I(X,U,te,$)},S=(X={},q)=>M(pi({id:q,action:"setParameters",payload:{params:X}})),_=async(X,q={},ae={blocks:!0,text:!0,hocr:!0,tsv:!0},$)=>M(pi({id:$,action:"recognize",payload:{image:await OC(X),options:q,output:ae}})),O=(X="Tesseract OCR Result",q=!1,ae)=>(console.log("`getPDF` function is depreciated. `recognize` option `savePDF` should be used instead."),M(pi({id:ae,action:"getPDF",payload:{title:X,textonly:q}}))),j=async(X,q)=>{if(g)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return M(pi({id:q,action:"detect",payload:{image:await OC(X)}}))},V=async()=>(k!==null&&(r3(k),k=null),Promise.resolve());n3(k,({workerId:X,jobId:q,status:ae,action:$,data:U})=>{let te=`${$}-${q}`;if(ae==="resolve"){FC(`[${X}]: Complete ${q}`);let ee=U;$==="recognize"?ee=QO(U):$==="getPDF"&&(ee=Array.from({...U,length:Object.keys(U).length})),l[te]({jobId:q,data:ee})}else if(ae==="reject")if(u[te](U),$==="load"&&m(U),i)i(U);else throw Error(U);else ae==="progress"&&s({...U,userJobId:q})});let z={id:n,worker:k,setResolve:L,setReject:N,load:W,writeText:J,readText:oe,removeFile:pe,FS:le,loadLanguage:w,initialize:P,reinitialize:H,setParameters:S,recognize:_,getPDF:O,detect:j,terminate:V};return Y().then(()=>F(t)).then(()=>I(t,e,o)).then(()=>y(z)).catch(()=>{}),C}});var LC=tt((B4,BC)=>{var IC=ag(),s3=async(t,e,r)=>{let o=await IC(e,1,r);return o.recognize(t).finally(async()=>{await o.terminate()})},o3=async(t,e)=>{let r=await IC("osd",0,e);return r.detect(t).finally(async()=>{await r.terminate()})};BC.exports={recognize:s3,detect:o3}});var RC=tt((L4,MC)=>{MC.exports={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}});var NC=tt((M4,jC)=>{jC.exports={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}});var zC=tt((R4,UC)=>{$y();var a3=rC(),u3=ag(),l3=LC(),c3=RC(),h3=ig(),f3=NC(),{setLogging:d3}=xh();UC.exports={languages:c3,OEM:h3,PSM:f3,createScheduler:a3,createWorker:u3,setLogging:d3,...l3}});var VC=tt(At=>{"use strict";var Ja,bl,Fh,pg;typeof performance=="object"&&typeof performance.now=="function"?(WC=performance,At.unstable_now=function(){return WC.now()}):(ug=Date,GC=ug.now(),At.unstable_now=function(){return ug.now()-GC});var WC,ug,GC;typeof window>"u"||typeof MessageChannel!="function"?(Ka=null,lg=null,cg=function(){if(Ka!==null)try{var t=At.unstable_now();Ka(!0,t),Ka=null}catch(e){throw setTimeout(cg,0),e}},Ja=function(t){Ka!==null?setTimeout(Ja,0,t):(Ka=t,setTimeout(cg,0))},bl=function(t,e){lg=setTimeout(t,e)},Fh=function(){clearTimeout(lg)},At.unstable_shouldYield=function(){return!1},pg=At.unstable_forceFrameRate=function(){}):(HC=window.setTimeout,XC=window.clearTimeout,typeof console<"u"&&(YC=window.cancelAnimationFrame,typeof window.requestAnimationFrame!="function"&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),typeof YC!="function"&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")),wl=!1,Sl=null,Eh=-1,hg=5,fg=0,At.unstable_shouldYield=function(){return At.unstable_now()>=fg},pg=function(){},At.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):hg=0<t?Math.floor(1e3/t):5},dg=new MessageChannel,Ah=dg.port2,dg.port1.onmessage=function(){if(Sl!==null){var t=At.unstable_now();fg=t+hg;try{Sl(!0,t)?Ah.postMessage(null):(wl=!1,Sl=null)}catch(e){throw Ah.postMessage(null),e}}else wl=!1},Ja=function(t){Sl=t,wl||(wl=!0,Ah.postMessage(null))},bl=function(t,e){Eh=HC(function(){t(At.unstable_now())},e)},Fh=function(){XC(Eh),Eh=-1});var Ka,lg,cg,HC,XC,YC,wl,Sl,Eh,hg,fg,dg,Ah;function gg(t,e){var r=t.length;t.push(e);e:for(;;){var o=r-1>>>1,n=t[o];if(n!==void 0&&0<Th(n,e))t[o]=e,t[r]=n,r=o;else break e}}function gi(t){return t=t[0],t===void 0?null:t}function Oh(t){var e=t[0];if(e!==void 0){var r=t.pop();if(r!==e){t[0]=r;e:for(var o=0,n=t.length;o<n;){var s=2*(o+1)-1,i=t[s],a=s+1,l=t[a];if(i!==void 0&&0>Th(i,r))l!==void 0&&0>Th(l,i)?(t[o]=l,t[a]=r,o=a):(t[o]=i,t[s]=r,o=s);else if(l!==void 0&&0>Th(l,r))t[o]=l,t[a]=r,o=a;else break e}}return e}return null}function Th(t,e){var r=t.sortIndex-e.sortIndex;return r!==0?r:t.id-e.id}var ki=[],Vs=[],p3=1,Yn=null,Ir=3,kh=!1,Jo=!1,xl=!1;function mg(t){for(var e=gi(Vs);e!==null;){if(e.callback===null)Oh(Vs);else if(e.startTime<=t)Oh(Vs),e.sortIndex=e.expirationTime,gg(ki,e);else break;e=gi(Vs)}}function vg(t){if(xl=!1,mg(t),!Jo)if(gi(ki)!==null)Jo=!0,Ja(yg);else{var e=gi(Vs);e!==null&&bl(vg,e.startTime-t)}}function yg(t,e){Jo=!1,xl&&(xl=!1,Fh()),kh=!0;var r=Ir;try{for(mg(e),Yn=gi(ki);Yn!==null&&(!(Yn.expirationTime>e)||t&&!At.unstable_shouldYield());){var o=Yn.callback;if(typeof o=="function"){Yn.callback=null,Ir=Yn.priorityLevel;var n=o(Yn.expirationTime<=e);e=At.unstable_now(),typeof n=="function"?Yn.callback=n:Yn===gi(ki)&&Oh(ki),mg(e)}else Oh(ki);Yn=gi(ki)}if(Yn!==null)var s=!0;else{var i=gi(Vs);i!==null&&bl(vg,i.startTime-e),s=!1}return s}finally{Yn=null,Ir=r,kh=!1}}var g3=pg;At.unstable_IdlePriority=5;At.unstable_ImmediatePriority=1;At.unstable_LowPriority=4;At.unstable_NormalPriority=3;At.unstable_Profiling=null;At.unstable_UserBlockingPriority=2;At.unstable_cancelCallback=function(t){t.callback=null};At.unstable_continueExecution=function(){Jo||kh||(Jo=!0,Ja(yg))};At.unstable_getCurrentPriorityLevel=function(){return Ir};At.unstable_getFirstCallbackNode=function(){return gi(ki)};At.unstable_next=function(t){switch(Ir){case 1:case 2:case 3:var e=3;break;default:e=Ir}var r=Ir;Ir=e;try{return t()}finally{Ir=r}};At.unstable_pauseExecution=function(){};At.unstable_requestPaint=g3;At.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var r=Ir;Ir=t;try{return e()}finally{Ir=r}};At.unstable_scheduleCallback=function(t,e,r){var o=At.unstable_now();switch(typeof r=="object"&&r!==null?(r=r.delay,r=typeof r=="number"&&0<r?o+r:o):r=o,t){case 1:var n=-1;break;case 2:n=250;break;case 5:n=1073741823;break;case 4:n=1e4;break;default:n=5e3}return n=r+n,t={id:p3++,callback:e,priorityLevel:t,startTime:r,expirationTime:n,sortIndex:-1},r>o?(t.sortIndex=r,gg(Vs,t),gi(ki)===null&&t===gi(Vs)&&(xl?Fh():xl=!0,bl(vg,r-o))):(t.sortIndex=n,gg(ki,t),Jo||kh||(Jo=!0,Ja(yg))),t};At.unstable_wrapCallback=function(t){var e=Ir;return function(){var r=Ir;Ir=e;try{return t.apply(this,arguments)}finally{Ir=r}}}});var $C=tt((N4,qC)=>{"use strict";qC.exports=VC()});var Lw=tt(Qn=>{"use strict";var Df=Go(),zt=tp(),gr=$C();function Pe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!Df)throw Error(Pe(227));var u2=new Set,ec={};function ua(t,e){yu(t,e),yu(t+"Capture",e)}function yu(t,e){for(ec[t]=e,t=0;t<e.length;t++)u2.add(e[t])}var vs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,KC=Object.prototype.hasOwnProperty,JC={},QC={};function v3(t){return KC.call(QC,t)?!0:KC.call(JC,t)?!1:m3.test(t)?QC[t]=!0:(JC[t]=!0,!1)}function y3(t,e,r,o){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return o?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function C3(t,e,r,o){if(e===null||typeof e>"u"||y3(t,e,r,o))return!0;if(o)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Qr(t,e,r,o,n,s,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=o,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=i}var br={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){br[t]=new Qr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];br[e]=new Qr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){br[t]=new Qr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){br[t]=new Qr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){br[t]=new Qr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){br[t]=new Qr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){br[t]=new Qr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){br[t]=new Qr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){br[t]=new Qr(t,5,!1,t.toLowerCase(),null,!1,!1)});var A0=/[\-:]([a-z])/g;function T0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(A0,T0);br[e]=new Qr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(A0,T0);br[e]=new Qr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(A0,T0);br[e]=new Qr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){br[t]=new Qr(t,1,!1,t.toLowerCase(),null,!1,!1)});br.xlinkHref=new Qr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){br[t]=new Qr(t,1,!1,t.toLowerCase(),null,!0,!0)});function F0(t,e,r,o){var n=br.hasOwnProperty(e)?br[e]:null,s=n!==null?n.type===0:o?!1:!(!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N");s||(C3(e,r,n,o)&&(r=null),o||n===null?v3(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):n.mustUseProperty?t[n.propertyName]=r===null?n.type===3?!1:"":r:(e=n.attributeName,o=n.attributeNamespace,r===null?t.removeAttribute(e):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,o?t.setAttributeNS(o,e,r):t.setAttribute(e,r))))}var la=Df.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rl=60103,Zo=60106,$s=60107,O0=60108,Wl=60114,k0=60109,P0=60110,Ef=60112,Gl=60113,tf=60120,Af=60115,I0=60116,B0=60121,L0=60128,l2=60129,M0=60130,zg=60131;typeof Symbol=="function"&&Symbol.for&&(hr=Symbol.for,Rl=hr("react.element"),Zo=hr("react.portal"),$s=hr("react.fragment"),O0=hr("react.strict_mode"),Wl=hr("react.profiler"),k0=hr("react.provider"),P0=hr("react.context"),Ef=hr("react.forward_ref"),Gl=hr("react.suspense"),tf=hr("react.suspense_list"),Af=hr("react.memo"),I0=hr("react.lazy"),B0=hr("react.block"),hr("react.scope"),L0=hr("react.opaque.id"),l2=hr("react.debug_trace_mode"),M0=hr("react.offscreen"),zg=hr("react.legacy_hidden"));var hr,ZC=typeof Symbol=="function"&&Symbol.iterator;function Dl(t){return t===null||typeof t!="object"?null:(t=ZC&&t[ZC]||t["@@iterator"],typeof t=="function"?t:null)}var Cg;function jl(t){if(Cg===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Cg=e&&e[1]||""}return`
`+Cg+t}var _g=!1;function Ph(t,e){if(!t||_g)return"";_g=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var o=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){o=l}t.call(e.prototype)}else{try{throw Error()}catch(l){o=l}t()}}catch(l){if(l&&o&&typeof l.stack=="string"){for(var n=l.stack.split(`
`),s=o.stack.split(`
`),i=n.length-1,a=s.length-1;1<=i&&0<=a&&n[i]!==s[a];)a--;for(;1<=i&&0<=a;i--,a--)if(n[i]!==s[a]){if(i!==1||a!==1)do if(i--,a--,0>a||n[i]!==s[a])return`
`+n[i].replace(" at new "," at ");while(1<=i&&0<=a);break}}}finally{_g=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?jl(t):""}function _3(t){switch(t.tag){case 5:return jl(t.type);case 16:return jl("Lazy");case 13:return jl("Suspense");case 19:return jl("SuspenseList");case 0:case 2:case 15:return t=Ph(t.type,!1),t;case 11:return t=Ph(t.type.render,!1),t;case 22:return t=Ph(t.type._render,!1),t;case 1:return t=Ph(t.type,!0),t;default:return""}}function uu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case $s:return"Fragment";case Zo:return"Portal";case Wl:return"Profiler";case O0:return"StrictMode";case Gl:return"Suspense";case tf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case P0:return(t.displayName||"Context")+".Consumer";case k0:return(t._context.displayName||"Context")+".Provider";case Ef:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case Af:return uu(t.type);case B0:return uu(t._render);case I0:e=t._payload,t=t._init;try{return uu(t(e))}catch{}}return null}function ao(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function c2(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function w3(t){var e=c2(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),o=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return n.call(this)},set:function(i){o=""+i,s.call(this,i)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return o},setValue:function(i){o=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ih(t){t._valueTracker||(t._valueTracker=w3(t))}function h2(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),o="";return t&&(o=c2(t)?t.checked?"true":"false":t.value),t=o,t!==r?(e.setValue(t),!0):!1}function rf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Wg(t,e){var r=e.checked;return zt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function e_(t,e){var r=e.defaultValue==null?"":e.defaultValue,o=e.checked!=null?e.checked:e.defaultChecked;r=ao(e.value!=null?e.value:r),t._wrapperState={initialChecked:o,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function f2(t,e){e=e.checked,e!=null&&F0(t,"checked",e,!1)}function Gg(t,e){f2(t,e);var r=ao(e.value),o=e.type;if(r!=null)o==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(o==="submit"||o==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Hg(t,e.type,r):e.hasOwnProperty("defaultValue")&&Hg(t,e.type,ao(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function t_(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var o=e.type;if(!(o!=="submit"&&o!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Hg(t,e,r){(e!=="number"||rf(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}function S3(t){var e="";return Df.Children.forEach(t,function(r){r!=null&&(e+=r)}),e}function Xg(t,e){return t=zt({children:void 0},e),(e=S3(e.children))&&(t.children=e),t}function lu(t,e,r,o){if(t=t.options,e){e={};for(var n=0;n<r.length;n++)e["$"+r[n]]=!0;for(r=0;r<t.length;r++)n=e.hasOwnProperty("$"+t[r].value),t[r].selected!==n&&(t[r].selected=n),n&&o&&(t[r].defaultSelected=!0)}else{for(r=""+ao(r),e=null,n=0;n<t.length;n++){if(t[n].value===r){t[n].selected=!0,o&&(t[n].defaultSelected=!0);return}e!==null||t[n].disabled||(e=t[n])}e!==null&&(e.selected=!0)}}function Yg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Pe(91));return zt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function r_(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Pe(92));if(Array.isArray(r)){if(!(1>=r.length))throw Error(Pe(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:ao(r)}}function d2(t,e){var r=ao(e.value),o=ao(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),o!=null&&(t.defaultValue=""+o)}function n_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}var Vg={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function p2(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?p2(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Bh,g2=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,o,n){MSApp.execUnsafeLocalFunction(function(){return t(e,r,o,n)})}:t}(function(t,e){if(t.namespaceURI!==Vg.svg||"innerHTML"in t)t.innerHTML=e;else{for(Bh=Bh||document.createElement("div"),Bh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Bh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function tc(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Hl={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},b3=["Webkit","ms","Moz","O"];Object.keys(Hl).forEach(function(t){b3.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Hl[e]=Hl[t]})});function m2(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Hl.hasOwnProperty(t)&&Hl[t]?(""+e).trim():e+"px"}function v2(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var o=r.indexOf("--")===0,n=m2(r,e[r],o);r==="float"&&(r="cssFloat"),o?t.setProperty(r,n):t[r]=n}}var x3=zt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $g(t,e){if(e){if(x3[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Pe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Pe(60));if(!(typeof e.dangerouslySetInnerHTML=="object"&&"__html"in e.dangerouslySetInnerHTML))throw Error(Pe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Pe(62))}}function Kg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function R0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Jg=null,cu=null,hu=null;function i_(t){if(t=gc(t)){if(typeof Jg!="function")throw Error(Pe(280));var e=t.stateNode;e&&(e=If(e),Jg(t.stateNode,t.type,e))}}function y2(t){cu?hu?hu.push(t):hu=[t]:cu=t}function C2(){if(cu){var t=cu,e=hu;if(hu=cu=null,i_(t),e)for(t=0;t<e.length;t++)i_(e[t])}}function j0(t,e){return t(e)}function _2(t,e,r,o,n){return t(e,r,o,n)}function N0(){}var w2=j0,ea=!1,wg=!1;function U0(){(cu!==null||hu!==null)&&(N0(),C2())}function D3(t,e,r){if(wg)return t(e,r);wg=!0;try{return w2(t,e,r)}finally{wg=!1,U0()}}function rc(t,e){var r=t.stateNode;if(r===null)return null;var o=If(r);if(o===null)return null;r=o[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(t=t.type,o=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!o;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Pe(231,e,typeof r));return r}var Qg=!1;if(vs)try{Qa={},Object.defineProperty(Qa,"passive",{get:function(){Qg=!0}}),window.addEventListener("test",Qa,Qa),window.removeEventListener("test",Qa,Qa)}catch{Qg=!1}var Qa;function E3(t,e,r,o,n,s,i,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(c){this.onError(c)}}var Xl=!1,nf=null,sf=!1,Zg=null,A3={onError:function(t){Xl=!0,nf=t}};function T3(t,e,r,o,n,s,i,a,l){Xl=!1,nf=null,E3.apply(A3,arguments)}function F3(t,e,r,o,n,s,i,a,l){if(T3.apply(this,arguments),Xl){if(Xl){var u=nf;Xl=!1,nf=null}else throw Error(Pe(198));sf||(sf=!0,Zg=u)}}function ca(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,(e.flags&1026)!==0&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function S2(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function s_(t){if(ca(t)!==t)throw Error(Pe(188))}function O3(t){var e=t.alternate;if(!e){if(e=ca(t),e===null)throw Error(Pe(188));return e!==t?null:t}for(var r=t,o=e;;){var n=r.return;if(n===null)break;var s=n.alternate;if(s===null){if(o=n.return,o!==null){r=o;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===r)return s_(n),t;if(s===o)return s_(n),e;s=s.sibling}throw Error(Pe(188))}if(r.return!==o.return)r=n,o=s;else{for(var i=!1,a=n.child;a;){if(a===r){i=!0,r=n,o=s;break}if(a===o){i=!0,o=n,r=s;break}a=a.sibling}if(!i){for(a=s.child;a;){if(a===r){i=!0,r=s,o=n;break}if(a===o){i=!0,o=s,r=n;break}a=a.sibling}if(!i)throw Error(Pe(189))}}if(r.alternate!==o)throw Error(Pe(190))}if(r.tag!==3)throw Error(Pe(188));return r.stateNode.current===r?t:e}function b2(t){if(t=O3(t),!t)return null;for(var e=t;;){if(e.tag===5||e.tag===6)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function o_(t,e){for(var r=t.alternate;e!==null;){if(e===t||e===r)return!0;e=e.return}return!1}var x2,z0,D2,E2,e0=!1,Pi=[],Zs=null,eo=null,to=null,nc=new Map,ic=new Map,El=[],a_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function t0(t,e,r,o,n){return{blockedOn:t,domEventName:e,eventSystemFlags:r|16,nativeEvent:n,targetContainers:[o]}}function u_(t,e){switch(t){case"focusin":case"focusout":Zs=null;break;case"dragenter":case"dragleave":eo=null;break;case"mouseover":case"mouseout":to=null;break;case"pointerover":case"pointerout":nc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ic.delete(e.pointerId)}}function Al(t,e,r,o,n,s){return t===null||t.nativeEvent!==s?(t=t0(e,r,o,n,s),e!==null&&(e=gc(e),e!==null&&z0(e)),t):(t.eventSystemFlags|=o,e=t.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),t)}function k3(t,e,r,o,n){switch(e){case"focusin":return Zs=Al(Zs,t,e,r,o,n),!0;case"dragenter":return eo=Al(eo,t,e,r,o,n),!0;case"mouseover":return to=Al(to,t,e,r,o,n),!0;case"pointerover":var s=n.pointerId;return nc.set(s,Al(nc.get(s)||null,t,e,r,o,n)),!0;case"gotpointercapture":return s=n.pointerId,ic.set(s,Al(ic.get(s)||null,t,e,r,o,n)),!0}return!1}function P3(t){var e=ta(t.target);if(e!==null){var r=ca(e);if(r!==null){if(e=r.tag,e===13){if(e=S2(r),e!==null){t.blockedOn=e,E2(t.lanePriority,function(){gr.unstable_runWithPriority(t.priority,function(){D2(r)})});return}}else if(e===3&&r.stateNode.hydrate){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Xh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=X0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r!==null)return e=gc(r),e!==null&&z0(e),t.blockedOn=r,!1;e.shift()}return!0}function l_(t,e,r){Xh(t)&&r.delete(e)}function I3(){for(e0=!1;0<Pi.length;){var t=Pi[0];if(t.blockedOn!==null){t=gc(t.blockedOn),t!==null&&x2(t);break}for(var e=t.targetContainers;0<e.length;){var r=X0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r!==null){t.blockedOn=r;break}e.shift()}t.blockedOn===null&&Pi.shift()}Zs!==null&&Xh(Zs)&&(Zs=null),eo!==null&&Xh(eo)&&(eo=null),to!==null&&Xh(to)&&(to=null),nc.forEach(l_),ic.forEach(l_)}function Tl(t,e){t.blockedOn===e&&(t.blockedOn=null,e0||(e0=!0,gr.unstable_scheduleCallback(gr.unstable_NormalPriority,I3)))}function A2(t){function e(n){return Tl(n,t)}if(0<Pi.length){Tl(Pi[0],t);for(var r=1;r<Pi.length;r++){var o=Pi[r];o.blockedOn===t&&(o.blockedOn=null)}}for(Zs!==null&&Tl(Zs,t),eo!==null&&Tl(eo,t),to!==null&&Tl(to,t),nc.forEach(e),ic.forEach(e),r=0;r<El.length;r++)o=El[r],o.blockedOn===t&&(o.blockedOn=null);for(;0<El.length&&(r=El[0],r.blockedOn===null);)P3(r),r.blockedOn===null&&El.shift()}function Lh(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var ru={animationend:Lh("Animation","AnimationEnd"),animationiteration:Lh("Animation","AnimationIteration"),animationstart:Lh("Animation","AnimationStart"),transitionend:Lh("Transition","TransitionEnd")},Sg={},T2={};vs&&(T2=document.createElement("div").style,"AnimationEvent"in window||(delete ru.animationend.animation,delete ru.animationiteration.animation,delete ru.animationstart.animation),"TransitionEvent"in window||delete ru.transitionend.transition);function Tf(t){if(Sg[t])return Sg[t];if(!ru[t])return t;var e=ru[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in T2)return Sg[t]=e[r];return t}var F2=Tf("animationend"),O2=Tf("animationiteration"),k2=Tf("animationstart"),P2=Tf("transitionend"),I2=new Map,W0=new Map,B3=["abort","abort",F2,"animationEnd",O2,"animationIteration",k2,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",P2,"transitionEnd","waiting","waiting"];function G0(t,e){for(var r=0;r<t.length;r+=2){var o=t[r],n=t[r+1];n="on"+(n[0].toUpperCase()+n.slice(1)),W0.set(o,e),I2.set(o,n),ua(n,[o])}}var L3=gr.unstable_now;L3();var Bt=8;function eu(t){if((1&t)!==0)return Bt=15,1;if((2&t)!==0)return Bt=14,2;if((4&t)!==0)return Bt=13,4;var e=24&t;return e!==0?(Bt=12,e):(t&32)!==0?(Bt=11,32):(e=192&t,e!==0?(Bt=10,e):(t&256)!==0?(Bt=9,256):(e=3584&t,e!==0?(Bt=8,e):(t&4096)!==0?(Bt=7,4096):(e=4186112&t,e!==0?(Bt=6,e):(e=62914560&t,e!==0?(Bt=5,e):t&67108864?(Bt=4,67108864):(t&134217728)!==0?(Bt=3,134217728):(e=805306368&t,e!==0?(Bt=2,e):(1073741824&t)!==0?(Bt=1,1073741824):(Bt=8,t))))))}function M3(t){switch(t){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}function R3(t){switch(t){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(Pe(358,t))}}function sc(t,e){var r=t.pendingLanes;if(r===0)return Bt=0;var o=0,n=0,s=t.expiredLanes,i=t.suspendedLanes,a=t.pingedLanes;if(s!==0)o=s,n=Bt=15;else if(s=r&134217727,s!==0){var l=s&~i;l!==0?(o=eu(l),n=Bt):(a&=s,a!==0&&(o=eu(a),n=Bt))}else s=r&~i,s!==0?(o=eu(s),n=Bt):a!==0&&(o=eu(a),n=Bt);if(o===0)return 0;if(o=31-uo(o),o=r&((0>o?0:1<<o)<<1)-1,e!==0&&e!==o&&(e&i)===0){if(eu(e),n<=Bt)return e;Bt=n}if(e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=o;0<e;)r=31-uo(e),n=1<<r,o|=t[r],e&=~n;return o}function B2(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function of(t,e){switch(t){case 15:return 1;case 14:return 2;case 12:return t=tu(24&~e),t===0?of(10,e):t;case 10:return t=tu(192&~e),t===0?of(8,e):t;case 8:return t=tu(3584&~e),t===0&&(t=tu(4186112&~e),t===0&&(t=512)),t;case 2:return e=tu(805306368&~e),e===0&&(e=268435456),e}throw Error(Pe(358,t))}function tu(t){return t&-t}function bg(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Ff(t,e,r){t.pendingLanes|=e;var o=e-1;t.suspendedLanes&=o,t.pingedLanes&=o,t=t.eventTimes,e=31-uo(e),t[e]=r}var uo=Math.clz32?Math.clz32:U3,j3=Math.log,N3=Math.LN2;function U3(t){return t===0?32:31-(j3(t)/N3|0)|0}var z3=gr.unstable_UserBlockingPriority,W3=gr.unstable_runWithPriority,Yh=!0;function G3(t,e,r,o){ea||N0();var n=H0,s=ea;ea=!0;try{_2(n,t,e,r,o)}finally{(ea=s)||U0()}}function H3(t,e,r,o){W3(z3,H0.bind(null,t,e,r,o))}function H0(t,e,r,o){if(Yh){var n;if((n=(e&4)===0)&&0<Pi.length&&-1<a_.indexOf(t))t=t0(null,t,e,r,o),Pi.push(t);else{var s=X0(t,e,r,o);if(s===null)n&&u_(t,o);else{if(n){if(-1<a_.indexOf(t)){t=t0(s,t,e,r,o),Pi.push(t);return}if(k3(s,t,e,r,o))return;u_(t,o)}V2(t,e,o,null,r)}}}}function X0(t,e,r,o){var n=R0(o);if(n=ta(n),n!==null){var s=ca(n);if(s===null)n=null;else{var i=s.tag;if(i===13){if(n=S2(s),n!==null)return n;n=null}else if(i===3){if(s.stateNode.hydrate)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null)}}return V2(t,e,o,n,r),null}var Ks=null,Y0=null,Vh=null;function L2(){if(Vh)return Vh;var t,e=Y0,r=e.length,o,n="value"in Ks?Ks.value:Ks.textContent,s=n.length;for(t=0;t<r&&e[t]===n[t];t++);var i=r-t;for(o=1;o<=i&&e[r-o]===n[s-o];o++);return Vh=n.slice(t,1<o?1-o:void 0)}function qh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Mh(){return!0}function c_(){return!1}function kn(t){function e(r,o,n,s,i){this._reactName=r,this._targetInst=n,this.type=o,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Mh:c_,this.isPropagationStopped=c_,this}return zt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Mh)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Mh)},persist:function(){},isPersistent:Mh}),e}var Su={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},V0=kn(Su),pc=zt({},Su,{view:0,detail:0}),X3=kn(pc),xg,Dg,Fl,Of=zt({},pc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:q0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Fl&&(Fl&&t.type==="mousemove"?(xg=t.screenX-Fl.screenX,Dg=t.screenY-Fl.screenY):Dg=xg=0,Fl=t),xg)},movementY:function(t){return"movementY"in t?t.movementY:Dg}}),h_=kn(Of),Y3=zt({},Of,{dataTransfer:0}),V3=kn(Y3),q3=zt({},pc,{relatedTarget:0}),Eg=kn(q3),$3=zt({},Su,{animationName:0,elapsedTime:0,pseudoElement:0}),K3=kn($3),J3=zt({},Su,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Q3=kn(J3),Z3=zt({},Su,{data:0}),f_=kn(Z3),ek={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nk(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=rk[t])?!!e[t]:!1}function q0(){return nk}var ik=zt({},pc,{key:function(t){if(t.key){var e=ek[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=qh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?tk[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:q0,charCode:function(t){return t.type==="keypress"?qh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?qh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sk=kn(ik),ok=zt({},Of,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),d_=kn(ok),ak=zt({},pc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:q0}),uk=kn(ak),lk=zt({},Su,{propertyName:0,elapsedTime:0,pseudoElement:0}),ck=kn(lk),hk=zt({},Of,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),fk=kn(hk),dk=[9,13,27,32],$0=vs&&"CompositionEvent"in window,Yl=null;vs&&"documentMode"in document&&(Yl=document.documentMode);var pk=vs&&"TextEvent"in window&&!Yl,M2=vs&&(!$0||Yl&&8<Yl&&11>=Yl),p_=" ",g_=!1;function R2(t,e){switch(t){case"keyup":return dk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function j2(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var nu=!1;function gk(t,e){switch(t){case"compositionend":return j2(e);case"keypress":return e.which!==32?null:(g_=!0,p_);case"textInput":return t=e.data,t===p_&&g_?null:t;default:return null}}function mk(t,e){if(nu)return t==="compositionend"||!$0&&R2(t,e)?(t=L2(),Vh=Y0=Ks=null,nu=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return M2&&e.locale!=="ko"?null:e.data;default:return null}}var vk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function m_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!vk[t.type]:e==="textarea"}function N2(t,e,r,o){y2(o),e=af(e,"onChange"),0<e.length&&(r=new V0("onChange","change",null,r,o),t.push({event:r,listeners:e}))}var Vl=null,oc=null;function yk(t){H2(t,0)}function kf(t){var e=su(t);if(h2(e))return t}function Ck(t,e){if(t==="change")return e}var U2=!1;vs&&(vs?(jh="oninput"in document,jh||(Ag=document.createElement("div"),Ag.setAttribute("oninput","return;"),jh=typeof Ag.oninput=="function"),Rh=jh):Rh=!1,U2=Rh&&(!document.documentMode||9<document.documentMode));var Rh,jh,Ag;function v_(){Vl&&(Vl.detachEvent("onpropertychange",z2),oc=Vl=null)}function z2(t){if(t.propertyName==="value"&&kf(oc)){var e=[];if(N2(e,oc,t,R0(t)),t=yk,ea)t(e);else{ea=!0;try{j0(t,e)}finally{ea=!1,U0()}}}}function _k(t,e,r){t==="focusin"?(v_(),Vl=e,oc=r,Vl.attachEvent("onpropertychange",z2)):t==="focusout"&&v_()}function wk(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return kf(oc)}function Sk(t,e){if(t==="click")return kf(e)}function bk(t,e){if(t==="input"||t==="change")return kf(e)}function xk(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Vn=typeof Object.is=="function"?Object.is:xk,Dk=Object.prototype.hasOwnProperty;function ac(t,e){if(Vn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),o=Object.keys(e);if(r.length!==o.length)return!1;for(o=0;o<r.length;o++)if(!Dk.call(e,r[o])||!Vn(t[r[o]],e[r[o]]))return!1;return!0}function y_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function C_(t,e){var r=y_(t);t=0;for(var o;r;){if(r.nodeType===3){if(o=t+r.textContent.length,t<=e&&o>=e)return{node:r,offset:e-t};t=o}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=y_(r)}}function W2(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?W2(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function __(){for(var t=window,e=rf();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=rf(t.document)}return e}function r0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var Ek=vs&&"documentMode"in document&&11>=document.documentMode,iu=null,n0=null,ql=null,i0=!1;function w_(t,e,r){var o=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;i0||iu==null||iu!==rf(o)||(o=iu,"selectionStart"in o&&r0(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),ql&&ac(ql,o)||(ql=o,o=af(n0,"onSelect"),0<o.length&&(e=new V0("onSelect","select",null,e,r),t.push({event:e,listeners:o}),e.target=iu)))}G0("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0);G0("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);G0(B3,2);for(Tg="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Nh=0;Nh<Tg.length;Nh++)W0.set(Tg[Nh],0);var Tg,Nh;yu("onMouseEnter",["mouseout","mouseover"]);yu("onMouseLeave",["mouseout","mouseover"]);yu("onPointerEnter",["pointerout","pointerover"]);yu("onPointerLeave",["pointerout","pointerover"]);ua("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ua("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ua("onBeforeInput",["compositionend","keypress","textInput","paste"]);ua("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ua("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ua("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),G2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nl));function S_(t,e,r){var o=t.type||"unknown-event";t.currentTarget=r,F3(o,e,void 0,t),t.currentTarget=null}function H2(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var o=t[r],n=o.event;o=o.listeners;e:{var s=void 0;if(e)for(var i=o.length-1;0<=i;i--){var a=o[i],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&n.isPropagationStopped())break e;S_(n,a,u),s=l}else for(i=0;i<o.length;i++){if(a=o[i],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&n.isPropagationStopped())break e;S_(n,a,u),s=l}}}if(sf)throw t=Zg,sf=!1,Zg=null,t}function Rt(t,e){var r=$2(e),o=t+"__bubble";r.has(o)||(Y2(e,t,2,!1),r.add(o))}var b_="_reactListening"+Math.random().toString(36).slice(2);function X2(t){t[b_]||(t[b_]=!0,u2.forEach(function(e){G2.has(e)||x_(e,!1,t,null),x_(e,!0,t,null)}))}function x_(t,e,r,o){var n=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,s=r;if(t==="selectionchange"&&r.nodeType!==9&&(s=r.ownerDocument),o!==null&&!e&&G2.has(t)){if(t!=="scroll")return;n|=2,s=o}var i=$2(s),a=t+"__"+(e?"capture":"bubble");i.has(a)||(e&&(n|=4),Y2(s,t,n,e),i.add(a))}function Y2(t,e,r,o){var n=W0.get(e);switch(n===void 0?2:n){case 0:n=G3;break;case 1:n=H3;break;default:n=H0}r=n.bind(null,e,r,t),n=void 0,!Qg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),o?n!==void 0?t.addEventListener(e,r,{capture:!0,passive:n}):t.addEventListener(e,r,!0):n!==void 0?t.addEventListener(e,r,{passive:n}):t.addEventListener(e,r,!1)}function V2(t,e,r,o,n){var s=o;if((e&1)===0&&(e&2)===0&&o!==null)e:for(;;){if(o===null)return;var i=o.tag;if(i===3||i===4){var a=o.stateNode.containerInfo;if(a===n||a.nodeType===8&&a.parentNode===n)break;if(i===4)for(i=o.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;i=i.return}for(;a!==null;){if(i=ta(a),i===null)return;if(l=i.tag,l===5||l===6){o=s=i;continue e}a=a.parentNode}}o=o.return}D3(function(){var u=s,c=R0(r),h=[];e:{var d=I2.get(t);if(d!==void 0){var g=V0,m=t;switch(t){case"keypress":if(qh(r)===0)break e;case"keydown":case"keyup":g=sk;break;case"focusin":m="focus",g=Eg;break;case"focusout":m="blur",g=Eg;break;case"beforeblur":case"afterblur":g=Eg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=h_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=V3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=uk;break;case F2:case O2:case k2:g=K3;break;case P2:g=ck;break;case"scroll":g=X3;break;case"wheel":g=fk;break;case"copy":case"cut":case"paste":g=Q3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=d_}var y=(e&4)!==0,C=!y&&t==="scroll",b=y?d!==null?d+"Capture":null:d;y=[];for(var k=u,L;k!==null;){L=k;var N=L.stateNode;if(L.tag===5&&N!==null&&(L=N,b!==null&&(N=rc(k,b),N!=null&&y.push(uc(k,N,L)))),C)break;k=k.return}0<y.length&&(d=new g(d,m,null,r,c),h.push({event:d,listeners:y}))}}if((e&7)===0){e:{if(d=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",d&&(e&16)===0&&(m=r.relatedTarget||r.fromElement)&&(ta(m)||m[bu]))break e;if((g||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,g?(m=r.relatedTarget||r.toElement,g=u,m=m?ta(m):null,m!==null&&(C=ca(m),m!==C||m.tag!==5&&m.tag!==6)&&(m=null)):(g=null,m=u),g!==m)){if(y=h_,N="onMouseLeave",b="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(y=d_,N="onPointerLeave",b="onPointerEnter",k="pointer"),C=g==null?d:su(g),L=m==null?d:su(m),d=new y(N,k+"leave",g,r,c),d.target=C,d.relatedTarget=L,N=null,ta(c)===u&&(y=new y(b,k+"enter",m,r,c),y.target=L,y.relatedTarget=C,N=y),C=N,g&&m)t:{for(y=g,b=m,k=0,L=y;L;L=Za(L))k++;for(L=0,N=b;N;N=Za(N))L++;for(;0<k-L;)y=Za(y),k--;for(;0<L-k;)b=Za(b),L--;for(;k--;){if(y===b||b!==null&&y===b.alternate)break t;y=Za(y),b=Za(b)}y=null}else y=null;g!==null&&D_(h,d,g,y,!1),m!==null&&C!==null&&D_(h,C,m,y,!0)}}e:{if(d=u?su(u):window,g=d.nodeName&&d.nodeName.toLowerCase(),g==="select"||g==="input"&&d.type==="file")var M=Ck;else if(m_(d))if(U2)M=bk;else{M=wk;var W=_k}else(g=d.nodeName)&&g.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(M=Sk);if(M&&(M=M(t,u))){N2(h,M,r,c);break e}W&&W(t,d,u),t==="focusout"&&(W=d._wrapperState)&&W.controlled&&d.type==="number"&&Hg(d,"number",d.value)}switch(W=u?su(u):window,t){case"focusin":(m_(W)||W.contentEditable==="true")&&(iu=W,n0=u,ql=null);break;case"focusout":ql=n0=iu=null;break;case"mousedown":i0=!0;break;case"contextmenu":case"mouseup":case"dragend":i0=!1,w_(h,r,c);break;case"selectionchange":if(Ek)break;case"keydown":case"keyup":w_(h,r,c)}var Y;if($0)e:{switch(t){case"compositionstart":var J="onCompositionStart";break e;case"compositionend":J="onCompositionEnd";break e;case"compositionupdate":J="onCompositionUpdate";break e}J=void 0}else nu?R2(t,r)&&(J="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(J="onCompositionStart");J&&(M2&&r.locale!=="ko"&&(nu||J!=="onCompositionStart"?J==="onCompositionEnd"&&nu&&(Y=L2()):(Ks=c,Y0="value"in Ks?Ks.value:Ks.textContent,nu=!0)),W=af(u,J),0<W.length&&(J=new f_(J,t,null,r,c),h.push({event:J,listeners:W}),Y?J.data=Y:(Y=j2(r),Y!==null&&(J.data=Y)))),(Y=pk?gk(t,r):mk(t,r))&&(u=af(u,"onBeforeInput"),0<u.length&&(c=new f_("onBeforeInput","beforeinput",null,r,c),h.push({event:c,listeners:u}),c.data=Y))}H2(h,e)})}function uc(t,e,r){return{instance:t,listener:e,currentTarget:r}}function af(t,e){for(var r=e+"Capture",o=[];t!==null;){var n=t,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=rc(t,r),s!=null&&o.unshift(uc(t,s,n)),s=rc(t,e),s!=null&&o.push(uc(t,s,n))),t=t.return}return o}function Za(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function D_(t,e,r,o,n){for(var s=e._reactName,i=[];r!==null&&r!==o;){var a=r,l=a.alternate,u=a.stateNode;if(l!==null&&l===o)break;a.tag===5&&u!==null&&(a=u,n?(l=rc(r,s),l!=null&&i.unshift(uc(r,l,a))):n||(l=rc(r,s),l!=null&&i.push(uc(r,l,a)))),r=r.return}i.length!==0&&t.push({event:e,listeners:i})}function uf(){}var Fg=null,Og=null;function q2(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function s0(t,e){return t==="textarea"||t==="option"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var E_=typeof setTimeout=="function"?setTimeout:void 0,Ak=typeof clearTimeout=="function"?clearTimeout:void 0;function K0(t){t.nodeType===1?t.textContent="":t.nodeType===9&&(t=t.body,t!=null&&(t.textContent=""))}function fu(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break}return t}function A_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var kg=0;function Tk(t){return{$$typeof:L0,toString:t,valueOf:t}}var Pf=Math.random().toString(36).slice(2),Js="__reactFiber$"+Pf,lf="__reactProps$"+Pf,bu="__reactContainer$"+Pf,T_="__reactEvents$"+Pf;function ta(t){var e=t[Js];if(e)return e;for(var r=t.parentNode;r;){if(e=r[bu]||r[Js]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=A_(t);t!==null;){if(r=t[Js])return r;t=A_(t)}return e}t=r,r=t.parentNode}return null}function gc(t){return t=t[Js]||t[bu],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function su(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Pe(33))}function If(t){return t[lf]||null}function $2(t){var e=t[T_];return e===void 0&&(e=t[T_]=new Set),e}var o0=[],ou=-1;function fo(t){return{current:t}}function jt(t){0>ou||(t.current=o0[ou],o0[ou]=null,ou--)}function Qt(t,e){ou++,o0[ou]=t.current,t.current=e}var lo={},Rr=fo(lo),pn=fo(!1),sa=lo;function Cu(t,e){var r=t.type.contextTypes;if(!r)return lo;var o=t.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===e)return o.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in r)n[s]=e[s];return o&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=n),n}function gn(t){return t=t.childContextTypes,t!=null}function cf(){jt(pn),jt(Rr)}function F_(t,e,r){if(Rr.current!==lo)throw Error(Pe(168));Qt(Rr,e),Qt(pn,r)}function K2(t,e,r){var o=t.stateNode;if(t=e.childContextTypes,typeof o.getChildContext!="function")return r;o=o.getChildContext();for(var n in o)if(!(n in t))throw Error(Pe(108,uu(e)||"Unknown",n));return zt({},r,o)}function $h(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||lo,sa=Rr.current,Qt(Rr,t),Qt(pn,pn.current),!0}function O_(t,e,r){var o=t.stateNode;if(!o)throw Error(Pe(169));r?(t=K2(t,e,sa),o.__reactInternalMemoizedMergedChildContext=t,jt(pn),jt(Rr),Qt(Rr,t)):jt(pn),Qt(pn,r)}var J0=null,ia=null,Fk=gr.unstable_runWithPriority,Q0=gr.unstable_scheduleCallback,a0=gr.unstable_cancelCallback,Ok=gr.unstable_shouldYield,k_=gr.unstable_requestPaint,u0=gr.unstable_now,kk=gr.unstable_getCurrentPriorityLevel,Bf=gr.unstable_ImmediatePriority,J2=gr.unstable_UserBlockingPriority,Q2=gr.unstable_NormalPriority,Z2=gr.unstable_LowPriority,ew=gr.unstable_IdlePriority,Pg={},Pk=k_!==void 0?k_:function(){},fs=null,Kh=null,Ig=!1,P_=u0(),Lr=1e4>P_?u0:function(){return u0()-P_};function _u(){switch(kk()){case Bf:return 99;case J2:return 98;case Q2:return 97;case Z2:return 96;case ew:return 95;default:throw Error(Pe(332))}}function tw(t){switch(t){case 99:return Bf;case 98:return J2;case 97:return Q2;case 96:return Z2;case 95:return ew;default:throw Error(Pe(332))}}function oa(t,e){return t=tw(t),Fk(t,e)}function lc(t,e,r){return t=tw(t),Q0(t,e,r)}function Ri(){if(Kh!==null){var t=Kh;Kh=null,a0(t)}rw()}function rw(){if(!Ig&&fs!==null){Ig=!0;var t=0;try{var e=fs;oa(99,function(){for(;t<e.length;t++){var r=e[t];do r=r(!0);while(r!==null)}}),fs=null}catch(r){throw fs!==null&&(fs=fs.slice(t+1)),Q0(Bf,Ri),r}finally{Ig=!1}}}var Ik=la.ReactCurrentBatchConfig;function mi(t,e){if(t&&t.defaultProps){e=zt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}var hf=fo(null),ff=null,au=null,df=null;function Z0(){df=au=ff=null}function em(t){var e=hf.current;jt(hf),t.type._context._currentValue=e}function nw(t,e){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)===e){if(r===null||(r.childLanes&e)===e)break;r.childLanes|=e}else t.childLanes|=e,r!==null&&(r.childLanes|=e);t=t.return}}function du(t,e){ff=t,df=au=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&e)!==0&&(vi=!0),t.firstContext=null)}function Kn(t,e){if(df!==t&&e!==!1&&e!==0)if((typeof e!="number"||e===1073741823)&&(df=t,e=1073741823),e={context:t,observedBits:e,next:null},au===null){if(ff===null)throw Error(Pe(308));au=e,ff.dependencies={lanes:0,firstContext:e,responders:null}}else au=au.next=e;return t._currentValue}var qs=!1;function tm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function iw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ro(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function no(t,e){if(t=t.updateQueue,t!==null){t=t.shared;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}}function I_(t,e){var r=t.updateQueue,o=t.alternate;if(o!==null&&(o=o.updateQueue,r===o)){var n=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?n=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?n=s=e:s=s.next=e}else n=s=e;r={baseState:o.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:o.shared,effects:o.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function cc(t,e,r,o){var n=t.updateQueue;qs=!1;var s=n.firstBaseUpdate,i=n.lastBaseUpdate,a=n.shared.pending;if(a!==null){n.shared.pending=null;var l=a,u=l.next;l.next=null,i===null?s=u:i.next=u,i=l;var c=t.alternate;if(c!==null){c=c.updateQueue;var h=c.lastBaseUpdate;h!==i&&(h===null?c.firstBaseUpdate=u:h.next=u,c.lastBaseUpdate=l)}}if(s!==null){h=n.baseState,i=0,c=u=l=null;do{a=s.lane;var d=s.eventTime;if((o&a)===a){c!==null&&(c=c.next={eventTime:d,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var g=t,m=s;switch(a=e,d=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){h=g.call(d,h,a);break e}h=g;break e;case 3:g.flags=g.flags&-4097|64;case 0:if(g=m.payload,a=typeof g=="function"?g.call(d,h,a):g,a==null)break e;h=zt({},h,a);break e;case 2:qs=!0}}s.callback!==null&&(t.flags|=32,a=n.effects,a===null?n.effects=[s]:a.push(s))}else d={eventTime:d,lane:a,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(u=c=d,l=h):c=c.next=d,i|=a;if(s=s.next,s===null){if(a=n.shared.pending,a===null)break;s=a.next,a.next=null,n.lastBaseUpdate=a,n.shared.pending=null}}while(!0);c===null&&(l=h),n.baseState=l,n.firstBaseUpdate=u,n.lastBaseUpdate=c,vc|=i,t.lanes=i,t.memoizedState=h}}function B_(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var o=t[e],n=o.callback;if(n!==null){if(o.callback=null,o=r,typeof n!="function")throw Error(Pe(191,n));n.call(o)}}}var sw=new Df.Component().refs;function pf(t,e,r,o){e=t.memoizedState,r=r(o,e),r=r==null?e:zt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Lf={isMounted:function(t){return(t=t._reactInternals)?ca(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var o=On(),n=io(t),s=ro(o,n);s.payload=e,r!=null&&(s.callback=r),no(t,s),so(t,n,o)},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var o=On(),n=io(t),s=ro(o,n);s.tag=1,s.payload=e,r!=null&&(s.callback=r),no(t,s),so(t,n,o)},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=On(),o=io(t),n=ro(r,o);n.tag=2,e!=null&&(n.callback=e),no(t,n),so(t,o,r)}};function L_(t,e,r,o,n,s,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(o,s,i):e.prototype&&e.prototype.isPureReactComponent?!ac(r,o)||!ac(n,s):!0}function ow(t,e,r){var o=!1,n=lo,s=e.contextType;return typeof s=="object"&&s!==null?s=Kn(s):(n=gn(e)?sa:Rr.current,o=e.contextTypes,s=(o=o!=null)?Cu(t,n):lo),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Lf,t.stateNode=e,e._reactInternals=t,o&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=s),e}function M_(t,e,r,o){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,o),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,o),e.state!==t&&Lf.enqueueReplaceState(e,e.state,null)}function l0(t,e,r,o){var n=t.stateNode;n.props=r,n.state=t.memoizedState,n.refs=sw,tm(t);var s=e.contextType;typeof s=="object"&&s!==null?n.context=Kn(s):(s=gn(e)?sa:Rr.current,n.context=Cu(t,s)),cc(t,r,n,o),n.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(pf(t,e,s,r),n.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&Lf.enqueueReplaceState(n,n.state,null),cc(t,r,n,o),n.state=t.memoizedState),typeof n.componentDidMount=="function"&&(t.flags|=4)}var Uh=Array.isArray;function Ol(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Pe(309));var o=r.stateNode}if(!o)throw Error(Pe(147,t));var n=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===n?e.ref:(e=function(s){var i=o.refs;i===sw&&(i=o.refs={}),s===null?delete i[n]:i[n]=s},e._stringRef=n,e)}if(typeof t!="string")throw Error(Pe(284));if(!r._owner)throw Error(Pe(290,t))}return t}function zh(t,e){if(t.type!=="textarea")throw Error(Pe(31,Object.prototype.toString.call(e)==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":e))}function aw(t){function e(C,b){if(t){var k=C.lastEffect;k!==null?(k.nextEffect=b,C.lastEffect=b):C.firstEffect=C.lastEffect=b,b.nextEffect=null,b.flags=8}}function r(C,b){if(!t)return null;for(;b!==null;)e(C,b),b=b.sibling;return null}function o(C,b){for(C=new Map;b!==null;)b.key!==null?C.set(b.key,b):C.set(b.index,b),b=b.sibling;return C}function n(C,b){return C=ho(C,b),C.index=0,C.sibling=null,C}function s(C,b,k){return C.index=k,t?(k=C.alternate,k!==null?(k=k.index,k<b?(C.flags=2,b):k):(C.flags=2,b)):b}function i(C){return t&&C.alternate===null&&(C.flags=2),C}function a(C,b,k,L){return b===null||b.tag!==6?(b=jg(k,C.mode,L),b.return=C,b):(b=n(b,k),b.return=C,b)}function l(C,b,k,L){return b!==null&&b.elementType===k.type?(L=n(b,k.props),L.ref=Ol(C,b,k),L.return=C,L):(L=ef(k.type,k.key,k.props,null,C.mode,L),L.ref=Ol(C,b,k),L.return=C,L)}function u(C,b,k,L){return b===null||b.tag!==4||b.stateNode.containerInfo!==k.containerInfo||b.stateNode.implementation!==k.implementation?(b=Ng(k,C.mode,L),b.return=C,b):(b=n(b,k.children||[]),b.return=C,b)}function c(C,b,k,L,N){return b===null||b.tag!==7?(b=vu(k,C.mode,L,N),b.return=C,b):(b=n(b,k),b.return=C,b)}function h(C,b,k){if(typeof b=="string"||typeof b=="number")return b=jg(""+b,C.mode,k),b.return=C,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Rl:return k=ef(b.type,b.key,b.props,null,C.mode,k),k.ref=Ol(C,null,b),k.return=C,k;case Zo:return b=Ng(b,C.mode,k),b.return=C,b}if(Uh(b)||Dl(b))return b=vu(b,C.mode,k,null),b.return=C,b;zh(C,b)}return null}function d(C,b,k,L){var N=b!==null?b.key:null;if(typeof k=="string"||typeof k=="number")return N!==null?null:a(C,b,""+k,L);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Rl:return k.key===N?k.type===$s?c(C,b,k.props.children,L,N):l(C,b,k,L):null;case Zo:return k.key===N?u(C,b,k,L):null}if(Uh(k)||Dl(k))return N!==null?null:c(C,b,k,L,null);zh(C,k)}return null}function g(C,b,k,L,N){if(typeof L=="string"||typeof L=="number")return C=C.get(k)||null,a(b,C,""+L,N);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case Rl:return C=C.get(L.key===null?k:L.key)||null,L.type===$s?c(b,C,L.props.children,N,L.key):l(b,C,L,N);case Zo:return C=C.get(L.key===null?k:L.key)||null,u(b,C,L,N)}if(Uh(L)||Dl(L))return C=C.get(k)||null,c(b,C,L,N,null);zh(b,L)}return null}function m(C,b,k,L){for(var N=null,M=null,W=b,Y=b=0,J=null;W!==null&&Y<k.length;Y++){W.index>Y?(J=W,W=null):J=W.sibling;var oe=d(C,W,k[Y],L);if(oe===null){W===null&&(W=J);break}t&&W&&oe.alternate===null&&e(C,W),b=s(oe,b,Y),M===null?N=oe:M.sibling=oe,M=oe,W=J}if(Y===k.length)return r(C,W),N;if(W===null){for(;Y<k.length;Y++)W=h(C,k[Y],L),W!==null&&(b=s(W,b,Y),M===null?N=W:M.sibling=W,M=W);return N}for(W=o(C,W);Y<k.length;Y++)J=g(W,C,Y,k[Y],L),J!==null&&(t&&J.alternate!==null&&W.delete(J.key===null?Y:J.key),b=s(J,b,Y),M===null?N=J:M.sibling=J,M=J);return t&&W.forEach(function(pe){return e(C,pe)}),N}function y(C,b,k,L){var N=Dl(k);if(typeof N!="function")throw Error(Pe(150));if(k=N.call(k),k==null)throw Error(Pe(151));for(var M=N=null,W=b,Y=b=0,J=null,oe=k.next();W!==null&&!oe.done;Y++,oe=k.next()){W.index>Y?(J=W,W=null):J=W.sibling;var pe=d(C,W,oe.value,L);if(pe===null){W===null&&(W=J);break}t&&W&&pe.alternate===null&&e(C,W),b=s(pe,b,Y),M===null?N=pe:M.sibling=pe,M=pe,W=J}if(oe.done)return r(C,W),N;if(W===null){for(;!oe.done;Y++,oe=k.next())oe=h(C,oe.value,L),oe!==null&&(b=s(oe,b,Y),M===null?N=oe:M.sibling=oe,M=oe);return N}for(W=o(C,W);!oe.done;Y++,oe=k.next())oe=g(W,C,Y,oe.value,L),oe!==null&&(t&&oe.alternate!==null&&W.delete(oe.key===null?Y:oe.key),b=s(oe,b,Y),M===null?N=oe:M.sibling=oe,M=oe);return t&&W.forEach(function(le){return e(C,le)}),N}return function(C,b,k,L){var N=typeof k=="object"&&k!==null&&k.type===$s&&k.key===null;N&&(k=k.props.children);var M=typeof k=="object"&&k!==null;if(M)switch(k.$$typeof){case Rl:e:{for(M=k.key,N=b;N!==null;){if(N.key===M){switch(N.tag){case 7:if(k.type===$s){r(C,N.sibling),b=n(N,k.props.children),b.return=C,C=b;break e}break;default:if(N.elementType===k.type){r(C,N.sibling),b=n(N,k.props),b.ref=Ol(C,N,k),b.return=C,C=b;break e}}r(C,N);break}else e(C,N);N=N.sibling}k.type===$s?(b=vu(k.props.children,C.mode,L,k.key),b.return=C,C=b):(L=ef(k.type,k.key,k.props,null,C.mode,L),L.ref=Ol(C,b,k),L.return=C,C=L)}return i(C);case Zo:e:{for(N=k.key;b!==null;){if(b.key===N)if(b.tag===4&&b.stateNode.containerInfo===k.containerInfo&&b.stateNode.implementation===k.implementation){r(C,b.sibling),b=n(b,k.children||[]),b.return=C,C=b;break e}else{r(C,b);break}else e(C,b);b=b.sibling}b=Ng(k,C.mode,L),b.return=C,C=b}return i(C)}if(typeof k=="string"||typeof k=="number")return k=""+k,b!==null&&b.tag===6?(r(C,b.sibling),b=n(b,k),b.return=C,C=b):(r(C,b),b=jg(k,C.mode,L),b.return=C,C=b),i(C);if(Uh(k))return m(C,b,k,L);if(Dl(k))return y(C,b,k,L);if(M&&zh(C,k),typeof k>"u"&&!N)switch(C.tag){case 1:case 22:case 0:case 11:case 15:throw Error(Pe(152,uu(C.type)||"Component"))}return r(C,b)}}var gf=aw(!0),uw=aw(!1),mc={},Li=fo(mc),hc=fo(mc),fc=fo(mc);function ra(t){if(t===mc)throw Error(Pe(174));return t}function c0(t,e){switch(Qt(fc,e),Qt(hc,t),Qt(Li,mc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=qg(e,t)}jt(Li),Qt(Li,e)}function wu(){jt(Li),jt(hc),jt(fc)}function R_(t){ra(fc.current);var e=ra(Li.current),r=qg(e,t.type);e!==r&&(Qt(hc,t),Qt(Li,r))}function rm(t){hc.current===t&&(jt(Li),jt(hc))}var Jt=fo(0);function mf(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if((e.flags&64)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ps=null,Qs=null,Mi=!1;function lw(t,e){var r=qn(5,null,null,0);r.elementType="DELETED",r.type="DELETED",r.stateNode=e,r.return=t,r.flags=8,t.lastEffect!==null?(t.lastEffect.nextEffect=r,t.lastEffect=r):t.firstEffect=t.lastEffect=r}function j_(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,!0):!1;case 13:return!1;default:return!1}}function h0(t){if(Mi){var e=Qs;if(e){var r=e;if(!j_(t,e)){if(e=fu(r.nextSibling),!e||!j_(t,e)){t.flags=t.flags&-1025|2,Mi=!1,ps=t;return}lw(ps,r)}ps=t,Qs=fu(e.firstChild)}else t.flags=t.flags&-1025|2,Mi=!1,ps=t}}function N_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ps=t}function Wh(t){if(t!==ps)return!1;if(!Mi)return N_(t),Mi=!0,!1;var e=t.type;if(t.tag!==5||e!=="head"&&e!=="body"&&!s0(e,t.memoizedProps))for(e=Qs;e;)lw(t,e),e=fu(e.nextSibling);if(N_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Pe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Qs=fu(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Qs=null}}else Qs=ps?fu(t.stateNode.nextSibling):null;return!0}function Bg(){Qs=ps=null,Mi=!1}var pu=[];function nm(){for(var t=0;t<pu.length;t++)pu[t]._workInProgressVersionPrimary=null;pu.length=0}var $l=la.ReactCurrentDispatcher,$n=la.ReactCurrentBatchConfig,dc=0,ir=null,Br=null,wr=null,vf=!1,Kl=!1;function fn(){throw Error(Pe(321))}function im(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Vn(t[r],e[r]))return!1;return!0}function sm(t,e,r,o,n,s){if(dc=s,ir=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$l.current=t===null||t.memoizedState===null?Lk:Mk,t=r(o,n),Kl){s=0;do{if(Kl=!1,!(25>s))throw Error(Pe(301));s+=1,wr=Br=null,e.updateQueue=null,$l.current=Rk,t=r(o,n)}while(Kl)}if($l.current=wf,e=Br!==null&&Br.next!==null,dc=0,wr=Br=ir=null,vf=!1,e)throw Error(Pe(300));return t}function na(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wr===null?ir.memoizedState=wr=t:wr=wr.next=t,wr}function ha(){if(Br===null){var t=ir.alternate;t=t!==null?t.memoizedState:null}else t=Br.next;var e=wr===null?ir.memoizedState:wr.next;if(e!==null)wr=e,Br=t;else{if(t===null)throw Error(Pe(310));Br=t,t={memoizedState:Br.memoizedState,baseState:Br.baseState,baseQueue:Br.baseQueue,queue:Br.queue,next:null},wr===null?ir.memoizedState=wr=t:wr=wr.next=t}return wr}function Ii(t,e){return typeof e=="function"?e(t):e}function kl(t){var e=ha(),r=e.queue;if(r===null)throw Error(Pe(311));r.lastRenderedReducer=t;var o=Br,n=o.baseQueue,s=r.pending;if(s!==null){if(n!==null){var i=n.next;n.next=s.next,s.next=i}o.baseQueue=n=s,r.pending=null}if(n!==null){n=n.next,o=o.baseState;var a=i=s=null,l=n;do{var u=l.lane;if((dc&u)===u)a!==null&&(a=a.next={lane:0,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),o=l.eagerReducer===t?l.eagerState:t(o,l.action);else{var c={lane:u,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};a===null?(i=a=c,s=o):a=a.next=c,ir.lanes|=u,vc|=u}l=l.next}while(l!==null&&l!==n);a===null?s=o:a.next=i,Vn(o,e.memoizedState)||(vi=!0),e.memoizedState=o,e.baseState=s,e.baseQueue=a,r.lastRenderedState=o}return[e.memoizedState,r.dispatch]}function Pl(t){var e=ha(),r=e.queue;if(r===null)throw Error(Pe(311));r.lastRenderedReducer=t;var o=r.dispatch,n=r.pending,s=e.memoizedState;if(n!==null){r.pending=null;var i=n=n.next;do s=t(s,i.action),i=i.next;while(i!==n);Vn(s,e.memoizedState)||(vi=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,o]}function U_(t,e,r){var o=e._getVersion;o=o(e._source);var n=e._workInProgressVersionPrimary;if(n!==null?t=n===o:(t=t.mutableReadLanes,(t=(dc&t)===t)&&(e._workInProgressVersionPrimary=o,pu.push(e))),t)return r(e._source);throw pu.push(e),Error(Pe(350))}function cw(t,e,r,o){var n=Jr;if(n===null)throw Error(Pe(349));var s=e._getVersion,i=s(e._source),a=$l.current,l=a.useState(function(){return U_(n,e,r)}),u=l[1],c=l[0];l=wr;var h=t.memoizedState,d=h.refs,g=d.getSnapshot,m=h.source;h=h.subscribe;var y=ir;return t.memoizedState={refs:d,source:e,subscribe:o},a.useEffect(function(){d.getSnapshot=r,d.setSnapshot=u;var C=s(e._source);if(!Vn(i,C)){C=r(e._source),Vn(c,C)||(u(C),C=io(y),n.mutableReadLanes|=C&n.pendingLanes),C=n.mutableReadLanes,n.entangledLanes|=C;for(var b=n.entanglements,k=C;0<k;){var L=31-uo(k),N=1<<L;b[L]|=C,k&=~N}}},[r,e,o]),a.useEffect(function(){return o(e._source,function(){var C=d.getSnapshot,b=d.setSnapshot;try{b(C(e._source));var k=io(y);n.mutableReadLanes|=k&n.pendingLanes}catch(L){b(function(){throw L})}})},[e,o]),Vn(g,r)&&Vn(m,e)&&Vn(h,o)||(t={pending:null,dispatch:null,lastRenderedReducer:Ii,lastRenderedState:c},t.dispatch=u=um.bind(null,ir,t),l.queue=t,l.baseQueue=null,c=U_(n,e,r),l.memoizedState=l.baseState=c),c}function hw(t,e,r){var o=ha();return cw(o,t,e,r)}function Il(t){var e=na();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t=e.queue={pending:null,dispatch:null,lastRenderedReducer:Ii,lastRenderedState:t},t=t.dispatch=um.bind(null,ir,t),[e.memoizedState,t]}function yf(t,e,r,o){return t={tag:t,create:e,destroy:r,deps:o,next:null},e=ir.updateQueue,e===null?(e={lastEffect:null},ir.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(o=r.next,r.next=t,t.next=o,e.lastEffect=t)),t}function z_(t){var e=na();return t={current:t},e.memoizedState=t}function Cf(){return ha().memoizedState}function f0(t,e,r,o){var n=na();ir.flags|=t,n.memoizedState=yf(1|e,r,void 0,o===void 0?null:o)}function om(t,e,r,o){var n=ha();o=o===void 0?null:o;var s=void 0;if(Br!==null){var i=Br.memoizedState;if(s=i.destroy,o!==null&&im(o,i.deps)){yf(e,r,s,o);return}}ir.flags|=t,n.memoizedState=yf(1|e,r,s,o)}function W_(t,e){return f0(516,4,t,e)}function _f(t,e){return om(516,4,t,e)}function fw(t,e){return om(4,2,t,e)}function dw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function pw(t,e,r){return r=r!=null?r.concat([t]):null,om(4,2,dw.bind(null,e,t),r)}function am(){}function gw(t,e){var r=ha();e=e===void 0?null:e;var o=r.memoizedState;return o!==null&&e!==null&&im(e,o[1])?o[0]:(r.memoizedState=[t,e],t)}function mw(t,e){var r=ha();e=e===void 0?null:e;var o=r.memoizedState;return o!==null&&e!==null&&im(e,o[1])?o[0]:(t=t(),r.memoizedState=[t,e],t)}function Bk(t,e){var r=_u();oa(98>r?98:r,function(){t(!0)}),oa(97<r?97:r,function(){var o=$n.transition;$n.transition=1;try{t(!1),e()}finally{$n.transition=o}})}function um(t,e,r){var o=On(),n=io(t),s={lane:n,action:r,eagerReducer:null,eagerState:null,next:null},i=e.pending;if(i===null?s.next=s:(s.next=i.next,i.next=s),e.pending=s,i=t.alternate,t===ir||i!==null&&i===ir)Kl=vf=!0;else{if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,r);if(s.eagerReducer=i,s.eagerState=l,Vn(l,a))return}catch{}finally{}so(t,n,o)}}var wf={readContext:Kn,useCallback:fn,useContext:fn,useEffect:fn,useImperativeHandle:fn,useLayoutEffect:fn,useMemo:fn,useReducer:fn,useRef:fn,useState:fn,useDebugValue:fn,useDeferredValue:fn,useTransition:fn,useMutableSource:fn,useOpaqueIdentifier:fn,unstable_isNewReconciler:!1},Lk={readContext:Kn,useCallback:function(t,e){return na().memoizedState=[t,e===void 0?null:e],t},useContext:Kn,useEffect:W_,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,f0(4,2,dw.bind(null,e,t),r)},useLayoutEffect:function(t,e){return f0(4,2,t,e)},useMemo:function(t,e){var r=na();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var o=na();return e=r!==void 0?r(e):e,o.memoizedState=o.baseState=e,t=o.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},t=t.dispatch=um.bind(null,ir,t),[o.memoizedState,t]},useRef:z_,useState:Il,useDebugValue:am,useDeferredValue:function(t){var e=Il(t),r=e[0],o=e[1];return W_(function(){var n=$n.transition;$n.transition=1;try{o(t)}finally{$n.transition=n}},[t]),r},useTransition:function(){var t=Il(!1),e=t[0];return t=Bk.bind(null,t[1]),z_(t),[t,e]},useMutableSource:function(t,e,r){var o=na();return o.memoizedState={refs:{getSnapshot:e,setSnapshot:null},source:t,subscribe:r},cw(o,t,e,r)},useOpaqueIdentifier:function(){if(Mi){var t=!1,e=Tk(function(){throw t||(t=!0,r("r:"+(kg++).toString(36))),Error(Pe(355))}),r=Il(e)[1];return(ir.mode&2)===0&&(ir.flags|=516,yf(5,function(){r("r:"+(kg++).toString(36))},void 0,null)),e}return e="r:"+(kg++).toString(36),Il(e),e},unstable_isNewReconciler:!1},Mk={readContext:Kn,useCallback:gw,useContext:Kn,useEffect:_f,useImperativeHandle:pw,useLayoutEffect:fw,useMemo:mw,useReducer:kl,useRef:Cf,useState:function(){return kl(Ii)},useDebugValue:am,useDeferredValue:function(t){var e=kl(Ii),r=e[0],o=e[1];return _f(function(){var n=$n.transition;$n.transition=1;try{o(t)}finally{$n.transition=n}},[t]),r},useTransition:function(){var t=kl(Ii)[0];return[Cf().current,t]},useMutableSource:hw,useOpaqueIdentifier:function(){return kl(Ii)[0]},unstable_isNewReconciler:!1},Rk={readContext:Kn,useCallback:gw,useContext:Kn,useEffect:_f,useImperativeHandle:pw,useLayoutEffect:fw,useMemo:mw,useReducer:Pl,useRef:Cf,useState:function(){return Pl(Ii)},useDebugValue:am,useDeferredValue:function(t){var e=Pl(Ii),r=e[0],o=e[1];return _f(function(){var n=$n.transition;$n.transition=1;try{o(t)}finally{$n.transition=n}},[t]),r},useTransition:function(){var t=Pl(Ii)[0];return[Cf().current,t]},useMutableSource:hw,useOpaqueIdentifier:function(){return Pl(Ii)[0]},unstable_isNewReconciler:!1},jk=la.ReactCurrentOwner,vi=!1;function dn(t,e,r,o){e.child=t===null?uw(e,null,r,o):gf(e,t.child,r,o)}function G_(t,e,r,o,n){r=r.render;var s=e.ref;return du(e,n),o=sm(t,e,r,o,s,n),t!==null&&!vi?(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~n,gs(t,e,n)):(e.flags|=1,dn(t,e,o,n),e.child)}function H_(t,e,r,o,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!pm(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,vw(t,e,i,o,n,s)):(t=ef(r.type,null,o,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}return i=t.child,(n&s)===0&&(n=i.memoizedProps,r=r.compare,r=r!==null?r:ac,r(n,o)&&t.ref===e.ref)?gs(t,e,s):(e.flags|=1,t=ho(i,o),t.ref=e.ref,t.return=e,e.child=t)}function vw(t,e,r,o,n,s){if(t!==null&&ac(t.memoizedProps,o)&&t.ref===e.ref)if(vi=!1,(s&n)!==0)(t.flags&16384)!==0&&(vi=!0);else return e.lanes=t.lanes,gs(t,e,s);return d0(t,e,r,o,s)}function Lg(t,e,r){var o=e.pendingProps,n=o.children,s=t!==null?t.memoizedState:null;if(o.mode==="hidden"||o.mode==="unstable-defer-without-hiding")if((e.mode&4)===0)e.memoizedState={baseLanes:0},Hh(e,r);else if((r&1073741824)!==0)e.memoizedState={baseLanes:0},Hh(e,s!==null?s.baseLanes:r);else return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t},Hh(e,t),null;else s!==null?(o=s.baseLanes|r,e.memoizedState=null):o=r,Hh(e,o);return dn(t,e,n,r),e.child}function yw(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=128)}function d0(t,e,r,o,n){var s=gn(r)?sa:Rr.current;return s=Cu(e,s),du(e,n),r=sm(t,e,r,o,s,n),t!==null&&!vi?(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~n,gs(t,e,n)):(e.flags|=1,dn(t,e,r,n),e.child)}function X_(t,e,r,o,n){if(gn(r)){var s=!0;$h(e)}else s=!1;if(du(e,n),e.stateNode===null)t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2),ow(e,r,o),l0(e,r,o,n),o=!0;else if(t===null){var i=e.stateNode,a=e.memoizedProps;i.props=a;var l=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=Kn(u):(u=gn(r)?sa:Rr.current,u=Cu(e,u));var c=r.getDerivedStateFromProps,h=typeof c=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==o||l!==u)&&M_(e,i,o,u),qs=!1;var d=e.memoizedState;i.state=d,cc(e,o,i,n),l=e.memoizedState,a!==o||d!==l||pn.current||qs?(typeof c=="function"&&(pf(e,r,c,o),l=e.memoizedState),(a=qs||L_(e,r,a,o,d,l,u))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4)):(typeof i.componentDidMount=="function"&&(e.flags|=4),e.memoizedProps=o,e.memoizedState=l),i.props=o,i.state=l,i.context=u,o=a):(typeof i.componentDidMount=="function"&&(e.flags|=4),o=!1)}else{i=e.stateNode,iw(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:mi(e.type,a),i.props=u,h=e.pendingProps,d=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Kn(l):(l=gn(r)?sa:Rr.current,l=Cu(e,l));var g=r.getDerivedStateFromProps;(c=typeof g=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==h||d!==l)&&M_(e,i,o,l),qs=!1,d=e.memoizedState,i.state=d,cc(e,o,i,n);var m=e.memoizedState;a!==h||d!==m||pn.current||qs?(typeof g=="function"&&(pf(e,r,g,o),m=e.memoizedState),(u=qs||L_(e,r,u,o,d,m,l))?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(o,m,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(o,m,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=256)):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=256),e.memoizedProps=o,e.memoizedState=m),i.props=o,i.state=m,i.context=l,o=u):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=256),o=!1)}return p0(t,e,r,o,s,n)}function p0(t,e,r,o,n,s){yw(t,e);var i=(e.flags&64)!==0;if(!o&&!i)return n&&O_(e,r,!1),gs(t,e,s);o=e.stateNode,jk.current=e;var a=i&&typeof r.getDerivedStateFromError!="function"?null:o.render();return e.flags|=1,t!==null&&i?(e.child=gf(e,t.child,null,s),e.child=gf(e,null,a,s)):dn(t,e,a,s),e.memoizedState=o.state,n&&O_(e,r,!0),e.child}function Y_(t){var e=t.stateNode;e.pendingContext?F_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&F_(t,e.context,!1),c0(t,e.containerInfo)}var Gh={dehydrated:null,retryLane:0};function V_(t,e,r){var o=e.pendingProps,n=Jt.current,s=!1,i;return(i=(e.flags&64)!==0)||(i=t!==null&&t.memoizedState===null?!1:(n&2)!==0),i?(s=!0,e.flags&=-65):t!==null&&t.memoizedState===null||o.fallback===void 0||o.unstable_avoidThisFallback===!0||(n|=1),Qt(Jt,n&1),t===null?(o.fallback!==void 0&&h0(e),t=o.children,n=o.fallback,s?(t=q_(e,t,n,r),e.child.memoizedState={baseLanes:r},e.memoizedState=Gh,t):typeof o.unstable_expectedLoadTime=="number"?(t=q_(e,t,n,r),e.child.memoizedState={baseLanes:r},e.memoizedState=Gh,e.lanes=33554432,t):(r=gm({mode:"visible",children:t},e.mode,r,null),r.return=e,e.child=r)):t.memoizedState!==null?s?(o=K_(t,e,o.children,o.fallback,r),s=e.child,n=t.child.memoizedState,s.memoizedState=n===null?{baseLanes:r}:{baseLanes:n.baseLanes|r},s.childLanes=t.childLanes&~r,e.memoizedState=Gh,o):(r=$_(t,e,o.children,r),e.memoizedState=null,r):s?(o=K_(t,e,o.children,o.fallback,r),s=e.child,n=t.child.memoizedState,s.memoizedState=n===null?{baseLanes:r}:{baseLanes:n.baseLanes|r},s.childLanes=t.childLanes&~r,e.memoizedState=Gh,o):(r=$_(t,e,o.children,r),e.memoizedState=null,r)}function q_(t,e,r,o){var n=t.mode,s=t.child;return e={mode:"hidden",children:e},(n&2)===0&&s!==null?(s.childLanes=0,s.pendingProps=e):s=gm(e,n,0,null),r=vu(r,n,o,null),s.return=t,r.return=t,s.sibling=r,t.child=s,r}function $_(t,e,r,o){var n=t.child;return t=n.sibling,r=ho(n,{mode:"visible",children:r}),(e.mode&2)===0&&(r.lanes=o),r.return=e,r.sibling=null,t!==null&&(t.nextEffect=null,t.flags=8,e.firstEffect=e.lastEffect=t),e.child=r}function K_(t,e,r,o,n){var s=e.mode,i=t.child;t=i.sibling;var a={mode:"hidden",children:r};return(s&2)===0&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,i=r.lastEffect,i!==null?(e.firstEffect=r.firstEffect,e.lastEffect=i,i.nextEffect=null):e.firstEffect=e.lastEffect=null):r=ho(i,a),t!==null?o=ho(t,o):(o=vu(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,o}function J_(t,e){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),nw(t.return,e)}function Mg(t,e,r,o,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:o,tail:r,tailMode:n,lastEffect:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=o,i.tail=r,i.tailMode=n,i.lastEffect=s)}function Q_(t,e,r){var o=e.pendingProps,n=o.revealOrder,s=o.tail;if(dn(t,e,o.children,r),o=Jt.current,(o&2)!==0)o=o&1|2,e.flags|=64;else{if(t!==null&&(t.flags&64)!==0)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&J_(t,r);else if(t.tag===19)J_(t,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}o&=1}if(Qt(Jt,o),(e.mode&2)===0)e.memoizedState=null;else switch(n){case"forwards":for(r=e.child,n=null;r!==null;)t=r.alternate,t!==null&&mf(t)===null&&(n=r),r=r.sibling;r=n,r===null?(n=e.child,e.child=null):(n=r.sibling,r.sibling=null),Mg(e,!1,n,r,s,e.lastEffect);break;case"backwards":for(r=null,n=e.child,e.child=null;n!==null;){if(t=n.alternate,t!==null&&mf(t)===null){e.child=n;break}t=n.sibling,n.sibling=r,r=n,n=t}Mg(e,!0,r,null,s,e.lastEffect);break;case"together":Mg(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function gs(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),vc|=e.lanes,(r&e.childLanes)!==0){if(t!==null&&e.child!==t.child)throw Error(Pe(153));if(e.child!==null){for(t=e.child,r=ho(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=ho(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}return null}var Cw,g0,_w,ww;Cw=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};g0=function(){};_w=function(t,e,r,o){var n=t.memoizedProps;if(n!==o){t=e.stateNode,ra(Li.current);var s=null;switch(r){case"input":n=Wg(t,n),o=Wg(t,o),s=[];break;case"option":n=Xg(t,n),o=Xg(t,o),s=[];break;case"select":n=zt({},n,{value:void 0}),o=zt({},o,{value:void 0}),s=[];break;case"textarea":n=Yg(t,n),o=Yg(t,o),s=[];break;default:typeof n.onClick!="function"&&typeof o.onClick=="function"&&(t.onclick=uf)}$g(r,o);var i;r=null;for(u in n)if(!o.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var a=n[u];for(i in a)a.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ec.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in o){var l=o[u];if(a=n?.[u],o.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ec.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Rt("scroll",t),s||a===l||(s=[])):typeof l=="object"&&l!==null&&l.$$typeof===L0?l.toString():(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};ww=function(t,e,r,o){r!==o&&(e.flags|=4)};function Bl(t,e){if(!Mi)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:o.sibling=null}}function Nk(t,e,r){var o=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return gn(e.type)&&cf(),null;case 3:return wu(),jt(pn),jt(Rr),nm(),o=e.stateNode,o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(t===null||t.child===null)&&(Wh(e)?e.flags|=4:o.hydrate||(e.flags|=256)),g0(e),null;case 5:rm(e);var n=ra(fc.current);if(r=e.type,t!==null&&e.stateNode!=null)_w(t,e,r,o,n),t.ref!==e.ref&&(e.flags|=128);else{if(!o){if(e.stateNode===null)throw Error(Pe(166));return null}if(t=ra(Li.current),Wh(e)){o=e.stateNode,r=e.type;var s=e.memoizedProps;switch(o[Js]=e,o[lf]=s,r){case"dialog":Rt("cancel",o),Rt("close",o);break;case"iframe":case"object":case"embed":Rt("load",o);break;case"video":case"audio":for(t=0;t<Nl.length;t++)Rt(Nl[t],o);break;case"source":Rt("error",o);break;case"img":case"image":case"link":Rt("error",o),Rt("load",o);break;case"details":Rt("toggle",o);break;case"input":e_(o,s),Rt("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!s.multiple},Rt("invalid",o);break;case"textarea":r_(o,s),Rt("invalid",o)}$g(r,s),t=null;for(var i in s)s.hasOwnProperty(i)&&(n=s[i],i==="children"?typeof n=="string"?o.textContent!==n&&(t=["children",n]):typeof n=="number"&&o.textContent!==""+n&&(t=["children",""+n]):ec.hasOwnProperty(i)&&n!=null&&i==="onScroll"&&Rt("scroll",o));switch(r){case"input":Ih(o),t_(o,s,!0);break;case"textarea":Ih(o),n_(o);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(o.onclick=uf)}o=t,e.updateQueue=o,o!==null&&(e.flags|=4)}else{switch(i=n.nodeType===9?n:n.ownerDocument,t===Vg.html&&(t=p2(r)),t===Vg.html?r==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof o.is=="string"?t=i.createElement(r,{is:o.is}):(t=i.createElement(r),r==="select"&&(i=t,o.multiple?i.multiple=!0:o.size&&(i.size=o.size))):t=i.createElementNS(t,r),t[Js]=e,t[lf]=o,Cw(t,e,!1,!1),e.stateNode=t,i=Kg(r,o),r){case"dialog":Rt("cancel",t),Rt("close",t),n=o;break;case"iframe":case"object":case"embed":Rt("load",t),n=o;break;case"video":case"audio":for(n=0;n<Nl.length;n++)Rt(Nl[n],t);n=o;break;case"source":Rt("error",t),n=o;break;case"img":case"image":case"link":Rt("error",t),Rt("load",t),n=o;break;case"details":Rt("toggle",t),n=o;break;case"input":e_(t,o),n=Wg(t,o),Rt("invalid",t);break;case"option":n=Xg(t,o);break;case"select":t._wrapperState={wasMultiple:!!o.multiple},n=zt({},o,{value:void 0}),Rt("invalid",t);break;case"textarea":r_(t,o),n=Yg(t,o),Rt("invalid",t);break;default:n=o}$g(r,n);var a=n;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?v2(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&g2(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&tc(t,l):typeof l=="number"&&tc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ec.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Rt("scroll",t):l!=null&&F0(t,s,l,i))}switch(r){case"input":Ih(t),t_(t,o,!1);break;case"textarea":Ih(t),n_(t);break;case"option":o.value!=null&&t.setAttribute("value",""+ao(o.value));break;case"select":t.multiple=!!o.multiple,s=o.value,s!=null?lu(t,!!o.multiple,s,!1):o.defaultValue!=null&&lu(t,!!o.multiple,o.defaultValue,!0);break;default:typeof n.onClick=="function"&&(t.onclick=uf)}q2(r,o)&&(e.flags|=4)}e.ref!==null&&(e.flags|=128)}return null;case 6:if(t&&e.stateNode!=null)ww(t,e,t.memoizedProps,o);else{if(typeof o!="string"&&e.stateNode===null)throw Error(Pe(166));r=ra(fc.current),ra(Li.current),Wh(e)?(o=e.stateNode,r=e.memoizedProps,o[Js]=e,o.nodeValue!==r&&(e.flags|=4)):(o=(r.nodeType===9?r:r.ownerDocument).createTextNode(o),o[Js]=e,e.stateNode=o)}return null;case 13:return jt(Jt),o=e.memoizedState,(e.flags&64)!==0?(e.lanes=r,e):(o=o!==null,r=!1,t===null?e.memoizedProps.fallback!==void 0&&Wh(e):r=t.memoizedState!==null,o&&!r&&(e.mode&2)!==0&&(t===null&&e.memoizedProps.unstable_avoidThisFallback!==!0||(Jt.current&1)!==0?Sr===0&&(Sr=3):((Sr===0||Sr===3)&&(Sr=4),Jr===null||(vc&134217727)===0&&(Du&134217727)===0||gu(Jr,Mr))),(o||r)&&(e.flags|=4),null);case 4:return wu(),g0(e),t===null&&X2(e.stateNode.containerInfo),null;case 10:return em(e),null;case 17:return gn(e.type)&&cf(),null;case 19:if(jt(Jt),o=e.memoizedState,o===null)return null;if(s=(e.flags&64)!==0,i=o.rendering,i===null)if(s)Bl(o,!1);else{if(Sr!==0||t!==null&&(t.flags&64)!==0)for(t=e.child;t!==null;){if(i=mf(t),i!==null){for(e.flags|=64,Bl(o,!1),s=i.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),o.lastEffect===null&&(e.firstEffect=null),e.lastEffect=o.lastEffect,o=r,r=e.child;r!==null;)s=r,t=o,s.flags&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,i=s.alternate,i===null?(s.childLanes=0,s.lanes=t,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,t=i.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Qt(Jt,Jt.current&1|2),e.child}t=t.sibling}o.tail!==null&&Lr()>w0&&(e.flags|=64,s=!0,Bl(o,!1),e.lanes=33554432)}else{if(!s)if(t=mf(i),t!==null){if(e.flags|=64,s=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Bl(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!Mi)return e=e.lastEffect=o.lastEffect,e!==null&&(e.nextEffect=null),null}else 2*Lr()-o.renderingStartTime>w0&&r!==1073741824&&(e.flags|=64,s=!0,Bl(o,!1),e.lanes=33554432);o.isBackwards?(i.sibling=e.child,e.child=i):(r=o.last,r!==null?r.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(r=o.tail,o.rendering=r,o.tail=r.sibling,o.lastEffect=e.lastEffect,o.renderingStartTime=Lr(),r.sibling=null,e=Jt.current,Qt(Jt,s?e&1|2:e&1),r):null;case 23:case 24:return dm(),t!==null&&t.memoizedState!==null!=(e.memoizedState!==null)&&o.mode!=="unstable-defer-without-hiding"&&(e.flags|=4),null}throw Error(Pe(156,e.tag))}function Uk(t){switch(t.tag){case 1:gn(t.type)&&cf();var e=t.flags;return e&4096?(t.flags=e&-4097|64,t):null;case 3:if(wu(),jt(pn),jt(Rr),nm(),e=t.flags,(e&64)!==0)throw Error(Pe(285));return t.flags=e&-4097|64,t;case 5:return rm(t),null;case 13:return jt(Jt),e=t.flags,e&4096?(t.flags=e&-4097|64,t):null;case 19:return jt(Jt),null;case 4:return wu(),null;case 10:return em(t),null;case 23:case 24:return dm(),null;default:return null}}function lm(t,e){try{var r="",o=e;do r+=_3(o),o=o.return;while(o);var n=r}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:n}}function m0(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var zk=typeof WeakMap=="function"?WeakMap:Map;function Sw(t,e,r){r=ro(-1,r),r.tag=3,r.payload={element:null};var o=e.value;return r.callback=function(){bf||(bf=!0,S0=o),m0(t,e)},r}function bw(t,e,r){r=ro(-1,r),r.tag=3;var o=t.type.getDerivedStateFromError;if(typeof o=="function"){var n=e.value;r.payload=function(){return m0(t,e),o(n)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){typeof o!="function"&&(Bi===null?Bi=new Set([this]):Bi.add(this),m0(t,e));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),r}var Wk=typeof WeakSet=="function"?WeakSet:Set;function Z_(t){var e=t.ref;if(e!==null)if(typeof e=="function")try{e(null)}catch(r){oo(t,r)}else e.current=null}function Gk(t,e){switch(e.tag){case 0:case 11:case 15:case 22:return;case 1:if(e.flags&256&&t!==null){var r=t.memoizedProps,o=t.memoizedState;t=e.stateNode,e=t.getSnapshotBeforeUpdate(e.elementType===e.type?r:mi(e.type,r),o),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:e.flags&256&&K0(e.stateNode.containerInfo);return;case 5:case 6:case 4:case 17:return}throw Error(Pe(163))}function Hk(t,e,r){switch(r.tag){case 0:case 11:case 15:case 22:if(e=r.updateQueue,e=e!==null?e.lastEffect:null,e!==null){t=e=e.next;do{if((t.tag&3)===3){var o=t.create;t.destroy=o()}t=t.next}while(t!==e)}if(e=r.updateQueue,e=e!==null?e.lastEffect:null,e!==null){t=e=e.next;do{var n=t;o=n.next,n=n.tag,(n&4)!==0&&(n&1)!==0&&(Pw(r,t),Qk(r,t)),t=o}while(t!==e)}return;case 1:t=r.stateNode,r.flags&4&&(e===null?t.componentDidMount():(o=r.elementType===r.type?e.memoizedProps:mi(r.type,e.memoizedProps),t.componentDidUpdate(o,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate))),e=r.updateQueue,e!==null&&B_(r,e,t);return;case 3:if(e=r.updateQueue,e!==null){if(t=null,r.child!==null)switch(r.child.tag){case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}B_(r,e,t)}return;case 5:t=r.stateNode,e===null&&r.flags&4&&q2(r.type,r.memoizedProps)&&t.focus();return;case 6:return;case 4:return;case 12:return;case 13:r.memoizedState===null&&(r=r.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&A2(r))));return;case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(Pe(163))}function e2(t,e){for(var r=t;;){if(r.tag===5){var o=r.stateNode;if(e)o=o.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none";else{o=r.stateNode;var n=r.memoizedProps.style;n=n!=null&&n.hasOwnProperty("display")?n.display:null,o.style.display=m2("display",n)}}else if(r.tag===6)r.stateNode.nodeValue=e?"":r.memoizedProps;else if((r.tag!==23&&r.tag!==24||r.memoizedState===null||r===t)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}}function t2(t,e){if(ia&&typeof ia.onCommitFiberUnmount=="function")try{ia.onCommitFiberUnmount(J0,e)}catch{}switch(e.tag){case 0:case 11:case 14:case 15:case 22:if(t=e.updateQueue,t!==null&&(t=t.lastEffect,t!==null)){var r=t=t.next;do{var o=r,n=o.destroy;if(o=o.tag,n!==void 0)if((o&4)!==0)Pw(e,r);else{o=e;try{n()}catch(s){oo(o,s)}}r=r.next}while(r!==t)}break;case 1:if(Z_(e),t=e.stateNode,typeof t.componentWillUnmount=="function")try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(s){oo(e,s)}break;case 5:Z_(e);break;case 4:xw(t,e)}}function r2(t){t.alternate=null,t.child=null,t.dependencies=null,t.firstEffect=null,t.lastEffect=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.return=null,t.updateQueue=null}function n2(t){return t.tag===5||t.tag===3||t.tag===4}function i2(t){e:{for(var e=t.return;e!==null;){if(n2(e))break e;e=e.return}throw Error(Pe(160))}var r=e;switch(e=r.stateNode,r.tag){case 5:var o=!1;break;case 3:e=e.containerInfo,o=!0;break;case 4:e=e.containerInfo,o=!0;break;default:throw Error(Pe(161))}r.flags&16&&(tc(e,""),r.flags&=-17);e:t:for(r=t;;){for(;r.sibling===null;){if(r.return===null||n2(r.return)){r=null;break e}r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue t;r.child.return=r,r=r.child}if(!(r.flags&2)){r=r.stateNode;break e}}o?v0(t,r,e):y0(t,r,e)}function v0(t,e,r){var o=t.tag,n=o===5||o===6;if(n)t=n?t.stateNode:t.stateNode.instance,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=uf));else if(o!==4&&(t=t.child,t!==null))for(v0(t,e,r),t=t.sibling;t!==null;)v0(t,e,r),t=t.sibling}function y0(t,e,r){var o=t.tag,n=o===5||o===6;if(n)t=n?t.stateNode:t.stateNode.instance,e?r.insertBefore(t,e):r.appendChild(t);else if(o!==4&&(t=t.child,t!==null))for(y0(t,e,r),t=t.sibling;t!==null;)y0(t,e,r),t=t.sibling}function xw(t,e){for(var r=e,o=!1,n,s;;){if(!o){o=r.return;e:for(;;){if(o===null)throw Error(Pe(160));switch(n=o.stateNode,o.tag){case 5:s=!1;break e;case 3:n=n.containerInfo,s=!0;break e;case 4:n=n.containerInfo,s=!0;break e}o=o.return}o=!0}if(r.tag===5||r.tag===6){e:for(var i=t,a=r,l=a;;)if(t2(i,l),l.child!==null&&l.tag!==4)l.child.return=l,l=l.child;else{if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}s?(i=n,a=r.stateNode,i.nodeType===8?i.parentNode.removeChild(a):i.removeChild(a)):n.removeChild(r.stateNode)}else if(r.tag===4){if(r.child!==null){n=r.stateNode.containerInfo,s=!0,r.child.return=r,r=r.child;continue}}else if(t2(t,r),r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return,r.tag===4&&(o=!1)}r.sibling.return=r.return,r=r.sibling}}function Rg(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do(o.tag&3)===3&&(t=o.destroy,o.destroy=void 0,t!==void 0&&t()),o=o.next;while(o!==r)}return;case 1:return;case 5:if(r=e.stateNode,r!=null){o=e.memoizedProps;var n=t!==null?t.memoizedProps:o;t=e.type;var s=e.updateQueue;if(e.updateQueue=null,s!==null){for(r[lf]=o,t==="input"&&o.type==="radio"&&o.name!=null&&f2(r,o),Kg(t,n),e=Kg(t,o),n=0;n<s.length;n+=2){var i=s[n],a=s[n+1];i==="style"?v2(r,a):i==="dangerouslySetInnerHTML"?g2(r,a):i==="children"?tc(r,a):F0(r,i,a,e)}switch(t){case"input":Gg(r,o);break;case"textarea":d2(r,o);break;case"select":t=r._wrapperState.wasMultiple,r._wrapperState.wasMultiple=!!o.multiple,s=o.value,s!=null?lu(r,!!o.multiple,s,!1):t!==!!o.multiple&&(o.defaultValue!=null?lu(r,!!o.multiple,o.defaultValue,!0):lu(r,!!o.multiple,o.multiple?[]:"",!1))}}}return;case 6:if(e.stateNode===null)throw Error(Pe(162));e.stateNode.nodeValue=e.memoizedProps;return;case 3:r=e.stateNode,r.hydrate&&(r.hydrate=!1,A2(r.containerInfo));return;case 12:return;case 13:e.memoizedState!==null&&(fm=Lr(),e2(e.child,!0)),s2(e);return;case 19:s2(e);return;case 17:return;case 23:case 24:e2(e,e.memoizedState!==null);return}throw Error(Pe(163))}function s2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Wk),e.forEach(function(o){var n=tP.bind(null,t,o);r.has(o)||(r.add(o),o.then(n,n))})}}function Xk(t,e){return t!==null&&(t=t.memoizedState,t===null||t.dehydrated!==null)?(e=e.memoizedState,e!==null&&e.dehydrated===null):!1}var Yk=Math.ceil,Sf=la.ReactCurrentDispatcher,cm=la.ReactCurrentOwner,rt=0,Jr=null,fr=null,Mr=0,aa=0,C0=fo(0),Sr=0,Mf=null,xu=0,vc=0,Du=0,hm=0,_0=null,fm=0,w0=1/0;function Eu(){w0=Lr()+500}var ze=null,bf=!1,S0=null,Bi=null,co=!1,Jl=null,Ul=90,b0=[],x0=[],ms=null,Ql=0,D0=null,Jh=-1,ds=0,Qh=0,Zl=null,Zh=!1;function On(){return(rt&48)!==0?Lr():Jh!==-1?Jh:Jh=Lr()}function io(t){if(t=t.mode,(t&2)===0)return 1;if((t&4)===0)return _u()===99?1:2;if(ds===0&&(ds=xu),Ik.transition!==0){Qh!==0&&(Qh=_0!==null?_0.pendingLanes:0),t=ds;var e=4186112&~Qh;return e&=-e,e===0&&(t=4186112&~t,e=t&-t,e===0&&(e=8192)),e}return t=_u(),(rt&4)!==0&&t===98?t=of(12,ds):(t=M3(t),t=of(t,ds)),t}function so(t,e,r){if(50<Ql)throw Ql=0,D0=null,Error(Pe(185));if(t=Rf(t,e),t===null)return null;Ff(t,e,r),t===Jr&&(Du|=e,Sr===4&&gu(t,Mr));var o=_u();e===1?(rt&8)!==0&&(rt&48)===0?E0(t):(Jn(t,r),rt===0&&(Eu(),Ri())):((rt&4)===0||o!==98&&o!==99||(ms===null?ms=new Set([t]):ms.add(t)),Jn(t,r)),_0=t}function Rf(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}function Jn(t,e){for(var r=t.callbackNode,o=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-uo(i),l=1<<a,u=s[a];if(u===-1){if((l&o)===0||(l&n)!==0){u=e,eu(l);var c=Bt;s[a]=10<=c?u+250:6<=c?u+5e3:-1}}else u<=e&&(t.expiredLanes|=l);i&=~l}if(o=sc(t,t===Jr?Mr:0),e=Bt,o===0)r!==null&&(r!==Pg&&a0(r),t.callbackNode=null,t.callbackPriority=0);else{if(r!==null){if(t.callbackPriority===e)return;r!==Pg&&a0(r)}e===15?(r=E0.bind(null,t),fs===null?(fs=[r],Kh=Q0(Bf,rw)):fs.push(r),r=Pg):e===14?r=lc(99,E0.bind(null,t)):(r=R3(e),r=lc(r,Dw.bind(null,t))),t.callbackPriority=e,t.callbackNode=r}}function Dw(t){if(Jh=-1,Qh=ds=0,(rt&48)!==0)throw Error(Pe(327));var e=t.callbackNode;if(po()&&t.callbackNode!==e)return null;var r=sc(t,t===Jr?Mr:0);if(r===0)return null;var o=r,n=rt;rt|=16;var s=Fw();(Jr!==t||Mr!==o)&&(Eu(),mu(t,o));do try{$k();break}catch(a){Tw(t,a)}while(!0);if(Z0(),Sf.current=s,rt=n,fr!==null?o=0:(Jr=null,Mr=0,o=Sr),(xu&Du)!==0)mu(t,0);else if(o!==0){if(o===2&&(rt|=64,t.hydrate&&(t.hydrate=!1,K0(t.containerInfo)),r=B2(t),r!==0&&(o=zl(t,r))),o===1)throw e=Mf,mu(t,0),gu(t,r),Jn(t,Lr()),e;switch(t.finishedWork=t.current.alternate,t.finishedLanes=r,o){case 0:case 1:throw Error(Pe(345));case 2:Qo(t);break;case 3:if(gu(t,r),(r&62914560)===r&&(o=fm+500-Lr(),10<o)){if(sc(t,0)!==0)break;if(n=t.suspendedLanes,(n&r)!==r){On(),t.pingedLanes|=t.suspendedLanes&n;break}t.timeoutHandle=E_(Qo.bind(null,t),o);break}Qo(t);break;case 4:if(gu(t,r),(r&4186112)===r)break;for(o=t.eventTimes,n=-1;0<r;){var i=31-uo(r);s=1<<i,i=o[i],i>n&&(n=i),r&=~s}if(r=n,r=Lr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Yk(r/1960))-r,10<r){t.timeoutHandle=E_(Qo.bind(null,t),r);break}Qo(t);break;case 5:Qo(t);break;default:throw Error(Pe(329))}}return Jn(t,Lr()),t.callbackNode===e?Dw.bind(null,t):null}function gu(t,e){for(e&=~hm,e&=~Du,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-uo(e),o=1<<r;t[r]=-1,e&=~o}}function E0(t){if((rt&48)!==0)throw Error(Pe(327));if(po(),t===Jr&&(t.expiredLanes&Mr)!==0){var e=Mr,r=zl(t,e);(xu&Du)!==0&&(e=sc(t,e),r=zl(t,e))}else e=sc(t,0),r=zl(t,e);if(t.tag!==0&&r===2&&(rt|=64,t.hydrate&&(t.hydrate=!1,K0(t.containerInfo)),e=B2(t),e!==0&&(r=zl(t,e))),r===1)throw r=Mf,mu(t,0),gu(t,e),Jn(t,Lr()),r;return t.finishedWork=t.current.alternate,t.finishedLanes=e,Qo(t),Jn(t,Lr()),null}function Vk(){if(ms!==null){var t=ms;ms=null,t.forEach(function(e){e.expiredLanes|=24&e.pendingLanes,Jn(e,Lr())})}Ri()}function Ew(t,e){var r=rt;rt|=1;try{return t(e)}finally{rt=r,rt===0&&(Eu(),Ri())}}function Aw(t,e){var r=rt;rt&=-2,rt|=8;try{return t(e)}finally{rt=r,rt===0&&(Eu(),Ri())}}function Hh(t,e){Qt(C0,aa),aa|=e,xu|=e}function dm(){aa=C0.current,jt(C0)}function mu(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Ak(r)),fr!==null)for(r=fr.return;r!==null;){var o=r;switch(o.tag){case 1:o=o.type.childContextTypes,o!=null&&cf();break;case 3:wu(),jt(pn),jt(Rr),nm();break;case 5:rm(o);break;case 4:wu();break;case 13:jt(Jt);break;case 19:jt(Jt);break;case 10:em(o);break;case 23:case 24:dm()}r=r.return}Jr=t,fr=ho(t.current,null),Mr=aa=xu=e,Sr=0,Mf=null,hm=Du=vc=0}function Tw(t,e){do{var r=fr;try{if(Z0(),$l.current=wf,vf){for(var o=ir.memoizedState;o!==null;){var n=o.queue;n!==null&&(n.pending=null),o=o.next}vf=!1}if(dc=0,wr=Br=ir=null,Kl=!1,cm.current=null,r===null||r.return===null){Sr=1,Mf=e,fr=null;break}e:{var s=t,i=r.return,a=r,l=e;if(e=Mr,a.flags|=2048,a.firstEffect=a.lastEffect=null,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l;if((a.mode&2)===0){var c=a.alternate;c?(a.updateQueue=c.updateQueue,a.memoizedState=c.memoizedState,a.lanes=c.lanes):(a.updateQueue=null,a.memoizedState=null)}var h=(Jt.current&1)!==0,d=i;do{var g;if(g=d.tag===13){var m=d.memoizedState;if(m!==null)g=m.dehydrated!==null;else{var y=d.memoizedProps;g=y.fallback===void 0?!1:y.unstable_avoidThisFallback!==!0?!0:!h}}if(g){var C=d.updateQueue;if(C===null){var b=new Set;b.add(u),d.updateQueue=b}else C.add(u);if((d.mode&2)===0){if(d.flags|=64,a.flags|=16384,a.flags&=-2981,a.tag===1)if(a.alternate===null)a.tag=17;else{var k=ro(-1,1);k.tag=2,no(a,k)}a.lanes|=1;break e}l=void 0,a=e;var L=s.pingCache;if(L===null?(L=s.pingCache=new zk,l=new Set,L.set(u,l)):(l=L.get(u),l===void 0&&(l=new Set,L.set(u,l))),!l.has(a)){l.add(a);var N=eP.bind(null,s,u,a);u.then(N,N)}d.flags|=4096,d.lanes=e;break e}d=d.return}while(d!==null);l=Error((uu(a.type)||"A React component")+` suspended while rendering, but no fallback UI was specified.

Add a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.`)}Sr!==5&&(Sr=2),l=lm(l,a),d=i;do{switch(d.tag){case 3:s=l,d.flags|=4096,e&=-e,d.lanes|=e;var M=Sw(d,s,e);I_(d,M);break e;case 1:s=l;var W=d.type,Y=d.stateNode;if((d.flags&64)===0&&(typeof W.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(Bi===null||!Bi.has(Y)))){d.flags|=4096,e&=-e,d.lanes|=e;var J=bw(d,s,e);I_(d,J);break e}}d=d.return}while(d!==null)}kw(r)}catch(oe){e=oe,fr===r&&r!==null&&(fr=r=r.return);continue}break}while(!0)}function Fw(){var t=Sf.current;return Sf.current=wf,t===null?wf:t}function zl(t,e){var r=rt;rt|=16;var o=Fw();Jr===t&&Mr===e||mu(t,e);do try{qk();break}catch(n){Tw(t,n)}while(!0);if(Z0(),rt=r,Sf.current=o,fr!==null)throw Error(Pe(261));return Jr=null,Mr=0,Sr}function qk(){for(;fr!==null;)Ow(fr)}function $k(){for(;fr!==null&&!Ok();)Ow(fr)}function Ow(t){var e=Iw(t.alternate,t,aa);t.memoizedProps=t.pendingProps,e===null?kw(t):fr=e,cm.current=null}function kw(t){var e=t;do{var r=e.alternate;if(t=e.return,(e.flags&2048)===0){if(r=Nk(r,e,aa),r!==null){fr=r;return}if(r=e,r.tag!==24&&r.tag!==23||r.memoizedState===null||(aa&1073741824)!==0||(r.mode&4)===0){for(var o=0,n=r.child;n!==null;)o|=n.lanes|n.childLanes,n=n.sibling;r.childLanes=o}t!==null&&(t.flags&2048)===0&&(t.firstEffect===null&&(t.firstEffect=e.firstEffect),e.lastEffect!==null&&(t.lastEffect!==null&&(t.lastEffect.nextEffect=e.firstEffect),t.lastEffect=e.lastEffect),1<e.flags&&(t.lastEffect!==null?t.lastEffect.nextEffect=e:t.firstEffect=e,t.lastEffect=e))}else{if(r=Uk(e),r!==null){r.flags&=2047,fr=r;return}t!==null&&(t.firstEffect=t.lastEffect=null,t.flags|=2048)}if(e=e.sibling,e!==null){fr=e;return}fr=e=t}while(e!==null);Sr===0&&(Sr=5)}function Qo(t){var e=_u();return oa(99,Kk.bind(null,t,e)),null}function Kk(t,e){do po();while(Jl!==null);if((rt&48)!==0)throw Error(Pe(327));var r=t.finishedWork;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Pe(177));t.callbackNode=null;var o=r.lanes|r.childLanes,n=o,s=t.pendingLanes&~n;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=n,t.mutableReadLanes&=n,t.entangledLanes&=n,n=t.entanglements;for(var i=t.eventTimes,a=t.expirationTimes;0<s;){var l=31-uo(s),u=1<<l;n[l]=0,i[l]=-1,a[l]=-1,s&=~u}if(ms!==null&&(o&24)===0&&ms.has(t)&&ms.delete(t),t===Jr&&(fr=Jr=null,Mr=0),1<r.flags?r.lastEffect!==null?(r.lastEffect.nextEffect=r,o=r.firstEffect):o=r:o=r.firstEffect,o!==null){if(n=rt,rt|=32,cm.current=null,Fg=Yh,i=__(),r0(i)){if("selectionStart"in i)a={start:i.selectionStart,end:i.selectionEnd};else e:if(a=(a=i.ownerDocument)&&a.defaultView||window,(u=a.getSelection&&a.getSelection())&&u.rangeCount!==0){a=u.anchorNode,s=u.anchorOffset,l=u.focusNode,u=u.focusOffset;try{a.nodeType,l.nodeType}catch{a=null;break e}var c=0,h=-1,d=-1,g=0,m=0,y=i,C=null;t:for(;;){for(var b;y!==a||s!==0&&y.nodeType!==3||(h=c+s),y!==l||u!==0&&y.nodeType!==3||(d=c+u),y.nodeType===3&&(c+=y.nodeValue.length),(b=y.firstChild)!==null;)C=y,y=b;for(;;){if(y===i)break t;if(C===a&&++g===s&&(h=c),C===l&&++m===u&&(d=c),(b=y.nextSibling)!==null)break;y=C,C=y.parentNode}y=b}a=h===-1||d===-1?null:{start:h,end:d}}else a=null;a=a||{start:0,end:0}}else a=null;Og={focusedElem:i,selectionRange:a},Yh=!1,Zl=null,Zh=!1,ze=o;do try{Jk()}catch(oe){if(ze===null)throw Error(Pe(330));oo(ze,oe),ze=ze.nextEffect}while(ze!==null);Zl=null,ze=o;do try{for(i=t;ze!==null;){var k=ze.flags;if(k&16&&tc(ze.stateNode,""),k&128){var L=ze.alternate;if(L!==null){var N=L.ref;N!==null&&(typeof N=="function"?N(null):N.current=null)}}switch(k&1038){case 2:i2(ze),ze.flags&=-3;break;case 6:i2(ze),ze.flags&=-3,Rg(ze.alternate,ze);break;case 1024:ze.flags&=-1025;break;case 1028:ze.flags&=-1025,Rg(ze.alternate,ze);break;case 4:Rg(ze.alternate,ze);break;case 8:a=ze,xw(i,a);var M=a.alternate;r2(a),M!==null&&r2(M)}ze=ze.nextEffect}}catch(oe){if(ze===null)throw Error(Pe(330));oo(ze,oe),ze=ze.nextEffect}while(ze!==null);if(N=Og,L=__(),k=N.focusedElem,i=N.selectionRange,L!==k&&k&&k.ownerDocument&&W2(k.ownerDocument.documentElement,k)){for(i!==null&&r0(k)&&(L=i.start,N=i.end,N===void 0&&(N=L),"selectionStart"in k?(k.selectionStart=L,k.selectionEnd=Math.min(N,k.value.length)):(N=(L=k.ownerDocument||document)&&L.defaultView||window,N.getSelection&&(N=N.getSelection(),a=k.textContent.length,M=Math.min(i.start,a),i=i.end===void 0?M:Math.min(i.end,a),!N.extend&&M>i&&(a=i,i=M,M=a),a=C_(k,M),s=C_(k,i),a&&s&&(N.rangeCount!==1||N.anchorNode!==a.node||N.anchorOffset!==a.offset||N.focusNode!==s.node||N.focusOffset!==s.offset)&&(L=L.createRange(),L.setStart(a.node,a.offset),N.removeAllRanges(),M>i?(N.addRange(L),N.extend(s.node,s.offset)):(L.setEnd(s.node,s.offset),N.addRange(L)))))),L=[],N=k;N=N.parentNode;)N.nodeType===1&&L.push({element:N,left:N.scrollLeft,top:N.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<L.length;k++)N=L[k],N.element.scrollLeft=N.left,N.element.scrollTop=N.top}Yh=!!Fg,Og=Fg=null,t.current=r,ze=o;do try{for(k=t;ze!==null;){var W=ze.flags;if(W&36&&Hk(k,ze.alternate,ze),W&128){L=void 0;var Y=ze.ref;if(Y!==null){var J=ze.stateNode;switch(ze.tag){case 5:L=J;break;default:L=J}typeof Y=="function"?Y(L):Y.current=L}}ze=ze.nextEffect}}catch(oe){if(ze===null)throw Error(Pe(330));oo(ze,oe),ze=ze.nextEffect}while(ze!==null);ze=null,Pk(),rt=n}else t.current=r;if(co)co=!1,Jl=t,Ul=e;else for(ze=o;ze!==null;)e=ze.nextEffect,ze.nextEffect=null,ze.flags&8&&(W=ze,W.sibling=null,W.stateNode=null),ze=e;if(o=t.pendingLanes,o===0&&(Bi=null),o===1?t===D0?Ql++:(Ql=0,D0=t):Ql=0,r=r.stateNode,ia&&typeof ia.onCommitFiberRoot=="function")try{ia.onCommitFiberRoot(J0,r,void 0,(r.current.flags&64)===64)}catch{}if(Jn(t,Lr()),bf)throw bf=!1,t=S0,S0=null,t;return(rt&8)!==0||Ri(),null}function Jk(){for(;ze!==null;){var t=ze.alternate;Zh||Zl===null||((ze.flags&8)!==0?o_(ze,Zl)&&(Zh=!0):ze.tag===13&&Xk(t,ze)&&o_(ze,Zl)&&(Zh=!0));var e=ze.flags;(e&256)!==0&&Gk(t,ze),(e&512)===0||co||(co=!0,lc(97,function(){return po(),null})),ze=ze.nextEffect}}function po(){if(Ul!==90){var t=97<Ul?97:Ul;return Ul=90,oa(t,Zk)}return!1}function Qk(t,e){b0.push(e,t),co||(co=!0,lc(97,function(){return po(),null}))}function Pw(t,e){x0.push(e,t),co||(co=!0,lc(97,function(){return po(),null}))}function Zk(){if(Jl===null)return!1;var t=Jl;if(Jl=null,(rt&48)!==0)throw Error(Pe(331));var e=rt;rt|=32;var r=x0;x0=[];for(var o=0;o<r.length;o+=2){var n=r[o],s=r[o+1],i=n.destroy;if(n.destroy=void 0,typeof i=="function")try{i()}catch(l){if(s===null)throw Error(Pe(330));oo(s,l)}}for(r=b0,b0=[],o=0;o<r.length;o+=2){n=r[o],s=r[o+1];try{var a=n.create;n.destroy=a()}catch(l){if(s===null)throw Error(Pe(330));oo(s,l)}}for(a=t.current.firstEffect;a!==null;)t=a.nextEffect,a.nextEffect=null,a.flags&8&&(a.sibling=null,a.stateNode=null),a=t;return rt=e,Ri(),!0}function o2(t,e,r){e=lm(r,e),e=Sw(t,e,1),no(t,e),e=On(),t=Rf(t,1),t!==null&&(Ff(t,1,e),Jn(t,e))}function oo(t,e){if(t.tag===3)o2(t,t,e);else for(var r=t.return;r!==null;){if(r.tag===3){o2(r,t,e);break}else if(r.tag===1){var o=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Bi===null||!Bi.has(o))){t=lm(e,t);var n=bw(r,t,1);if(no(r,n),n=On(),r=Rf(r,1),r!==null)Ff(r,1,n),Jn(r,n);else if(typeof o.componentDidCatch=="function"&&(Bi===null||!Bi.has(o)))try{o.componentDidCatch(e,t)}catch{}break}}r=r.return}}function eP(t,e,r){var o=t.pingCache;o!==null&&o.delete(e),e=On(),t.pingedLanes|=t.suspendedLanes&r,Jr===t&&(Mr&r)===r&&(Sr===4||Sr===3&&(Mr&62914560)===Mr&&500>Lr()-fm?mu(t,0):hm|=r),Jn(t,e)}function tP(t,e){var r=t.stateNode;r!==null&&r.delete(e),e=0,e===0&&(e=t.mode,(e&2)===0?e=1:(e&4)===0?e=_u()===99?1:2:(ds===0&&(ds=xu),e=tu(62914560&~ds),e===0&&(e=4194304))),r=On(),t=Rf(t,e),t!==null&&(Ff(t,e,r),Jn(t,r))}var Iw;Iw=function(t,e,r){var o=e.lanes;if(t!==null)if(t.memoizedProps!==e.pendingProps||pn.current)vi=!0;else if((r&o)!==0)vi=(t.flags&16384)!==0;else{switch(vi=!1,e.tag){case 3:Y_(e),Bg();break;case 5:R_(e);break;case 1:gn(e.type)&&$h(e);break;case 4:c0(e,e.stateNode.containerInfo);break;case 10:o=e.memoizedProps.value;var n=e.type._context;Qt(hf,n._currentValue),n._currentValue=o;break;case 13:if(e.memoizedState!==null)return(r&e.child.childLanes)!==0?V_(t,e,r):(Qt(Jt,Jt.current&1),e=gs(t,e,r),e!==null?e.sibling:null);Qt(Jt,Jt.current&1);break;case 19:if(o=(r&e.childLanes)!==0,(t.flags&64)!==0){if(o)return Q_(t,e,r);e.flags|=64}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Qt(Jt,Jt.current),o)break;return null;case 23:case 24:return e.lanes=0,Lg(t,e,r)}return gs(t,e,r)}else vi=!1;switch(e.lanes=0,e.tag){case 2:if(o=e.type,t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,n=Cu(e,Rr.current),du(e,r),n=sm(null,e,o,t,n,r),e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,gn(o)){var s=!0;$h(e)}else s=!1;e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,tm(e);var i=o.getDerivedStateFromProps;typeof i=="function"&&pf(e,o,i,t),n.updater=Lf,e.stateNode=n,n._reactInternals=e,l0(e,o,t,r),e=p0(null,e,o,!0,s,r)}else e.tag=0,dn(null,e,n,r),e=e.child;return e;case 16:n=e.elementType;e:{switch(t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=nP(n),t=mi(n,t),s){case 0:e=d0(null,e,n,t,r);break e;case 1:e=X_(null,e,n,t,r);break e;case 11:e=G_(null,e,n,t,r);break e;case 14:e=H_(null,e,n,mi(n.type,t),o,r);break e}throw Error(Pe(306,n,""))}return e;case 0:return o=e.type,n=e.pendingProps,n=e.elementType===o?n:mi(o,n),d0(t,e,o,n,r);case 1:return o=e.type,n=e.pendingProps,n=e.elementType===o?n:mi(o,n),X_(t,e,o,n,r);case 3:if(Y_(e),o=e.updateQueue,t===null||o===null)throw Error(Pe(282));if(o=e.pendingProps,n=e.memoizedState,n=n!==null?n.element:null,iw(t,e),cc(e,o,null,r),o=e.memoizedState.element,o===n)Bg(),e=gs(t,e,r);else{if(n=e.stateNode,(s=n.hydrate)&&(Qs=fu(e.stateNode.containerInfo.firstChild),ps=e,s=Mi=!0),s){if(t=n.mutableSourceEagerHydrationData,t!=null)for(n=0;n<t.length;n+=2)s=t[n],s._workInProgressVersionPrimary=t[n+1],pu.push(s);for(r=uw(e,null,o,r),e.child=r;r;)r.flags=r.flags&-3|1024,r=r.sibling}else dn(t,e,o,r),Bg();e=e.child}return e;case 5:return R_(e),t===null&&h0(e),o=e.type,n=e.pendingProps,s=t!==null?t.memoizedProps:null,i=n.children,s0(o,n)?i=null:s!==null&&s0(o,s)&&(e.flags|=16),yw(t,e),dn(t,e,i,r),e.child;case 6:return t===null&&h0(e),null;case 13:return V_(t,e,r);case 4:return c0(e,e.stateNode.containerInfo),o=e.pendingProps,t===null?e.child=gf(e,null,o,r):dn(t,e,o,r),e.child;case 11:return o=e.type,n=e.pendingProps,n=e.elementType===o?n:mi(o,n),G_(t,e,o,n,r);case 7:return dn(t,e,e.pendingProps,r),e.child;case 8:return dn(t,e,e.pendingProps.children,r),e.child;case 12:return dn(t,e,e.pendingProps.children,r),e.child;case 10:e:{o=e.type._context,n=e.pendingProps,i=e.memoizedProps,s=n.value;var a=e.type._context;if(Qt(hf,a._currentValue),a._currentValue=s,i!==null)if(a=i.value,s=Vn(a,s)?0:(typeof o._calculateChangedBits=="function"?o._calculateChangedBits(a,s):1073741823)|0,s===0){if(i.children===n.children&&!pn.current){e=gs(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){i=a.child;for(var u=l.firstContext;u!==null;){if(u.context===o&&(u.observedBits&s)!==0){a.tag===1&&(u=ro(-1,r&-r),u.tag=2,no(a,u)),a.lanes|=r,u=a.alternate,u!==null&&(u.lanes|=r),nw(a.return,r),l.lanes|=r;break}u=u.next}}else i=a.tag===10&&a.type===e.type?null:a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===e){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}dn(t,e,n.children,r),e=e.child}return e;case 9:return n=e.type,s=e.pendingProps,o=s.children,du(e,r),n=Kn(n,s.unstable_observedBits),o=o(n),e.flags|=1,dn(t,e,o,r),e.child;case 14:return n=e.type,s=mi(n,e.pendingProps),s=mi(n.type,s),H_(t,e,n,s,o,r);case 15:return vw(t,e,e.type,e.pendingProps,o,r);case 17:return o=e.type,n=e.pendingProps,n=e.elementType===o?n:mi(o,n),t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2),e.tag=1,gn(o)?(t=!0,$h(e)):t=!1,du(e,r),ow(e,o,n),l0(e,o,n,r),p0(null,e,o,!0,t,r);case 19:return Q_(t,e,r);case 23:return Lg(t,e,r);case 24:return Lg(t,e,r)}throw Error(Pe(156,e.tag))};function rP(t,e,r,o){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function qn(t,e,r,o){return new rP(t,e,r,o)}function pm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function nP(t){if(typeof t=="function")return pm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ef)return 11;if(t===Af)return 14}return 2}function ho(t,e){var r=t.alternate;return r===null?(r=qn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null),r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function ef(t,e,r,o,n,s){var i=2;if(o=t,typeof t=="function")pm(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case $s:return vu(r.children,n,s,e);case l2:i=8,n|=16;break;case O0:i=8,n|=1;break;case Wl:return t=qn(12,r,e,n|8),t.elementType=Wl,t.type=Wl,t.lanes=s,t;case Gl:return t=qn(13,r,e,n),t.type=Gl,t.elementType=Gl,t.lanes=s,t;case tf:return t=qn(19,r,e,n),t.elementType=tf,t.lanes=s,t;case M0:return gm(r,n,s,e);case zg:return t=qn(24,r,e,n),t.elementType=zg,t.lanes=s,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case k0:i=10;break e;case P0:i=9;break e;case Ef:i=11;break e;case Af:i=14;break e;case I0:i=16,o=null;break e;case B0:i=22;break e}throw Error(Pe(130,t==null?t:typeof t,""))}return e=qn(i,r,e,n),e.elementType=t,e.type=o,e.lanes=s,e}function vu(t,e,r,o){return t=qn(7,t,o,e),t.lanes=r,t}function gm(t,e,r,o){return t=qn(23,t,o,e),t.elementType=M0,t.lanes=r,t}function jg(t,e,r){return t=qn(6,t,null,e),t.lanes=r,t}function Ng(t,e,r){return e=qn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function iP(t,e,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=r,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=bg(0),this.expirationTimes=bg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bg(0),this.mutableSourceEagerHydrationData=null}function sP(t,e,r){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zo,key:o==null?null:""+o,children:t,containerInfo:e,implementation:r}}function xf(t,e,r,o){var n=e.current,s=On(),i=io(n);e:if(r){r=r._reactInternals;t:{if(ca(r)!==r||r.tag!==1)throw Error(Pe(170));var a=r;do{switch(a.tag){case 3:a=a.stateNode.context;break t;case 1:if(gn(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break t}}a=a.return}while(a!==null);throw Error(Pe(171))}if(r.tag===1){var l=r.type;if(gn(l)){r=K2(r,l,a);break e}}r=a}else r=lo;return e.context===null?e.context=r:e.pendingContext=r,e=ro(s,i),e.payload={element:t},o=o===void 0?null:o,o!==null&&(e.callback=o),no(n,e),so(n,i,s),i}function Ug(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function a2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function mm(t,e){a2(t,e),(t=t.alternate)&&a2(t,e)}function oP(){return null}function vm(t,e,r){var o=r!=null&&r.hydrationOptions!=null&&r.hydrationOptions.mutableSources||null;if(r=new iP(t,e,r!=null&&r.hydrate===!0),e=qn(3,null,null,e===2?7:e===1?3:0),r.current=e,e.stateNode=r,tm(e),t[bu]=r.current,X2(t.nodeType===8?t.parentNode:t),o)for(t=0;t<o.length;t++){e=o[t];var n=e._getVersion;n=n(e._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[e,n]:r.mutableSourceEagerHydrationData.push(e,n)}this._internalRoot=r}vm.prototype.render=function(t){xf(t,this._internalRoot,null,null)};vm.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;xf(null,t,null,function(){e[bu]=null})};function yc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function aP(t,e){if(e||(e=t?t.nodeType===9?t.documentElement:t.firstChild:null,e=!(!e||e.nodeType!==1||!e.hasAttribute("data-reactroot"))),!e)for(var r;r=t.lastChild;)t.removeChild(r);return new vm(t,0,e?{hydrate:!0}:void 0)}function jf(t,e,r,o,n){var s=r._reactRootContainer;if(s){var i=s._internalRoot;if(typeof n=="function"){var a=n;n=function(){var u=Ug(i);a.call(u)}}xf(e,i,t,n)}else{if(s=r._reactRootContainer=aP(r,o),i=s._internalRoot,typeof n=="function"){var l=n;n=function(){var u=Ug(i);l.call(u)}}Aw(function(){xf(e,i,t,n)})}return Ug(i)}x2=function(t){if(t.tag===13){var e=On();so(t,4,e),mm(t,4)}};z0=function(t){if(t.tag===13){var e=On();so(t,67108864,e),mm(t,67108864)}};D2=function(t){if(t.tag===13){var e=On(),r=io(t);so(t,r,e),mm(t,r)}};E2=function(t,e){return e()};Jg=function(t,e,r){switch(e){case"input":if(Gg(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var o=r[e];if(o!==t&&o.form===t.form){var n=If(o);if(!n)throw Error(Pe(90));h2(o),Gg(o,n)}}}break;case"textarea":d2(t,r);break;case"select":e=r.value,e!=null&&lu(t,!!r.multiple,e,!1)}};j0=Ew;_2=function(t,e,r,o,n){var s=rt;rt|=4;try{return oa(98,t.bind(null,e,r,o,n))}finally{rt=s,rt===0&&(Eu(),Ri())}};N0=function(){(rt&49)===0&&(Vk(),po())};w2=function(t,e){var r=rt;rt|=2;try{return t(e)}finally{rt=r,rt===0&&(Eu(),Ri())}};function Bw(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!yc(e))throw Error(Pe(200));return sP(t,e,null,r)}var uP={Events:[gc,su,If,y2,C2,po,{current:!1}]},Ll={findFiberByHostInstance:ta,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},lP={bundleType:Ll.bundleType,version:Ll.version,rendererPackageName:Ll.rendererPackageName,rendererConfig:Ll.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:la.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=b2(t),t===null?null:t.stateNode},findFiberByHostInstance:Ll.findFiberByHostInstance||oP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&(Ml=__REACT_DEVTOOLS_GLOBAL_HOOK__,!Ml.isDisabled&&Ml.supportsFiber))try{J0=Ml.inject(lP),ia=Ml}catch{}var Ml;Qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uP;Qn.createPortal=Bw;Qn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Pe(188)):Error(Pe(268,Object.keys(t)));return t=b2(e),t=t===null?null:t.stateNode,t};Qn.flushSync=function(t,e){var r=rt;if((r&48)!==0)return t(e);rt|=1;try{if(t)return oa(99,t.bind(null,e))}finally{rt=r,Ri()}};Qn.hydrate=function(t,e,r){if(!yc(e))throw Error(Pe(200));return jf(null,t,e,!0,r)};Qn.render=function(t,e,r){if(!yc(e))throw Error(Pe(200));return jf(null,t,e,!1,r)};Qn.unmountComponentAtNode=function(t){if(!yc(t))throw Error(Pe(40));return t._reactRootContainer?(Aw(function(){jf(null,null,t,!1,function(){t._reactRootContainer=null,t[bu]=null})}),!0):!1};Qn.unstable_batchedUpdates=Ew;Qn.unstable_createPortal=function(t,e){return Bw(t,e,2<arguments.length&&arguments[2]!==void 0?arguments[2]:null)};Qn.unstable_renderSubtreeIntoContainer=function(t,e,r,o){if(!yc(r))throw Error(Pe(200));if(t==null||t._reactInternals===void 0)throw Error(Pe(38));return jf(t,e,r,!1,o)};Qn.version="17.0.2"});var jw=tt((z4,Rw)=>{"use strict";function Mw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Mw)}catch(t){console.error(t)}}Mw(),Rw.exports=Lw()});var Nw=tt((Zn,yi)=>{(function(t,e){typeof Zn=="object"&&typeof yi=="object"?yi.exports=e():typeof define=="function"&&define.amd?define([],e):typeof Zn=="object"?Zn.LSPluginEntry=e():t.LSPluginEntry=e()})(self,()=>(()=>{var t={227:(n,s,i)=>{var a=i(155);s.formatArgs=function(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;let c="color: "+this.color;u.splice(1,0,c,"color: inherit");let h=0,d=0;u[0].replace(/%[a-zA-Z%]/g,g=>{g!=="%%"&&(h++,g==="%c"&&(d=h))}),u.splice(d,0,c)},s.save=function(u){try{u?s.storage.setItem("debug",u):s.storage.removeItem("debug")}catch{}},s.load=function(){let u;try{u=s.storage.getItem("debug")}catch{}return!u&&a!==void 0&&"env"in a&&(u=a.env.DEBUG),u},s.useColors=function(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},s.storage=function(){try{return localStorage}catch{}}(),s.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),s.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],s.log=console.debug||console.log||(()=>{}),n.exports=i(447)(s);let{formatters:l}=n.exports;l.j=function(u){try{return JSON.stringify(u)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}},447:(n,s,i)=>{n.exports=function(a){function l(h){let d,g,m,y=null;function C(...b){if(!C.enabled)return;let k=C,L=Number(new Date),N=L-(d||L);k.diff=N,k.prev=d,k.curr=L,d=L,b[0]=l.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let M=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(W,Y)=>{if(W==="%%")return"%";M++;let J=l.formatters[Y];if(typeof J=="function"){let oe=b[M];W=J.call(k,oe),b.splice(M,1),M--}return W}),l.formatArgs.call(k,b),(k.log||l.log).apply(k,b)}return C.namespace=h,C.useColors=l.useColors(),C.color=l.selectColor(h),C.extend=u,C.destroy=l.destroy,Object.defineProperty(C,"enabled",{enumerable:!0,configurable:!1,get:()=>y!==null?y:(g!==l.namespaces&&(g=l.namespaces,m=l.enabled(h)),m),set:b=>{y=b}}),typeof l.init=="function"&&l.init(C),C}function u(h,d){let g=l(this.namespace+(d===void 0?":":d)+h);return g.log=this.log,g}function c(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}return l.debug=l,l.default=l,l.coerce=function(h){return h instanceof Error?h.stack||h.message:h},l.disable=function(){let h=[...l.names.map(c),...l.skips.map(c).map(d=>"-"+d)].join(",");return l.enable(""),h},l.enable=function(h){let d;l.save(h),l.namespaces=h,l.names=[],l.skips=[];let g=(typeof h=="string"?h:"").split(/[\s,]+/),m=g.length;for(d=0;d<m;d++)g[d]&&((h=g[d].replace(/\*/g,".*?"))[0]==="-"?l.skips.push(new RegExp("^"+h.slice(1)+"$")):l.names.push(new RegExp("^"+h+"$")))},l.enabled=function(h){if(h[h.length-1]==="*")return!0;let d,g;for(d=0,g=l.skips.length;d<g;d++)if(l.skips[d].test(h))return!1;for(d=0,g=l.names.length;d<g;d++)if(l.names[d].test(h))return!0;return!1},l.humanize=i(824),l.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(a).forEach(h=>{l[h]=a[h]}),l.names=[],l.skips=[],l.formatters={},l.selectColor=function(h){let d=0;for(let g=0;g<h.length;g++)d=(d<<5)-d+h.charCodeAt(g),d|=0;return l.colors[Math.abs(d)%l.colors.length]},l.enable(l.load()),l}},996:n=>{"use strict";var s=function(m){return function(y){return!!y&&typeof y=="object"}(m)&&!function(y){var C=Object.prototype.toString.call(y);return C==="[object RegExp]"||C==="[object Date]"||function(b){return b.$$typeof===i}(y)}(m)},i=typeof Symbol=="function"&&Symbol.for?Symbol.for("react.element"):60103;function a(m,y){return y.clone!==!1&&y.isMergeableObject(m)?d((C=m,Array.isArray(C)?[]:{}),m,y):m;var C}function l(m,y,C){return m.concat(y).map(function(b){return a(b,C)})}function u(m){return Object.keys(m).concat(function(y){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(y).filter(function(C){return Object.propertyIsEnumerable.call(y,C)}):[]}(m))}function c(m,y){try{return y in m}catch{return!1}}function h(m,y,C){var b={};return C.isMergeableObject(m)&&u(m).forEach(function(k){b[k]=a(m[k],C)}),u(y).forEach(function(k){(function(L,N){return c(L,N)&&!(Object.hasOwnProperty.call(L,N)&&Object.propertyIsEnumerable.call(L,N))})(m,k)||(c(m,k)&&C.isMergeableObject(y[k])?b[k]=function(L,N){if(!N.customMerge)return d;var M=N.customMerge(L);return typeof M=="function"?M:d}(k,C)(m[k],y[k],C):b[k]=a(y[k],C))}),b}function d(m,y,C){(C=C||{}).arrayMerge=C.arrayMerge||l,C.isMergeableObject=C.isMergeableObject||s,C.cloneUnlessOtherwiseSpecified=a;var b=Array.isArray(y);return b===Array.isArray(m)?b?C.arrayMerge(m,y,C):h(m,y,C):a(y,C)}d.all=function(m,y){if(!Array.isArray(m))throw new Error("first argument should be an array");return m.reduce(function(C,b){return d(C,b,y)},{})};var g=d;n.exports=g},856:function(n){n.exports=function(){"use strict";function s(ke){return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ne){return typeof Ne}:function(Ne){return Ne&&typeof Symbol=="function"&&Ne.constructor===Symbol&&Ne!==Symbol.prototype?"symbol":typeof Ne},s(ke)}function i(ke,Ne){return i=Object.setPrototypeOf||function(Xe,ct){return Xe.__proto__=ct,Xe},i(ke,Ne)}function a(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function l(ke,Ne,Xe){return l=a()?Reflect.construct:function(ct,Nt,ar){var er=[null];er.push.apply(er,Nt);var Ni=new(Function.bind.apply(ct,er));return ar&&i(Ni,ar.prototype),Ni},l.apply(null,arguments)}function u(ke){return c(ke)||h(ke)||d(ke)||m()}function c(ke){if(Array.isArray(ke))return g(ke)}function h(ke){if(typeof Symbol<"u"&&ke[Symbol.iterator]!=null||ke["@@iterator"]!=null)return Array.from(ke)}function d(ke,Ne){if(ke){if(typeof ke=="string")return g(ke,Ne);var Xe=Object.prototype.toString.call(ke).slice(8,-1);return Xe==="Object"&&ke.constructor&&(Xe=ke.constructor.name),Xe==="Map"||Xe==="Set"?Array.from(ke):Xe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Xe)?g(ke,Ne):void 0}}function g(ke,Ne){(Ne==null||Ne>ke.length)&&(Ne=ke.length);for(var Xe=0,ct=new Array(Ne);Xe<Ne;Xe++)ct[Xe]=ke[Xe];return ct}function m(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var y=Object.hasOwnProperty,C=Object.setPrototypeOf,b=Object.isFrozen,k=Object.getPrototypeOf,L=Object.getOwnPropertyDescriptor,N=Object.freeze,M=Object.seal,W=Object.create,Y=typeof Reflect<"u"&&Reflect,J=Y.apply,oe=Y.construct;J||(J=function(ke,Ne,Xe){return ke.apply(Ne,Xe)}),N||(N=function(ke){return ke}),M||(M=function(ke){return ke}),oe||(oe=function(ke,Ne){return l(ke,u(Ne))});var pe=z(Array.prototype.forEach),le=z(Array.prototype.pop),w=z(Array.prototype.push),F=z(String.prototype.toLowerCase),P=z(String.prototype.toString),I=z(String.prototype.match),H=z(String.prototype.replace),S=z(String.prototype.indexOf),_=z(String.prototype.trim),O=z(RegExp.prototype.test),j=X(TypeError);function V(ke){return typeof ke=="number"&&isNaN(ke)}function z(ke){return function(Ne){for(var Xe=arguments.length,ct=new Array(Xe>1?Xe-1:0),Nt=1;Nt<Xe;Nt++)ct[Nt-1]=arguments[Nt];return J(ke,Ne,ct)}}function X(ke){return function(){for(var Ne=arguments.length,Xe=new Array(Ne),ct=0;ct<Ne;ct++)Xe[ct]=arguments[ct];return oe(ke,Xe)}}function q(ke,Ne,Xe){var ct;Xe=(ct=Xe)!==null&&ct!==void 0?ct:F,C&&C(ke,null);for(var Nt=Ne.length;Nt--;){var ar=Ne[Nt];if(typeof ar=="string"){var er=Xe(ar);er!==ar&&(b(Ne)||(Ne[Nt]=er),ar=er)}ke[ar]=!0}return ke}function ae(ke){var Ne,Xe=W(null);for(Ne in ke)J(y,ke,[Ne])===!0&&(Xe[Ne]=ke[Ne]);return Xe}function $(ke,Ne){for(;ke!==null;){var Xe=L(ke,Ne);if(Xe){if(Xe.get)return z(Xe.get);if(typeof Xe.value=="function")return z(Xe.value)}ke=k(ke)}function ct(Nt){return console.warn("fallback value for",Nt),null}return ct}var U=N(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),te=N(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ee=N(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Q=N(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ne=N(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),ce=N(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ee=N(["#text"]),we=N(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),re=N(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ye=N(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Te=N(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Be=M(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ue=M(/<%[\w\W]*|[\w\W]*%>/gm),Me=M(/\${[\w\W]*}/gm),at=M(/^data-[\-\w.\u00B7-\uFFFF]/),Qe=M(/^aria-[\-\w]+$/),Lt=M(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Zt=M(/^(?:\w+script|data):/i),wt=M(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Zr=M(/^html$/i),vn=M(/^[a-z][.\w]*(-[.\w]+)+$/i),Pn=function(){return typeof window>"u"?null:window},Dr=function(ke,Ne){if(s(ke)!=="object"||typeof ke.createPolicy!="function")return null;var Xe=null,ct="data-tt-policy-suffix";Ne.currentScript&&Ne.currentScript.hasAttribute(ct)&&(Xe=Ne.currentScript.getAttribute(ct));var Nt="dompurify"+(Xe?"#"+Xe:"");try{return ke.createPolicy(Nt,{createHTML:function(ar){return ar},createScriptURL:function(ar){return ar}})}catch{return console.warn("TrustedTypes policy "+Nt+" could not be created."),null}};function Ci(){var ke=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pn(),Ne=function(se){return Ci(se)};if(Ne.version="2.5.4",Ne.removed=[],!ke||!ke.document||ke.document.nodeType!==9)return Ne.isSupported=!1,Ne;var Xe=ke.document,ct=ke.document,Nt=ke.DocumentFragment,ar=ke.HTMLTemplateElement,er=ke.Node,Ni=ke.Element,_i=ke.NodeFilter,mo=ke.NamedNodeMap,Fu=mo===void 0?ke.NamedNodeMap||ke.MozNamedAttrMap:mo,Ou=ke.HTMLFormElement,ku=ke.DOMParser,Cs=ke.trustedTypes,Ui=Ni.prototype,ei=$(Ui,"cloneNode"),da=$(Ui,"nextSibling"),Pu=$(Ui,"childNodes"),ti=$(Ui,"parentNode");if(typeof ar=="function"){var vo=ct.createElement("template");vo.content&&vo.content.ownerDocument&&(ct=vo.content.ownerDocument)}var Yt=Dr(Cs,Xe),_s=Yt?Yt.createHTML(""):"",zi=ct,yo=zi.implementation,Iu=zi.createNodeIterator,pa=zi.createDocumentFragment,Bu=zi.getElementsByTagName,ga=Xe.importNode,Co={};try{Co=ae(ct).documentMode?ct.documentMode:{}}catch{}var Er={};Ne.isSupported=typeof ti=="function"&&yo&&yo.createHTMLDocument!==void 0&&Co!==9;var In,Vt,ws=Be,Wi=Ue,St=Me,Lu=at,Ss=Qe,ma=Zt,yn=wt,_o=vn,bs=Lt,Wt=null,xs=q({},[].concat(u(U),u(te),u(ee),u(ne),u(Ee))),Gt=null,wo=q({},[].concat(u(we),u(re),u(ye),u(Te))),Mt=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Gi=null,So=null,va=!0,Ds=!0,bo=!1,Hi=!0,Bn=!1,xo=!0,Cn=!1,_n=!1,Es=!1,wi=!1,Xi=!1,Yi=!1,As=!0,ri=!1,Vi="user-content-",qi=!0,ni=!1,jr={},ii=null,si=q({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Si=null,Do=q({},["audio","video","img","source","image","track"]),Ts=null,Eo=q({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),$i="http://www.w3.org/1998/Math/MathML",Fs="http://www.w3.org/2000/svg",wn="http://www.w3.org/1999/xhtml",bi=wn,Ln=!1,Os=null,Mu=q({},[$i,Fs,wn],P),Ru=["application/xhtml+xml","text/html"],ks="text/html",Mn=null,ya=255,ju=ct.createElement("form"),Ca=function(se){return se instanceof RegExp||se instanceof Function},Rn=function(se){Mn&&Mn===se||(se&&s(se)==="object"||(se={}),se=ae(se),In=In=Ru.indexOf(se.PARSER_MEDIA_TYPE)===-1?ks:se.PARSER_MEDIA_TYPE,Vt=In==="application/xhtml+xml"?P:F,Wt="ALLOWED_TAGS"in se?q({},se.ALLOWED_TAGS,Vt):xs,Gt="ALLOWED_ATTR"in se?q({},se.ALLOWED_ATTR,Vt):wo,Os="ALLOWED_NAMESPACES"in se?q({},se.ALLOWED_NAMESPACES,P):Mu,Ts="ADD_URI_SAFE_ATTR"in se?q(ae(Eo),se.ADD_URI_SAFE_ATTR,Vt):Eo,Si="ADD_DATA_URI_TAGS"in se?q(ae(Do),se.ADD_DATA_URI_TAGS,Vt):Do,ii="FORBID_CONTENTS"in se?q({},se.FORBID_CONTENTS,Vt):si,Gi="FORBID_TAGS"in se?q({},se.FORBID_TAGS,Vt):{},So="FORBID_ATTR"in se?q({},se.FORBID_ATTR,Vt):{},jr="USE_PROFILES"in se&&se.USE_PROFILES,va=se.ALLOW_ARIA_ATTR!==!1,Ds=se.ALLOW_DATA_ATTR!==!1,bo=se.ALLOW_UNKNOWN_PROTOCOLS||!1,Hi=se.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Bn=se.SAFE_FOR_TEMPLATES||!1,xo=se.SAFE_FOR_XML!==!1,Cn=se.WHOLE_DOCUMENT||!1,wi=se.RETURN_DOM||!1,Xi=se.RETURN_DOM_FRAGMENT||!1,Yi=se.RETURN_TRUSTED_TYPE||!1,Es=se.FORCE_BODY||!1,As=se.SANITIZE_DOM!==!1,ri=se.SANITIZE_NAMED_PROPS||!1,qi=se.KEEP_CONTENT!==!1,ni=se.IN_PLACE||!1,bs=se.ALLOWED_URI_REGEXP||bs,bi=se.NAMESPACE||wn,Mt=se.CUSTOM_ELEMENT_HANDLING||{},se.CUSTOM_ELEMENT_HANDLING&&Ca(se.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Mt.tagNameCheck=se.CUSTOM_ELEMENT_HANDLING.tagNameCheck),se.CUSTOM_ELEMENT_HANDLING&&Ca(se.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Mt.attributeNameCheck=se.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),se.CUSTOM_ELEMENT_HANDLING&&typeof se.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Mt.allowCustomizedBuiltInElements=se.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Bn&&(Ds=!1),Xi&&(wi=!0),jr&&(Wt=q({},u(Ee)),Gt=[],jr.html===!0&&(q(Wt,U),q(Gt,we)),jr.svg===!0&&(q(Wt,te),q(Gt,re),q(Gt,Te)),jr.svgFilters===!0&&(q(Wt,ee),q(Gt,re),q(Gt,Te)),jr.mathMl===!0&&(q(Wt,ne),q(Gt,ye),q(Gt,Te))),se.ADD_TAGS&&(Wt===xs&&(Wt=ae(Wt)),q(Wt,se.ADD_TAGS,Vt)),se.ADD_ATTR&&(Gt===wo&&(Gt=ae(Gt)),q(Gt,se.ADD_ATTR,Vt)),se.ADD_URI_SAFE_ATTR&&q(Ts,se.ADD_URI_SAFE_ATTR,Vt),se.FORBID_CONTENTS&&(ii===si&&(ii=ae(ii)),q(ii,se.FORBID_CONTENTS,Vt)),qi&&(Wt["#text"]=!0),Cn&&q(Wt,["html","head","body"]),Wt.table&&(q(Wt,["tbody"]),delete Gi.tbody),N&&N(se),Mn=se)},Ki=q({},["mi","mo","mn","ms","mtext"]),xt=q({},["foreignobject","annotation-xml"]),gt=q({},["title","style","font","a","script"]),oi=q({},te);q(oi,ee),q(oi,Q);var Ao=q({},ne);q(Ao,ce);var Nu=function(se){var Oe=ti(se);Oe&&Oe.tagName||(Oe={namespaceURI:bi,tagName:"template"});var Fe=F(se.tagName),Je=F(Oe.tagName);return!!Os[se.namespaceURI]&&(se.namespaceURI===Fs?Oe.namespaceURI===wn?Fe==="svg":Oe.namespaceURI===$i?Fe==="svg"&&(Je==="annotation-xml"||Ki[Je]):!!oi[Fe]:se.namespaceURI===$i?Oe.namespaceURI===wn?Fe==="math":Oe.namespaceURI===Fs?Fe==="math"&&xt[Je]:!!Ao[Fe]:se.namespaceURI===wn?!(Oe.namespaceURI===Fs&&!xt[Je])&&!(Oe.namespaceURI===$i&&!Ki[Je])&&!Ao[Fe]&&(gt[Fe]||!oi[Fe]):!(In!=="application/xhtml+xml"||!Os[se.namespaceURI]))},tr=function(se){w(Ne.removed,{element:se});try{se.parentNode.removeChild(se)}catch{try{se.outerHTML=_s}catch{se.remove()}}},Ps=function(se,Oe){try{w(Ne.removed,{attribute:Oe.getAttributeNode(se),from:Oe})}catch{w(Ne.removed,{attribute:null,from:Oe})}if(Oe.removeAttribute(se),se==="is"&&!Gt[se])if(wi||Xi)try{tr(Oe)}catch{}else try{Oe.setAttribute(se,"")}catch{}},_a=function(se){var Oe,Fe;if(Es)se="<remove></remove>"+se;else{var Je=I(se,/^[\r\n\t ]+/);Fe=Je&&Je[0]}In==="application/xhtml+xml"&&bi===wn&&(se='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+se+"</body></html>");var Pt=Yt?Yt.createHTML(se):se;if(bi===wn)try{Oe=new ku().parseFromString(Pt,In)}catch{}if(!Oe||!Oe.documentElement){Oe=yo.createDocument(bi,"template",null);try{Oe.documentElement.innerHTML=Ln?_s:Pt}catch{}}var yt=Oe.body||Oe.documentElement;return se&&Fe&&yt.insertBefore(ct.createTextNode(Fe),yt.childNodes[0]||null),bi===wn?Bu.call(Oe,Cn?"html":"body")[0]:Cn?Oe.documentElement:yt},To=function(se){return Iu.call(se.ownerDocument||se,se,_i.SHOW_ELEMENT|_i.SHOW_COMMENT|_i.SHOW_TEXT|_i.SHOW_PROCESSING_INSTRUCTION|_i.SHOW_CDATA_SECTION,null,!1)},Fo=function(se){return se instanceof Ou&&(se.__depth!==void 0&&typeof se.__depth!="number"||se.__removalCount!==void 0&&typeof se.__removalCount!="number"||typeof se.nodeName!="string"||typeof se.textContent!="string"||typeof se.removeChild!="function"||!(se.attributes instanceof Fu)||typeof se.removeAttribute!="function"||typeof se.setAttribute!="function"||typeof se.namespaceURI!="string"||typeof se.insertBefore!="function"||typeof se.hasChildNodes!="function")},Ot=function(se){return s(er)==="object"?se instanceof er:se&&s(se)==="object"&&typeof se.nodeType=="number"&&typeof se.nodeName=="string"},Nr=function(se,Oe,Fe){Er[se]&&pe(Er[se],function(Je){Je.call(Ne,Oe,Fe,Mn)})},jn=function(se){var Oe;if(Nr("beforeSanitizeElements",se,null),Fo(se)||O(/[\u0080-\uFFFF]/,se.nodeName))return tr(se),!0;var Fe=Vt(se.nodeName);if(Nr("uponSanitizeElement",se,{tagName:Fe,allowedTags:Wt}),se.hasChildNodes()&&!Ot(se.firstElementChild)&&(!Ot(se.content)||!Ot(se.content.firstElementChild))&&O(/<[/\w]/g,se.innerHTML)&&O(/<[/\w]/g,se.textContent)||Fe==="select"&&O(/<template/i,se.innerHTML)||se.nodeType===7||xo&&se.nodeType===8&&O(/<[/\w]/g,se.data))return tr(se),!0;if(!Wt[Fe]||Gi[Fe]){if(!Gi[Fe]&&xi(Fe)&&(Mt.tagNameCheck instanceof RegExp&&O(Mt.tagNameCheck,Fe)||Mt.tagNameCheck instanceof Function&&Mt.tagNameCheck(Fe)))return!1;if(qi&&!ii[Fe]){var Je=ti(se)||se.parentNode,Pt=Pu(se)||se.childNodes;if(Pt&&Je)for(var yt=Pt.length-1;yt>=0;--yt){var sr=ei(Pt[yt],!0);sr.__removalCount=(se.__removalCount||0)+1,Je.insertBefore(sr,da(se))}}return tr(se),!0}return se instanceof Ni&&!Nu(se)?(tr(se),!0):Fe!=="noscript"&&Fe!=="noembed"&&Fe!=="noframes"||!O(/<\/no(script|embed|frames)/i,se.innerHTML)?(Bn&&se.nodeType===3&&(Oe=se.textContent,Oe=H(Oe,ws," "),Oe=H(Oe,Wi," "),Oe=H(Oe,St," "),se.textContent!==Oe&&(w(Ne.removed,{element:se.cloneNode()}),se.textContent=Oe)),Nr("afterSanitizeElements",se,null),!1):(tr(se),!0)},Is=function(se,Oe,Fe){if(As&&(Oe==="id"||Oe==="name")&&(Fe in ct||Fe in ju||Fe==="__depth"||Fe==="__removalCount"))return!1;if(!(Ds&&!So[Oe]&&O(Lu,Oe))){if(!(va&&O(Ss,Oe))){if(!Gt[Oe]||So[Oe]){if(!(xi(se)&&(Mt.tagNameCheck instanceof RegExp&&O(Mt.tagNameCheck,se)||Mt.tagNameCheck instanceof Function&&Mt.tagNameCheck(se))&&(Mt.attributeNameCheck instanceof RegExp&&O(Mt.attributeNameCheck,Oe)||Mt.attributeNameCheck instanceof Function&&Mt.attributeNameCheck(Oe))||Oe==="is"&&Mt.allowCustomizedBuiltInElements&&(Mt.tagNameCheck instanceof RegExp&&O(Mt.tagNameCheck,Fe)||Mt.tagNameCheck instanceof Function&&Mt.tagNameCheck(Fe))))return!1}else if(!Ts[Oe]){if(!O(bs,H(Fe,yn,""))){if((Oe!=="src"&&Oe!=="xlink:href"&&Oe!=="href"||se==="script"||S(Fe,"data:")!==0||!Si[se])&&!(bo&&!O(ma,H(Fe,yn,"")))){if(Fe)return!1}}}}}return!0},xi=function(se){return se!=="annotation-xml"&&I(se,_o)},mr=function(se){var Oe,Fe,Je,Pt;Nr("beforeSanitizeAttributes",se,null);var yt=se.attributes;if(yt){var sr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Gt};for(Pt=yt.length;Pt--;){var or=Oe=yt[Pt],en=or.name,tn=or.namespaceURI;if(Fe=en==="value"?Oe.value:_(Oe.value),Je=Vt(en),sr.attrName=Je,sr.attrValue=Fe,sr.keepAttr=!0,sr.forceKeepAttr=void 0,Nr("uponSanitizeAttribute",se,sr),Fe=sr.attrValue,!sr.forceKeepAttr&&(Ps(en,se),sr.keepAttr))if(Hi||!O(/\/>/i,Fe))if(xo&&O(/((--!?|])>)|<\/(style|title)/i,Fe))Ps(en,se);else{Bn&&(Fe=H(Fe,ws," "),Fe=H(Fe,Wi," "),Fe=H(Fe,St," "));var It=Vt(se.nodeName);if(Is(It,Je,Fe)){if(!ri||Je!=="id"&&Je!=="name"||(Ps(en,se),Fe=Vi+Fe),Yt&&s(Cs)==="object"&&typeof Cs.getAttributeType=="function"&&!tn)switch(Cs.getAttributeType(It,Je)){case"TrustedHTML":Fe=Yt.createHTML(Fe);break;case"TrustedScriptURL":Fe=Yt.createScriptURL(Fe)}try{tn?se.setAttributeNS(tn,en,Fe):se.setAttribute(en,Fe),Fo(se)?tr(se):le(Ne.removed)}catch{}}}else Ps(en,se)}Nr("afterSanitizeAttributes",se,null)}},wa=function se(Oe){var Fe,Je=To(Oe);for(Nr("beforeSanitizeShadowDOM",Oe,null);Fe=Je.nextNode();)if(Nr("uponSanitizeShadowNode",Fe,null),!jn(Fe)){var Pt=ti(Fe);Fe.nodeType===1&&(Pt&&Pt.__depth?Fe.__depth=(Fe.__removalCount||0)+Pt.__depth+1:Fe.__depth=1),(Fe.__depth>=ya||V(Fe.__depth))&&tr(Fe),Fe.content instanceof Nt&&(Fe.content.__depth=Fe.__depth,se(Fe.content)),mr(Fe)}Nr("afterSanitizeShadowDOM",Oe,null)};return Ne.sanitize=function(se){var Oe,Fe,Je,Pt,yt,sr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if((Ln=!se)&&(se="<!-->"),typeof se!="string"&&!Ot(se)){if(typeof se.toString!="function")throw j("toString is not a function");if(typeof(se=se.toString())!="string")throw j("dirty is not a string, aborting")}if(!Ne.isSupported){if(s(ke.toStaticHTML)==="object"||typeof ke.toStaticHTML=="function"){if(typeof se=="string")return ke.toStaticHTML(se);if(Ot(se))return ke.toStaticHTML(se.outerHTML)}return se}if(_n||Rn(sr),Ne.removed=[],typeof se=="string"&&(ni=!1),ni){if(se.nodeName){var or=Vt(se.nodeName);if(!Wt[or]||Gi[or])throw j("root node is forbidden and cannot be sanitized in-place")}}else if(se instanceof er)(Fe=(Oe=_a("<!---->")).ownerDocument.importNode(se,!0)).nodeType===1&&Fe.nodeName==="BODY"||Fe.nodeName==="HTML"?Oe=Fe:Oe.appendChild(Fe);else{if(!wi&&!Bn&&!Cn&&se.indexOf("<")===-1)return Yt&&Yi?Yt.createHTML(se):se;if(!(Oe=_a(se)))return wi?null:Yi?_s:""}Oe&&Es&&tr(Oe.firstChild);for(var en=To(ni?se:Oe);Je=en.nextNode();)if((Je.nodeType!==3||Je!==Pt)&&!jn(Je)){var tn=ti(Je);Je.nodeType===1&&(tn&&tn.__depth?Je.__depth=(Je.__removalCount||0)+tn.__depth+1:Je.__depth=1),(Je.__depth>=ya||V(Je.__depth))&&tr(Je),Je.content instanceof Nt&&(Je.content.__depth=Je.__depth,wa(Je.content)),mr(Je),Pt=Je}if(Pt=null,ni)return se;if(wi){if(Xi)for(yt=pa.call(Oe.ownerDocument);Oe.firstChild;)yt.appendChild(Oe.firstChild);else yt=Oe;return(Gt.shadowroot||Gt.shadowrootmod)&&(yt=ga.call(Xe,yt,!0)),yt}var It=Cn?Oe.outerHTML:Oe.innerHTML;return Cn&&Wt["!doctype"]&&Oe.ownerDocument&&Oe.ownerDocument.doctype&&Oe.ownerDocument.doctype.name&&O(Zr,Oe.ownerDocument.doctype.name)&&(It="<!DOCTYPE "+Oe.ownerDocument.doctype.name+`>
`+It),Bn&&(It=H(It,ws," "),It=H(It,Wi," "),It=H(It,St," ")),Yt&&Yi?Yt.createHTML(It):It},Ne.setConfig=function(se){Rn(se),_n=!0},Ne.clearConfig=function(){Mn=null,_n=!1},Ne.isValidAttribute=function(se,Oe,Fe){Mn||Rn({});var Je=Vt(se),Pt=Vt(Oe);return Is(Je,Pt,Fe)},Ne.addHook=function(se,Oe){typeof Oe=="function"&&(Er[se]=Er[se]||[],w(Er[se],Oe))},Ne.removeHook=function(se){if(Er[se])return le(Er[se])},Ne.removeHooks=function(se){Er[se]&&(Er[se]=[])},Ne.removeAllHooks=function(){Er={}},Ne}return Ci()}()},729:n=>{"use strict";var s=Object.prototype.hasOwnProperty,i="~";function a(){}function l(d,g,m){this.fn=d,this.context=g,this.once=m||!1}function u(d,g,m,y,C){if(typeof m!="function")throw new TypeError("The listener must be a function");var b=new l(m,y||d,C),k=i?i+g:g;return d._events[k]?d._events[k].fn?d._events[k]=[d._events[k],b]:d._events[k].push(b):(d._events[k]=b,d._eventsCount++),d}function c(d,g){--d._eventsCount==0?d._events=new a:delete d._events[g]}function h(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(i=!1)),h.prototype.eventNames=function(){var d,g,m=[];if(this._eventsCount===0)return m;for(g in d=this._events)s.call(d,g)&&m.push(i?g.slice(1):g);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(d)):m},h.prototype.listeners=function(d){var g=i?i+d:d,m=this._events[g];if(!m)return[];if(m.fn)return[m.fn];for(var y=0,C=m.length,b=new Array(C);y<C;y++)b[y]=m[y].fn;return b},h.prototype.listenerCount=function(d){var g=i?i+d:d,m=this._events[g];return m?m.fn?1:m.length:0},h.prototype.emit=function(d,g,m,y,C,b){var k=i?i+d:d;if(!this._events[k])return!1;var L,N,M=this._events[k],W=arguments.length;if(M.fn){switch(M.once&&this.removeListener(d,M.fn,void 0,!0),W){case 1:return M.fn.call(M.context),!0;case 2:return M.fn.call(M.context,g),!0;case 3:return M.fn.call(M.context,g,m),!0;case 4:return M.fn.call(M.context,g,m,y),!0;case 5:return M.fn.call(M.context,g,m,y,C),!0;case 6:return M.fn.call(M.context,g,m,y,C,b),!0}for(N=1,L=new Array(W-1);N<W;N++)L[N-1]=arguments[N];M.fn.apply(M.context,L)}else{var Y,J=M.length;for(N=0;N<J;N++)switch(M[N].once&&this.removeListener(d,M[N].fn,void 0,!0),W){case 1:M[N].fn.call(M[N].context);break;case 2:M[N].fn.call(M[N].context,g);break;case 3:M[N].fn.call(M[N].context,g,m);break;case 4:M[N].fn.call(M[N].context,g,m,y);break;default:if(!L)for(Y=1,L=new Array(W-1);Y<W;Y++)L[Y-1]=arguments[Y];M[N].fn.apply(M[N].context,L)}}return!0},h.prototype.on=function(d,g,m){return u(this,d,g,m,!1)},h.prototype.once=function(d,g,m){return u(this,d,g,m,!0)},h.prototype.removeListener=function(d,g,m,y){var C=i?i+d:d;if(!this._events[C])return this;if(!g)return c(this,C),this;var b=this._events[C];if(b.fn)b.fn!==g||y&&!b.once||m&&b.context!==m||c(this,C);else{for(var k=0,L=[],N=b.length;k<N;k++)(b[k].fn!==g||y&&!b[k].once||m&&b[k].context!==m)&&L.push(b[k]);L.length?this._events[C]=L.length===1?L[0]:L:c(this,C)}return this},h.prototype.removeAllListeners=function(d){var g;return d?(g=i?i+d:d,this._events[g]&&c(this,g)):(this._events=new a,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=i,h.EventEmitter=h,n.exports=h},717:n=>{typeof Object.create=="function"?n.exports=function(s,i){s.super_=i,s.prototype=Object.create(i.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}})}:n.exports=function(s,i){s.super_=i;var a=function(){};a.prototype=i.prototype,s.prototype=new a,s.prototype.constructor=s}},824:n=>{var s=1e3,i=60*s,a=60*i,l=24*a,u=7*l,c=365.25*l;function h(d,g,m,y){var C=g>=1.5*m;return Math.round(d/m)+" "+y+(C?"s":"")}n.exports=function(d,g){g=g||{};var m=typeof d;if(m==="string"&&d.length>0)return function(y){if(!((y=String(y)).length>100)){var C=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);if(C){var b=parseFloat(C[1]);switch((C[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return b*c;case"weeks":case"week":case"w":return b*u;case"days":case"day":case"d":return b*l;case"hours":case"hour":case"hrs":case"hr":case"h":return b*a;case"minutes":case"minute":case"mins":case"min":case"m":return b*i;case"seconds":case"second":case"secs":case"sec":case"s":return b*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return b;default:return}}}}(d);if(m==="number"&&isFinite(d))return g.long?function(y){var C=Math.abs(y);return C>=l?h(y,C,l,"day"):C>=a?h(y,C,a,"hour"):C>=i?h(y,C,i,"minute"):C>=s?h(y,C,s,"second"):y+" ms"}(d):function(y){var C=Math.abs(y);return C>=l?Math.round(y/l)+"d":C>=a?Math.round(y/a)+"h":C>=i?Math.round(y/i)+"m":C>=s?Math.round(y/s)+"s":y+"ms"}(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))}},520:(n,s,i)=>{"use strict";var a=i(155),l=a.platform==="win32",u=i(539);function c(M,W){for(var Y=[],J=0;J<M.length;J++){var oe=M[J];oe&&oe!=="."&&(oe===".."?Y.length&&Y[Y.length-1]!==".."?Y.pop():W&&Y.push(".."):Y.push(oe))}return Y}function h(M){for(var W=M.length-1,Y=0;Y<=W&&!M[Y];Y++);for(var J=W;J>=0&&!M[J];J--);return Y===0&&J===W?M:Y>J?[]:M.slice(Y,J+1)}var d=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,g=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,m={};function y(M){var W=d.exec(M),Y=(W[1]||"")+(W[2]||""),J=W[3]||"",oe=g.exec(J);return[Y,oe[1],oe[2],oe[3]]}function C(M){var W=d.exec(M),Y=W[1]||"",J=!!Y&&Y[1]!==":";return{device:Y,isUnc:J,isAbsolute:J||!!W[2],tail:W[3]}}function b(M){return"\\\\"+M.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}m.resolve=function(){for(var M="",W="",Y=!1,J=arguments.length-1;J>=-1;J--){var oe;if(J>=0?oe=arguments[J]:M?(oe=a.env["="+M])&&oe.substr(0,3).toLowerCase()===M.toLowerCase()+"\\"||(oe=M+"\\"):oe=a.cwd(),!u.isString(oe))throw new TypeError("Arguments to path.resolve must be strings");if(oe){var pe=C(oe),le=pe.device,w=pe.isUnc,F=pe.isAbsolute,P=pe.tail;if((!le||!M||le.toLowerCase()===M.toLowerCase())&&(M||(M=le),Y||(W=P+"\\"+W,Y=F),M&&Y))break}}return w&&(M=b(M)),M+(Y?"\\":"")+(W=c(W.split(/[\\\/]+/),!Y).join("\\"))||"."},m.normalize=function(M){var W=C(M),Y=W.device,J=W.isUnc,oe=W.isAbsolute,pe=W.tail,le=/[\\\/]$/.test(pe);return(pe=c(pe.split(/[\\\/]+/),!oe).join("\\"))||oe||(pe="."),pe&&le&&(pe+="\\"),J&&(Y=b(Y)),Y+(oe?"\\":"")+pe},m.isAbsolute=function(M){return C(M).isAbsolute},m.join=function(){for(var M=[],W=0;W<arguments.length;W++){var Y=arguments[W];if(!u.isString(Y))throw new TypeError("Arguments to path.join must be strings");Y&&M.push(Y)}var J=M.join("\\");return/^[\\\/]{2}[^\\\/]/.test(M[0])||(J=J.replace(/^[\\\/]{2,}/,"\\")),m.normalize(J)},m.relative=function(M,W){M=m.resolve(M),W=m.resolve(W);for(var Y=M.toLowerCase(),J=W.toLowerCase(),oe=h(W.split("\\")),pe=h(Y.split("\\")),le=h(J.split("\\")),w=Math.min(pe.length,le.length),F=w,P=0;P<w;P++)if(pe[P]!==le[P]){F=P;break}if(F==0)return W;var I=[];for(P=F;P<pe.length;P++)I.push("..");return(I=I.concat(oe.slice(F))).join("\\")},m._makeLong=function(M){if(!u.isString(M))return M;if(!M)return"";var W=m.resolve(M);return/^[a-zA-Z]\:\\/.test(W)?"\\\\?\\"+W:/^\\\\[^?.]/.test(W)?"\\\\?\\UNC\\"+W.substring(2):M},m.dirname=function(M){var W=y(M),Y=W[0],J=W[1];return Y||J?(J&&(J=J.substr(0,J.length-1)),Y+J):"."},m.basename=function(M,W){var Y=y(M)[2];return W&&Y.substr(-1*W.length)===W&&(Y=Y.substr(0,Y.length-W.length)),Y},m.extname=function(M){return y(M)[3]},m.format=function(M){if(!u.isObject(M))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof M);var W=M.root||"";if(!u.isString(W))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof M.root);var Y=M.dir,J=M.base||"";return Y?Y[Y.length-1]===m.sep?Y+J:Y+m.sep+J:J},m.parse=function(M){if(!u.isString(M))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof M);var W=y(M);if(!W||W.length!==4)throw new TypeError("Invalid path '"+M+"'");return{root:W[0],dir:W[0]+W[1].slice(0,-1),base:W[2],ext:W[3],name:W[2].slice(0,W[2].length-W[3].length)}},m.sep="\\",m.delimiter=";";var k=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,L={};function N(M){return k.exec(M).slice(1)}L.resolve=function(){for(var M="",W=!1,Y=arguments.length-1;Y>=-1&&!W;Y--){var J=Y>=0?arguments[Y]:a.cwd();if(!u.isString(J))throw new TypeError("Arguments to path.resolve must be strings");J&&(M=J+"/"+M,W=J[0]==="/")}return(W?"/":"")+(M=c(M.split("/"),!W).join("/"))||"."},L.normalize=function(M){var W=L.isAbsolute(M),Y=M&&M[M.length-1]==="/";return(M=c(M.split("/"),!W).join("/"))||W||(M="."),M&&Y&&(M+="/"),(W?"/":"")+M},L.isAbsolute=function(M){return M.charAt(0)==="/"},L.join=function(){for(var M="",W=0;W<arguments.length;W++){var Y=arguments[W];if(!u.isString(Y))throw new TypeError("Arguments to path.join must be strings");Y&&(M+=M?"/"+Y:Y)}return L.normalize(M)},L.relative=function(M,W){M=L.resolve(M).substr(1),W=L.resolve(W).substr(1);for(var Y=h(M.split("/")),J=h(W.split("/")),oe=Math.min(Y.length,J.length),pe=oe,le=0;le<oe;le++)if(Y[le]!==J[le]){pe=le;break}var w=[];for(le=pe;le<Y.length;le++)w.push("..");return(w=w.concat(J.slice(pe))).join("/")},L._makeLong=function(M){return M},L.dirname=function(M){var W=N(M),Y=W[0],J=W[1];return Y||J?(J&&(J=J.substr(0,J.length-1)),Y+J):"."},L.basename=function(M,W){var Y=N(M)[2];return W&&Y.substr(-1*W.length)===W&&(Y=Y.substr(0,Y.length-W.length)),Y},L.extname=function(M){return N(M)[3]},L.format=function(M){if(!u.isObject(M))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof M);var W=M.root||"";if(!u.isString(W))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof M.root);return(M.dir?M.dir+L.sep:"")+(M.base||"")},L.parse=function(M){if(!u.isString(M))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof M);var W=N(M);if(!W||W.length!==4)throw new TypeError("Invalid path '"+M+"'");return W[1]=W[1]||"",W[2]=W[2]||"",W[3]=W[3]||"",{root:W[0],dir:W[0]+W[1].slice(0,-1),base:W[2],ext:W[3],name:W[2].slice(0,W[2].length-W[3].length)}},L.sep="/",L.delimiter=":",n.exports=l?m:L,n.exports.posix=L,n.exports.win32=m},155:n=>{var s,i,a=n.exports={};function l(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(L){if(s===setTimeout)return setTimeout(L,0);if((s===l||!s)&&setTimeout)return s=setTimeout,setTimeout(L,0);try{return s(L,0)}catch{try{return s.call(null,L,0)}catch{return s.call(this,L,0)}}}(function(){try{s=typeof setTimeout=="function"?setTimeout:l}catch{s=l}try{i=typeof clearTimeout=="function"?clearTimeout:u}catch{i=u}})();var h,d=[],g=!1,m=-1;function y(){g&&h&&(g=!1,h.length?d=h.concat(d):m=-1,d.length&&C())}function C(){if(!g){var L=c(y);g=!0;for(var N=d.length;N;){for(h=d,d=[];++m<N;)h&&h[m].run();m=-1,N=d.length}h=null,g=!1,function(M){if(i===clearTimeout)return clearTimeout(M);if((i===u||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(M);try{i(M)}catch{try{return i.call(null,M)}catch{return i.call(this,M)}}}(L)}}function b(L,N){this.fun=L,this.array=N}function k(){}a.nextTick=function(L){var N=new Array(arguments.length-1);if(arguments.length>1)for(var M=1;M<arguments.length;M++)N[M-1]=arguments[M];d.push(new b(L,N)),d.length!==1||g||c(C)},b.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=k,a.addListener=k,a.once=k,a.off=k,a.removeListener=k,a.removeAllListeners=k,a.emit=k,a.prependListener=k,a.prependOnceListener=k,a.listeners=function(L){return[]},a.binding=function(L){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(L){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},384:n=>{n.exports=function(s){return s&&typeof s=="object"&&typeof s.copy=="function"&&typeof s.fill=="function"&&typeof s.readUInt8=="function"}},539:(n,s,i)=>{var a=i(155),l=/%[sdj%]/g;s.format=function(S){if(!M(S)){for(var _=[],O=0;O<arguments.length;O++)_.push(h(arguments[O]));return _.join(" ")}O=1;for(var j=arguments,V=j.length,z=String(S).replace(l,function(q){if(q==="%%")return"%";if(O>=V)return q;switch(q){case"%s":return String(j[O++]);case"%d":return Number(j[O++]);case"%j":try{return JSON.stringify(j[O++])}catch{return"[Circular]"}default:return q}}),X=j[O];O<V;X=j[++O])L(X)||!J(X)?z+=" "+X:z+=" "+h(X);return z},s.deprecate=function(S,_){if(W(i.g.process))return function(){return s.deprecate(S,_).apply(this,arguments)};if(a.noDeprecation===!0)return S;var O=!1;return function(){if(!O){if(a.throwDeprecation)throw new Error(_);a.traceDeprecation?console.trace(_):console.error(_),O=!0}return S.apply(this,arguments)}};var u,c={};function h(S,_){var O={seen:[],stylize:g};return arguments.length>=3&&(O.depth=arguments[2]),arguments.length>=4&&(O.colors=arguments[3]),k(_)?O.showHidden=_:_&&s._extend(O,_),W(O.showHidden)&&(O.showHidden=!1),W(O.depth)&&(O.depth=2),W(O.colors)&&(O.colors=!1),W(O.customInspect)&&(O.customInspect=!0),O.colors&&(O.stylize=d),m(O,S,O.depth)}function d(S,_){var O=h.styles[_];return O?"\x1B["+h.colors[O][0]+"m"+S+"\x1B["+h.colors[O][1]+"m":S}function g(S,_){return S}function m(S,_,O){if(S.customInspect&&_&&le(_.inspect)&&_.inspect!==s.inspect&&(!_.constructor||_.constructor.prototype!==_)){var j=_.inspect(O,S);return M(j)||(j=m(S,j,O)),j}var V=function(ee,Q){if(W(Q))return ee.stylize("undefined","undefined");if(M(Q)){var ne="'"+JSON.stringify(Q).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ee.stylize(ne,"string")}if(N(Q))return ee.stylize(""+Q,"number");if(k(Q))return ee.stylize(""+Q,"boolean");if(L(Q))return ee.stylize("null","null")}(S,_);if(V)return V;var z=Object.keys(_),X=function(ee){var Q={};return ee.forEach(function(ne,ce){Q[ne]=!0}),Q}(z);if(S.showHidden&&(z=Object.getOwnPropertyNames(_)),pe(_)&&(z.indexOf("message")>=0||z.indexOf("description")>=0))return y(_);if(z.length===0){if(le(_)){var q=_.name?": "+_.name:"";return S.stylize("[Function"+q+"]","special")}if(Y(_))return S.stylize(RegExp.prototype.toString.call(_),"regexp");if(oe(_))return S.stylize(Date.prototype.toString.call(_),"date");if(pe(_))return y(_)}var ae,$="",U=!1,te=["{","}"];return b(_)&&(U=!0,te=["[","]"]),le(_)&&($=" [Function"+(_.name?": "+_.name:"")+"]"),Y(_)&&($=" "+RegExp.prototype.toString.call(_)),oe(_)&&($=" "+Date.prototype.toUTCString.call(_)),pe(_)&&($=" "+y(_)),z.length!==0||U&&_.length!=0?O<0?Y(_)?S.stylize(RegExp.prototype.toString.call(_),"regexp"):S.stylize("[Object]","special"):(S.seen.push(_),ae=U?function(ee,Q,ne,ce,Ee){for(var we=[],re=0,ye=Q.length;re<ye;++re)H(Q,String(re))?we.push(C(ee,Q,ne,ce,String(re),!0)):we.push("");return Ee.forEach(function(Te){Te.match(/^\d+$/)||we.push(C(ee,Q,ne,ce,Te,!0))}),we}(S,_,O,X,z):z.map(function(ee){return C(S,_,O,X,ee,U)}),S.seen.pop(),function(ee,Q,ne){return ee.reduce(function(ce,Ee){return Ee.indexOf(`
`)>=0,ce+Ee.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?ne[0]+(Q===""?"":Q+`
 `)+" "+ee.join(`,
  `)+" "+ne[1]:ne[0]+Q+" "+ee.join(", ")+" "+ne[1]}(ae,$,te)):te[0]+$+te[1]}function y(S){return"["+Error.prototype.toString.call(S)+"]"}function C(S,_,O,j,V,z){var X,q,ae;if((ae=Object.getOwnPropertyDescriptor(_,V)||{value:_[V]}).get?q=ae.set?S.stylize("[Getter/Setter]","special"):S.stylize("[Getter]","special"):ae.set&&(q=S.stylize("[Setter]","special")),H(j,V)||(X="["+V+"]"),q||(S.seen.indexOf(ae.value)<0?(q=L(O)?m(S,ae.value,null):m(S,ae.value,O-1)).indexOf(`
`)>-1&&(q=z?q.split(`
`).map(function($){return"  "+$}).join(`
`).substr(2):`
`+q.split(`
`).map(function($){return"   "+$}).join(`
`)):q=S.stylize("[Circular]","special")),W(X)){if(z&&V.match(/^\d+$/))return q;(X=JSON.stringify(""+V)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(X=X.substr(1,X.length-2),X=S.stylize(X,"name")):(X=X.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),X=S.stylize(X,"string"))}return X+": "+q}function b(S){return Array.isArray(S)}function k(S){return typeof S=="boolean"}function L(S){return S===null}function N(S){return typeof S=="number"}function M(S){return typeof S=="string"}function W(S){return S===void 0}function Y(S){return J(S)&&w(S)==="[object RegExp]"}function J(S){return typeof S=="object"&&S!==null}function oe(S){return J(S)&&w(S)==="[object Date]"}function pe(S){return J(S)&&(w(S)==="[object Error]"||S instanceof Error)}function le(S){return typeof S=="function"}function w(S){return Object.prototype.toString.call(S)}function F(S){return S<10?"0"+S.toString(10):S.toString(10)}s.debuglog=function(S){if(W(u)&&(u=a.env.NODE_DEBUG||""),S=S.toUpperCase(),!c[S])if(new RegExp("\\b"+S+"\\b","i").test(u)){var _=a.pid;c[S]=function(){var O=s.format.apply(s,arguments);console.error("%s %d: %s",S,_,O)}}else c[S]=function(){};return c[S]},s.inspect=h,h.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},h.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},s.isArray=b,s.isBoolean=k,s.isNull=L,s.isNullOrUndefined=function(S){return S==null},s.isNumber=N,s.isString=M,s.isSymbol=function(S){return typeof S=="symbol"},s.isUndefined=W,s.isRegExp=Y,s.isObject=J,s.isDate=oe,s.isError=pe,s.isFunction=le,s.isPrimitive=function(S){return S===null||typeof S=="boolean"||typeof S=="number"||typeof S=="string"||typeof S=="symbol"||S===void 0},s.isBuffer=i(384);var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(){var S=new Date,_=[F(S.getHours()),F(S.getMinutes()),F(S.getSeconds())].join(":");return[S.getDate(),P[S.getMonth()],_].join(" ")}function H(S,_){return Object.prototype.hasOwnProperty.call(S,_)}s.log=function(){console.log("%s - %s",I(),s.format.apply(s,arguments))},s.inherits=i(717),s._extend=function(S,_){if(!_||!J(_))return S;for(var O=Object.keys(_),j=O.length;j--;)S[O[j]]=_[O[j]];return S}}},e={};function r(n){var s=e[n];if(s!==void 0)return s.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}r.n=n=>{var s=n&&n.__esModule?()=>n.default:()=>n;return r.d(s,{a:s}),s},r.d=(n,s)=>{for(var i in s)r.o(s,i)&&!r.o(n,i)&&Object.defineProperty(n,i,{enumerable:!0,get:s[i]})},r.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),r.o=(n,s)=>Object.prototype.hasOwnProperty.call(n,s),r.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var o={};return(()=>{"use strict";r.r(o),r.d(o,{LSPluginUser:()=>Vu,setupPluginUserInstance:()=>Lo});var n=r(520),s=(r(856),r(996)),i=r.n(s),a=function(){return a=Object.assign||function(T){for(var E,B=1,Z=arguments.length;B<Z;B++)for(var de in E=arguments[B])Object.prototype.hasOwnProperty.call(E,de)&&(T[de]=E[de]);return T},a.apply(this,arguments)};function l(T){return T.toLowerCase()}var u=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],c=/[^A-Z0-9]+/gi;function h(T,E,B){return E instanceof RegExp?T.replace(E,B):E.reduce(function(Z,de){return Z.replace(de,B)},T)}function d(T,E){return E===void 0&&(E={}),function(B,Z){Z===void 0&&(Z={});for(var de=Z.splitRegexp,ge=de===void 0?u:de,ve=Z.stripRegexp,De=ve===void 0?c:ve,Ie=Z.transform,Re=Ie===void 0?l:Ie,nt=Z.delimiter,We=nt===void 0?" ":nt,He=h(h(B,ge,"$1\0$2"),De,"\0"),Ze=0,Ke=He.length;He.charAt(Ze)==="\0";)Ze++;for(;He.charAt(Ke-1)==="\0";)Ke--;return He.slice(Ze,Ke).split("\0").map(Re).join(We)}(T,a({delimiter:"."},E))}var g=r(729),m=r.n(g);function y(T,E,B){return E in T?Object.defineProperty(T,E,{value:B,enumerable:!0,configurable:!0,writable:!0}):T[E]=B,T}let C=navigator.platform.toLowerCase()==="win32"?n.win32:n.posix,b=function(T,E){return E===void 0&&(E={}),d(T,a({delimiter:"_"},E))};class k extends m(){constructor(E,B){super(),y(this,"_tag",void 0),y(this,"_opts",void 0),y(this,"_logs",[]),this._tag=E,this._opts=B}write(E,B,Z){var de;B!=null&&B.length&&B[B.length-1]===!0&&(Z=!0,B.pop());let ge=B.reduce((De,Ie)=>(Ie&&Ie instanceof Error?De+=`${Ie.message} ${Ie.stack}`:De+=Ie.toString(),De),`[${this._tag}][${new Date().toLocaleTimeString()}] `);var ve;this._logs.push([E,ge]),(Z||(de=this._opts)!==null&&de!==void 0&&de.console)&&((ve=console)===null||ve===void 0||ve[E==="ERROR"?"error":"debug"](`${E}: ${ge}`)),this.emit("change")}clear(){this._logs=[],this.emit("change")}info(...E){this.write("INFO",E)}error(...E){this.write("ERROR",E)}warn(...E){this.write("WARN",E)}setTag(E){this._tag=E}toJSON(){return this._logs}}function L(T,...E){try{let B=new URL(T);if(!B.origin)throw new Error(null);let Z=C.join(T.substr(B.origin.length),...E);return B.origin+Z}catch{return C.join(T,...E)}}function N(T,E){let B,Z,de=!1,ge=De=>Ie=>{T&&clearTimeout(T),De(Ie),de=!0},ve=new Promise((De,Ie)=>{B=ge(De),Z=ge(Ie),T&&(T=setTimeout(()=>Z(new Error(`[deferred timeout] ${E}`)),T))});return{created:Date.now(),setTag:De=>E=De,resolve:B,reject:Z,promise:ve,get settled(){return de}}}let M=new Map;window.__injectedUIEffects=M;var W=r(227),Y=r.n(W);function J(T,E,B){return E in T?Object.defineProperty(T,E,{value:B,enumerable:!0,configurable:!0,writable:!0}):T[E]=B,T}let oe="application/x-postmate-v1+json",pe=0,le={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},w=(T,E)=>(typeof E!="string"||T.origin===E)&&!!T.data&&(typeof T.data!="object"||"postmate"in T.data)&&T.data.type===oe&&!!le[T.data.postmate];class F{constructor(E){J(this,"parent",void 0),J(this,"frame",void 0),J(this,"child",void 0),J(this,"events",{}),J(this,"childOrigin",void 0),J(this,"listener",void 0),this.parent=E.parent,this.frame=E.frame,this.child=E.child,this.childOrigin=E.childOrigin,this.listener=B=>{if(!w(B,this.childOrigin))return!1;let{data:Z,name:de}=((B||{}).data||{}).value||{};B.data.postmate==="emit"&&de in this.events&&this.events[de].forEach(ge=>{ge.call(this,Z)})},this.parent.addEventListener("message",this.listener,!1)}get(E,...B){return new Promise((Z,de)=>{let ge=++pe,ve=De=>{De.data.uid===ge&&De.data.postmate==="reply"&&(this.parent.removeEventListener("message",ve,!1),De.data.error?de(De.data.error):Z(De.data.value))};this.parent.addEventListener("message",ve,!1),this.child.postMessage({postmate:"request",type:oe,property:E,args:B,uid:ge},this.childOrigin)})}call(E,B){this.child.postMessage({postmate:"call",type:oe,property:E,data:B},this.childOrigin)}on(E,B){this.events[E]||(this.events[E]=[]),this.events[E].push(B)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class P{constructor(E){J(this,"model",void 0),J(this,"parent",void 0),J(this,"parentOrigin",void 0),J(this,"child",void 0),this.model=E.model,this.parent=E.parent,this.parentOrigin=E.parentOrigin,this.child=E.child,this.child.addEventListener("message",B=>{if(!w(B,this.parentOrigin))return;let{property:Z,uid:de,data:ge,args:ve}=B.data;B.data.postmate!=="call"?((De,Ie,Re)=>{let nt=typeof De[Ie]=="function"?De[Ie].apply(null,Re):De[Ie];return Promise.resolve(nt)})(this.model,Z,ve).then(De=>{B.source.postMessage({property:Z,postmate:"reply",type:oe,uid:de,value:De},B.origin)}).catch(De=>{B.source.postMessage({property:Z,postmate:"reply",type:oe,uid:de,error:De},B.origin)}):Z in this.model&&typeof this.model[Z]=="function"&&this.model[Z](ge)})}emit(E,B){this.parent.postMessage({postmate:"emit",type:oe,value:{name:E,data:B}},this.parentOrigin)}}class I{constructor(E){J(this,"container",void 0),J(this,"parent",void 0),J(this,"frame",void 0),J(this,"child",void 0),J(this,"childOrigin",void 0),J(this,"url",void 0),J(this,"model",void 0),this.container=E.container,this.url=E.url,this.parent=window,this.frame=document.createElement("iframe"),E.id&&(this.frame.id=E.id),E.name&&(this.frame.name=E.name),this.frame.classList.add.apply(this.frame.classList,E.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=E.model||{}}sendHandshake(E){let B=(ge=>{let ve=document.createElement("a");ve.href=ge;let De=ve.protocol.length>4?ve.protocol:window.location.protocol,Ie=ve.host.length?ve.port==="80"||ve.port==="443"?ve.hostname:ve.host:window.location.host;return ve.origin||`${De}//${Ie}`})(E=E||this.url),Z,de=0;return new Promise((ge,ve)=>{let De=Re=>!!w(Re,B)&&(Re.data.postmate==="handshake-reply"?(clearInterval(Z),this.parent.removeEventListener("message",De,!1),this.childOrigin=Re.origin,ge(new F(this))):ve("Failed handshake"));this.parent.addEventListener("message",De,!1);let Ie=()=>{de++,this.child.postMessage({postmate:"handshake",type:oe,model:this.model},B),de===5&&clearInterval(Z)};this.frame.addEventListener("load",()=>{Ie(),Z=setInterval(Ie,500)}),this.frame.src=E})}destroy(){this.frame.parentNode.removeChild(this.frame)}}J(I,"debug",!1),J(I,"Model",void 0);class H{constructor(E){J(this,"child",void 0),J(this,"model",void 0),J(this,"parent",void 0),J(this,"parentOrigin",void 0),this.child=window,this.model=E,this.parent=this.child.parent}sendHandshakeReply(){return new Promise((E,B)=>{let Z=de=>{if(de.data.postmate){if(de.data.postmate==="handshake"){this.child.removeEventListener("message",Z,!1),de.source.postMessage({postmate:"handshake-reply",type:oe},de.origin),this.parentOrigin=de.origin;let ge=de.data.model;return ge&&Object.keys(ge).forEach(ve=>{this.model[ve]=ge[ve]}),E(new P(this))}return B("Handshake Reply Failed")}};this.child.addEventListener("message",Z,!1)})}}function S(T,E,B){return E in T?Object.defineProperty(T,E,{value:B,enumerable:!0,configurable:!0,writable:!0}):T[E]=B,T}let{importHTML:_,createSandboxContainer:O}=window.QSandbox||{};function j(T,E){return T.startsWith("http")?fetch(T,E):(T=T.replace("file://",""),new Promise(async(B,Z)=>{try{let de=await window.apis.doAction(["readFile",T]);B({text:()=>de})}catch(de){console.error(de),Z(de)}}))}class V extends m(){constructor(E){super(),S(this,"_pluginLocal",void 0),S(this,"_frame",void 0),S(this,"_root",void 0),S(this,"_loaded",!1),S(this,"_unmountFns",[]),this._pluginLocal=E,E._dispose(()=>{this._unmount()})}async load(){let{name:E,entry:B}=this._pluginLocal.options;if(this.loaded||!B)return;let{template:Z,execScripts:de}=await _(B,{fetch:j});this._mount(Z,document.body);let ge=O(E,{elementGetter:()=>{var De;return(De=this._root)===null||De===void 0?void 0:De.firstChild}}).instance.proxy;ge.__shadow_mode__=!0,ge.LSPluginLocal=this._pluginLocal,ge.LSPluginShadow=this,ge.LSPluginUser=ge.logseq=new Vu(this._pluginLocal.toJSON(),this._pluginLocal.caller);let ve=await de(ge,!0);this._unmountFns.push(ve.unmount),this._loaded=!0}_mount(E,B){let Z=this._frame=document.createElement("div");Z.classList.add("lsp-shadow-sandbox"),Z.id=this._pluginLocal.id,this._root=Z.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${E}</div>`,B.appendChild(Z),this.emit("mounted")}_unmount(){for(let E of this._unmountFns)E&&E.call(null)}destroy(){var E,B;(E=this.frame)===null||E===void 0||(B=E.parentNode)===null||B===void 0||B.removeChild(this.frame)}get loaded(){return this._loaded}get document(){var E;return(E=this._root)===null||E===void 0?void 0:E.firstChild}get frame(){return this._frame}}function z(T,E,B){return E in T?Object.defineProperty(T,E,{value:B,enumerable:!0,configurable:!0,writable:!0}):T[E]=B,T}let X=Y()("LSPlugin:caller"),q="#await#response#",ae="#lspmsg#",$="#lspmsg#error#",U=T=>`#lspmsg#${T}`;class te extends m(){constructor(E){super(),z(this,"_pluginLocal",void 0),z(this,"_connected",!1),z(this,"_parent",void 0),z(this,"_child",void 0),z(this,"_shadow",void 0),z(this,"_status",void 0),z(this,"_userModel",{}),z(this,"_call",void 0),z(this,"_callUserModel",void 0),z(this,"_debugTag",""),this._pluginLocal=E,E&&(this._debugTag=E.debugTag)}async connectToChild(){if(this._connected)return;let{shadow:E}=this._pluginLocal;E?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(E={}){if(this._connected)return;let B=this,Z=this._pluginLocal!=null,de=0,ge=0,ve=new Map,De=N(6e4),Ie=this._extendUserModel({"#lspmsg#ready#":async We=>{Ie[U(We?.pid)]=({type:He,payload:Ze})=>{X(`[host (_call) -> *user] ${this._debugTag}`,He,Ze),B.emit(He,Ze)},await De.resolve()},"#lspmsg#beforeunload#":async We=>{let He=N(1e4);B.emit("beforeunload",Object.assign({actor:He},We)),await He.promise},"#lspmsg#settings#":async({type:We,payload:He})=>{B.emit("settings:changed",He)},[ae]:async({ns:We,type:He,payload:Ze})=>{X(`[host (async) -> *user] ${this._debugTag} ns=${We} type=${He}`,Ze),We&&We.startsWith("hook")?B.emit(`${We}:${He}`,Ze):B.emit(He,Ze)},"#lspmsg#reply#":({_sync:We,result:He})=>{if(X(`[sync host -> *user] #${We}`,He),ve.has(We)){let Ze=ve.get(We);Ze&&(He!=null&&He.hasOwnProperty($)?Ze.reject(He[$]):Ze.resolve(He),ve.delete(We))}},...E});var Re;if(Z)return await De.promise,JSON.parse(JSON.stringify((Re=this._pluginLocal)===null||Re===void 0?void 0:Re.toJSON()));let nt=new H(Ie).sendHandshakeReply();return this._status="pending",await nt.then(We=>{this._child=We,this._connected=!0,this._call=async(He,Ze={},Ke)=>{if(Ke){let ht=++ge;ve.set(ht,Ke),Ze._sync=ht,Ke.setTag(`async call #${ht}`),X(`async call #${ht}`)}return We.emit(U(Ie.baseInfo.id),{type:He,payload:Ze}),Ke?.promise},this._callUserModel=async(He,Ze)=>{try{Ie[He](Ze)}catch{X(`[model method] #${He} not existed`)}},de=setInterval(()=>{if(ve.size>100)for(let[He,Ze]of ve)Ze.settled&&ve.delete(He)},18e5)}).finally(()=>{this._status=void 0}),await De.promise,Ie.baseInfo}async call(E,B={}){var Z;return(Z=this._call)===null||Z===void 0?void 0:Z.call(this,E,B)}async callAsync(E,B={}){var Z;let de=N(1e4);return(Z=this._call)===null||Z===void 0?void 0:Z.call(this,E,B,de)}async callUserModel(E,...B){var Z;return(Z=this._callUserModel)===null||Z===void 0?void 0:Z.apply(this,[E,...B])}async callUserModelAsync(E,...B){var Z;return E=`${q}${E}`,(Z=this._callUserModel)===null||Z===void 0?void 0:Z.apply(this,[E,...B])}async _setupIframeSandbox(){let E=this._pluginLocal,B=E.id,Z=`${B}_lsp_main`,de=new URL(E.options.entry);de.searchParams.set("__v__",E.options.version);let ge=document.querySelector(`#${Z}`);ge&&ge.parentElement.removeChild(ge);let ve=document.createElement("div");ve.classList.add("lsp-iframe-sandbox-container"),ve.id=Z,ve.dataset.pid=B;try{var De;let We=(De=await this._pluginLocal._loadLayoutsData())===null||De===void 0?void 0:De.$$0;if(We){ve.dataset.inited_layout="true";let{width:He,height:Ze,left:Ke,top:ht,vw:Dt,vh:$t}=We;Ke=Math.max(Ke,0),Ke=typeof Dt=="number"?`${Math.min(100*Ke/Dt,99)}%`:`${Ke}px`,ht=Math.max(ht,45),ht=typeof $t=="number"?`${Math.min(100*ht/$t,99)}%`:`${ht}px`,Object.assign(ve.style,{width:He+"px",height:Ze+"px",left:Ke,top:ht})}}catch(We){console.error("[Restore Layout Error]",We)}document.body.appendChild(ve);let Ie=new I({id:B+"_iframe",container:ve,url:de.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(E.toJSON()))}}),Re,nt=Ie.sendHandshake();return this._status="pending",new Promise((We,He)=>{Re=setTimeout(()=>{He(new Error("handshake Timeout")),Ie.destroy()},8e3),nt.then(Ze=>{this._parent=Ze,this._connected=!0,this.emit("connected"),Ze.on(U(E.id),({type:Ke,payload:ht})=>{var Dt,$t;X("[user -> *host] ",Ke,ht),(Dt=this._pluginLocal)===null||Dt===void 0||Dt.emit(Ke,ht||{}),($t=this._pluginLocal)===null||$t===void 0||$t.caller.emit(Ke,ht||{})}),this._call=async(...Ke)=>{await Ze.call(U(E.id),{type:Ke[0],payload:Object.assign(Ke[1]||{},{$$pid:E.id})})},this._callUserModel=async(Ke,...ht)=>{if(Ke.startsWith(q))return await Ze.get(Ke.replace(q,""),...ht);Ze.call(Ke,ht?.[0])},We(null)}).catch(Ze=>{He(Ze)}).finally(()=>{clearTimeout(Re)})}).catch(We=>{throw X("[iframe sandbox] error",We),We}).finally(()=>{this._status=void 0})}async _setupShadowSandbox(){let E=this._pluginLocal,B=this._shadow=new V(E);try{this._status="pending",await B.load(),this._connected=!0,this.emit("connected"),this._call=async(Z,de={},ge)=>{var ve;return ge&&(de.actor=ge),(ve=this._pluginLocal)===null||ve===void 0||ve.emit(Z,Object.assign(de,{$$pid:E.id})),ge?.promise},this._callUserModel=async(...Z)=>{var de;let ge=Z[0];(de=ge)!==null&&de!==void 0&&de.startsWith(q)&&(ge=ge.replace(q,""));let ve=Z[1]||{},De=this._userModel[ge];typeof De=="function"&&await De.call(null,ve)}}catch(Z){throw X("[shadow sandbox] error",Z),Z}finally{this._status=void 0}}_extendUserModel(E){return Object.assign(this._userModel,E)}_getSandboxIframeContainer(){var E;return(E=this._parent)===null||E===void 0?void 0:E.frame.parentNode}_getSandboxShadowContainer(){var E;return(E=this._shadow)===null||E===void 0?void 0:E.frame.parentNode}_getSandboxIframeRoot(){var E;return(E=this._parent)===null||E===void 0?void 0:E.frame}_getSandboxShadowRoot(){var E;return(E=this._shadow)===null||E===void 0?void 0:E.frame}set debugTag(E){this._debugTag=E}async destroy(){var E;let B=null;this._parent&&(B=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(B=this._getSandboxShadowContainer(),this._shadow.destroy()),(E=B)===null||E===void 0||E.parentNode.removeChild(B)}}function ee(T,E,B){return E in T?Object.defineProperty(T,E,{value:B,enumerable:!0,configurable:!0,writable:!0}):T[E]=B,T}class Q{constructor(E,B){ee(this,"ctx",void 0),ee(this,"opts",void 0),this.ctx=E,this.opts=B}get ctxId(){return this.ctx.baseInfo.id}setItem(E,B){var Z;return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,E,B,(Z=this.opts)===null||Z===void 0?void 0:Z.assets]})}getItem(E){var B;return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,E,(B=this.opts)===null||B===void 0?void 0:B.assets]})}removeItem(E){var B;return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,E,(B=this.opts)===null||B===void 0?void 0:B.assets]})}allKeys(){var E;return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,(E=this.opts)===null||E===void 0?void 0:E.assets]})}clear(){var E;return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,(E=this.opts)===null||E===void 0?void 0:E.assets]})}hasItem(E){var B;return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,E,(B=this.opts)===null||B===void 0?void 0:B.assets]})}}class ne{constructor(E){var B,Z,de;de=void 0,(Z="ctx")in(B=this)?Object.defineProperty(B,Z,{value:de,enumerable:!0,configurable:!0,writable:!0}):B[Z]=de,this.ctx=E}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get Components(){return{Editor:this.ensureHostScope().logseq.sdk.experiments.cp_page_editor}}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(E,...B){var Z;let de=this.ensureHostScope();E=(Z=b(E))===null||Z===void 0?void 0:Z.toLowerCase();let ge=de.logseq.api["exper_"+E]||de.logseq.sdk.experiments[E];return ge?.apply(de,B)}async loadScripts(...E){(E=E.map(B=>B!=null&&B.startsWith("http")?B:this.ctx.resolveResourceFullUrl(B))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...E)}registerFencedCodeRenderer(E,B){return this.invokeExperMethod("registerFencedCodeRenderer",this.ctx.baseInfo.id,E,B)}registerDaemonRenderer(E,B){return this.invokeExperMethod("registerDaemonRenderer",this.ctx.baseInfo.id,E,B)}registerRouteRenderer(E,B){return this.invokeExperMethod("registerRouteRenderer",this.ctx.baseInfo.id,E,B)}registerExtensionsEnhancer(E,B){let Z=this.ensureHostScope();return E==="katex"&&Z.katex&&B(Z.katex).catch(console.error),this.invokeExperMethod("registerExtensionsEnhancer",this.ctx.baseInfo.id,E,B)}ensureHostScope(){return window===top?(console.error("Can not access host scope!"),{}):top}}function ce(T,E,B){return E in T?Object.defineProperty(T,E,{value:B,enumerable:!0,configurable:!0,writable:!0}):T[E]=B,T}let Ee=T=>`task_callback_${T}`;class we{constructor(E,B,Z={}){ce(this,"_client",void 0),ce(this,"_requestId",void 0),ce(this,"_requestOptions",void 0),ce(this,"_promise",void 0),ce(this,"_aborted",!1),this._client=E,this._requestId=B,this._requestOptions=Z,this._promise=new Promise((De,Ie)=>{if(!this._requestId)return Ie(null);this._client.once(Ee(this._requestId),Re=>{Re&&Re instanceof Error?Ie(Re):De(Re)})});let{success:de,fail:ge,final:ve}=this._requestOptions;this._promise.then(De=>{de?.(De)}).catch(De=>{ge?.(De)}).finally(()=>{ve?.()})}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class re extends g.EventEmitter{constructor(E){super(),ce(this,"_ctx",void 0),this._ctx=E,this.ctx.caller.on("#lsp#request#callback",B=>{let Z=B?.requestId;Z&&this.emit(Ee(Z),B?.payload)})}static createRequestTask(E,B,Z){return new we(E,B,Z)}async _request(E){let B=this.ctx.baseInfo.id,{success:Z,fail:de,final:ge,...ve}=E,De=this.ctx.Experiments.invokeExperMethod("request",B,ve),Ie=re.createRequestTask(this.ctx.Request,De,E);return ve.abortable?Ie:Ie.promise}get ctx(){return this._ctx}}let ye=Array.isArray,Te=typeof global=="object"&&global&&global.Object===Object&&global;var Be=typeof self=="object"&&self&&self.Object===Object&&self;let Ue=Te||Be||Function("return this")(),Me=Ue.Symbol;var at=Object.prototype,Qe=at.hasOwnProperty,Lt=at.toString,Zt=Me?Me.toStringTag:void 0;let wt=function(T){var E=Qe.call(T,Zt),B=T[Zt];try{T[Zt]=void 0;var Z=!0}catch{}var de=Lt.call(T);return Z&&(E?T[Zt]=B:delete T[Zt]),de};var Zr=Object.prototype.toString;let vn=function(T){return Zr.call(T)};var Pn=Me?Me.toStringTag:void 0;let Dr=function(T){return T==null?T===void 0?"[object Undefined]":"[object Null]":Pn&&Pn in Object(T)?wt(T):vn(T)},Ci=function(T){var E=typeof T;return T!=null&&(E=="object"||E=="function")},ke=function(T){if(!Ci(T))return!1;var E=Dr(T);return E=="[object Function]"||E=="[object GeneratorFunction]"||E=="[object AsyncFunction]"||E=="[object Proxy]"},Ne=Ue["__core-js_shared__"];var Xe,ct=(Xe=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||""))?"Symbol(src)_1."+Xe:"";let Nt=function(T){return!!ct&&ct in T};var ar=Function.prototype.toString;let er=function(T){if(T!=null){try{return ar.call(T)}catch{}try{return T+""}catch{}}return""};var Ni=/^\[object .+?Constructor\]$/,_i=Function.prototype,mo=Object.prototype,Fu=_i.toString,Ou=mo.hasOwnProperty,ku=RegExp("^"+Fu.call(Ou).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");let Cs=function(T){return!(!Ci(T)||Nt(T))&&(ke(T)?ku:Ni).test(er(T))},Ui=function(T,E){return T?.[E]},ei=function(T,E){var B=Ui(T,E);return Cs(B)?B:void 0},da=function(){try{var T=ei(Object,"defineProperty");return T({},"",{}),T}catch{}}(),Pu=function(T,E,B){E=="__proto__"&&da?da(T,E,{configurable:!0,enumerable:!0,value:B,writable:!0}):T[E]=B},ti=function(T){return function(E,B,Z){for(var de=-1,ge=Object(E),ve=Z(E),De=ve.length;De--;){var Ie=ve[T?De:++de];if(B(ge[Ie],Ie,ge)===!1)break}return E}}(),vo=function(T,E){for(var B=-1,Z=Array(T);++B<T;)Z[B]=E(B);return Z},Yt=function(T){return T!=null&&typeof T=="object"},_s=function(T){return Yt(T)&&Dr(T)=="[object Arguments]"};var zi=Object.prototype,yo=zi.hasOwnProperty,Iu=zi.propertyIsEnumerable;let pa=_s(function(){return arguments}())?_s:function(T){return Yt(T)&&yo.call(T,"callee")&&!Iu.call(T,"callee")},Bu=function(){return!1};var ga=typeof Zn=="object"&&Zn&&!Zn.nodeType&&Zn,Co=ga&&typeof yi=="object"&&yi&&!yi.nodeType&&yi,Er=Co&&Co.exports===ga?Ue.Buffer:void 0;let In=(Er?Er.isBuffer:void 0)||Bu;var Vt=/^(?:0|[1-9]\d*)$/;let ws=function(T,E){var B=typeof T;return!!(E=E??9007199254740991)&&(B=="number"||B!="symbol"&&Vt.test(T))&&T>-1&&T%1==0&&T<E},Wi=function(T){return typeof T=="number"&&T>-1&&T%1==0&&T<=9007199254740991};var St={};St["[object Float32Array]"]=St["[object Float64Array]"]=St["[object Int8Array]"]=St["[object Int16Array]"]=St["[object Int32Array]"]=St["[object Uint8Array]"]=St["[object Uint8ClampedArray]"]=St["[object Uint16Array]"]=St["[object Uint32Array]"]=!0,St["[object Arguments]"]=St["[object Array]"]=St["[object ArrayBuffer]"]=St["[object Boolean]"]=St["[object DataView]"]=St["[object Date]"]=St["[object Error]"]=St["[object Function]"]=St["[object Map]"]=St["[object Number]"]=St["[object Object]"]=St["[object RegExp]"]=St["[object Set]"]=St["[object String]"]=St["[object WeakMap]"]=!1;let Lu=function(T){return Yt(T)&&Wi(T.length)&&!!St[Dr(T)]},Ss=function(T){return function(E){return T(E)}};var ma=typeof Zn=="object"&&Zn&&!Zn.nodeType&&Zn,yn=ma&&typeof yi=="object"&&yi&&!yi.nodeType&&yi,_o=yn&&yn.exports===ma&&Te.process,bs=function(){try{var T=yn&&yn.require&&yn.require("util").types;return T||_o&&_o.binding&&_o.binding("util")}catch{}}(),Wt=bs&&bs.isTypedArray;let xs=Wt?Ss(Wt):Lu;var Gt=Object.prototype.hasOwnProperty;let wo=function(T,E){var B=ye(T),Z=!B&&pa(T),de=!B&&!Z&&In(T),ge=!B&&!Z&&!de&&xs(T),ve=B||Z||de||ge,De=ve?vo(T.length,String):[],Ie=De.length;for(var Re in T)!E&&!Gt.call(T,Re)||ve&&(Re=="length"||de&&(Re=="offset"||Re=="parent")||ge&&(Re=="buffer"||Re=="byteLength"||Re=="byteOffset")||ws(Re,Ie))||De.push(Re);return De};var Mt=Object.prototype;let Gi=function(T){var E=T&&T.constructor;return T===(typeof E=="function"&&E.prototype||Mt)},So=function(T,E){return function(B){return T(E(B))}}(Object.keys,Object);var va=Object.prototype.hasOwnProperty;let Ds=function(T){if(!Gi(T))return So(T);var E=[];for(var B in Object(T))va.call(T,B)&&B!="constructor"&&E.push(B);return E},bo=function(T){return T!=null&&Wi(T.length)&&!ke(T)},Hi=function(T){return bo(T)?wo(T):Ds(T)},Bn=function(T,E){return T&&ti(T,E,Hi)},xo=function(){this.__data__=[],this.size=0},Cn=function(T,E){return T===E||T!=T&&E!=E},_n=function(T,E){for(var B=T.length;B--;)if(Cn(T[B][0],E))return B;return-1};var Es=Array.prototype.splice;let wi=function(T){var E=this.__data__,B=_n(E,T);return!(B<0)&&(B==E.length-1?E.pop():Es.call(E,B,1),--this.size,!0)},Xi=function(T){var E=this.__data__,B=_n(E,T);return B<0?void 0:E[B][1]},Yi=function(T){return _n(this.__data__,T)>-1},As=function(T,E){var B=this.__data__,Z=_n(B,T);return Z<0?(++this.size,B.push([T,E])):B[Z][1]=E,this};function ri(T){var E=-1,B=T==null?0:T.length;for(this.clear();++E<B;){var Z=T[E];this.set(Z[0],Z[1])}}ri.prototype.clear=xo,ri.prototype.delete=wi,ri.prototype.get=Xi,ri.prototype.has=Yi,ri.prototype.set=As;let Vi=ri,qi=function(){this.__data__=new Vi,this.size=0},ni=function(T){var E=this.__data__,B=E.delete(T);return this.size=E.size,B},jr=function(T){return this.__data__.get(T)},ii=function(T){return this.__data__.has(T)},si=ei(Ue,"Map"),Si=ei(Object,"create"),Do=function(){this.__data__=Si?Si(null):{},this.size=0},Ts=function(T){var E=this.has(T)&&delete this.__data__[T];return this.size-=E?1:0,E};var Eo=Object.prototype.hasOwnProperty;let $i=function(T){var E=this.__data__;if(Si){var B=E[T];return B==="__lodash_hash_undefined__"?void 0:B}return Eo.call(E,T)?E[T]:void 0};var Fs=Object.prototype.hasOwnProperty;let wn=function(T){var E=this.__data__;return Si?E[T]!==void 0:Fs.call(E,T)},bi=function(T,E){var B=this.__data__;return this.size+=this.has(T)?0:1,B[T]=Si&&E===void 0?"__lodash_hash_undefined__":E,this};function Ln(T){var E=-1,B=T==null?0:T.length;for(this.clear();++E<B;){var Z=T[E];this.set(Z[0],Z[1])}}Ln.prototype.clear=Do,Ln.prototype.delete=Ts,Ln.prototype.get=$i,Ln.prototype.has=wn,Ln.prototype.set=bi;let Os=Ln,Mu=function(){this.size=0,this.__data__={hash:new Os,map:new(si||Vi),string:new Os}},Ru=function(T){var E=typeof T;return E=="string"||E=="number"||E=="symbol"||E=="boolean"?T!=="__proto__":T===null},ks=function(T,E){var B=T.__data__;return Ru(E)?B[typeof E=="string"?"string":"hash"]:B.map},Mn=function(T){var E=ks(this,T).delete(T);return this.size-=E?1:0,E},ya=function(T){return ks(this,T).get(T)},ju=function(T){return ks(this,T).has(T)},Ca=function(T,E){var B=ks(this,T),Z=B.size;return B.set(T,E),this.size+=B.size==Z?0:1,this};function Rn(T){var E=-1,B=T==null?0:T.length;for(this.clear();++E<B;){var Z=T[E];this.set(Z[0],Z[1])}}Rn.prototype.clear=Mu,Rn.prototype.delete=Mn,Rn.prototype.get=ya,Rn.prototype.has=ju,Rn.prototype.set=Ca;let Ki=Rn,xt=function(T,E){var B=this.__data__;if(B instanceof Vi){var Z=B.__data__;if(!si||Z.length<199)return Z.push([T,E]),this.size=++B.size,this;B=this.__data__=new Ki(Z)}return B.set(T,E),this.size=B.size,this};function gt(T){var E=this.__data__=new Vi(T);this.size=E.size}gt.prototype.clear=qi,gt.prototype.delete=ni,gt.prototype.get=jr,gt.prototype.has=ii,gt.prototype.set=xt;let oi=gt,Ao=function(T){return this.__data__.set(T,"__lodash_hash_undefined__"),this},Nu=function(T){return this.__data__.has(T)};function tr(T){var E=-1,B=T==null?0:T.length;for(this.__data__=new Ki;++E<B;)this.add(T[E])}tr.prototype.add=tr.prototype.push=Ao,tr.prototype.has=Nu;let Ps=tr,_a=function(T,E){for(var B=-1,Z=T==null?0:T.length;++B<Z;)if(E(T[B],B,T))return!0;return!1},To=function(T,E){return T.has(E)},Fo=function(T,E,B,Z,de,ge){var ve=1&B,De=T.length,Ie=E.length;if(De!=Ie&&!(ve&&Ie>De))return!1;var Re=ge.get(T),nt=ge.get(E);if(Re&&nt)return Re==E&&nt==T;var We=-1,He=!0,Ze=2&B?new Ps:void 0;for(ge.set(T,E),ge.set(E,T);++We<De;){var Ke=T[We],ht=E[We];if(Z)var Dt=ve?Z(ht,Ke,We,E,T,ge):Z(Ke,ht,We,T,E,ge);if(Dt!==void 0){if(Dt)continue;He=!1;break}if(Ze){if(!_a(E,function($t,zr){if(!To(Ze,zr)&&(Ke===$t||de(Ke,$t,B,Z,ge)))return Ze.push(zr)})){He=!1;break}}else if(Ke!==ht&&!de(Ke,ht,B,Z,ge)){He=!1;break}}return ge.delete(T),ge.delete(E),He},Ot=Ue.Uint8Array,Nr=function(T){var E=-1,B=Array(T.size);return T.forEach(function(Z,de){B[++E]=[de,Z]}),B},jn=function(T){var E=-1,B=Array(T.size);return T.forEach(function(Z){B[++E]=Z}),B};var Is=Me?Me.prototype:void 0,xi=Is?Is.valueOf:void 0;let mr=function(T,E,B,Z,de,ge,ve){switch(B){case"[object DataView]":if(T.byteLength!=E.byteLength||T.byteOffset!=E.byteOffset)return!1;T=T.buffer,E=E.buffer;case"[object ArrayBuffer]":return!(T.byteLength!=E.byteLength||!ge(new Ot(T),new Ot(E)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Cn(+T,+E);case"[object Error]":return T.name==E.name&&T.message==E.message;case"[object RegExp]":case"[object String]":return T==E+"";case"[object Map]":var De=Nr;case"[object Set]":var Ie=1&Z;if(De||(De=jn),T.size!=E.size&&!Ie)return!1;var Re=ve.get(T);if(Re)return Re==E;Z|=2,ve.set(T,E);var nt=Fo(De(T),De(E),Z,de,ge,ve);return ve.delete(T),nt;case"[object Symbol]":if(xi)return xi.call(T)==xi.call(E)}return!1},wa=function(T,E){for(var B=-1,Z=E.length,de=T.length;++B<Z;)T[de+B]=E[B];return T},se=function(T,E,B){var Z=E(T);return ye(T)?Z:wa(Z,B(T))},Oe=function(T,E){for(var B=-1,Z=T==null?0:T.length,de=0,ge=[];++B<Z;){var ve=T[B];E(ve,B,T)&&(ge[de++]=ve)}return ge},Fe=function(){return[]};var Je=Object.prototype.propertyIsEnumerable,Pt=Object.getOwnPropertySymbols;let yt=Pt?function(T){return T==null?[]:(T=Object(T),Oe(Pt(T),function(E){return Je.call(T,E)}))}:Fe,sr=function(T){return se(T,Hi,yt)};var or=Object.prototype.hasOwnProperty;let en=function(T,E,B,Z,de,ge){var ve=1&B,De=sr(T),Ie=De.length;if(Ie!=sr(E).length&&!ve)return!1;for(var Re=Ie;Re--;){var nt=De[Re];if(!(ve?nt in E:or.call(E,nt)))return!1}var We=ge.get(T),He=ge.get(E);if(We&&He)return We==E&&He==T;var Ze=!0;ge.set(T,E),ge.set(E,T);for(var Ke=ve;++Re<Ie;){var ht=T[nt=De[Re]],Dt=E[nt];if(Z)var $t=ve?Z(Dt,ht,nt,E,T,ge):Z(ht,Dt,nt,T,E,ge);if(!($t===void 0?ht===Dt||de(ht,Dt,B,Z,ge):$t)){Ze=!1;break}Ke||(Ke=nt=="constructor")}if(Ze&&!Ke){var zr=T.constructor,es=E.constructor;zr==es||!("constructor"in T)||!("constructor"in E)||typeof zr=="function"&&zr instanceof zr&&typeof es=="function"&&es instanceof es||(Ze=!1)}return ge.delete(T),ge.delete(E),Ze},tn=ei(Ue,"DataView"),It=ei(Ue,"Promise"),Ji=ei(Ue,"Set"),Oo=ei(Ue,"WeakMap");var kt="[object Map]",ai="[object Promise]",Sa="[object Set]",Sc="[object WeakMap]",ba="[object DataView]",Uf=er(tn),zf=er(si),Wf=er(It),bc=er(Ji),xa=er(Oo),rn=Dr;(tn&&rn(new tn(new ArrayBuffer(1)))!=ba||si&&rn(new si)!=kt||It&&rn(It.resolve())!=ai||Ji&&rn(new Ji)!=Sa||Oo&&rn(new Oo)!=Sc)&&(rn=function(T){var E=Dr(T),B=E=="[object Object]"?T.constructor:void 0,Z=B?er(B):"";if(Z)switch(Z){case Uf:return ba;case zf:return kt;case Wf:return ai;case bc:return Sa;case xa:return Sc}return E});let xc=rn;var Uu="[object Arguments]",zu="[object Array]",Bs="[object Object]",Da=Object.prototype.hasOwnProperty;let Dc=function(T,E,B,Z,de,ge){var ve=ye(T),De=ye(E),Ie=ve?zu:xc(T),Re=De?zu:xc(E),nt=(Ie=Ie==Uu?Bs:Ie)==Bs,We=(Re=Re==Uu?Bs:Re)==Bs,He=Ie==Re;if(He&&In(T)){if(!In(E))return!1;ve=!0,nt=!1}if(He&&!nt)return ge||(ge=new oi),ve||xs(T)?Fo(T,E,B,Z,de,ge):mr(T,E,Ie,B,Z,de,ge);if(!(1&B)){var Ze=nt&&Da.call(T,"__wrapped__"),Ke=We&&Da.call(E,"__wrapped__");if(Ze||Ke){var ht=Ze?T.value():T,Dt=Ke?E.value():E;return ge||(ge=new oi),de(ht,Dt,B,Z,ge)}}return!!He&&(ge||(ge=new oi),en(T,E,B,Z,de,ge))},Ec=function T(E,B,Z,de,ge){return E===B||(E==null||B==null||!Yt(E)&&!Yt(B)?E!=E&&B!=B:Dc(E,B,Z,de,T,ge))},Wu=function(T,E,B,Z){var de=B.length,ge=de,ve=!Z;if(T==null)return!ge;for(T=Object(T);de--;){var De=B[de];if(ve&&De[2]?De[1]!==T[De[0]]:!(De[0]in T))return!1}for(;++de<ge;){var Ie=(De=B[de])[0],Re=T[Ie],nt=De[1];if(ve&&De[2]){if(Re===void 0&&!(Ie in T))return!1}else{var We=new oi;if(Z)var He=Z(Re,nt,Ie,T,E,We);if(!(He===void 0?Ec(nt,Re,3,Z,We):He))return!1}}return!0},Ea=function(T){return T==T&&!Ci(T)},Gf=function(T){for(var E=Hi(T),B=E.length;B--;){var Z=E[B],de=T[Z];E[B]=[Z,de,Ea(de)]}return E},Gu=function(T,E){return function(B){return B!=null&&B[T]===E&&(E!==void 0||T in Object(B))}},Ur=function(T){var E=Gf(T);return E.length==1&&E[0][2]?Gu(E[0][0],E[0][1]):function(B){return B===T||Wu(B,T,E)}},ko=function(T){return typeof T=="symbol"||Yt(T)&&Dr(T)=="[object Symbol]"};var Po=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ac=/^\w*$/;let Aa=function(T,E){if(ye(T))return!1;var B=typeof T;return!(B!="number"&&B!="symbol"&&B!="boolean"&&T!=null&&!ko(T))||Ac.test(T)||!Po.test(T)||E!=null&&T in Object(E)};function Hu(T,E){if(typeof T!="function"||E!=null&&typeof E!="function")throw new TypeError("Expected a function");var B=function(){var Z=arguments,de=E?E.apply(this,Z):Z[0],ge=B.cache;if(ge.has(de))return ge.get(de);var ve=T.apply(this,Z);return B.cache=ge.set(de,ve)||ge,ve};return B.cache=new(Hu.Cache||Ki),B}Hu.Cache=Ki;let Hf=Hu;var Xf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Yf=/\\(\\)?/g;let Vf=function(T){var E=Hf(T,function(Z){return B.size===500&&B.clear(),Z}),B=E.cache;return E}(function(T){var E=[];return T.charCodeAt(0)===46&&E.push(""),T.replace(Xf,function(B,Z,de,ge){E.push(de?ge.replace(Yf,"$1"):Z||B)}),E}),Ls=function(T,E){for(var B=-1,Z=T==null?0:T.length,de=Array(Z);++B<Z;)de[B]=E(T[B],B,T);return de};var Tc=Me?Me.prototype:void 0,Fc=Tc?Tc.toString:void 0;let Xu=function T(E){if(typeof E=="string")return E;if(ye(E))return Ls(E,T)+"";if(ko(E))return Fc?Fc.call(E):"";var B=E+"";return B=="0"&&1/E==-1/0?"-0":B},Oc=function(T){return T==null?"":Xu(T)},ui=function(T,E){return ye(T)?T:Aa(T,E)?[T]:Vf(Oc(T))},Qi=function(T){if(typeof T=="string"||ko(T))return T;var E=T+"";return E=="0"&&1/T==-1/0?"-0":E},kc=function(T,E){for(var B=0,Z=(E=ui(E,T)).length;T!=null&&B<Z;)T=T[Qi(E[B++])];return B&&B==Z?T:void 0},qf=function(T,E,B){var Z=T==null?void 0:kc(T,E);return Z===void 0?B:Z},$f=function(T,E){return T!=null&&E in Object(T)},Ms=function(T,E,B){for(var Z=-1,de=(E=ui(E,T)).length,ge=!1;++Z<de;){var ve=Qi(E[Z]);if(!(ge=T!=null&&B(T,ve)))break;T=T[ve]}return ge||++Z!=de?ge:!!(de=T==null?0:T.length)&&Wi(de)&&ws(ve,de)&&(ye(T)||pa(T))},Sn=function(T,E){return T!=null&&Ms(T,E,$f)},Pc=function(T,E){return Aa(T)&&Ea(E)?Gu(Qi(T),E):function(B){var Z=qf(B,T);return Z===void 0&&Z===E?Sn(B,T):Ec(E,Z,3)}},Kf=function(T){return T},Jf=function(T){return function(E){return E?.[T]}},Qf=function(T){return function(E){return kc(E,T)}},Zf=function(T){return Aa(T)?Jf(Qi(T)):Qf(T)},ed=function(T){return typeof T=="function"?T:T==null?Kf:typeof T=="object"?ye(T)?Pc(T[0],T[1]):Ur(T):Zf(T)},Di=function(T,E){var B={};return E=ed(E,3),Bn(T,function(Z,de,ge){Pu(B,E(Z,de,ge),Z)}),B};function he(T,E,B){return E in T?Object.defineProperty(T,E,{value:B,enumerable:!0,configurable:!0,writable:!0}):T[E]=B,T}class Se{constructor(E,B){he(this,"ctx",void 0),he(this,"serviceHooks",void 0),this.ctx=E,this.serviceHooks=B,E._execCallableAPI("register-search-service",E.baseInfo.id,B.name,B.options),Object.entries({query:{f:"onQuery",args:["graph","q",!0],reply:!0,transformOutput:Z=>(ye(Z?.blocks)&&(Z.blocks=Z.blocks.map(de=>de&&Di(de,(ge,ve)=>`block/${ve}`))),Z)},rebuildBlocksIndice:{f:"onIndiceInit",args:["graph","blocks"]},transactBlocks:{f:"onBlocksChanged",args:["graph","data"]},truncateBlocks:{f:"onIndiceReset",args:["graph"]},removeDb:{f:"onGraph",args:["graph"]}}).forEach(([Z,de])=>{let ge=(ve=>`service:search:${ve}:${B.name}`)(Z);E.caller.on(ge,async ve=>{if(ke(B?.[de.f])){let De=null;try{De=await B[de.f].apply(B,(de.args||[]).map(Ie=>{if(ve){if(Ie===!0)return ve;if(ve.hasOwnProperty(Ie)){let Re=ve[Ie];return delete ve[Ie],Re}}})),de.transformOutput&&(De=de.transformOutput(De))}catch(Ie){console.error("[SearchService] ",Ie),De=Ie}finally{de.reply&&E.caller.call(`${ge}:reply`,De)}}})})}}function me(T,E,B){(function(Z,de){if(de.has(Z))throw new TypeError("Cannot initialize the same private elements twice on an object")})(T,E),E.set(T,B)}function Le(T,E,B){return E in T?Object.defineProperty(T,E,{value:B,enumerable:!0,configurable:!0,writable:!0}):T[E]=B,T}function et(T,E,B){return function(Z,de,ge){if(de.set)de.set.call(Z,ge);else{if(!de.writable)throw new TypeError("attempted to set read only private field");de.value=ge}}(T,qt(T,E,"set"),B),B}function Ct(T,E){return function(B,Z){return Z.get?Z.get.call(B):Z.value}(T,qt(T,E,"get"))}function qt(T,E,B){if(!E.has(T))throw new TypeError("attempted to "+B+" private field on non-instance");return E.get(T)}let Tt=Symbol.for("proxy-continue"),Yu=Y()("LSPlugin:user"),Ic=new k("",{console:!0});function ur(T,E,B){var Z;let{key:de,label:ge,desc:ve,palette:De,keybinding:Ie,extras:Re}=E;if(typeof B!="function")return this.logger.error(`${de||ge}: command action should be function.`),!1;let nt=function(He){if(typeof He=="string")return He.trim().replace(/\s/g,"_").toLowerCase()}(de);if(!nt)return this.logger.error(`${ge}: command key is required.`),!1;let We=`SimpleCommandHook${nt}${++Bo}`;this.Editor["on"+We](B),(Z=this.caller)===null||Z===void 0||Z.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:nt,label:ge,type:T,desc:ve,keybinding:Ie,extras:Re},["editor/hook",We]],De]})}function Io(T){return!(typeof(E=T)!="string"||E.length!==36||!/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(E))||(Ic.error(`#${T} is not a valid UUID string.`),!1);var E}let Ta=null,Zi=new Map,Fa={async getInfo(T){return Ta||(Ta=await this._execCallableAPIAsync("get-app-info")),typeof T=="string"?Ta[T]:Ta},registerCommand:ur,registerSearchService(T){if(Zi.has(T.name))throw new Error(`SearchService: #${T.name} has registered!`);Zi.set(T.name,new Se(this,T))},registerCommandPalette(T,E){let{key:B,label:Z,keybinding:de}=T;return ur.call(this,"$palette$",{key:B,label:Z,palette:!0,keybinding:de},E)},registerCommandShortcut(T,E,B={}){typeof T=="string"&&(T={mode:"global",binding:T});let{binding:Z}=T,de="$shortcut$",ge=B.key||de+b(Z?.toString());return ur.call(this,de,{...B,key:ge,palette:!1,keybinding:T},E)},registerUIItem(T,E){var B;let Z=this.baseInfo.id;(B=this.caller)===null||B===void 0||B.call("api:call",{method:"register-plugin-ui-item",args:[Z,T,E]})},registerPageMenuItem(T,E){if(typeof E!="function")return!1;let B=T+"_"+this.baseInfo.id,Z=T;ur.call(this,"page-menu-item",{key:B,label:Z},E)},onBlockRendererSlotted(T,E){if(!Io(T))return;let B=this.baseInfo.id,Z=`hook:editor:${b(`slot:${T}`)}`;return this.caller.on(Z,E),this.App._installPluginHook(B,Z),()=>{this.caller.off(Z,E),this.App._uninstallPluginHook(B,Z)}},invokeExternalPlugin(T,...E){var B;if(!(T=(B=T)===null||B===void 0?void 0:B.trim()))return;let[Z,de]=T.split(".");if(!["models","commands"].includes(de?.toLowerCase()))throw new Error("Type only support '.models' or '.commands' currently.");let ge=T.replace(`${Z}.${de}.`,"");if(!Z||!de||!ge)throw new Error(`Illegal type of #${T} to invoke external plugin.`);return this._execCallableAPIAsync("invoke_external_plugin_cmd",Z,de.toLowerCase(),ge,E)},setFullScreen(T){let E=(...B)=>this._callWin("setFullScreen",...B);T==="toggle"?this._callWin("isFullScreen").then(B=>{B?E():E(!0)}):T?E(!0):E()}},Bo=0,bt={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},registerSlashCommand(T,E){var B;Yu("Register slash command #",this.baseInfo.id,T,E),typeof E=="function"&&(E=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",E]]),E=E.map(Z=>{let[de,...ge]=Z;if(de==="editor/hook"){let ve=ge[0],De=()=>{var Re;(Re=this.caller)===null||Re===void 0||Re.callUserModel(ve)};typeof ve=="function"&&(De=ve);let Ie=`SlashCommandHook${de}${++Bo}`;Z[1]=Ie,this.Editor["on"+Ie](De)}return Z}),(B=this.caller)===null||B===void 0||B.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[T,E]]})},registerBlockContextMenuItem(T,E){if(typeof E!="function")return!1;let B=T+"_"+this.baseInfo.id;ur.call(this,"block-context-menu-item",{key:B,label:T},E)},registerHighlightContextMenuItem(T,E,B){if(typeof E!="function")return!1;let Z=T+"_"+this.baseInfo.id;ur.call(this,"highlight-context-menu-item",{key:Z,label:T,extras:B},E)},scrollToBlockInPage(T,E,B){let Z="block-content-"+E;B!=null&&B.replaceState?this.App.replaceState("page",{name:T},{anchor:Z}):this.App.pushState("page",{name:T},{anchor:Z})}},td={onBlockChanged(T,E){if(!Io(T))return;let B=this.baseInfo.id,Z=`hook:db:${b(`block:${T}`)}`,de=({block:ge,txData:ve,txMeta:De})=>{ge.uuid===T&&E(ge,ve,De)};return this.caller.on(Z,de),this.App._installPluginHook(B,Z),()=>{this.caller.off(Z,de),this.App._uninstallPluginHook(B,Z)}},datascriptQuery(T,...E){return E.pop(),E!=null&&E.some(B=>typeof B=="function")?this.Experiments.ensureHostScope().logseq.api.datascript_query(T,...E):this._execCallableAPIAsync("datascript_query",T,...E)}},Bc={},Oa={},rd={makeSandboxStorage(){return new Q(this,{assets:!0})}};var ka=new WeakMap;class Vu extends m(){constructor(E,B){super(),Le(this,"_baseInfo",void 0),Le(this,"_caller",void 0),Le(this,"_version","0.2.1"),Le(this,"_debugTag",""),Le(this,"_settingsSchema",void 0),Le(this,"_connected",!1),Le(this,"_ui",new Map),Le(this,"_mFileStorage",void 0),Le(this,"_mRequest",void 0),Le(this,"_mExperiments",void 0),Le(this,"_beforeunloadCallback",void 0),me(this,ka,{writable:!0,value:void 0}),this._baseInfo=E,this._caller=B,B.on("sys:ui:visible",Z=>{Z!=null&&Z.toggle&&this.toggleMainUI()}),B.on("settings:changed",Z=>{let de=Object.assign({},this.settings),ge=Object.assign(this._baseInfo.settings,Z);this.emit("settings:changed",{...ge},de)}),B.on("beforeunload",async Z=>{let{actor:de,...ge}=Z,ve=this._beforeunloadCallback;try{ve&&await ve(ge),de?.resolve(null)}catch(De){this.logger.error("[beforeunload] ",De),de?.reject(De)}})}async ready(E,B){var Z,de;if(!this._connected)try{var ge;typeof E=="function"&&(B=E,E={});let ve=await this._caller.connectToParent(E);this._connected=!0,Z=this._baseInfo,de=ve,ve=i()(Z,de,{arrayMerge:(De,Ie)=>Ie}),this._baseInfo=ve,(ge=ve)!==null&&ge!==void 0&&ge.id&&(this._debugTag=this._caller.debugTag=`#${ve.id} [${ve.name}]`,this.logger.setTag(this._debugTag)),this._settingsSchema&&(ve.settings=function(De,Ie){let Re=(Ie||[]).reduce((nt,We)=>("default"in We&&(nt[We.key]=We.default),nt),{});return Object.assign(Re,De)}(ve.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema));try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version})}catch(De){console.warn(De)}B&&B.call(this,ve)}catch(ve){console.error(`${this._debugTag} [Ready Error]`,ve)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(E){typeof E=="function"&&(this._beforeunloadCallback=E)}provideModel(E){return this.caller._extendUserModel(E),this}provideTheme(E){return this.caller.call("provider:theme",E),this}provideStyle(E){return this.caller.call("provider:style",E),this}provideUI(E){return this.caller.call("provider:ui",E),this}useSettingsSchema(E){return this.connected&&this.caller.call("settings:schema",{schema:E,isSync:!0}),this._settingsSchema=E,this}updateSettings(E){this.caller.call("settings:update",E)}onSettingsChanged(E){let B="settings:changed";return this.on(B,E),()=>this.off(B,E)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(E){this.caller.call("main-ui:attrs",E)}setMainUIInlineStyle(E){this.caller.call("main-ui:style",E)}hideMainUI(E){let B={key:0,visible:!1,cursor:E?.restoreEditingCursor};this.caller.call("main-ui:visible",B),this.emit("ui:visible:changed",B),this._ui.set(B.key,B)}showMainUI(E){let B={key:0,visible:!0,autoFocus:E?.autoFocus};this.caller.call("main-ui:visible",B),this.emit("ui:visible:changed",B),this._ui.set(B.key,B)}toggleMainUI(){let B=this._ui.get(0);B&&B.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){let E=this._ui.get(0);return!!(E&&E.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get effect(){return(E=this)&&(((B=E.baseInfo)===null||B===void 0?void 0:B.effect)||!((Z=E.baseInfo)!==null&&Z!==void 0&&Z.iir));var E,B,Z}get logger(){return Ic}get settings(){var E;return(E=this.baseInfo)===null||E===void 0?void 0:E.settings}get caller(){return this._caller}resolveResourceFullUrl(E){if(this.ensureConnected(),E)return E=E.replace(/^[.\\/]+/,""),L(this._baseInfo.lsr,E)}_makeUserProxy(E,B){let Z=this,de=this.caller;return new Proxy(E,{get(ge,ve,De){let Ie=ge[ve];return function(...Re){if(Ie){Re?.length!==0&&Re.concat(B);let We=Ie.apply(Z,Re);if(We!==Tt)return We}if(B){let We=ve.toString().match(/^(once|off|on)/i);if(We!=null){let He=We[0].toLowerCase(),Ze=We.input,Ke=He==="off",ht=Z.baseInfo.id,Dt=Ze.slice(He.length),$t=Re[0],zr=Re[1];typeof $t=="string"&&typeof zr=="function"&&($t=$t.replace(/^logseq./,":"),Dt=`${Dt}${$t}`,$t=zr,zr=Re[2]),Dt=`hook:${B}:${b(Dt)}`,de[He](Dt,$t);let es=()=>{de.off(Dt,$t),de.listenerCount(Dt)||Z.App._uninstallPluginHook(ht,Dt)};return Ke?void es():(Z.App._installPluginHook(ht,Dt,zr),es)}}let nt=ve;return["git","ui","assets"].includes(B)&&(nt=B+"_"+nt),de.callAsync("api:call",{tag:B,method:nt,args:Re})}}})}_execCallableAPIAsync(E,...B){return this._caller.callAsync("api:call",{method:E,args:B})}_execCallableAPI(E,...B){this._caller.call("api:call",{method:E,args:B})}_callWin(...E){return this._execCallableAPIAsync("_callMainWin",...E)}get App(){return Ct(this,ka)?Ct(this,ka):et(this,ka,this._makeUserProxy(Fa,"app"))}get Editor(){return this._makeUserProxy(bt,"editor")}get DB(){return this._makeUserProxy(td,"db")}get Git(){return this._makeUserProxy(Bc,"git")}get UI(){return this._makeUserProxy(Oa,"ui")}get Assets(){return this._makeUserProxy(rd,"assets")}get FileStorage(){let E=this._mFileStorage;return E||(E=this._mFileStorage=new Q(this)),E}get Request(){let E=this._mRequest;return E||(E=this._mRequest=new re(this)),E}get Experiments(){let E=this._mExperiments;return E||(E=this._mExperiments=new ne(this)),E}}function Lo(T,E){return new Vu(T,E)}if(window.__LSP__HOST__==null){let T=new te(null);window.logseq=Lo({},T)}})(),o})())});var Uw=tt(fa=>{"use strict";var ji=fa&&fa.__classPrivateFieldGet||function(t,e,r,o){if(r==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!o:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?o:r==="a"?o.call(t):o?o.value:e.get(t)},ym=fa&&fa.__classPrivateFieldSet||function(t,e,r,o,n){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r},ys,go;Object.defineProperty(fa,"__esModule",{value:!0});var Cm=class{constructor(){ys.set(this,!1),go.set(this,new Set)}get acquired(){return ji(this,ys,"f")}acquireAsync({timeout:e}={}){if(!ji(this,ys,"f"))return ym(this,ys,!0,"f"),Promise.resolve();if(e==null)return new Promise(n=>{ji(this,go,"f").add(n)});let r,o;return Promise.race([new Promise(n=>{r=()=>{clearTimeout(o),n()},ji(this,go,"f").add(r)}),new Promise((n,s)=>{o=setTimeout(()=>{ji(this,go,"f").delete(r),s(new Error("Timed out waiting for lock"))},e)})])}tryAcquire(){return ji(this,ys,"f")?!1:(ym(this,ys,!0,"f"),!0)}release(){if(!ji(this,ys,"f"))throw new Error("Cannot release an unacquired lock");if(ji(this,go,"f").size>0){let[e]=ji(this,go,"f");ji(this,go,"f").delete(e),e()}else ym(this,ys,!1,"f")}};fa.default=Cm;ys=new WeakMap,go=new WeakMap});var xm=Fr(f1());var Kw=Fr(Go()),FP=Fr(uh()),Jw=Fr(I1()),OP=Fr(hp());var fh={exports:{}};function dA(t){return t==="description"||t==="string"||t==="code"}function $r(t,e,r){if(!dA(r))throw new Error("invalid Failure type: "+r);this.pexpr=t,this.text=e,this.type=r,this.fluffy=!1}$r.prototype.getPExpr=function(){return this.pexpr};$r.prototype.getText=function(){return this.text};$r.prototype.getType=function(){return this.type};$r.prototype.isDescription=function(){return this.type==="description"};$r.prototype.isStringTerminal=function(){return this.type==="string"};$r.prototype.isCode=function(){return this.type==="code"};$r.prototype.isFluffy=function(){return this.fluffy};$r.prototype.makeFluffy=function(){this.fluffy=!0};$r.prototype.clearFluffy=function(){this.fluffy=!1};$r.prototype.subsumes=function(t){return this.getText()===t.getText()&&this.type===t.type&&(!this.isFluffy()||this.isFluffy()&&t.isFluffy())};$r.prototype.toString=function(){return this.type==="string"?JSON.stringify(this.getText()):this.getText()};$r.prototype.clone=function(){let t=new $r(this.pexpr,this.text,this.type);return this.isFluffy()&&t.makeFluffy(),t};$r.prototype.toKey=function(){return this.toString()+"#"+this.type};var Z1=$r,Ft={};(function(t){let e={};for(let o=0;o<128;o++)e[o]=String.fromCharCode(o);e[39]="\\'",e[34]='\\"',e[92]="\\\\",e[8]="\\b",e[12]="\\f",e[10]="\\n",e[13]="\\r",e[9]="\\t",e[11]="\\v",t.abstract=function(o){let n=o||"";return function(){throw new Error("this method "+n+" is abstract! (it has no implementation in class "+this.constructor.name+")")}},t.assert=function(o,n){if(!o)throw new Error(n||"Assertion failed")},t.defineLazyProperty=function(o,n,s){let i;Object.defineProperty(o,n,{get(){return i||(i=s.call(this)),i}})},t.clone=function(o){return o&&Object.assign({},o)},t.repeatFn=function(o,n){let s=[];for(;n-- >0;)s.push(o());return s},t.repeatStr=function(o,n){return new Array(n+1).join(o)},t.repeat=function(o,n){return t.repeatFn(()=>o,n)},t.getDuplicates=function(o){let n=[];for(let s=0;s<o.length;s++){let i=o[s];o.lastIndexOf(i)!==s&&n.indexOf(i)<0&&n.push(i)}return n},t.copyWithoutDuplicates=function(o){let n=[];return o.forEach(s=>{n.indexOf(s)<0&&n.push(s)}),n},t.isSyntactic=function(o){let n=o[0];return n===n.toUpperCase()},t.isLexical=function(o){return!t.isSyntactic(o)},t.padLeft=function(o,n,s){let i=s||" ";return o.length<n?t.repeatStr(i,n-o.length)+o:o},t.StringBuffer=function(){this.strings=[]},t.StringBuffer.prototype.append=function(o){this.strings.push(o)},t.StringBuffer.prototype.contents=function(){return this.strings.join("")};let r=o=>String.fromCodePoint(parseInt(o,16));t.unescapeCodePoint=function(o){if(o.charAt(0)==="\\")switch(o.charAt(1)){case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";case"v":return"\v";case"x":return r(o.slice(2,4));case"u":return o.charAt(2)==="{"?r(o.slice(3,-1)):r(o.slice(2,6));default:return o.charAt(1)}else return o},t.unexpectedObjToString=function(o){if(o==null)return String(o);let n=Object.prototype.toString.call(o);try{let s;return o.constructor&&o.constructor.name?s=o.constructor.name:n.indexOf("[object ")===0?s=n.slice(8,-1):s=typeof o,s+": "+JSON.stringify(String(o))}catch{return n}}})(Ft);var M1=Ft,Ha=class{constructor(e){this.matchLength=e}get ctorName(){throw new Error("subclass responsibility")}numChildren(){return this.children?this.children.length:0}childAt(e){if(this.children)return this.children[e]}indexOfChild(e){return this.children.indexOf(e)}hasChildren(){return this.numChildren()>0}hasNoChildren(){return!this.hasChildren()}onlyChild(){if(this.numChildren()!==1)throw new Error("cannot get only child of a node of type "+this.ctorName+" (it has "+this.numChildren()+" children)");return this.firstChild()}firstChild(){if(this.hasNoChildren())throw new Error("cannot get first child of a "+this.ctorName+" node, which has no children");return this.childAt(0)}lastChild(){if(this.hasNoChildren())throw new Error("cannot get last child of a "+this.ctorName+" node, which has no children");return this.childAt(this.numChildren()-1)}childBefore(e){let r=this.indexOfChild(e);if(r<0)throw new Error("Node.childBefore() called w/ an argument that is not a child");if(r===0)throw new Error("cannot get child before first child");return this.childAt(r-1)}childAfter(e){let r=this.indexOfChild(e);if(r<0)throw new Error("Node.childAfter() called w/ an argument that is not a child");if(r===this.numChildren()-1)throw new Error("cannot get child after last child");return this.childAt(r+1)}isTerminal(){return!1}isNonterminal(){return!1}isIteration(){return!1}isOptional(){return!1}},gp=class extends Ha{get ctorName(){return"_terminal"}isTerminal(){return!0}get primitiveValue(){throw new Error("The `primitiveValue` property was removed in Ohm v17.")}},mp=class extends Ha{constructor(e,r,o,n){super(n),this.ruleName=e,this.children=r,this.childOffsets=o}get ctorName(){return this.ruleName}isNonterminal(){return!0}isLexical(){return M1.isLexical(this.ctorName)}isSyntactic(){return M1.isSyntactic(this.ctorName)}},vp=class extends Ha{constructor(e,r,o,n){super(o),this.children=e,this.childOffsets=r,this.optional=n}get ctorName(){return"_iter"}isIteration(){return!0}isOptional(){return this.optional}},Mp={Node:Ha,TerminalNode:gp,NonterminalNode:mp,IterationNode:vp},vt={},pA={Lu:/[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AE\uA7B0-\uA7B4\uA7B6\uFF21-\uFF3A]|\uD801[\uDC00-\uDC27\uDCB0-\uDCD3]|\uD803[\uDC80-\uDCB2]|\uD806[\uDCA0-\uDCBF]|\uD835[\uDC00-\uDC19\uDC34-\uDC4D\uDC68-\uDC81\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB5\uDCD0-\uDCE9\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD38\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD6C-\uDD85\uDDA0-\uDDB9\uDDD4-\uDDED\uDE08-\uDE21\uDE3C-\uDE55\uDE70-\uDE89\uDEA8-\uDEC0\uDEE2-\uDEFA\uDF1C-\uDF34\uDF56-\uDF6E\uDF90-\uDFA8\uDFCA]|\uD83A[\uDD00-\uDD21]/,Ll:/[a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0561-\u0587\u13F8-\u13FD\u1C80-\u1C88\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7B5\uA7B7\uA7FA\uAB30-\uAB5A\uAB60-\uAB65\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A]|\uD801[\uDC28-\uDC4F\uDCD8-\uDCFB]|\uD803[\uDCC0-\uDCF2]|\uD806[\uDCC0-\uDCDF]|\uD835[\uDC1A-\uDC33\uDC4E-\uDC54\uDC56-\uDC67\uDC82-\uDC9B\uDCB6-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDCEA-\uDD03\uDD1E-\uDD37\uDD52-\uDD6B\uDD86-\uDD9F\uDDBA-\uDDD3\uDDEE-\uDE07\uDE22-\uDE3B\uDE56-\uDE6F\uDE8A-\uDEA5\uDEC2-\uDEDA\uDEDC-\uDEE1\uDEFC-\uDF14\uDF16-\uDF1B\uDF36-\uDF4E\uDF50-\uDF55\uDF70-\uDF88\uDF8A-\uDF8F\uDFAA-\uDFC2\uDFC4-\uDFC9\uDFCB]|\uD83A[\uDD22-\uDD43]/,Lt:/[\u01C5\u01C8\u01CB\u01F2\u1F88-\u1F8F\u1F98-\u1F9F\u1FA8-\u1FAF\u1FBC\u1FCC\u1FFC]/,Lm:/[\u02B0-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0374\u037A\u0559\u0640\u06E5\u06E6\u07F4\u07F5\u07FA\u081A\u0824\u0828\u0971\u0E46\u0EC6\u10FC\u17D7\u1843\u1AA7\u1C78-\u1C7D\u1D2C-\u1D6A\u1D78\u1D9B-\u1DBF\u2071\u207F\u2090-\u209C\u2C7C\u2C7D\u2D6F\u2E2F\u3005\u3031-\u3035\u303B\u309D\u309E\u30FC-\u30FE\uA015\uA4F8-\uA4FD\uA60C\uA67F\uA69C\uA69D\uA717-\uA71F\uA770\uA788\uA7F8\uA7F9\uA9CF\uA9E6\uAA70\uAADD\uAAF3\uAAF4\uAB5C-\uAB5F\uFF70\uFF9E\uFF9F]|\uD81A[\uDF40-\uDF43]|\uD81B[\uDF93-\uDF9F\uDFE0]/,Lo:/[\xAA\xBA\u01BB\u01C0-\u01C3\u0294\u05D0-\u05EA\u05F0-\u05F2\u0620-\u063F\u0641-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u0800-\u0815\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0972-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E45\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10D0-\u10FA\u10FD-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17DC\u1820-\u1842\u1844-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C77\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u2135-\u2138\u2D30-\u2D67\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3006\u303C\u3041-\u3096\u309F\u30A1-\u30FA\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA014\uA016-\uA48C\uA4D0-\uA4F7\uA500-\uA60B\uA610-\uA61F\uA62A\uA62B\uA66E\uA6A0-\uA6E5\uA78F\uA7F7\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9E0-\uA9E4\uA9E7-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA6F\uAA71-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB\uAADC\uAAE0-\uAAEA\uAAF2\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF66-\uFF6F\uFF71-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC50-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,Nl:/[\u16EE-\u16F0\u2160-\u2182\u2185-\u2188\u3007\u3021-\u3029\u3038-\u303A\uA6E6-\uA6EF]|\uD800[\uDD40-\uDD74\uDF41\uDF4A\uDFD1-\uDFD5]|\uD809[\uDC00-\uDC6E]/,Nd:/[0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]|\uD801[\uDCA0-\uDCA9]|\uD804[\uDC66-\uDC6F\uDCF0-\uDCF9\uDD36-\uDD3F\uDDD0-\uDDD9\uDEF0-\uDEF9]|[\uD805\uD807][\uDC50-\uDC59\uDCD0-\uDCD9\uDE50-\uDE59\uDEC0-\uDEC9\uDF30-\uDF39]|\uD806[\uDCE0-\uDCE9]|\uD81A[\uDE60-\uDE69\uDF50-\uDF59]|\uD835[\uDFCE-\uDFFF]|\uD83A[\uDD50-\uDD59]/,Mn:/[\u0300-\u036F\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962\u0963\u0981\u09BC\u09C1-\u09C4\u09CD\u09E2\u09E3\u0A01\u0A02\u0A3C\u0A41\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7\u0AC8\u0ACD\u0AE2\u0AE3\u0B01\u0B3C\u0B3F\u0B41-\u0B44\u0B4D\u0B56\u0B62\u0B63\u0B82\u0BC0\u0BCD\u0C00\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81\u0CBC\u0CBF\u0CC6\u0CCC\u0CCD\u0CE2\u0CE3\u0D01\u0D41-\u0D44\u0D4D\u0D62\u0D63\u0DCA\u0DD2-\u0DD4\u0DD6\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039\u103A\u103D\u103E\u1058\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193B\u1A17\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ABD\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80\u1B81\u1BA2-\u1BA5\u1BA8\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u3099\u309A\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA825\uA826\uA8C4\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9E5\uAA29-\uAA2E\uAA31\uAA32\uAA35\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEC\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD804[\uDC01\uDC38-\uDC46\uDC7F-\uDC81\uDCB3-\uDCB6\uDCB9\uDCBA\uDD00-\uDD02\uDD27-\uDD2B\uDD2D-\uDD34\uDD73\uDD80\uDD81\uDDB6-\uDDBE\uDDCA-\uDDCC\uDE2F-\uDE31\uDE34\uDE36\uDE37\uDE3E\uDEDF\uDEE3-\uDEEA\uDF00\uDF01\uDF3C\uDF40\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC38-\uDC3F\uDC42-\uDC44\uDC46\uDCB3-\uDCB8\uDCBA\uDCBF\uDCC0\uDCC2\uDCC3\uDDB2-\uDDB5\uDDBC\uDDBD\uDDBF\uDDC0\uDDDC\uDDDD\uDE33-\uDE3A\uDE3D\uDE3F\uDE40\uDEAB\uDEAD\uDEB0-\uDEB5\uDEB7\uDF1D-\uDF1F\uDF22-\uDF25\uDF27-\uDF2B]|\uD807[\uDC30-\uDC36\uDC38-\uDC3D\uDC3F\uDC92-\uDCA7\uDCAA-\uDCB0\uDCB2\uDCB3\uDCB5\uDCB6]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF8F-\uDF92]|\uD82F[\uDC9D\uDC9E]|\uD834[\uDD67-\uDD69\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD4A]|\uDB40[\uDD00-\uDDEF]/,Mc:/[\u0903-\u0903]|[\u093E-\u0940]|[\u0949-\u094C]|[\u0982-\u0983]|[\u09BE-\u09C0]|[\u09C7-\u09C8]|[\u09CB-\u09CC]|[\u09D7-\u09D7]|[\u0A3E-\u0A40]|[\u0A83-\u0A83]|[\u0ABE-\u0AC0]|[\u0AC9-\u0AC9]|[\u0ACB-\u0ACC]|[\u0B02-\u0B03]|[\u0B3E-\u0B3E]|[\u0B40-\u0B40]|[\u0B47-\u0B48]|[\u0B4B-\u0B4C]|[\u0B57-\u0B57]|[\u0B83-\u0B83]|[\u0BBE-\u0BBF]|[\u0BC1-\u0BC2]|[\u0BC6-\u0BC8]|[\u0BCA-\u0BCC]|[\u0BD7-\u0BD7]|[\u0C01-\u0C03]|[\u0C41-\u0C44]|[\u0C82-\u0C83]|[\u0CBE-\u0CBE]|[\u0CC0-\u0CC4]|[\u0CC7-\u0CC8]|[\u0CCA-\u0CCB]|[\u0CD5-\u0CD6]|[\u0D02-\u0D03]|[\u0D3E-\u0D40]|[\u0D46-\u0D48]|[\u0D4A-\u0D4C]|[\u0D57-\u0D57]|[\u0F3E-\u0F3F]|[\u0F7F-\u0F7F]/,Pc:/[_\u203F\u2040\u2054\uFE33\uFE34\uFE4D-\uFE4F\uFF3F]/,Zs:/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,L:/[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,Ltmo:/[\u01C5\u01C8\u01CB\u01F2\u1F88-\u1F8F\u1F98-\u1F9F\u1FA8-\u1FAF\u1FBC\u1FCC\u1FFC]|[\u02B0-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0374\u037A\u0559\u0640\u06E5\u06E6\u07F4\u07F5\u07FA\u081A\u0824\u0828\u0971\u0E46\u0EC6\u10FC\u17D7\u1843\u1AA7\u1C78-\u1C7D\u1D2C-\u1D6A\u1D78\u1D9B-\u1DBF\u2071\u207F\u2090-\u209C\u2C7C\u2C7D\u2D6F\u2E2F\u3005\u3031-\u3035\u303B\u309D\u309E\u30FC-\u30FE\uA015\uA4F8-\uA4FD\uA60C\uA67F\uA69C\uA69D\uA717-\uA71F\uA770\uA788\uA7F8\uA7F9\uA9CF\uA9E6\uAA70\uAADD\uAAF3\uAAF4\uAB5C-\uAB5F\uFF70\uFF9E\uFF9F]|\uD81A[\uDF40-\uDF43]|\uD81B[\uDF93-\uDF9F\uDFE0]|[\xAA\xBA\u01BB\u01C0-\u01C3\u0294\u05D0-\u05EA\u05F0-\u05F2\u0620-\u063F\u0641-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u0800-\u0815\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0972-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E45\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10D0-\u10FA\u10FD-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17DC\u1820-\u1842\u1844-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C77\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u2135-\u2138\u2D30-\u2D67\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3006\u303C\u3041-\u3096\u309F\u30A1-\u30FA\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA014\uA016-\uA48C\uA4D0-\uA4F7\uA500-\uA60B\uA610-\uA61F\uA62A\uA62B\uA66E\uA6A0-\uA6E5\uA78F\uA7F7\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9E0-\uA9E4\uA9E7-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA6F\uAA71-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB\uAADC\uAAE0-\uAAEA\uAAF2\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF66-\uFF6F\uFF71-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC50-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/},gA=pA,mA=Ft,kr=class t{constructor(){if(this.constructor===t)throw new Error("PExpr cannot be instantiated -- it's abstract")}withSource(e){return e&&(this.source=e.trimmed()),this}},vA=Object.create(kr.prototype),yA=Object.create(kr.prototype),yp=class extends kr{constructor(e){super(),this.obj=e}},Cp=class extends kr{constructor(e,r){super(),this.from=e,this.to=r,this.matchCodePoint=e.length>1||r.length>1}},_p=class extends kr{constructor(e){super(),this.index=e}},fl=class extends kr{constructor(e){super(),this.terms=e}},wp=class extends fl{constructor(e,r,o){let n=e.rules[r].body;super([o,n]),this.superGrammar=e,this.name=r,this.body=o}},Sp=class extends fl{constructor(e,r,o,n){let s=e.rules[r].body;super([...o,s,...n]),this.superGrammar=e,this.ruleName=r,this.expansionPos=o.length}},bp=class extends kr{constructor(e){super(),this.factors=e}},Xa=class extends kr{constructor(e){super(),this.expr=e}},Ya=class extends Xa{},Va=class extends Xa{},qa=class extends Xa{};Ya.prototype.operator="*";Va.prototype.operator="+";qa.prototype.operator="?";Ya.prototype.minNumMatches=0;Va.prototype.minNumMatches=1;qa.prototype.minNumMatches=0;Ya.prototype.maxNumMatches=Number.POSITIVE_INFINITY;Va.prototype.maxNumMatches=Number.POSITIVE_INFINITY;qa.prototype.maxNumMatches=1;var xp=class extends kr{constructor(e){super(),this.expr=e}},Dp=class extends kr{constructor(e){super(),this.expr=e}},Ep=class extends kr{constructor(e){super(),this.expr=e}},Ap=class extends kr{constructor(e,r=[]){super(),this.ruleName=e,this.args=r}isSyntactic(){return mA.isSyntactic(this.ruleName)}toMemoKey(){return this._memoKey||Object.defineProperty(this,"_memoKey",{value:this.toString()}),this._memoKey}},Tp=class extends kr{constructor(e){super(),this.category=e,this.pattern=gA[e]}};vt.PExpr=kr;vt.any=vA;vt.end=yA;vt.Terminal=yp;vt.Range=Cp;vt.Param=_p;vt.Alt=fl;vt.Extend=wp;vt.Splice=Sp;vt.Seq=bp;vt.Iter=Xa;vt.Star=Ya;vt.Plus=Va;vt.Opt=qa;vt.Not=xp;vt.Lookahead=Dp;vt.Lex=Ep;vt.Apply=Ap;vt.UnicodeChar=Tp;var CA=Ft,ln=vt;ln.PExpr.prototype.allowsSkippingPrecedingSpace=CA.abstract("allowsSkippingPrecedingSpace");ln.any.allowsSkippingPrecedingSpace=ln.end.allowsSkippingPrecedingSpace=ln.Apply.prototype.allowsSkippingPrecedingSpace=ln.Terminal.prototype.allowsSkippingPrecedingSpace=ln.Range.prototype.allowsSkippingPrecedingSpace=ln.UnicodeChar.prototype.allowsSkippingPrecedingSpace=function(){return!0};ln.Alt.prototype.allowsSkippingPrecedingSpace=ln.Iter.prototype.allowsSkippingPrecedingSpace=ln.Lex.prototype.allowsSkippingPrecedingSpace=ln.Lookahead.prototype.allowsSkippingPrecedingSpace=ln.Not.prototype.allowsSkippingPrecedingSpace=ln.Param.prototype.allowsSkippingPrecedingSpace=ln.Seq.prototype.allowsSkippingPrecedingSpace=function(){return!1};function An(){}An.prototype=Object.create(null);An.asNamespace=function(t){return t instanceof An?t:An.createNamespace(t)};An.createNamespace=function(t){return An.extend(An.prototype,t)};An.extend=function(t,e){if(t!==An.prototype&&!(t instanceof An))throw new TypeError("not a Namespace object: "+t);let r=Object.create(t,{constructor:{value:An,enumerable:!1,writable:!0,configurable:!0}});return Object.assign(r,e)};An.toString=function(t){return Object.prototype.toString.call(t)};var ey=An,{assert:_A}=Ft,wA=ey,SA=vt;function Xt(t,e){let r;return e?(r=new Error(e.getLineAndColumnMessage()+t),r.shortMessage=t,r.interval=e):r=new Error(t),r}function bA(){return Xt("Interval sources don't match")}function xA(t){let e=new Error;return Object.defineProperty(e,"message",{enumerable:!0,get(){return t.message}}),Object.defineProperty(e,"shortMessage",{enumerable:!0,get(){return"Expected "+t.getExpectedText()}}),e.interval=t.getInterval(),e}function DA(t,e,r){let o=e?"Grammar "+t+" is not declared in namespace "+wA.toString(e):"Undeclared grammar "+t;return Xt(o,r)}function EA(t,e){return Xt("Grammar "+t.name+" is already declared in this namespace")}function AA(t,e,r){return Xt("Rule "+t+" is not declared in grammar "+e,r)}function TA(t,e,r){return Xt("Cannot override rule "+t+" because it is not declared in "+e,r)}function FA(t,e,r){return Xt("Cannot extend rule "+t+" because it is not declared in "+e,r)}function OA(t,e,r,o){let n="Duplicate declaration for rule '"+t+"' in grammar '"+e+"'";return e!==r&&(n+=" (originally declared in '"+r+"')"),Xt(n,o)}function kA(t,e,r,o){return Xt("Wrong number of parameters for rule "+t+" (expected "+e+", got "+r+")",o)}function PA(t,e,r,o){return Xt("Wrong number of arguments for rule "+t+" (expected "+e+", got "+r+")",o)}function IA(t,e,r){return Xt("Duplicate parameter names in rule "+t+": "+e.join(", "),r)}function BA(t,e){return Xt("Invalid parameter to rule "+t+": "+e+" has arity "+e.getArity()+", but parameter expressions must have arity 1",e.source)}var LA="NOTE: A _syntactic rule_ is a rule whose name begins with a capital letter. See https://ohmjs.org/d/svl for more details.";function MA(t,e){return Xt("Cannot apply syntactic rule "+t+" from here (inside a lexical context)",e.source)}function RA(t){let{ruleName:e}=t;return Xt(`applySyntactic is for syntactic rules, but '${e}' is a lexical rule. `+LA,t.source)}function jA(t){return Xt("applySyntactic is not required here (in a syntactic context)",t.source)}function NA(t,e){return Xt("Incorrect argument type: expected "+t,e.source)}function UA(t){return Xt("'...' can appear at most once in a rule body",t.source)}function zA(t){let e=t._node;_A(e&&e.isNonterminal()&&e.ctorName==="escapeChar_unicodeCodePoint");let r=t.children.slice(1,-1).map(n=>n.source),o=r[0].coverageWith(...r.slice(1));return Xt(`U+${o.contents} is not a valid Unicode code point`,o)}function WA(t,e){let r=e.length>0?e[e.length-1].args:[],n="Nullable expression "+t.expr.substituteParams(r)+" is not allowed inside '"+t.operator+"' (possible infinite loop)";if(e.length>0){let s=e.map(i=>new SA.Apply(i.ruleName,i.args)).join(`
`);n+=`
Application stack (most recent application last):
`+s}return Xt(n,t.expr.source)}function GA(t,e,r,o){return Xt("Rule "+t+" involves an alternation which has inconsistent arity (expected "+e+", got "+r+")",o.source)}function HA(t){return Xt("Object pattern has duplicate property names: "+t.join(", "))}function XA(t,e,r){return Xt("Attempt to invoke constructor "+e+" with invalid or unexpected arguments")}function YA(t){let e=t.map(r=>r.message);return Xt(["Errors:"].concat(e).join(`
- `),t[0].interval)}function VA(t,e,r,o){let n=o.slice(0,-1).map(l=>{let u="  "+l[0].name+" > "+l[1];return l.length===3?u+" for '"+l[2]+"'":u}).join(`
`);n+=`
  `+e+" > "+t;let s="";t==="_iter"&&(s=[`
NOTE: as of Ohm v16, there is no default action for iteration nodes \u2014 see `,"  https://ohmjs.org/d/dsa for details."].join(`
`));let i=[`Missing semantic action for '${t}' in ${r} '${e}'.${s}`,"Action stack (most recent call last):",n].join(`
`),a=Xt(i);return a.name="missingSemanticAction",a}var hs={applicationOfSyntacticRuleFromLexicalContext:MA,applySyntacticWithLexicalRuleApplication:RA,cannotExtendUndeclaredRule:FA,cannotOverrideUndeclaredRule:TA,duplicateGrammarDeclaration:EA,duplicateParameterNames:IA,duplicatePropertyNames:HA,duplicateRuleDeclaration:OA,inconsistentArity:GA,incorrectArgumentType:NA,intervalSourcesDontMatch:bA,invalidCodePoint:zA,invalidConstructorCall:XA,invalidParameter:BA,grammarSyntaxError:xA,kleeneExprHasNullableOperand:WA,missingSemanticAction:VA,multipleSuperSplices:UA,undeclaredGrammar:DA,undeclaredRule:AA,unnecessaryExperimentalApplySyntactic:jA,wrongNumberOfArguments:PA,wrongNumberOfParameters:kA,throwErrors(t){if(t.length===1)throw t[0];if(t.length>1)throw YA(t)}},Hs={};(function(t){let e=Ft;function r(i){let a=0;return i.map(u=>{let c=u.toString();return a=Math.max(a,c.length),c}).map(u=>e.padLeft(u,a))}function o(i,a,l){let u=i.length,c=i.slice(0,l),h=i.slice(l+a.length);return(c+a+h).substr(0,u)}function n(...i){let a=this,{offset:l}=a,{repeatStr:u}=e,c=new e.StringBuffer;c.append("Line "+a.lineNum+", col "+a.colNum+`:
`);let h=r([a.prevLine==null?0:a.lineNum-1,a.lineNum,a.nextLine==null?0:a.lineNum+1]),d=(C,b,k)=>{c.append(k+h[C]+" | "+b+`
`)};a.prevLine!=null&&d(0,a.prevLine,"  "),d(1,a.line,"> ");let g=a.line.length,m=u(" ",g+1);for(let C=0;C<i.length;++C){let b=i[C][0],k=i[C][1];e.assert(b>=0&&b<=k,"range start must be >= 0 and <= end");let L=l-a.colNum+1;b=Math.max(0,b-L),k=Math.min(k-L,g),m=o(m,u("~",k-b),b)}let y=2+h[1].length+3;return c.append(u(" ",y)),m=o(m,"^",a.colNum-1),c.append(m.replace(/ +$/,"")+`
`),a.nextLine!=null&&d(2,a.nextLine,"  "),c.contents()}let s=[];t.awaitBuiltInRules=i=>{s.push(i)},t.announceBuiltInRules=i=>{s.forEach(a=>{a(i)}),s=null},t.getLineAndColumn=(i,a)=>{let l=1,u=1,c=0,h=0,d=null,g=null,m=-1;for(;c<a;){let b=i.charAt(c++);b===`
`?(l++,u=1,m=h,h=c):b!=="\r"&&u++}let y=i.indexOf(`
`,h);if(y===-1)y=i.length;else{let b=i.indexOf(`
`,y+1);d=b===-1?i.slice(y):i.slice(y,b),d=d.replace(/^\r?\n/,"").replace(/\r$/,"")}m>=0&&(g=i.slice(m,h).replace(/\r?\n$/,""));let C=i.slice(h,y).replace(/\r$/,"");return{offset:a,lineNum:l,colNum:u,line:C,prevLine:g,nextLine:d,toString:n}},t.getLineAndColumnMessage=function(i,a,...l){return t.getLineAndColumn(i,a).toString(...l)},t.uniqueId=(()=>{let i=0;return a=>""+a+i++})()})(Hs);var{abstract:qA,isSyntactic:fp}=Ft,Ws=hs,yr=vt,$A=Hs,ll;$A.awaitBuiltInRules(t=>{ll=t});var lh;yr.PExpr.prototype.assertAllApplicationsAreValid=function(t,e){lh=0,this._assertAllApplicationsAreValid(t,e)};yr.PExpr.prototype._assertAllApplicationsAreValid=qA("_assertAllApplicationsAreValid");yr.any._assertAllApplicationsAreValid=yr.end._assertAllApplicationsAreValid=yr.Terminal.prototype._assertAllApplicationsAreValid=yr.Range.prototype._assertAllApplicationsAreValid=yr.Param.prototype._assertAllApplicationsAreValid=yr.UnicodeChar.prototype._assertAllApplicationsAreValid=function(t,e){};yr.Lex.prototype._assertAllApplicationsAreValid=function(t,e){lh++,this.expr._assertAllApplicationsAreValid(t,e),lh--};yr.Alt.prototype._assertAllApplicationsAreValid=function(t,e){for(let r=0;r<this.terms.length;r++)this.terms[r]._assertAllApplicationsAreValid(t,e)};yr.Seq.prototype._assertAllApplicationsAreValid=function(t,e){for(let r=0;r<this.factors.length;r++)this.factors[r]._assertAllApplicationsAreValid(t,e)};yr.Iter.prototype._assertAllApplicationsAreValid=yr.Not.prototype._assertAllApplicationsAreValid=yr.Lookahead.prototype._assertAllApplicationsAreValid=function(t,e){this.expr._assertAllApplicationsAreValid(t,e)};yr.Apply.prototype._assertAllApplicationsAreValid=function(t,e,r=!1){let o=e.rules[this.ruleName],n=fp(t)&&lh===0;if(!o)throw Ws.undeclaredRule(this.ruleName,e.name,this.source);if(!r&&fp(this.ruleName)&&!n)throw Ws.applicationOfSyntacticRuleFromLexicalContext(this.ruleName,this);let s=this.args.length,i=o.formals.length;if(s!==i)throw Ws.wrongNumberOfArguments(this.ruleName,i,s,this.source);let a=ll&&o===ll.rules.applySyntactic;if(ll&&o===ll.rules.caseInsensitive&&!(this.args[0]instanceof yr.Terminal))throw Ws.incorrectArgumentType('a Terminal (e.g. "abc")',this.args[0]);if(a){let u=this.args[0];if(!(u instanceof yr.Apply))throw Ws.incorrectArgumentType("a syntactic rule application",u);if(!fp(u.ruleName))throw Ws.applySyntacticWithLexicalRuleApplication(u);if(n)throw Ws.unnecessaryExperimentalApplySyntactic(this)}this.args.forEach(u=>{if(u._assertAllApplicationsAreValid(t,e,a),u.getArity()!==1)throw Ws.invalidParameter(this.ruleName,u)})};var KA=Ft,ty=hs,Yr=vt;Yr.PExpr.prototype.assertChoicesHaveUniformArity=KA.abstract("assertChoicesHaveUniformArity");Yr.any.assertChoicesHaveUniformArity=Yr.end.assertChoicesHaveUniformArity=Yr.Terminal.prototype.assertChoicesHaveUniformArity=Yr.Range.prototype.assertChoicesHaveUniformArity=Yr.Param.prototype.assertChoicesHaveUniformArity=Yr.Lex.prototype.assertChoicesHaveUniformArity=Yr.UnicodeChar.prototype.assertChoicesHaveUniformArity=function(t){};Yr.Alt.prototype.assertChoicesHaveUniformArity=function(t){if(this.terms.length===0)return;let e=this.terms[0].getArity();for(let r=0;r<this.terms.length;r++){let o=this.terms[r];o.assertChoicesHaveUniformArity();let n=o.getArity();if(e!==n)throw ty.inconsistentArity(t,e,n,o)}};Yr.Extend.prototype.assertChoicesHaveUniformArity=function(t){let e=this.terms[0].getArity(),r=this.terms[1].getArity();if(e!==r)throw ty.inconsistentArity(t,r,e,this.terms[0])};Yr.Seq.prototype.assertChoicesHaveUniformArity=function(t){for(let e=0;e<this.factors.length;e++)this.factors[e].assertChoicesHaveUniformArity(t)};Yr.Iter.prototype.assertChoicesHaveUniformArity=function(t){this.expr.assertChoicesHaveUniformArity(t)};Yr.Not.prototype.assertChoicesHaveUniformArity=function(t){};Yr.Lookahead.prototype.assertChoicesHaveUniformArity=function(t){this.expr.assertChoicesHaveUniformArity(t)};Yr.Apply.prototype.assertChoicesHaveUniformArity=function(t){};var JA=Ft,QA=hs,Vr=vt;Vr.PExpr.prototype.assertIteratedExprsAreNotNullable=JA.abstract("assertIteratedExprsAreNotNullable");Vr.any.assertIteratedExprsAreNotNullable=Vr.end.assertIteratedExprsAreNotNullable=Vr.Terminal.prototype.assertIteratedExprsAreNotNullable=Vr.Range.prototype.assertIteratedExprsAreNotNullable=Vr.Param.prototype.assertIteratedExprsAreNotNullable=Vr.UnicodeChar.prototype.assertIteratedExprsAreNotNullable=function(t){};Vr.Alt.prototype.assertIteratedExprsAreNotNullable=function(t){for(let e=0;e<this.terms.length;e++)this.terms[e].assertIteratedExprsAreNotNullable(t)};Vr.Seq.prototype.assertIteratedExprsAreNotNullable=function(t){for(let e=0;e<this.factors.length;e++)this.factors[e].assertIteratedExprsAreNotNullable(t)};Vr.Iter.prototype.assertIteratedExprsAreNotNullable=function(t){if(this.expr.assertIteratedExprsAreNotNullable(t),this.expr.isNullable(t))throw QA.kleeneExprHasNullableOperand(this,[])};Vr.Opt.prototype.assertIteratedExprsAreNotNullable=Vr.Not.prototype.assertIteratedExprsAreNotNullable=Vr.Lookahead.prototype.assertIteratedExprsAreNotNullable=Vr.Lex.prototype.assertIteratedExprsAreNotNullable=function(t){this.expr.assertIteratedExprsAreNotNullable(t)};Vr.Apply.prototype.assertIteratedExprsAreNotNullable=function(t){this.args.forEach(e=>{e.assertIteratedExprsAreNotNullable(t)})};var{assert:ZA}=Ft,Fp=hs,R1=Hs;function Xr(t,e,r){this.sourceString=t,this.startIdx=e,this.endIdx=r}Xr.coverage=function(t,...e){let{startIdx:r,endIdx:o}=t;for(let n of e){if(n.sourceString!==t.sourceString)throw Fp.intervalSourcesDontMatch();r=Math.min(r,n.startIdx),o=Math.max(o,n.endIdx)}return new Xr(t.sourceString,r,o)};Xr.prototype={coverageWith(...t){return Xr.coverage(...t,this)},collapsedLeft(){return new Xr(this.sourceString,this.startIdx,this.startIdx)},collapsedRight(){return new Xr(this.sourceString,this.endIdx,this.endIdx)},getLineAndColumn(){return R1.getLineAndColumn(this.sourceString,this.startIdx)},getLineAndColumnMessage(){let t=[this.startIdx,this.endIdx];return R1.getLineAndColumnMessage(this.sourceString,this.startIdx,t)},minus(t){if(this.sourceString!==t.sourceString)throw Fp.intervalSourcesDontMatch();return this.startIdx===t.startIdx&&this.endIdx===t.endIdx?[]:this.startIdx<t.startIdx&&t.endIdx<this.endIdx?[new Xr(this.sourceString,this.startIdx,t.startIdx),new Xr(this.sourceString,t.endIdx,this.endIdx)]:this.startIdx<t.endIdx&&t.endIdx<this.endIdx?[new Xr(this.sourceString,t.endIdx,this.endIdx)]:this.startIdx<t.startIdx&&t.startIdx<this.endIdx?[new Xr(this.sourceString,this.startIdx,t.startIdx)]:[this]},relativeTo(t){if(this.sourceString!==t.sourceString)throw Fp.intervalSourcesDontMatch();return ZA(this.startIdx>=t.startIdx&&this.endIdx<=t.endIdx,"other interval does not cover this one"),new Xr(this.sourceString,this.startIdx-t.startIdx,this.endIdx-t.startIdx)},trimmed(){let{contents:t}=this,e=this.startIdx+t.match(/^\s*/)[0].length,r=this.endIdx-t.match(/\s*$/)[0].length;return new Xr(this.sourceString,e,r)},subInterval(t,e){let r=this.startIdx+t;return new Xr(this.sourceString,r,r+e)}};Object.defineProperties(Xr.prototype,{contents:{get(){return this._contents===void 0&&(this._contents=this.sourceString.slice(this.startIdx,this.endIdx)),this._contents},enumerable:!0},length:{get(){return this.endIdx-this.startIdx},enumerable:!0}});var Rp=Xr,eT=Rp,jp=Ft,tT="\u2717",rT="\u2713",nT="\u22C5",iT="\u21D2",sT="\u2409",oT="\u240A",aT="\u240D",Op={succeeded:1,isRootNode:2,isImplicitSpaces:4,isMemoized:8,isHeadOfLeftRecursion:16,terminatesLR:32};function uT(t){return jp.repeat(" ",t).join("")}function lT(t,e,r){let o=ry(t.slice(e,e+r));return o.length<r?o+jp.repeat(" ",r-o.length).join(""):o}function ry(t){return typeof t=="string"?t.replace(/ /g,nT).replace(/\t/g,sT).replace(/\n/g,oT).replace(/\r/g,aT):String(t)}function Xn(t,e,r,o,n,s,i){this.input=t,this.pos=this.pos1=e,this.pos2=r,this.source=new eT(t,e,r),this.expr=o,this.bindings=s,this.children=i||[],this.terminatingLREntry=null,this._flags=n?Op.succeeded:0}Xn.prototype.SKIP={};Object.defineProperty(Xn.prototype,"displayString",{get(){return this.expr.toDisplayString()}});Object.keys(Op).forEach(t=>{let e=Op[t];Object.defineProperty(Xn.prototype,t,{get(){return(this._flags&e)!==0},set(r){r?this._flags|=e:this._flags&=~e}})});Xn.prototype.clone=function(){return this.cloneWithExpr(this.expr)};Xn.prototype.cloneWithExpr=function(t){let e=new Xn(this.input,this.pos,this.pos2,t,this.succeeded,this.bindings,this.children);return e.isHeadOfLeftRecursion=this.isHeadOfLeftRecursion,e.isImplicitSpaces=this.isImplicitSpaces,e.isMemoized=this.isMemoized,e.isRootNode=this.isRootNode,e.terminatesLR=this.terminatesLR,e.terminatingLREntry=this.terminatingLREntry,e};Xn.prototype.recordLRTermination=function(t,e){this.terminatingLREntry=new Xn(this.input,this.pos,this.pos2,this.expr,!1,[e],[t]),this.terminatingLREntry.terminatesLR=!0};Xn.prototype.walk=function(t,e){let r=t;typeof r=="function"&&(r={enter:r});function o(n,s,i){let a=!0;r.enter&&r.enter.call(e,n,s,i)===Xn.prototype.SKIP&&(a=!1),a&&(n.children.forEach(l=>{o(l,n,i+1)}),r.exit&&r.exit.call(e,n,s,i))}this.isRootNode?this.children.forEach(n=>{o(n,null,0)}):o(this,null,0)};Xn.prototype.toString=function(){let t=new jp.StringBuffer;return this.walk((e,r,o)=>{if(!e)return this.SKIP;if(e.expr.constructor.name!=="Alt"){if(t.append(lT(e.input,e.pos,10)+uT(o*2+1)),t.append((e.succeeded?rT:tT)+" "+e.displayString),e.isHeadOfLeftRecursion&&t.append(" (LR)"),e.succeeded){let s=ry(e.source.contents);t.append(" "+iT+"  "),t.append(typeof s=="string"?'"'+s+'"':s)}t.append(`
`)}}),t.contents()};var ny=Xn,cT=ny,iy=Ft,hT=hs,Np=Mp,cr=vt,{TerminalNode:pl}=Np,{NonterminalNode:fT}=Np,{IterationNode:dT}=Np;cr.PExpr.prototype.eval=iy.abstract("eval");cr.any.eval=function(t){let{inputStream:e}=t,r=e.pos,o=e.next();return o?(t.pushBinding(new pl(o.length),r),!0):(t.processFailure(r,this),!1)};cr.end.eval=function(t){let{inputStream:e}=t,r=e.pos;return e.atEnd()?(t.pushBinding(new pl(0),r),!0):(t.processFailure(r,this),!1)};cr.Terminal.prototype.eval=function(t){let{inputStream:e}=t,r=e.pos;return e.matchString(this.obj)?(t.pushBinding(new pl(this.obj.length),r),!0):(t.processFailure(r,this),!1)};cr.Range.prototype.eval=function(t){let{inputStream:e}=t,r=e.pos,o=this.matchCodePoint?e.nextCodePoint():e.nextCharCode();return o!==void 0&&this.from.codePointAt(0)<=o&&o<=this.to.codePointAt(0)?(t.pushBinding(new pl(String.fromCodePoint(o).length),r),!0):(t.processFailure(r,this),!1)};cr.Param.prototype.eval=function(t){return t.eval(t.currentApplication().args[this.index])};cr.Lex.prototype.eval=function(t){t.enterLexifiedContext();let e=t.eval(this.expr);return t.exitLexifiedContext(),e};cr.Alt.prototype.eval=function(t){for(let e=0;e<this.terms.length;e++)if(t.eval(this.terms[e]))return!0;return!1};cr.Seq.prototype.eval=function(t){for(let e=0;e<this.factors.length;e++){let r=this.factors[e];if(!t.eval(r))return!1}return!0};cr.Iter.prototype.eval=function(t){let{inputStream:e}=t,r=e.pos,o=this.getArity(),n=[],s=[];for(;n.length<o;)n.push([]),s.push([]);let i=0,a=r,l;for(;i<this.maxNumMatches&&t.eval(this.expr);){if(e.pos===a)throw hT.kleeneExprHasNullableOperand(this,t._applicationStack);a=e.pos,i++;let d=t._bindings.splice(t._bindings.length-o,o),g=t._bindingOffsets.splice(t._bindingOffsets.length-o,o);for(l=0;l<d.length;l++)n[l].push(d[l]),s[l].push(g[l])}if(i<this.minNumMatches)return!1;let u=t.posToOffset(r),c=0;if(i>0){let d=n[o-1],g=s[o-1],m=g[g.length-1]+d[d.length-1].matchLength;u=s[0][0],c=m-u}let h=this instanceof cr.Opt;for(l=0;l<n.length;l++)t._bindings.push(new dT(n[l],s[l],c,h)),t._bindingOffsets.push(u);return!0};cr.Not.prototype.eval=function(t){let{inputStream:e}=t,r=e.pos;t.pushFailuresInfo();let o=t.eval(this.expr);return t.popFailuresInfo(),o?(t.processFailure(r,this),!1):(e.pos=r,!0)};cr.Lookahead.prototype.eval=function(t){let{inputStream:e}=t,r=e.pos;return t.eval(this.expr)?(e.pos=r,!0):!1};cr.Apply.prototype.eval=function(t){let e=t.currentApplication(),r=e?e.args:[],o=this.substituteParams(r),n=t.getCurrentPosInfo();if(n.isActive(o))return o.handleCycle(t);let s=o.toMemoKey(),i=n.memo[s];if(i&&n.shouldUseMemoizedResult(i)){if(t.hasNecessaryInfo(i))return t.useMemoizedResult(t.inputStream.pos,i);delete n.memo[s]}return o.reallyEval(t)};cr.Apply.prototype.handleCycle=function(t){let e=t.getCurrentPosInfo(),{currentLeftRecursion:r}=e,o=this.toMemoKey(),n=e.memo[o];return r&&r.headApplication.toMemoKey()===o?n.updateInvolvedApplicationMemoKeys():n||(n=e.memoize(o,{matchLength:0,examinedLength:0,value:!1,rightmostFailureOffset:-1}),e.startLeftRecursion(this,n)),t.useMemoizedResult(t.inputStream.pos,n)};cr.Apply.prototype.reallyEval=function(t){let{inputStream:e}=t,r=e.pos,o=t.getCurrentPosInfo(),n=t.grammar.rules[this.ruleName],{body:s}=n,{description:i}=n;t.enterApplication(o,this),i&&t.pushFailuresInfo();let a=e.examinedLength;e.examinedLength=0;let l=this.evalOnce(s,t),u=o.currentLeftRecursion,c=this.toMemoKey(),h=u&&u.headApplication.toMemoKey()===c,d;h?(l=this.growSeedResult(s,t,r,u,l),o.endLeftRecursion(),d=u,d.examinedLength=e.examinedLength-r,d.rightmostFailureOffset=t._getRightmostFailureOffset(),o.memoize(c,d)):(!u||!u.isInvolved(c))&&(d=o.memoize(c,{matchLength:e.pos-r,examinedLength:e.examinedLength-r,value:l,failuresAtRightmostPosition:t.cloneRecordedFailures(),rightmostFailureOffset:t._getRightmostFailureOffset()}));let g=!!l;if(i&&(t.popFailuresInfo(),g||t.processFailure(r,this),d&&(d.failuresAtRightmostPosition=t.cloneRecordedFailures())),t.isTracing()&&d){let m=t.getTraceEntry(r,this,g,g?[l]:[]);h&&(iy.assert(m.terminatingLREntry!=null||!g),m.isHeadOfLeftRecursion=!0),d.traceEntry=m}return e.examinedLength=Math.max(e.examinedLength,a),t.exitApplication(o,l),g};cr.Apply.prototype.evalOnce=function(t,e){let{inputStream:r}=e,o=r.pos;if(e.eval(t)){let n=t.getArity(),s=e._bindings.splice(e._bindings.length-n,n),i=e._bindingOffsets.splice(e._bindingOffsets.length-n,n),a=r.pos-o;return new fT(this.ruleName,s,i,a)}else return!1};cr.Apply.prototype.growSeedResult=function(t,e,r,o,n){if(!n)return!1;let{inputStream:s}=e;for(;;){if(o.matchLength=s.pos-r,o.value=n,o.failuresAtRightmostPosition=e.cloneRecordedFailures(),e.isTracing()){let i=e.trace[e.trace.length-1];o.traceEntry=new cT(e.input,r,s.pos,this,!0,[n],[i.clone()])}if(s.pos=r,n=this.evalOnce(t,e),s.pos-r<=o.matchLength)break;e.isTracing()&&e.trace.splice(-2,1)}return e.isTracing()&&o.traceEntry.recordLRTermination(e.trace.pop(),n),s.pos=r+o.matchLength,o.value};cr.UnicodeChar.prototype.eval=function(t){let{inputStream:e}=t,r=e.pos,o=e.next();return o&&this.pattern.test(o)?(t.pushBinding(new pl(o.length),r),!0):(t.processFailure(r,this),!1)};var pT=Ft,cn=vt;cn.PExpr.prototype.getArity=pT.abstract("getArity");cn.any.getArity=cn.end.getArity=cn.Terminal.prototype.getArity=cn.Range.prototype.getArity=cn.Param.prototype.getArity=cn.Apply.prototype.getArity=cn.UnicodeChar.prototype.getArity=function(){return 1};cn.Alt.prototype.getArity=function(){return this.terms.length===0?0:this.terms[0].getArity()};cn.Seq.prototype.getArity=function(){let t=0;for(let e=0;e<this.factors.length;e++)t+=this.factors[e].getArity();return t};cn.Iter.prototype.getArity=function(){return this.expr.getArity()};cn.Not.prototype.getArity=function(){return 0};cn.Lookahead.prototype.getArity=cn.Lex.prototype.getArity=function(){return this.expr.getArity()};var gT=Ft,pr=vt;function di(t,e){let r={};if(t.source&&e){let o=t.source.relativeTo(e);r.sourceInterval=[o.startIdx,o.endIdx]}return r}pr.PExpr.prototype.outputRecipe=gT.abstract("outputRecipe");pr.any.outputRecipe=function(t,e){return["any",di(this,e)]};pr.end.outputRecipe=function(t,e){return["end",di(this,e)]};pr.Terminal.prototype.outputRecipe=function(t,e){return["terminal",di(this,e),this.obj]};pr.Range.prototype.outputRecipe=function(t,e){return["range",di(this,e),this.from,this.to]};pr.Param.prototype.outputRecipe=function(t,e){return["param",di(this,e),this.index]};pr.Alt.prototype.outputRecipe=function(t,e){return["alt",di(this,e)].concat(this.terms.map(r=>r.outputRecipe(t,e)))};pr.Extend.prototype.outputRecipe=function(t,e){return this.terms[0].outputRecipe(t,e)};pr.Splice.prototype.outputRecipe=function(t,e){let r=this.terms.slice(0,this.expansionPos),o=this.terms.slice(this.expansionPos+1);return["splice",di(this,e),r.map(n=>n.outputRecipe(t,e)),o.map(n=>n.outputRecipe(t,e))]};pr.Seq.prototype.outputRecipe=function(t,e){return["seq",di(this,e)].concat(this.factors.map(r=>r.outputRecipe(t,e)))};pr.Star.prototype.outputRecipe=pr.Plus.prototype.outputRecipe=pr.Opt.prototype.outputRecipe=pr.Not.prototype.outputRecipe=pr.Lookahead.prototype.outputRecipe=pr.Lex.prototype.outputRecipe=function(t,e){return[this.constructor.name.toLowerCase(),di(this,e),this.expr.outputRecipe(t,e)]};pr.Apply.prototype.outputRecipe=function(t,e){return["app",di(this,e),this.ruleName,this.args.map(r=>r.outputRecipe(t,e))]};pr.UnicodeChar.prototype.outputRecipe=function(t,e){return["unicodeChar",di(this,e),this.category]};var mT=Ft,qr=vt;qr.PExpr.prototype.introduceParams=mT.abstract("introduceParams");qr.any.introduceParams=qr.end.introduceParams=qr.Terminal.prototype.introduceParams=qr.Range.prototype.introduceParams=qr.Param.prototype.introduceParams=qr.UnicodeChar.prototype.introduceParams=function(t){return this};qr.Alt.prototype.introduceParams=function(t){return this.terms.forEach((e,r,o)=>{o[r]=e.introduceParams(t)}),this};qr.Seq.prototype.introduceParams=function(t){return this.factors.forEach((e,r,o)=>{o[r]=e.introduceParams(t)}),this};qr.Iter.prototype.introduceParams=qr.Not.prototype.introduceParams=qr.Lookahead.prototype.introduceParams=qr.Lex.prototype.introduceParams=function(t){return this.expr=this.expr.introduceParams(t),this};qr.Apply.prototype.introduceParams=function(t){let e=t.indexOf(this.ruleName);if(e>=0){if(this.args.length>0)throw new Error("Parameterized rules cannot be passed as arguments to another rule.");return new qr.Param(e).withSource(this.source)}else return this.args.forEach((r,o,n)=>{n[o]=r.introduceParams(t)}),this};var vT=Ft,Cr=vt;Cr.PExpr.prototype.isNullable=function(t){return this._isNullable(t,Object.create(null))};Cr.PExpr.prototype._isNullable=vT.abstract("_isNullable");Cr.any._isNullable=Cr.Range.prototype._isNullable=Cr.Param.prototype._isNullable=Cr.Plus.prototype._isNullable=Cr.UnicodeChar.prototype._isNullable=function(t,e){return!1};Cr.end._isNullable=function(t,e){return!0};Cr.Terminal.prototype._isNullable=function(t,e){return typeof this.obj=="string"?this.obj==="":!1};Cr.Alt.prototype._isNullable=function(t,e){return this.terms.length===0||this.terms.some(r=>r._isNullable(t,e))};Cr.Seq.prototype._isNullable=function(t,e){return this.factors.every(r=>r._isNullable(t,e))};Cr.Star.prototype._isNullable=Cr.Opt.prototype._isNullable=Cr.Not.prototype._isNullable=Cr.Lookahead.prototype._isNullable=function(t,e){return!0};Cr.Lex.prototype._isNullable=function(t,e){return this.expr._isNullable(t,e)};Cr.Apply.prototype._isNullable=function(t,e){let r=this.toMemoKey();if(!Object.prototype.hasOwnProperty.call(e,r)){let{body:o}=t.rules[this.ruleName],n=o.substituteParams(this.args);e[r]=!1,e[r]=n._isNullable(t,e)}return e[r]};var yT=Ft,_r=vt;_r.PExpr.prototype.substituteParams=yT.abstract("substituteParams");_r.any.substituteParams=_r.end.substituteParams=_r.Terminal.prototype.substituteParams=_r.Range.prototype.substituteParams=_r.UnicodeChar.prototype.substituteParams=function(t){return this};_r.Param.prototype.substituteParams=function(t){return t[this.index]};_r.Alt.prototype.substituteParams=function(t){return new _r.Alt(this.terms.map(e=>e.substituteParams(t)))};_r.Seq.prototype.substituteParams=function(t){return new _r.Seq(this.factors.map(e=>e.substituteParams(t)))};_r.Iter.prototype.substituteParams=_r.Not.prototype.substituteParams=_r.Lookahead.prototype.substituteParams=_r.Lex.prototype.substituteParams=function(t){return new this.constructor(this.expr.substituteParams(t))};_r.Apply.prototype.substituteParams=function(t){if(this.args.length===0)return this;{let e=this.args.map(r=>r.substituteParams(t));return new _r.Apply(this.ruleName,e)}};var sy=Ft,Kr=vt,{copyWithoutDuplicates:CT}=sy;function j1(t){return/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)}function Up(t){let e=Object.create(null);t.forEach(r=>{e[r]=(e[r]||0)+1}),Object.keys(e).forEach(r=>{if(e[r]<=1)return;let o=1;t.forEach((n,s)=>{n===r&&(t[s]=n+"_"+o++)})})}Kr.PExpr.prototype.toArgumentNameList=sy.abstract("toArgumentNameList");Kr.any.toArgumentNameList=function(t,e){return["any"]};Kr.end.toArgumentNameList=function(t,e){return["end"]};Kr.Terminal.prototype.toArgumentNameList=function(t,e){return typeof this.obj=="string"&&/^[_a-zA-Z0-9]+$/.test(this.obj)?["_"+this.obj]:["$"+t]};Kr.Range.prototype.toArgumentNameList=function(t,e){let r=this.from+"_to_"+this.to;return j1(r)||(r="_"+r),j1(r)||(r="$"+t),[r]};Kr.Alt.prototype.toArgumentNameList=function(t,e){let r=this.terms.map(s=>s.toArgumentNameList(t,!0)),o=[],n=r[0].length;for(let s=0;s<n;s++){let i=[];for(let l=0;l<this.terms.length;l++)i.push(r[l][s]);let a=CT(i);o.push(a.join("_or_"))}return e||Up(o),o};Kr.Seq.prototype.toArgumentNameList=function(t,e){let r=[];return this.factors.forEach(o=>{let n=o.toArgumentNameList(t,!0);r=r.concat(n),t+=n.length}),e||Up(r),r};Kr.Iter.prototype.toArgumentNameList=function(t,e){let r=this.expr.toArgumentNameList(t,e).map(o=>o[o.length-1]==="s"?o+"es":o+"s");return e||Up(r),r};Kr.Opt.prototype.toArgumentNameList=function(t,e){return this.expr.toArgumentNameList(t,e).map(r=>"opt"+r[0].toUpperCase()+r.slice(1))};Kr.Not.prototype.toArgumentNameList=function(t,e){return[]};Kr.Lookahead.prototype.toArgumentNameList=Kr.Lex.prototype.toArgumentNameList=function(t,e){return this.expr.toArgumentNameList(t,e)};Kr.Apply.prototype.toArgumentNameList=function(t,e){return[this.ruleName]};Kr.UnicodeChar.prototype.toArgumentNameList=function(t,e){return["$"+t]};Kr.Param.prototype.toArgumentNameList=function(t,e){return["param"+this.index]};var _T=Ft,un=vt;un.PExpr.prototype.toDisplayString=_T.abstract("toDisplayString");un.Alt.prototype.toDisplayString=un.Seq.prototype.toDisplayString=function(){return this.source?this.source.trimmed().contents:"["+this.constructor.name+"]"};un.any.toDisplayString=un.end.toDisplayString=un.Iter.prototype.toDisplayString=un.Not.prototype.toDisplayString=un.Lookahead.prototype.toDisplayString=un.Lex.prototype.toDisplayString=un.Terminal.prototype.toDisplayString=un.Range.prototype.toDisplayString=un.Param.prototype.toDisplayString=function(){return this.toString()};un.Apply.prototype.toDisplayString=function(){if(this.args.length>0){let t=this.args.map(e=>e.toDisplayString());return this.ruleName+"<"+t.join(",")+">"}else return this.ruleName};un.UnicodeChar.prototype.toDisplayString=function(){return"Unicode ["+this.category+"] character"};var Oi=Z1,wT=Ft,Tn=vt;Tn.PExpr.prototype.toFailure=wT.abstract("toFailure");Tn.any.toFailure=function(t){return new Oi(this,"any object","description")};Tn.end.toFailure=function(t){return new Oi(this,"end of input","description")};Tn.Terminal.prototype.toFailure=function(t){return new Oi(this,this.obj,"string")};Tn.Range.prototype.toFailure=function(t){return new Oi(this,JSON.stringify(this.from)+".."+JSON.stringify(this.to),"code")};Tn.Not.prototype.toFailure=function(t){let e=this.expr===Tn.any?"nothing":"not "+this.expr.toFailure(t);return new Oi(this,e,"description")};Tn.Lookahead.prototype.toFailure=function(t){return this.expr.toFailure(t)};Tn.Apply.prototype.toFailure=function(t){let{description:e}=t.rules[this.ruleName];return e||(e=(/^[aeiouAEIOU]/.test(this.ruleName)?"an":"a")+" "+this.ruleName),new Oi(this,e,"description")};Tn.UnicodeChar.prototype.toFailure=function(t){return new Oi(this,"a Unicode ["+this.category+"] character","description")};Tn.Alt.prototype.toFailure=function(t){let r="("+this.terms.map(o=>o.toFailure(t)).join(" or ")+")";return new Oi(this,r,"description")};Tn.Seq.prototype.toFailure=function(t){let r="("+this.factors.map(o=>o.toFailure(t)).join(" ")+")";return new Oi(this,r,"description")};Tn.Iter.prototype.toFailure=function(t){let e="("+this.expr.toFailure(t)+this.operator+")";return new Oi(this,e,"description")};var ST=Ft,hn=vt;hn.PExpr.prototype.toString=ST.abstract("toString");hn.any.toString=function(){return"any"};hn.end.toString=function(){return"end"};hn.Terminal.prototype.toString=function(){return JSON.stringify(this.obj)};hn.Range.prototype.toString=function(){return JSON.stringify(this.from)+".."+JSON.stringify(this.to)};hn.Param.prototype.toString=function(){return"$"+this.index};hn.Lex.prototype.toString=function(){return"#("+this.expr.toString()+")"};hn.Alt.prototype.toString=function(){return this.terms.length===1?this.terms[0].toString():"("+this.terms.map(t=>t.toString()).join(" | ")+")"};hn.Seq.prototype.toString=function(){return this.factors.length===1?this.factors[0].toString():"("+this.factors.map(t=>t.toString()).join(" ")+")"};hn.Iter.prototype.toString=function(){return this.expr+this.operator};hn.Not.prototype.toString=function(){return"~"+this.expr};hn.Lookahead.prototype.toString=function(){return"&"+this.expr};hn.Apply.prototype.toString=function(){if(this.args.length>0){let t=this.args.map(e=>e.toString());return this.ruleName+"<"+t.join(",")+">"}else return this.ruleName};hn.UnicodeChar.prototype.toString=function(){return"\\p{"+this.category+"}"};var Vo=vt,bT=Z1,{TerminalNode:xT}=Mp,{assert:DT}=Ft,{PExpr:ET,Terminal:AT}=Vo,kp=class t extends ET{constructor(e){super(),this.obj=e}_getString(e){let r=e.currentApplication().args[this.obj.index];return DT(r instanceof AT,"expected a Terminal expression"),r.obj}allowsSkippingPrecedingSpace(){return!0}eval(e){let{inputStream:r}=e,o=r.pos,n=this._getString(e);return r.matchString(n,!0)?(e.pushBinding(new xT(n.length),o),!0):(e.processFailure(o,this),!1)}getArity(){return 1}substituteParams(e){return new t(this.obj.substituteParams(e))}toDisplayString(){return this.obj.toDisplayString()+" (case-insensitive)"}toFailure(e){return new bT(this,this.obj.toFailure(e)+" (case-insensitive)","description")}_isNullable(e,r){return this.obj._isNullable(e,r)}},TT=kp,FT=Rp;function oy(t){this.source=t,this.pos=0,this.examinedLength=0}oy.prototype={atEnd(){let t=this.pos===this.source.length;return this.examinedLength=Math.max(this.examinedLength,this.pos+1),t},next(){let t=this.source[this.pos++];return this.examinedLength=Math.max(this.examinedLength,this.pos),t},nextCharCode(){let t=this.next();return t&&t.charCodeAt(0)},nextCodePoint(){let t=this.source.slice(this.pos++).codePointAt(0);return t>65535&&(this.pos+=1),this.examinedLength=Math.max(this.examinedLength,this.pos),t},matchString(t,e){let r;if(e){for(r=0;r<t.length;r++){let o=this.next(),n=t[r];if(o==null||o.toUpperCase()!==n.toUpperCase())return!1}return!0}for(r=0;r<t.length;r++)if(this.next()!==t[r])return!1;return!0},sourceSlice(t,e){return this.source.slice(t,e)},interval(t,e){return new FT(this.source,t,e||this.pos)}};var zp=oy,Pp=Ft,N1=Hs,OT=Rp;function Xs(t,e,r,o,n,s,i){this.matcher=t,this.input=e,this.startExpr=r,this._cst=o,this._cstOffset=n,this._rightmostFailurePosition=s,this._rightmostFailures=i,this.failed()&&(Pp.defineLazyProperty(this,"message",function(){let a="Expected "+this.getExpectedText();return N1.getLineAndColumnMessage(this.input,this.getRightmostFailurePosition())+a}),Pp.defineLazyProperty(this,"shortMessage",function(){let a="expected "+this.getExpectedText(),l=N1.getLineAndColumn(this.input,this.getRightmostFailurePosition());return"Line "+l.lineNum+", col "+l.colNum+": "+a}))}Xs.prototype.succeeded=function(){return!!this._cst};Xs.prototype.failed=function(){return!this.succeeded()};Xs.prototype.getRightmostFailurePosition=function(){return this._rightmostFailurePosition};Xs.prototype.getRightmostFailures=function(){if(!this._rightmostFailures){this.matcher.setInput(this.input);let t=this.matcher._match(this.startExpr,!1,this.getRightmostFailurePosition());this._rightmostFailures=t.getRightmostFailures()}return this._rightmostFailures};Xs.prototype.toString=function(){return this.succeeded()?"[match succeeded]":"[match failed at position "+this.getRightmostFailurePosition()+"]"};Xs.prototype.getExpectedText=function(){if(this.succeeded())throw new Error("cannot get expected text of a successful MatchResult");let t=new Pp.StringBuffer,e=this.getRightmostFailures();e=e.filter(r=>!r.isFluffy());for(let r=0;r<e.length;r++)r>0&&(r===e.length-1?t.append(e.length>2?", or ":" or "):t.append(", ")),t.append(e[r].toString());return t.contents()};Xs.prototype.getInterval=function(){let t=this.getRightmostFailurePosition();return new OT(this.input,t,t)};var ay=Xs;function uy(){this.applicationMemoKeyStack=[],this.memo={},this.maxExaminedLength=0,this.maxRightmostFailureOffset=-1,this.currentLeftRecursion=void 0}uy.prototype={isActive(t){return this.applicationMemoKeyStack.indexOf(t.toMemoKey())>=0},enter(t){this.applicationMemoKeyStack.push(t.toMemoKey())},exit(){this.applicationMemoKeyStack.pop()},startLeftRecursion(t,e){e.isLeftRecursion=!0,e.headApplication=t,e.nextLeftRecursion=this.currentLeftRecursion,this.currentLeftRecursion=e;let{applicationMemoKeyStack:r}=this,o=r.indexOf(t.toMemoKey())+1,n=r.slice(o);e.isInvolved=function(s){return n.indexOf(s)>=0},e.updateInvolvedApplicationMemoKeys=function(){for(let s=o;s<r.length;s++){let i=r[s];this.isInvolved(i)||n.push(i)}}},endLeftRecursion(){this.currentLeftRecursion=this.currentLeftRecursion.nextLeftRecursion},shouldUseMemoizedResult(t){if(!t.isLeftRecursion)return!0;let{applicationMemoKeyStack:e}=this;for(let r=0;r<e.length;r++){let o=e[r];if(t.isInvolved(o))return!1}return!0},memoize(t,e){return this.memo[t]=e,this.maxExaminedLength=Math.max(this.maxExaminedLength,e.examinedLength),this.maxRightmostFailureOffset=Math.max(this.maxRightmostFailureOffset,e.rightmostFailureOffset),e},clearObsoleteEntries(t,e){if(t+this.maxExaminedLength<=e)return;let{memo:r}=this;this.maxExaminedLength=0,this.maxRightmostFailureOffset=-1,Object.keys(r).forEach(o=>{let n=r[o];t+n.examinedLength>e?delete r[o]:(this.maxExaminedLength=Math.max(this.maxExaminedLength,n.examinedLength),this.maxRightmostFailureOffset=Math.max(this.maxRightmostFailureOffset,n.rightmostFailureOffset))})}};var kT=uy,PT=zp,IT=ay,BT=kT,LT=ny,Ip=Vo,MT=Hs,ly;MT.awaitBuiltInRules(t=>{ly=t.rules.applySyntactic.body});var dp=new Ip.Apply("spaces");function cy(t,e,r){this.matcher=t,this.startExpr=e,this.grammar=t.grammar,this.input=t.input,this.inputStream=new PT(t.input),this.memoTable=t.memoTable,this._bindings=[],this._bindingOffsets=[],this._applicationStack=[],this._posStack=[0],this.inLexifiedContextStack=[!1],this.rightmostFailurePosition=-1,this._rightmostFailurePositionStack=[],this._recordedFailuresStack=[],r!==void 0&&(this.positionToRecordFailures=r,this.recordedFailures=Object.create(null))}cy.prototype={posToOffset(t){return t-this._posStack[this._posStack.length-1]},enterApplication(t,e){this._posStack.push(this.inputStream.pos),this._applicationStack.push(e),this.inLexifiedContextStack.push(!1),t.enter(e),this._rightmostFailurePositionStack.push(this.rightmostFailurePosition),this.rightmostFailurePosition=-1},exitApplication(t,e){let r=this._posStack.pop();this._applicationStack.pop(),this.inLexifiedContextStack.pop(),t.exit(),this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,this._rightmostFailurePositionStack.pop()),e&&this.pushBinding(e,r)},enterLexifiedContext(){this.inLexifiedContextStack.push(!0)},exitLexifiedContext(){this.inLexifiedContextStack.pop()},currentApplication(){return this._applicationStack[this._applicationStack.length-1]},inSyntacticContext(){let t=this.currentApplication();return t?t.isSyntactic()&&!this.inLexifiedContext():this.startExpr.factors[0].isSyntactic()},inLexifiedContext(){return this.inLexifiedContextStack[this.inLexifiedContextStack.length-1]},skipSpaces(){return this.pushFailuresInfo(),this.eval(dp),this.popBinding(),this.popFailuresInfo(),this.inputStream.pos},skipSpacesIfInSyntacticContext(){return this.inSyntacticContext()?this.skipSpaces():this.inputStream.pos},maybeSkipSpacesBefore(t){return t.allowsSkippingPrecedingSpace()&&t!==dp?this.skipSpacesIfInSyntacticContext():this.inputStream.pos},pushBinding(t,e){this._bindings.push(t),this._bindingOffsets.push(this.posToOffset(e))},popBinding(){this._bindings.pop(),this._bindingOffsets.pop()},numBindings(){return this._bindings.length},truncateBindings(t){for(;this._bindings.length>t;)this.popBinding()},getCurrentPosInfo(){return this.getPosInfo(this.inputStream.pos)},getPosInfo(t){let e=this.memoTable[t];return e||(e=this.memoTable[t]=new BT),e},processFailure(t,e){if(this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,t),this.recordedFailures&&t===this.positionToRecordFailures){let r=this.currentApplication();r&&(e=e.substituteParams(r.args)),this.recordFailure(e.toFailure(this.grammar),!1)}},recordFailure(t,e){let r=t.toKey();this.recordedFailures[r]?this.recordedFailures[r].isFluffy()&&!t.isFluffy()&&this.recordedFailures[r].clearFluffy():this.recordedFailures[r]=e?t.clone():t},recordFailures(t,e){Object.keys(t).forEach(r=>{this.recordFailure(t[r],e)})},cloneRecordedFailures(){if(!this.recordedFailures)return;let t=Object.create(null);return Object.keys(this.recordedFailures).forEach(e=>{t[e]=this.recordedFailures[e].clone()}),t},getRightmostFailurePosition(){return this.rightmostFailurePosition},_getRightmostFailureOffset(){return this.rightmostFailurePosition>=0?this.posToOffset(this.rightmostFailurePosition):-1},getMemoizedTraceEntry(t,e){let r=this.memoTable[t];if(r&&e instanceof Ip.Apply){let o=r.memo[e.toMemoKey()];if(o&&o.traceEntry){let n=o.traceEntry.cloneWithExpr(e);return n.isMemoized=!0,n}}return null},getTraceEntry(t,e,r,o){if(e instanceof Ip.Apply){let n=this.currentApplication(),s=n?n.args:[];e=e.substituteParams(s)}return this.getMemoizedTraceEntry(t,e)||new LT(this.input,t,this.inputStream.pos,e,r,o,this.trace)},isTracing(){return!!this.trace},hasNecessaryInfo(t){return this.trace&&!t.traceEntry?!1:this.recordedFailures&&this.inputStream.pos+t.rightmostFailureOffset===this.positionToRecordFailures?!!t.failuresAtRightmostPosition:!0},useMemoizedResult(t,e){this.trace&&this.trace.push(e.traceEntry);let r=this.inputStream.pos+e.rightmostFailureOffset;return this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,r),this.recordedFailures&&this.positionToRecordFailures===r&&e.failuresAtRightmostPosition&&this.recordFailures(e.failuresAtRightmostPosition,!0),this.inputStream.examinedLength=Math.max(this.inputStream.examinedLength,e.examinedLength+t),e.value?(this.inputStream.pos+=e.matchLength,this.pushBinding(e.value,t),!0):!1},eval(t){let{inputStream:e}=this,r=this._bindings.length,o;this.recordedFailures&&(o=this.recordedFailures,this.recordedFailures=Object.create(null));let n=e.pos,s=this.maybeSkipSpacesBefore(t),i;this.trace&&(i=this.trace,this.trace=[]);let a=t.eval(this);if(this.trace){let l=this._bindings.slice(r),u=this.getTraceEntry(s,t,a,l);u.isImplicitSpaces=t===dp,u.isRootNode=t===this.startExpr,i.push(u),this.trace=i}return a?this.recordedFailures&&e.pos===this.positionToRecordFailures&&Object.keys(this.recordedFailures).forEach(l=>{this.recordedFailures[l].makeFluffy()}):(e.pos=n,this.truncateBindings(r)),this.recordedFailures&&this.recordFailures(o,!1),t===ly&&this.skipSpaces(),a},getMatchResult(){this.eval(this.startExpr);let t;this.recordedFailures&&(t=Object.keys(this.recordedFailures).map(r=>this.recordedFailures[r]));let e=this._bindings[0];return e&&(e.grammar=this.grammar),new IT(this.matcher,this.input,this.startExpr,e,this._bindingOffsets[0],this.rightmostFailurePosition,t)},getTrace(){this.trace=[];let t=this.getMatchResult(),e=this.trace[this.trace.length-1];return e.result=t,e},pushFailuresInfo(){this._rightmostFailurePositionStack.push(this.rightmostFailurePosition),this._recordedFailuresStack.push(this.recordedFailures)},popFailuresInfo(){this.rightmostFailurePosition=this._rightmostFailurePositionStack.pop(),this.recordedFailures=this._recordedFailuresStack.pop()}};var RT=cy,jT=RT,U1=Vo;function Ys(t){this.grammar=t,this.memoTable=[],this.input=""}Ys.prototype.getInput=function(){return this.input};Ys.prototype.setInput=function(t){return this.input!==t&&this.replaceInputRange(0,this.input.length,t),this};Ys.prototype.replaceInputRange=function(t,e,r){let o=this.input;if(t<0||t>o.length||e<0||e>o.length||t>e)throw new Error("Invalid indices: "+t+" and "+e);this.input=o.slice(0,t)+r+o.slice(e);let n=this.memoTable.slice(e);this.memoTable.length=t;for(let s=0;s<r.length;s++)this.memoTable.push(void 0);n.forEach(function(s){this.memoTable.push(s)},this);for(let s=0;s<t;s++){let i=this.memoTable[s];i&&i.clearObsoleteEntries(s,t)}return this};Ys.prototype.match=function(t){return this._match(this._getStartExpr(t),!1)};Ys.prototype.trace=function(t){return this._match(this._getStartExpr(t),!0)};Ys.prototype._match=function(t,e,r){let o=new jT(this,t,r);return e?o.getTrace():o.getMatchResult()};Ys.prototype._getStartExpr=function(t){let e=t||this.grammar.defaultStartRule;if(!e)throw new Error("Missing start rule argument -- the grammar has no default start rule.");let r=this.grammar.parseApplication(e);return new U1.Seq([r,U1.end])};var NT=Ys,UT=zp,{IterationNode:zT}=Mp,WT=ay,Wp=Ft,GT=hs,hy=Hs,cl=[],Gp=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),ch=class{constructor(e,r,o){this._node=e,this.source=r,this._baseInterval=o,e.isNonterminal()&&Wp.assert(r===o),this._childWrappers=[]}toString(){return"[semantics wrapper for "+this._node.grammar.name+"]"}_forgetMemoizedResultFor(e){delete this._node[this._semantics.attributeKeys[e]],this.children.forEach(r=>{r._forgetMemoizedResultFor(e)})}child(e){if(!(0<=e&&e<this._node.numChildren()))return;let r=this._childWrappers[e];if(!r){let o=this._node.childAt(e),n=this._node.childOffsets[e],s=this._baseInterval.subInterval(n,o.matchLength),i=o.isNonterminal()?s:this._baseInterval;r=this._childWrappers[e]=this._semantics.wrap(o,s,i)}return r}_children(){for(let e=0;e<this._node.numChildren();e++)this.child(e);return this._childWrappers}isIteration(){return this._node.isIteration()}isTerminal(){return this._node.isTerminal()}isNonterminal(){return this._node.isNonterminal()}isSyntactic(){return this.isNonterminal()&&this._node.isSyntactic()}isLexical(){return this.isNonterminal()&&this._node.isLexical()}isOptional(){return this._node.isOptional()}iteration(e){let r=e||[],o=r.map(i=>i._node),n=new zT(o,[],-1,!1),s=this._semantics.wrap(n,null,null);return s._childWrappers=r,s}get children(){return this._children()}get ctorName(){return this._node.ctorName}get interval(){throw new Error("The `interval` property is deprecated -- use `source` instead")}get numChildren(){return this._node.numChildren()}get sourceString(){return this.source.contents}};function Or(t,e){let r=this;if(this.grammar=t,this.checkedActionDicts=!1,this.Wrapper=class extends(e?e.Wrapper:ch){constructor(o,n,s){super(o,n,s),r.checkActionDictsIfHaventAlready(),this._semantics=r}},this.super=e,e){if(!(t.equals(this.super.grammar)||t._inheritsFrom(this.super.grammar)))throw new Error("Cannot extend a semantics for grammar '"+this.super.grammar.name+"' for use with grammar '"+t.name+"' (not a sub-grammar)");this.operations=Object.create(this.super.operations),this.attributes=Object.create(this.super.attributes),this.attributeKeys=Object.create(null);for(let o in this.attributes)Object.defineProperty(this.attributeKeys,o,{value:hy.uniqueId(o)})}else this.operations=Object.create(null),this.attributes=Object.create(null),this.attributeKeys=Object.create(null)}Or.prototype.toString=function(){return"[semantics for "+this.grammar.name+"]"};Or.prototype.checkActionDictsIfHaventAlready=function(){this.checkedActionDicts||(this.checkActionDicts(),this.checkedActionDicts=!0)};Or.prototype.checkActionDicts=function(){let t;for(t in this.operations)this.operations[t].checkActionDict(this.grammar);for(t in this.attributes)this.attributes[t].checkActionDict(this.grammar)};Or.prototype.toRecipe=function(t){function e(o){return o.super!==Or.BuiltInSemantics._getSemantics()}let r=`(function(g) {
`;if(e(this)){r+="  var semantics = "+this.super.toRecipe(!0)+"(g";let o=this.super.grammar,n=this.grammar;for(;n!==o;)r+=".superGrammar",n=n.superGrammar;r+=`);
`,r+="  return g.extendSemantics(semantics)"}else r+="  return g.createSemantics()";return["Operation","Attribute"].forEach(o=>{let n=this[o.toLowerCase()+"s"];Object.keys(n).forEach(s=>{let{actionDict:i,formals:a,builtInDefault:l}=n[s],u=s;a.length>0&&(u+="("+a.join(", ")+")");let c;e(this)&&this.super[o.toLowerCase()+"s"][s]?c="extend"+o:c="add"+o,r+=`
    .`+c+"("+JSON.stringify(u)+", {";let h=[];Object.keys(i).forEach(d=>{if(i[d]!==l){let g=i[d].toString().trim();g=g.replace(/^.*\(/,"function("),h.push(`
      `+JSON.stringify(d)+": "+g)}}),r+=h.join(",")+`
    })`})}),r+=`;
  })`,t||(r=`(function() {
  var grammar = this.fromRecipe(`+this.grammar.toRecipe()+`);
  var semantics = `+r+`(grammar);
  return semantics;
});
`),r};function fy(t,e){if(!Or.prototypeGrammar)return Wp.assert(t.indexOf("(")===-1),{name:t,formals:[]};let r=Or.prototypeGrammar.match(t,e==="operation"?"OperationSignature":"AttributeSignature");if(r.failed())throw new Error(r.message);return Or.prototypeGrammarSemantics(r).parse()}function HT(t,e,r){return function(...o){let s=(this._semantics.operations[e]||this._semantics.attributes[e]).formals.map(i=>this.args[i]);if(!this.isIteration()&&o.length===1)return r.apply(o[0],s);throw GT.missingSemanticAction(this.ctorName,e,t,cl)}}Or.prototype.addOperationOrAttribute=function(t,e,r){let o=t+"s",n=fy(e,t),{name:s}=n,{formals:i}=n;this.assertNewName(s,t);let a=HT(t,s,c),l={_default:a};Object.keys(r).forEach(h=>{l[h]=r[h]});let u=t==="operation"?new Yo(s,i,l,a):new dl(s,l,a);u.checkActionDict(this.grammar),this[o][s]=u;function c(...h){let d=this._semantics[o][s];if(arguments.length!==d.formals.length)throw new Error("Invalid number of arguments passed to "+s+" "+t+" (expected "+d.formals.length+", got "+arguments.length+")");let g=Object.create(null);for(let[C,b]of Object.entries(h)){let k=d.formals[C];g[k]=b}let m=this.args;this.args=g;let y=d.execute(this._semantics,this);return this.args=m,y}t==="operation"?(this.Wrapper.prototype[s]=c,this.Wrapper.prototype[s].toString=function(){return"["+s+" operation]"}):(Object.defineProperty(this.Wrapper.prototype,s,{get:c,configurable:!0}),Object.defineProperty(this.attributeKeys,s,{value:hy.uniqueId(s)}))};Or.prototype.extendOperationOrAttribute=function(t,e,r){let o=t+"s";if(fy(e,"attribute"),!(this.super&&e in this.super[o]))throw new Error("Cannot extend "+t+" '"+e+"': did not inherit an "+t+" with that name");if(Gp(this[o],e))throw new Error("Cannot extend "+t+" '"+e+"' again");let n=this[o][e].formals,s=this[o][e].actionDict,i=Object.create(s);Object.keys(r).forEach(a=>{i[a]=r[a]}),this[o][e]=t==="operation"?new Yo(e,n,i):new dl(e,i),this[o][e].checkActionDict(this.grammar)};Or.prototype.assertNewName=function(t,e){if(Gp(ch.prototype,t))throw new Error("Cannot add "+e+" '"+t+"': that's a reserved name");if(t in this.operations)throw new Error("Cannot add "+e+" '"+t+"': an operation with that name already exists");if(t in this.attributes)throw new Error("Cannot add "+e+" '"+t+"': an attribute with that name already exists")};Or.prototype.wrap=function(t,e,r){let o=r||e;return t instanceof this.Wrapper?t:new this.Wrapper(t,e,o)};Or.createSemantics=function(t,e){let r=new Or(t,e!==void 0?e:Or.BuiltInSemantics._getSemantics()),o=function(s){if(!(s instanceof WT))throw new TypeError("Semantics expected a MatchResult, but got "+Wp.unexpectedObjToString(s));if(s.failed())throw new TypeError("cannot apply Semantics to "+s.toString());let i=s._cst;if(i.grammar!==t)throw new Error("Cannot use a MatchResult from grammar '"+i.grammar.name+"' with a semantics for '"+t.name+"'");let a=new UT(s.input);return r.wrap(i,a.interval(s._cstOffset,s.input.length))};return o.addOperation=function(n,s){return r.addOperationOrAttribute("operation",n,s),o},o.extendOperation=function(n,s){return r.extendOperationOrAttribute("operation",n,s),o},o.addAttribute=function(n,s){return r.addOperationOrAttribute("attribute",n,s),o},o.extendAttribute=function(n,s){return r.extendOperationOrAttribute("attribute",n,s),o},o._getActionDict=function(n){let s=r.operations[n]||r.attributes[n];if(!s)throw new Error('"'+n+'" is not a valid operation or attribute name in this semantics for "'+t.name+'"');return s.actionDict},o._remove=function(n){let s;return n in r.operations?(s=r.operations[n],delete r.operations[n]):n in r.attributes&&(s=r.attributes[n],delete r.attributes[n]),delete r.Wrapper.prototype[n],s},o.getOperationNames=function(){return Object.keys(r.operations)},o.getAttributeNames=function(){return Object.keys(r.attributes)},o.getGrammar=function(){return r.grammar},o.toRecipe=function(n){return r.toRecipe(n)},o.toString=r.toString.bind(r),o._getSemantics=function(){return r},o};var Yo=class{constructor(e,r,o,n){this.name=e,this.formals=r,this.actionDict=o,this.builtInDefault=n}checkActionDict(e){e._checkTopDownActionDict(this.typeName,this.name,this.actionDict)}execute(e,r){try{let{ctorName:o}=r._node,n=this.actionDict[o];return n?(cl.push([this,o]),n.apply(r,r._children())):r.isNonterminal()&&(n=this.actionDict._nonterminal,n)?(cl.push([this,"_nonterminal",o]),n.apply(r,r._children())):(cl.push([this,"default action",o]),this.actionDict._default.apply(r,r._children()))}finally{cl.pop()}}};Yo.prototype.typeName="operation";var dl=class extends Yo{constructor(e,r,o){super(e,[],r,o)}execute(e,r){let o=r._node,n=e.attributeKeys[this.name];return Gp(o,n)||(o[n]=Yo.prototype.execute.call(this,e,r)),o[n]}};dl.prototype.typeName="attribute";var dy=Or,XT=TT,YT=NT,z1=dy,W1=Ft,G1=hs,fi=Vo,H1=["_iter","_terminal","_nonterminal","_default"];function X1(t){return Object.keys(t.rules).sort().map(e=>t.rules[e])}var VT=t=>t.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029");function Ho(t,e,r,o){if(this.name=t,this.superGrammar=e,this.rules=r,o){if(!(o in r))throw new Error("Invalid start rule: '"+o+"' is not a rule in grammar '"+t+"'");this.defaultStartRule=o}}var py,gy;Ho.initApplicationParser=function(t,e){py=t,gy=e};Ho.prototype={matcher(){return new YT(this)},isBuiltIn(){return this===Ho.ProtoBuiltInRules||this===Ho.BuiltInRules},equals(t){if(this===t)return!0;if(t==null||this.name!==t.name||this.defaultStartRule!==t.defaultStartRule||!(this.superGrammar===t.superGrammar||this.superGrammar.equals(t.superGrammar)))return!1;let e=X1(this),r=X1(t);return e.length===r.length&&e.every((o,n)=>o.description===r[n].description&&o.formals.join(",")===r[n].formals.join(",")&&o.body.toString()===r[n].body.toString())},match(t,e){let r=this.matcher();return r.replaceInputRange(0,0,t),r.match(e)},trace(t,e){let r=this.matcher();return r.replaceInputRange(0,0,t),r.trace(e)},createSemantics(){return z1.createSemantics(this)},extendSemantics(t){return z1.createSemantics(this,t._getSemantics())},_checkTopDownActionDict(t,e,r){let o=[];for(let n in r){let s=r[n];if(!H1.includes(n)&&!(n in this.rules)){o.push(`'${n}' is not a valid semantic action for '${this.name}'`);continue}if(typeof s!="function"){o.push(`'${n}' must be a function in an action dictionary for '${this.name}'`);continue}let a=s.length,l=this._topDownActionArity(n);if(a!==l){let u;n==="_iter"||n==="_nonterminal"?u=`it should use a rest parameter, e.g. \`${n}(...children) {}\`. NOTE: this is new in Ohm v16 \u2014 see https://ohmjs.org/d/ati for details.`:u=`expected ${l}, got ${a}`,o.push(`Semantic action '${n}' has the wrong arity: ${u}`)}}if(o.length>0){let n=o.map(i=>"- "+i),s=new Error([`Found errors in the action dictionary of the '${e}' ${t}:`,...n].join(`
`));throw s.problems=o,s}},_topDownActionArity(t){return H1.includes(t)?0:this.rules[t].body.getArity()},_inheritsFrom(t){let e=this.superGrammar;for(;e;){if(e.equals(t,!0))return!0;e=e.superGrammar}return!1},toRecipe(t=void 0){let e={};this.source&&(e.source=this.source.contents);let r=null;this.defaultStartRule&&(r=this.defaultStartRule);let o={};Object.keys(this.rules).forEach(i=>{let a=this.rules[i],{body:l}=a,u=!this.superGrammar||!this.superGrammar.rules[i],c;u?c="define":c=l instanceof fi.Extend?"extend":"override";let h={};if(a.source&&this.source){let m=a.source.relativeTo(this.source);h.sourceInterval=[m.startIdx,m.endIdx]}let d=u?a.description:null,g=l.outputRecipe(a.formals,this.source);o[i]=[c,h,d,a.formals,g]});let n="null";t?n=t:this.superGrammar&&!this.superGrammar.isBuiltIn()&&(n=this.superGrammar.toRecipe());let s=[...["grammar",e,this.name].map(JSON.stringify),n,...[r,o].map(JSON.stringify)];return VT(`[${s.join(",")}]`)},toOperationActionDictionaryTemplate(){return this._toOperationOrAttributeActionDictionaryTemplate()},toAttributeActionDictionaryTemplate(){return this._toOperationOrAttributeActionDictionaryTemplate()},_toOperationOrAttributeActionDictionaryTemplate(){let t=new W1.StringBuffer;t.append("{");let e=!0;for(let r in this.rules){let{body:o}=this.rules[r];e?e=!1:t.append(","),t.append(`
`),t.append("  "),this.addSemanticActionTemplate(r,o,t)}return t.append(`
}`),t.contents()},addSemanticActionTemplate(t,e,r){r.append(t),r.append(": function(");let o=this._topDownActionArity(t);r.append(W1.repeat("_",o).join(", ")),r.append(`) {
`),r.append("  }")},parseApplication(t){let e;if(t.indexOf("<")===-1)e=new fi.Apply(t);else{let o=py.match(t,"Base_application");e=gy(o,{})}if(!(e.ruleName in this.rules))throw G1.undeclaredRule(e.ruleName,this.name);let{formals:r}=this.rules[e.ruleName];if(r.length!==e.args.length){let{source:o}=this.rules[e.ruleName];throw G1.wrongNumberOfParameters(e.ruleName,r.length,e.args.length,o)}return e}};Ho.ProtoBuiltInRules=new Ho("ProtoBuiltInRules",void 0,{any:{body:fi.any,formals:[],description:"any character",primitive:!0},end:{body:fi.end,formals:[],description:"end of input",primitive:!0},caseInsensitive:{body:new XT(new fi.Param(0)),formals:["str"],primitive:!0},lower:{body:new fi.UnicodeChar("Ll"),formals:[],description:"a lowercase letter",primitive:!0},upper:{body:new fi.UnicodeChar("Lu"),formals:[],description:"an uppercase letter",primitive:!0},unicodeLtmo:{body:new fi.UnicodeChar("Ltmo"),formals:[],description:"a Unicode character in Lt, Lm, or Lo",primitive:!0},spaces:{body:new fi.Star(new fi.Apply("space")),formals:[]},space:{body:new fi.Range("\0"," "),formals:[],description:"a space"}});var dh=Ho,Bp=dh,qT=zp,my=Ft,Gs=hs,$T=Vo;function Fn(t){this.name=t}Fn.prototype.sourceInterval=function(t,e){return this.source.subInterval(t,e-t)};Fn.prototype.ensureSuperGrammar=function(){return this.superGrammar||this.withSuperGrammar(this.name==="BuiltInRules"?Bp.ProtoBuiltInRules:Bp.BuiltInRules),this.superGrammar};Fn.prototype.ensureSuperGrammarRuleForOverriding=function(t,e){let r=this.ensureSuperGrammar().rules[t];if(!r)throw Gs.cannotOverrideUndeclaredRule(t,this.superGrammar.name,e);return r};Fn.prototype.installOverriddenOrExtendedRule=function(t,e,r,o){let n=my.getDuplicates(e);if(n.length>0)throw Gs.duplicateParameterNames(t,n,o);let s=this.ensureSuperGrammar().rules[t],i=s.formals,a=i?i.length:0;if(e.length!==a)throw Gs.wrongNumberOfParameters(t,a,e.length,o);return this.install(t,e,r,s.description,o)};Fn.prototype.install=function(t,e,r,o,n){return this.rules[t]={body:r.introduceParams(e),formals:e,description:o,source:n},this};Fn.prototype.withSuperGrammar=function(t){if(this.superGrammar)throw new Error("the super grammar of a GrammarDecl cannot be set more than once");return this.superGrammar=t,this.rules=Object.create(t.rules),t.isBuiltIn()||(this.defaultStartRule=t.defaultStartRule),this};Fn.prototype.withDefaultStartRule=function(t){return this.defaultStartRule=t,this};Fn.prototype.withSource=function(t){return this.source=new qT(t).interval(0,t.length),this};Fn.prototype.build=function(){let t=new Bp(this.name,this.ensureSuperGrammar(),this.rules,this.defaultStartRule),e=[],r=!1;return Object.keys(t.rules).forEach(o=>{let{body:n}=t.rules[o];try{n.assertChoicesHaveUniformArity(o)}catch(s){e.push(s)}try{n.assertAllApplicationsAreValid(o,t)}catch(s){e.push(s),r=!0}}),r||Object.keys(t.rules).forEach(o=>{let{body:n}=t.rules[o];try{n.assertIteratedExprsAreNotNullable(t,[])}catch(s){e.push(s)}}),e.length>0&&Gs.throwErrors(e),this.source&&(t.source=this.source),t};Fn.prototype.define=function(t,e,r,o,n){if(this.ensureSuperGrammar(),this.superGrammar.rules[t])throw Gs.duplicateRuleDeclaration(t,this.name,this.superGrammar.name,n);if(this.rules[t])throw Gs.duplicateRuleDeclaration(t,this.name,this.name,n);let s=my.getDuplicates(e);if(s.length>0)throw Gs.duplicateParameterNames(t,s,n);return this.install(t,e,r,o,n)};Fn.prototype.override=function(t,e,r,o,n){return this.ensureSuperGrammarRuleForOverriding(t,n),this.installOverriddenOrExtendedRule(t,e,r,n),this};Fn.prototype.extend=function(t,e,r,o,n){if(!this.ensureSuperGrammar().rules[t])throw Gs.cannotExtendUndeclaredRule(t,this.superGrammar.name,n);let i=new $T.Extend(this.superGrammar,t,r);return i.source=r.source,this.installOverriddenOrExtendedRule(t,e,i,n),this};var KT=Fn,JT=dh,Y1=KT,Ut=Vo;function vy(){}vy.prototype={currentDecl:null,currentRuleName:null,newGrammar(t){return new Y1(t)},grammar(t,e,r,o,n){let s=new Y1(e);return r&&s.withSuperGrammar(r instanceof JT?r:this.fromRecipe(r)),o&&s.withDefaultStartRule(o),t&&t.source&&s.withSource(t.source),this.currentDecl=s,Object.keys(n).forEach(i=>{this.currentRuleName=i;let a=n[i],l=a[0],u=a[1],c=a[2],h=a[3],d=this.fromRecipe(a[4]),g;s.source&&u&&u.sourceInterval&&(g=s.source.subInterval(u.sourceInterval[0],u.sourceInterval[1]-u.sourceInterval[0])),s[l](i,h,d,c,g)}),this.currentRuleName=this.currentDecl=null,s.build()},terminal(t){return new Ut.Terminal(t)},range(t,e){return new Ut.Range(t,e)},param(t){return new Ut.Param(t)},alt(...t){let e=[];for(let r of t)r instanceof Ut.PExpr||(r=this.fromRecipe(r)),r instanceof Ut.Alt?e=e.concat(r.terms):e.push(r);return e.length===1?e[0]:new Ut.Alt(e)},seq(...t){let e=[];for(let r of t)r instanceof Ut.PExpr||(r=this.fromRecipe(r)),r instanceof Ut.Seq?e=e.concat(r.factors):e.push(r);return e.length===1?e[0]:new Ut.Seq(e)},star(t){return t instanceof Ut.PExpr||(t=this.fromRecipe(t)),new Ut.Star(t)},plus(t){return t instanceof Ut.PExpr||(t=this.fromRecipe(t)),new Ut.Plus(t)},opt(t){return t instanceof Ut.PExpr||(t=this.fromRecipe(t)),new Ut.Opt(t)},not(t){return t instanceof Ut.PExpr||(t=this.fromRecipe(t)),new Ut.Not(t)},la(t){return this.lookahead(t)},lookahead(t){return t instanceof Ut.PExpr||(t=this.fromRecipe(t)),new Ut.Lookahead(t)},lex(t){return t instanceof Ut.PExpr||(t=this.fromRecipe(t)),new Ut.Lex(t)},app(t,e){return e&&e.length>0&&(e=e.map(function(r){return r instanceof Ut.PExpr?r:this.fromRecipe(r)},this)),new Ut.Apply(t,e)},splice(t,e){return new Ut.Splice(this.currentDecl.superGrammar,this.currentRuleName,t.map(r=>this.fromRecipe(r)),e.map(r=>this.fromRecipe(r)))},fromRecipe(t){let e=t[0]==="grammar"?t.slice(1):t.slice(2),r=this[t[0]](...e),o=t[1];return o&&o.sourceInterval&&this.currentDecl&&r.withSource(this.currentDecl.sourceInterval(...o.sourceInterval)),r}};var yy=vy,QT="ohm-js",ZT="16.6.0",eF="An object-oriented language for parsing and pattern matching",tF="https://github.com/harc/ohm",rF=["parser","compiler","pattern matching","pattern-matching","ometa","ometa/js","ometa-js","ometajs","rapid","prototyping"],nF="https://ohmjs.org",iF="https://github.com/harc/ohm/issues",sF="index.js",oF="dist/ohm.esm.js",aF=["src","dist","extras","third_party","index.d.ts"],uF="index.d.ts",lF={prebootstrap:"bash scripts/prebootstrap",bootstrap:"bash scripts/bootstrap --test || (echo 'Bootstrap failed.' && mv -v dist/ohm-grammar.js.old dist/ohm-grammar.js && mv -v dist/built-in-rules.js.old dist/built-in-rules.js && mv -v dist/operations-and-attributes.js.old dist/operations-and-attributes.js)",build:"yarn build-debug && webpack --mode=production","build-debug":"webpack --mode=development && yarn build-esm && node scripts/generate-types.mjs","build-esm":"rollup -c rollup.config.mjs",clean:"rm -f dist/ohm.js dist/ohm.min.js",lint:"eslint . --ignore-path ../.eslintignore",format:"prettier . --write --ignore-path ../.prettierignore --config ../.prettierrc && eslint . --ignore-path ../.eslintignore --fix",test:"ava && ava --config ava-ts.config.js test/test-typings.ts","test-watch":"ava --watch","pre-commit":"yarn run lint && yarn run build && yarn run test",prepublishOnly:"bash scripts/prepublishOnly",prepack:"cp ../../README.md . && yarn build",postpack:"rm README.md",postpublish:"echo '\u{1F449}  Now go to https://github.com/harc/ohm/releases and create a release.'","unsafe-bootstrap":"bash scripts/bootstrap","update-contributors":"bash scripts/update-contributors",watch:"webpack --mode=development --watch"},cF="MIT",hF="Alex Warth <alexwarth@gmail.com> (http://tinlizzie.org/~awarth)",fF=["Patrick Dubroy <pdubroy@gmail.com>","Meixian Li <lmeixian@gmail.com>","Marko R\xF6der <m.roeder@photon-software.de>","Tony Garnock-Jones <tonygarnockjones@gmail.com>","Saketh Kasibatla <sake.kasi@gmail.com>","Lionel Landwerlin <llandwerlin@gmail.com>","Jason Merrill <jwmerrill@gmail.com>","Ray Toal <rtoal@lmu.edu>","Yoshiki Ohshima <Yoshiki.Ohshima@acm.org>","megabuz <3299889+megabuz@users.noreply.github.com>","Jonathan Edwards <JonathanMEdwards@gmail.com>","Milan Lajto\u0161 <milan.lajtos@me.com>","Neil Jewers <njjewers@uwaterloo.ca>","stagas <gstagas@gmail.com>","AngryPowman <angrypowman@qq.com>","Arthur Carabott <arthurc@gmail.com>","Casey Olson <casey.m.olson@gmail.com>","Daniel Tomlinson <DanielTomlinson@me.com>","Ian Harris <ian@fofgof.xyz>","Justin Chase <justin.m.chase@gmail.com>","Leslie Ying <acetophore@users.noreply.github.com>","Luca Guzzon <luca.guzzon@gmail.com>","Mike Niebling <(none)>","Patrick Dubroy <patrick@sourcegraph.com>","Pierre Donias <pierre.donias@gmail.com>","Stan Rozenraukh <stan@stanistan.com>","Stephan Seidt <stephan.seidt@gmail.com>","Steve Phillips <steve@tryingtobeawesome.com>","Szymon Kaliski <kaliskiszymon@gmail.com>","Thomas Nyberg <tomnyberg@gmail.com>","Vse Mozhet Byt <vsemozhetbyt@gmail.com>","Wil Chung <10446+iamwilhelm@users.noreply.github.com>","Zachary Sakowitz <zsakowitz@gmail.com>","abego <ub@abego-software.de>","acslk <d_vd415@hotmail.com>","codeZeilen <codeZeilen@users.noreply.github.com>","kassadin <kassadin@foxmail.com>","owch <bowenrainyday@gmail.com>","sfinnie <scott.finnie@gmail.com>"],dF={},pF={"@ohm-js/cli":"^1.0.0","@rollup/plugin-commonjs":"^21.0.1","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^13.1.3",ava:"^3.15.0","ava-spec":"^1.1.1",dedent:"^0.7.0",eslint:"^7.9.0","eslint-config-google":"^0.14.0","eslint-plugin-ava":"^11.0.0","eslint-plugin-camelcase-ohm":"^0.2.1","eslint-plugin-no-extension-in-require":"^0.2.0",husky:"^4.2.5",jsdom:"^9.9.1",json:"^9.0.6",markscript:"^0.5.0","node-static":"^0.7.11","ohm-grammar-ecmascript":"^1.0.0",rollup:"^2.63.0","ts-loader":"^8.0.4","ts-node":"^9.0.0",typescript:"^4.0.3","walk-sync":"^2.2.0",webpack:"^4.44.2","webpack-cli":"^3.3.12"},gF={node:">=0.12.1"},mF={name:QT,version:ZT,description:eF,repository:tF,keywords:rF,homepage:nF,bugs:iF,main:sF,module:oF,files:aF,types:uF,scripts:lF,license:cF,author:hF,contributors:fF,dependencies:dF,devDependencies:pF,engines:gF},vF=typeof __GLOBAL_OHM_VERSION__=="string"?__GLOBAL_OHM_VERSION__:mF.version,gl={},V1=yy;function yF(t){return typeof t=="function"?t.call(new V1):(typeof t=="string"&&(t=JSON.parse(t)),new V1().fromRecipe(t))}gl.makeRecipe=yF;var{makeRecipe:CF}=gl,_F=CF(["grammar",{source:`BuiltInRules {

  alnum  (an alpha-numeric character)
    = letter
    | digit

  letter  (a letter)
    = lower
    | upper
    | unicodeLtmo

  digit  (a digit)
    = "0".."9"

  hexDigit  (a hexadecimal digit)
    = digit
    | "a".."f"
    | "A".."F"

  ListOf<elem, sep>
    = NonemptyListOf<elem, sep>
    | EmptyListOf<elem, sep>

  NonemptyListOf<elem, sep>
    = elem (sep elem)*

  EmptyListOf<elem, sep>
    = /* nothing */

  listOf<elem, sep>
    = nonemptyListOf<elem, sep>
    | emptyListOf<elem, sep>

  nonemptyListOf<elem, sep>
    = elem (sep elem)*

  emptyListOf<elem, sep>
    = /* nothing */

  // Allows a syntactic rule application within a lexical context.
  applySyntactic<app> = app
}`},"BuiltInRules",null,null,{alnum:["define",{sourceInterval:[18,78]},"an alpha-numeric character",[],["alt",{sourceInterval:[60,78]},["app",{sourceInterval:[60,66]},"letter",[]],["app",{sourceInterval:[73,78]},"digit",[]]]],letter:["define",{sourceInterval:[82,142]},"a letter",[],["alt",{sourceInterval:[107,142]},["app",{sourceInterval:[107,112]},"lower",[]],["app",{sourceInterval:[119,124]},"upper",[]],["app",{sourceInterval:[131,142]},"unicodeLtmo",[]]]],digit:["define",{sourceInterval:[146,177]},"a digit",[],["range",{sourceInterval:[169,177]},"0","9"]],hexDigit:["define",{sourceInterval:[181,254]},"a hexadecimal digit",[],["alt",{sourceInterval:[219,254]},["app",{sourceInterval:[219,224]},"digit",[]],["range",{sourceInterval:[231,239]},"a","f"],["range",{sourceInterval:[246,254]},"A","F"]]],ListOf:["define",{sourceInterval:[258,336]},null,["elem","sep"],["alt",{sourceInterval:[282,336]},["app",{sourceInterval:[282,307]},"NonemptyListOf",[["param",{sourceInterval:[297,301]},0],["param",{sourceInterval:[303,306]},1]]],["app",{sourceInterval:[314,336]},"EmptyListOf",[["param",{sourceInterval:[326,330]},0],["param",{sourceInterval:[332,335]},1]]]]],NonemptyListOf:["define",{sourceInterval:[340,388]},null,["elem","sep"],["seq",{sourceInterval:[372,388]},["param",{sourceInterval:[372,376]},0],["star",{sourceInterval:[377,388]},["seq",{sourceInterval:[378,386]},["param",{sourceInterval:[378,381]},1],["param",{sourceInterval:[382,386]},0]]]]],EmptyListOf:["define",{sourceInterval:[392,434]},null,["elem","sep"],["seq",{sourceInterval:[438,438]}]],listOf:["define",{sourceInterval:[438,516]},null,["elem","sep"],["alt",{sourceInterval:[462,516]},["app",{sourceInterval:[462,487]},"nonemptyListOf",[["param",{sourceInterval:[477,481]},0],["param",{sourceInterval:[483,486]},1]]],["app",{sourceInterval:[494,516]},"emptyListOf",[["param",{sourceInterval:[506,510]},0],["param",{sourceInterval:[512,515]},1]]]]],nonemptyListOf:["define",{sourceInterval:[520,568]},null,["elem","sep"],["seq",{sourceInterval:[552,568]},["param",{sourceInterval:[552,556]},0],["star",{sourceInterval:[557,568]},["seq",{sourceInterval:[558,566]},["param",{sourceInterval:[558,561]},1],["param",{sourceInterval:[562,566]},0]]]]],emptyListOf:["define",{sourceInterval:[572,682]},null,["elem","sep"],["seq",{sourceInterval:[685,685]}]],applySyntactic:["define",{sourceInterval:[685,710]},null,["app"],["param",{sourceInterval:[707,710]},0]]}]),wF=dh;wF.BuiltInRules=_F;var{makeRecipe:SF}=gl,bF=SF(["grammar",{source:`OperationsAndAttributes {

  AttributeSignature =
    name

  OperationSignature =
    name Formals?

  Formals
    = "(" ListOf<name, ","> ")"

  name  (a name)
    = nameFirst nameRest*

  nameFirst
    = "_"
    | letter

  nameRest
    = "_"
    | alnum

}`},"OperationsAndAttributes",null,"AttributeSignature",{AttributeSignature:["define",{sourceInterval:[29,58]},null,[],["app",{sourceInterval:[54,58]},"name",[]]],OperationSignature:["define",{sourceInterval:[62,100]},null,[],["seq",{sourceInterval:[87,100]},["app",{sourceInterval:[87,91]},"name",[]],["opt",{sourceInterval:[92,100]},["app",{sourceInterval:[92,99]},"Formals",[]]]]],Formals:["define",{sourceInterval:[104,143]},null,[],["seq",{sourceInterval:[118,143]},["terminal",{sourceInterval:[118,121]},"("],["app",{sourceInterval:[122,139]},"ListOf",[["app",{sourceInterval:[129,133]},"name",[]],["terminal",{sourceInterval:[135,138]},","]]],["terminal",{sourceInterval:[140,143]},")"]]],name:["define",{sourceInterval:[147,187]},"a name",[],["seq",{sourceInterval:[168,187]},["app",{sourceInterval:[168,177]},"nameFirst",[]],["star",{sourceInterval:[178,187]},["app",{sourceInterval:[178,186]},"nameRest",[]]]]],nameFirst:["define",{sourceInterval:[191,223]},null,[],["alt",{sourceInterval:[207,223]},["terminal",{sourceInterval:[207,210]},"_"],["app",{sourceInterval:[217,223]},"letter",[]]]],nameRest:["define",{sourceInterval:[227,257]},null,[],["alt",{sourceInterval:[242,257]},["terminal",{sourceInterval:[242,245]},"_"],["app",{sourceInterval:[252,257]},"alnum",[]]]]}]),hh=dy,xF=Hs;xF.awaitBuiltInRules(t=>{let e=bF;DF(t),EF(e)});function DF(t){let e={empty(){return this.iteration()},nonEmpty(r,o,n){return this.iteration([r].concat(n.children))}};hh.BuiltInSemantics=hh.createSemantics(t,null).addOperation("asIteration",{emptyListOf:e.empty,nonemptyListOf:e.nonEmpty,EmptyListOf:e.empty,NonemptyListOf:e.nonEmpty})}function EF(t){hh.prototypeGrammarSemantics=t.createSemantics().addOperation("parse",{AttributeSignature(e){return{name:e.parse(),formals:[]}},OperationSignature(e,r){return{name:e.parse(),formals:r.children.map(o=>o.parse())[0]||[]}},Formals(e,r,o){return r.asIteration().children.map(n=>n.parse())},name(e,r){return this.sourceString}}),hh.prototypeGrammar=t}var{makeRecipe:AF}=gl,TF=AF(["grammar",{source:`Ohm {

  Grammars
    = Grammar*

  Grammar
    = ident SuperGrammar? "{" Rule* "}"

  SuperGrammar
    = "<:" ident

  Rule
    = ident Formals? ruleDescr? "="  RuleBody  -- define
    | ident Formals?            ":=" OverrideRuleBody  -- override
    | ident Formals?            "+=" RuleBody  -- extend

  RuleBody
    = "|"? NonemptyListOf<TopLevelTerm, "|">

  TopLevelTerm
    = Seq caseName  -- inline
    | Seq

  OverrideRuleBody
    = "|"? NonemptyListOf<OverrideTopLevelTerm, "|">

  OverrideTopLevelTerm
    = "..."  -- superSplice
    | TopLevelTerm

  Formals
    = "<" ListOf<ident, ","> ">"

  Params
    = "<" ListOf<Seq, ","> ">"

  Alt
    = NonemptyListOf<Seq, "|">

  Seq
    = Iter*

  Iter
    = Pred "*"  -- star
    | Pred "+"  -- plus
    | Pred "?"  -- opt
    | Pred

  Pred
    = "~" Lex  -- not
    | "&" Lex  -- lookahead
    | Lex

  Lex
    = "#" Base  -- lex
    | Base

  Base
    = ident Params? ~(ruleDescr? "=" | ":=" | "+=")  -- application
    | oneCharTerminal ".." oneCharTerminal           -- range
    | terminal                                       -- terminal
    | "(" Alt ")"                                    -- paren

  ruleDescr  (a rule description)
    = "(" ruleDescrText ")"

  ruleDescrText
    = (~")" any)*

  caseName
    = "--" (~"\\n" space)* name (~"\\n" space)* ("\\n" | &"}")

  name  (a name)
    = nameFirst nameRest*

  nameFirst
    = "_"
    | letter

  nameRest
    = "_"
    | alnum

  ident  (an identifier)
    = name

  terminal
    = "\\"" terminalChar* "\\""

  oneCharTerminal
    = "\\"" terminalChar "\\""

  terminalChar
    = escapeChar
      | ~"\\\\" ~"\\"" ~"\\n" "\\u{0}".."\\u{10FFFF}"

  escapeChar  (an escape sequence)
    = "\\\\\\\\"                                     -- backslash
    | "\\\\\\""                                     -- doubleQuote
    | "\\\\\\'"                                     -- singleQuote
    | "\\\\b"                                      -- backspace
    | "\\\\n"                                      -- lineFeed
    | "\\\\r"                                      -- carriageReturn
    | "\\\\t"                                      -- tab
    | "\\\\u{" hexDigit hexDigit? hexDigit?
             hexDigit? hexDigit? hexDigit? "}"   -- unicodeCodePoint
    | "\\\\u" hexDigit hexDigit hexDigit hexDigit  -- unicodeEscape
    | "\\\\x" hexDigit hexDigit                    -- hexEscape

  space
   += comment

  comment
    = "//" (~"\\n" any)* &("\\n" | end)  -- singleLine
    | "/*" (~"*/" any)* "*/"  -- multiLine

  tokens = token*

  token = caseName | comment | ident | operator | punctuation | terminal | any

  operator = "<:" | "=" | ":=" | "+=" | "*" | "+" | "?" | "~" | "&"

  punctuation = "<" | ">" | "," | "--"
}`},"Ohm",null,"Grammars",{Grammars:["define",{sourceInterval:[9,32]},null,[],["star",{sourceInterval:[24,32]},["app",{sourceInterval:[24,31]},"Grammar",[]]]],Grammar:["define",{sourceInterval:[36,83]},null,[],["seq",{sourceInterval:[50,83]},["app",{sourceInterval:[50,55]},"ident",[]],["opt",{sourceInterval:[56,69]},["app",{sourceInterval:[56,68]},"SuperGrammar",[]]],["terminal",{sourceInterval:[70,73]},"{"],["star",{sourceInterval:[74,79]},["app",{sourceInterval:[74,78]},"Rule",[]]],["terminal",{sourceInterval:[80,83]},"}"]]],SuperGrammar:["define",{sourceInterval:[87,116]},null,[],["seq",{sourceInterval:[106,116]},["terminal",{sourceInterval:[106,110]},"<:"],["app",{sourceInterval:[111,116]},"ident",[]]]],Rule_define:["define",{sourceInterval:[131,181]},null,[],["seq",{sourceInterval:[131,170]},["app",{sourceInterval:[131,136]},"ident",[]],["opt",{sourceInterval:[137,145]},["app",{sourceInterval:[137,144]},"Formals",[]]],["opt",{sourceInterval:[146,156]},["app",{sourceInterval:[146,155]},"ruleDescr",[]]],["terminal",{sourceInterval:[157,160]},"="],["app",{sourceInterval:[162,170]},"RuleBody",[]]]],Rule_override:["define",{sourceInterval:[188,248]},null,[],["seq",{sourceInterval:[188,235]},["app",{sourceInterval:[188,193]},"ident",[]],["opt",{sourceInterval:[194,202]},["app",{sourceInterval:[194,201]},"Formals",[]]],["terminal",{sourceInterval:[214,218]},":="],["app",{sourceInterval:[219,235]},"OverrideRuleBody",[]]]],Rule_extend:["define",{sourceInterval:[255,305]},null,[],["seq",{sourceInterval:[255,294]},["app",{sourceInterval:[255,260]},"ident",[]],["opt",{sourceInterval:[261,269]},["app",{sourceInterval:[261,268]},"Formals",[]]],["terminal",{sourceInterval:[281,285]},"+="],["app",{sourceInterval:[286,294]},"RuleBody",[]]]],Rule:["define",{sourceInterval:[120,305]},null,[],["alt",{sourceInterval:[131,305]},["app",{sourceInterval:[131,170]},"Rule_define",[]],["app",{sourceInterval:[188,235]},"Rule_override",[]],["app",{sourceInterval:[255,294]},"Rule_extend",[]]]],RuleBody:["define",{sourceInterval:[309,362]},null,[],["seq",{sourceInterval:[324,362]},["opt",{sourceInterval:[324,328]},["terminal",{sourceInterval:[324,327]},"|"]],["app",{sourceInterval:[329,362]},"NonemptyListOf",[["app",{sourceInterval:[344,356]},"TopLevelTerm",[]],["terminal",{sourceInterval:[358,361]},"|"]]]]],TopLevelTerm_inline:["define",{sourceInterval:[385,408]},null,[],["seq",{sourceInterval:[385,397]},["app",{sourceInterval:[385,388]},"Seq",[]],["app",{sourceInterval:[389,397]},"caseName",[]]]],TopLevelTerm:["define",{sourceInterval:[366,418]},null,[],["alt",{sourceInterval:[385,418]},["app",{sourceInterval:[385,397]},"TopLevelTerm_inline",[]],["app",{sourceInterval:[415,418]},"Seq",[]]]],OverrideRuleBody:["define",{sourceInterval:[422,491]},null,[],["seq",{sourceInterval:[445,491]},["opt",{sourceInterval:[445,449]},["terminal",{sourceInterval:[445,448]},"|"]],["app",{sourceInterval:[450,491]},"NonemptyListOf",[["app",{sourceInterval:[465,485]},"OverrideTopLevelTerm",[]],["terminal",{sourceInterval:[487,490]},"|"]]]]],OverrideTopLevelTerm_superSplice:["define",{sourceInterval:[522,543]},null,[],["terminal",{sourceInterval:[522,527]},"..."]],OverrideTopLevelTerm:["define",{sourceInterval:[495,562]},null,[],["alt",{sourceInterval:[522,562]},["app",{sourceInterval:[522,527]},"OverrideTopLevelTerm_superSplice",[]],["app",{sourceInterval:[550,562]},"TopLevelTerm",[]]]],Formals:["define",{sourceInterval:[566,606]},null,[],["seq",{sourceInterval:[580,606]},["terminal",{sourceInterval:[580,583]},"<"],["app",{sourceInterval:[584,602]},"ListOf",[["app",{sourceInterval:[591,596]},"ident",[]],["terminal",{sourceInterval:[598,601]},","]]],["terminal",{sourceInterval:[603,606]},">"]]],Params:["define",{sourceInterval:[610,647]},null,[],["seq",{sourceInterval:[623,647]},["terminal",{sourceInterval:[623,626]},"<"],["app",{sourceInterval:[627,643]},"ListOf",[["app",{sourceInterval:[634,637]},"Seq",[]],["terminal",{sourceInterval:[639,642]},","]]],["terminal",{sourceInterval:[644,647]},">"]]],Alt:["define",{sourceInterval:[651,685]},null,[],["app",{sourceInterval:[661,685]},"NonemptyListOf",[["app",{sourceInterval:[676,679]},"Seq",[]],["terminal",{sourceInterval:[681,684]},"|"]]]],Seq:["define",{sourceInterval:[689,704]},null,[],["star",{sourceInterval:[699,704]},["app",{sourceInterval:[699,703]},"Iter",[]]]],Iter_star:["define",{sourceInterval:[719,736]},null,[],["seq",{sourceInterval:[719,727]},["app",{sourceInterval:[719,723]},"Pred",[]],["terminal",{sourceInterval:[724,727]},"*"]]],Iter_plus:["define",{sourceInterval:[743,760]},null,[],["seq",{sourceInterval:[743,751]},["app",{sourceInterval:[743,747]},"Pred",[]],["terminal",{sourceInterval:[748,751]},"+"]]],Iter_opt:["define",{sourceInterval:[767,783]},null,[],["seq",{sourceInterval:[767,775]},["app",{sourceInterval:[767,771]},"Pred",[]],["terminal",{sourceInterval:[772,775]},"?"]]],Iter:["define",{sourceInterval:[708,794]},null,[],["alt",{sourceInterval:[719,794]},["app",{sourceInterval:[719,727]},"Iter_star",[]],["app",{sourceInterval:[743,751]},"Iter_plus",[]],["app",{sourceInterval:[767,775]},"Iter_opt",[]],["app",{sourceInterval:[790,794]},"Pred",[]]]],Pred_not:["define",{sourceInterval:[809,824]},null,[],["seq",{sourceInterval:[809,816]},["terminal",{sourceInterval:[809,812]},"~"],["app",{sourceInterval:[813,816]},"Lex",[]]]],Pred_lookahead:["define",{sourceInterval:[831,852]},null,[],["seq",{sourceInterval:[831,838]},["terminal",{sourceInterval:[831,834]},"&"],["app",{sourceInterval:[835,838]},"Lex",[]]]],Pred:["define",{sourceInterval:[798,862]},null,[],["alt",{sourceInterval:[809,862]},["app",{sourceInterval:[809,816]},"Pred_not",[]],["app",{sourceInterval:[831,838]},"Pred_lookahead",[]],["app",{sourceInterval:[859,862]},"Lex",[]]]],Lex_lex:["define",{sourceInterval:[876,892]},null,[],["seq",{sourceInterval:[876,884]},["terminal",{sourceInterval:[876,879]},"#"],["app",{sourceInterval:[880,884]},"Base",[]]]],Lex:["define",{sourceInterval:[866,903]},null,[],["alt",{sourceInterval:[876,903]},["app",{sourceInterval:[876,884]},"Lex_lex",[]],["app",{sourceInterval:[899,903]},"Base",[]]]],Base_application:["define",{sourceInterval:[918,979]},null,[],["seq",{sourceInterval:[918,963]},["app",{sourceInterval:[918,923]},"ident",[]],["opt",{sourceInterval:[924,931]},["app",{sourceInterval:[924,930]},"Params",[]]],["not",{sourceInterval:[932,963]},["alt",{sourceInterval:[934,962]},["seq",{sourceInterval:[934,948]},["opt",{sourceInterval:[934,944]},["app",{sourceInterval:[934,943]},"ruleDescr",[]]],["terminal",{sourceInterval:[945,948]},"="]],["terminal",{sourceInterval:[951,955]},":="],["terminal",{sourceInterval:[958,962]},"+="]]]]],Base_range:["define",{sourceInterval:[986,1041]},null,[],["seq",{sourceInterval:[986,1022]},["app",{sourceInterval:[986,1001]},"oneCharTerminal",[]],["terminal",{sourceInterval:[1002,1006]},".."],["app",{sourceInterval:[1007,1022]},"oneCharTerminal",[]]]],Base_terminal:["define",{sourceInterval:[1048,1106]},null,[],["app",{sourceInterval:[1048,1056]},"terminal",[]]],Base_paren:["define",{sourceInterval:[1113,1168]},null,[],["seq",{sourceInterval:[1113,1124]},["terminal",{sourceInterval:[1113,1116]},"("],["app",{sourceInterval:[1117,1120]},"Alt",[]],["terminal",{sourceInterval:[1121,1124]},")"]]],Base:["define",{sourceInterval:[907,1168]},null,[],["alt",{sourceInterval:[918,1168]},["app",{sourceInterval:[918,963]},"Base_application",[]],["app",{sourceInterval:[986,1022]},"Base_range",[]],["app",{sourceInterval:[1048,1056]},"Base_terminal",[]],["app",{sourceInterval:[1113,1124]},"Base_paren",[]]]],ruleDescr:["define",{sourceInterval:[1172,1231]},"a rule description",[],["seq",{sourceInterval:[1210,1231]},["terminal",{sourceInterval:[1210,1213]},"("],["app",{sourceInterval:[1214,1227]},"ruleDescrText",[]],["terminal",{sourceInterval:[1228,1231]},")"]]],ruleDescrText:["define",{sourceInterval:[1235,1266]},null,[],["star",{sourceInterval:[1255,1266]},["seq",{sourceInterval:[1256,1264]},["not",{sourceInterval:[1256,1260]},["terminal",{sourceInterval:[1257,1260]},")"]],["app",{sourceInterval:[1261,1264]},"any",[]]]]],caseName:["define",{sourceInterval:[1270,1338]},null,[],["seq",{sourceInterval:[1285,1338]},["terminal",{sourceInterval:[1285,1289]},"--"],["star",{sourceInterval:[1290,1304]},["seq",{sourceInterval:[1291,1302]},["not",{sourceInterval:[1291,1296]},["terminal",{sourceInterval:[1292,1296]},`
`]],["app",{sourceInterval:[1297,1302]},"space",[]]]],["app",{sourceInterval:[1305,1309]},"name",[]],["star",{sourceInterval:[1310,1324]},["seq",{sourceInterval:[1311,1322]},["not",{sourceInterval:[1311,1316]},["terminal",{sourceInterval:[1312,1316]},`
`]],["app",{sourceInterval:[1317,1322]},"space",[]]]],["alt",{sourceInterval:[1326,1337]},["terminal",{sourceInterval:[1326,1330]},`
`],["lookahead",{sourceInterval:[1333,1337]},["terminal",{sourceInterval:[1334,1337]},"}"]]]]],name:["define",{sourceInterval:[1342,1382]},"a name",[],["seq",{sourceInterval:[1363,1382]},["app",{sourceInterval:[1363,1372]},"nameFirst",[]],["star",{sourceInterval:[1373,1382]},["app",{sourceInterval:[1373,1381]},"nameRest",[]]]]],nameFirst:["define",{sourceInterval:[1386,1418]},null,[],["alt",{sourceInterval:[1402,1418]},["terminal",{sourceInterval:[1402,1405]},"_"],["app",{sourceInterval:[1412,1418]},"letter",[]]]],nameRest:["define",{sourceInterval:[1422,1452]},null,[],["alt",{sourceInterval:[1437,1452]},["terminal",{sourceInterval:[1437,1440]},"_"],["app",{sourceInterval:[1447,1452]},"alnum",[]]]],ident:["define",{sourceInterval:[1456,1489]},"an identifier",[],["app",{sourceInterval:[1485,1489]},"name",[]]],terminal:["define",{sourceInterval:[1493,1531]},null,[],["seq",{sourceInterval:[1508,1531]},["terminal",{sourceInterval:[1508,1512]},'"'],["star",{sourceInterval:[1513,1526]},["app",{sourceInterval:[1513,1525]},"terminalChar",[]]],["terminal",{sourceInterval:[1527,1531]},'"']]],oneCharTerminal:["define",{sourceInterval:[1535,1579]},null,[],["seq",{sourceInterval:[1557,1579]},["terminal",{sourceInterval:[1557,1561]},'"'],["app",{sourceInterval:[1562,1574]},"terminalChar",[]],["terminal",{sourceInterval:[1575,1579]},'"']]],terminalChar:["define",{sourceInterval:[1583,1660]},null,[],["alt",{sourceInterval:[1602,1660]},["app",{sourceInterval:[1602,1612]},"escapeChar",[]],["seq",{sourceInterval:[1621,1660]},["not",{sourceInterval:[1621,1626]},["terminal",{sourceInterval:[1622,1626]},"\\"]],["not",{sourceInterval:[1627,1632]},["terminal",{sourceInterval:[1628,1632]},'"']],["not",{sourceInterval:[1633,1638]},["terminal",{sourceInterval:[1634,1638]},`
`]],["range",{sourceInterval:[1639,1660]},"\0","\u{10FFFF}"]]]],escapeChar_backslash:["define",{sourceInterval:[1703,1758]},null,[],["terminal",{sourceInterval:[1703,1709]},"\\\\"]],escapeChar_doubleQuote:["define",{sourceInterval:[1765,1822]},null,[],["terminal",{sourceInterval:[1765,1771]},'\\"']],escapeChar_singleQuote:["define",{sourceInterval:[1829,1886]},null,[],["terminal",{sourceInterval:[1829,1835]},"\\'"]],escapeChar_backspace:["define",{sourceInterval:[1893,1948]},null,[],["terminal",{sourceInterval:[1893,1898]},"\\b"]],escapeChar_lineFeed:["define",{sourceInterval:[1955,2009]},null,[],["terminal",{sourceInterval:[1955,1960]},"\\n"]],escapeChar_carriageReturn:["define",{sourceInterval:[2016,2076]},null,[],["terminal",{sourceInterval:[2016,2021]},"\\r"]],escapeChar_tab:["define",{sourceInterval:[2083,2132]},null,[],["terminal",{sourceInterval:[2083,2088]},"\\t"]],escapeChar_unicodeCodePoint:["define",{sourceInterval:[2139,2243]},null,[],["seq",{sourceInterval:[2139,2221]},["terminal",{sourceInterval:[2139,2145]},"\\u{"],["app",{sourceInterval:[2146,2154]},"hexDigit",[]],["opt",{sourceInterval:[2155,2164]},["app",{sourceInterval:[2155,2163]},"hexDigit",[]]],["opt",{sourceInterval:[2165,2174]},["app",{sourceInterval:[2165,2173]},"hexDigit",[]]],["opt",{sourceInterval:[2188,2197]},["app",{sourceInterval:[2188,2196]},"hexDigit",[]]],["opt",{sourceInterval:[2198,2207]},["app",{sourceInterval:[2198,2206]},"hexDigit",[]]],["opt",{sourceInterval:[2208,2217]},["app",{sourceInterval:[2208,2216]},"hexDigit",[]]],["terminal",{sourceInterval:[2218,2221]},"}"]]],escapeChar_unicodeEscape:["define",{sourceInterval:[2250,2309]},null,[],["seq",{sourceInterval:[2250,2291]},["terminal",{sourceInterval:[2250,2255]},"\\u"],["app",{sourceInterval:[2256,2264]},"hexDigit",[]],["app",{sourceInterval:[2265,2273]},"hexDigit",[]],["app",{sourceInterval:[2274,2282]},"hexDigit",[]],["app",{sourceInterval:[2283,2291]},"hexDigit",[]]]],escapeChar_hexEscape:["define",{sourceInterval:[2316,2371]},null,[],["seq",{sourceInterval:[2316,2339]},["terminal",{sourceInterval:[2316,2321]},"\\x"],["app",{sourceInterval:[2322,2330]},"hexDigit",[]],["app",{sourceInterval:[2331,2339]},"hexDigit",[]]]],escapeChar:["define",{sourceInterval:[1664,2371]},"an escape sequence",[],["alt",{sourceInterval:[1703,2371]},["app",{sourceInterval:[1703,1709]},"escapeChar_backslash",[]],["app",{sourceInterval:[1765,1771]},"escapeChar_doubleQuote",[]],["app",{sourceInterval:[1829,1835]},"escapeChar_singleQuote",[]],["app",{sourceInterval:[1893,1898]},"escapeChar_backspace",[]],["app",{sourceInterval:[1955,1960]},"escapeChar_lineFeed",[]],["app",{sourceInterval:[2016,2021]},"escapeChar_carriageReturn",[]],["app",{sourceInterval:[2083,2088]},"escapeChar_tab",[]],["app",{sourceInterval:[2139,2221]},"escapeChar_unicodeCodePoint",[]],["app",{sourceInterval:[2250,2291]},"escapeChar_unicodeEscape",[]],["app",{sourceInterval:[2316,2339]},"escapeChar_hexEscape",[]]]],space:["extend",{sourceInterval:[2375,2394]},null,[],["app",{sourceInterval:[2387,2394]},"comment",[]]],comment_singleLine:["define",{sourceInterval:[2412,2458]},null,[],["seq",{sourceInterval:[2412,2443]},["terminal",{sourceInterval:[2412,2416]},"//"],["star",{sourceInterval:[2417,2429]},["seq",{sourceInterval:[2418,2427]},["not",{sourceInterval:[2418,2423]},["terminal",{sourceInterval:[2419,2423]},`
`]],["app",{sourceInterval:[2424,2427]},"any",[]]]],["lookahead",{sourceInterval:[2430,2443]},["alt",{sourceInterval:[2432,2442]},["terminal",{sourceInterval:[2432,2436]},`
`],["app",{sourceInterval:[2439,2442]},"end",[]]]]]],comment_multiLine:["define",{sourceInterval:[2465,2501]},null,[],["seq",{sourceInterval:[2465,2487]},["terminal",{sourceInterval:[2465,2469]},"/*"],["star",{sourceInterval:[2470,2482]},["seq",{sourceInterval:[2471,2480]},["not",{sourceInterval:[2471,2476]},["terminal",{sourceInterval:[2472,2476]},"*/"]],["app",{sourceInterval:[2477,2480]},"any",[]]]],["terminal",{sourceInterval:[2483,2487]},"*/"]]],comment:["define",{sourceInterval:[2398,2501]},null,[],["alt",{sourceInterval:[2412,2501]},["app",{sourceInterval:[2412,2443]},"comment_singleLine",[]],["app",{sourceInterval:[2465,2487]},"comment_multiLine",[]]]],tokens:["define",{sourceInterval:[2505,2520]},null,[],["star",{sourceInterval:[2514,2520]},["app",{sourceInterval:[2514,2519]},"token",[]]]],token:["define",{sourceInterval:[2524,2600]},null,[],["alt",{sourceInterval:[2532,2600]},["app",{sourceInterval:[2532,2540]},"caseName",[]],["app",{sourceInterval:[2543,2550]},"comment",[]],["app",{sourceInterval:[2553,2558]},"ident",[]],["app",{sourceInterval:[2561,2569]},"operator",[]],["app",{sourceInterval:[2572,2583]},"punctuation",[]],["app",{sourceInterval:[2586,2594]},"terminal",[]],["app",{sourceInterval:[2597,2600]},"any",[]]]],operator:["define",{sourceInterval:[2604,2669]},null,[],["alt",{sourceInterval:[2615,2669]},["terminal",{sourceInterval:[2615,2619]},"<:"],["terminal",{sourceInterval:[2622,2625]},"="],["terminal",{sourceInterval:[2628,2632]},":="],["terminal",{sourceInterval:[2635,2639]},"+="],["terminal",{sourceInterval:[2642,2645]},"*"],["terminal",{sourceInterval:[2648,2651]},"+"],["terminal",{sourceInterval:[2654,2657]},"?"],["terminal",{sourceInterval:[2660,2663]},"~"],["terminal",{sourceInterval:[2666,2669]},"&"]]],punctuation:["define",{sourceInterval:[2673,2709]},null,[],["alt",{sourceInterval:[2687,2709]},["terminal",{sourceInterval:[2687,2690]},"<"],["terminal",{sourceInterval:[2693,2696]},">"],["terminal",{sourceInterval:[2699,2702]},","],["terminal",{sourceInterval:[2705,2709]},"--"]]]}]),FF=yy,Hp=dh,Lp=ey,Cy=Ft,hl=hs,Xp=Vo,Yp=Hs,OF=vF,{makeRecipe:kF}=gl,ph,pp=Object.create(Xp.PExpr.prototype),PF=t=>!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t);function Vp(t,e,r){let o=new FF,n,s,i,a=!1;return(r||ph).createSemantics().addOperation("visit",{Grammars(c){return c.children.map(h=>h.visit())},Grammar(c,h,d,g,m){let y=c.visit();n=o.newGrammar(y,e),h.child(0)&&h.child(0).visit(),g.children.map(b=>b.visit());let C=n.build();if(C.source=this.source.trimmed(),y in e)throw hl.duplicateGrammarDeclaration(C,e);return e[y]=C,C},SuperGrammar(c,h){let d=h.visit();if(d==="null")n.withSuperGrammar(null);else{if(!e||!(d in e))throw hl.undeclaredGrammar(d,e,h.source);n.withSuperGrammar(e[d])}},Rule_define(c,h,d,g,m){s=c.visit(),i=h.children.map(k=>k.visit())[0]||[],!n.defaultStartRule&&n.ensureSuperGrammar()!==Hp.ProtoBuiltInRules&&n.withDefaultStartRule(s);let y=m.visit(),C=d.children.map(k=>k.visit())[0],b=this.source.trimmed();return n.define(s,i,y,C,b)},Rule_override(c,h,d,g){s=c.visit(),i=h.children.map(C=>C.visit())[0]||[];let m=this.source.trimmed();n.ensureSuperGrammarRuleForOverriding(s,m),a=!0;let y=g.visit();return a=!1,n.override(s,i,y,null,m)},Rule_extend(c,h,d,g){s=c.visit(),i=h.children.map(C=>C.visit())[0]||[];let m=g.visit(),y=this.source.trimmed();return n.extend(s,i,m,null,y)},RuleBody(c,h){return o.alt(...h.visit()).withSource(this.source)},OverrideRuleBody(c,h){let d=h.visit(),g=d.indexOf(pp);if(g>=0){let m=d.slice(0,g),y=d.slice(g+1);return y.forEach(C=>{if(C===pp)throw hl.multipleSuperSplices(C)}),new Xp.Splice(n.superGrammar,s,m,y).withSource(this.source)}else return o.alt(...d).withSource(this.source)},Formals(c,h,d){return h.visit()},Params(c,h,d){return h.visit()},Alt(c){return o.alt(...c.visit()).withSource(this.source)},TopLevelTerm_inline(c,h){let d=s+"_"+h.visit(),g=c.visit(),m=this.source.trimmed(),y=!(n.superGrammar&&n.superGrammar.rules[d]);a&&!y?n.override(d,i,g,null,m):n.define(d,i,g,null,m);let C=i.map(b=>o.app(b));return o.app(d,C).withSource(g.source)},OverrideTopLevelTerm_superSplice(c){return pp},Seq(c){return o.seq(...c.children.map(h=>h.visit())).withSource(this.source)},Iter_star(c,h){return o.star(c.visit()).withSource(this.source)},Iter_plus(c,h){return o.plus(c.visit()).withSource(this.source)},Iter_opt(c,h){return o.opt(c.visit()).withSource(this.source)},Pred_not(c,h){return o.not(h.visit()).withSource(this.source)},Pred_lookahead(c,h){return o.lookahead(h.visit()).withSource(this.source)},Lex_lex(c,h){return o.lex(h.visit()).withSource(this.source)},Base_application(c,h){let d=h.children.map(g=>g.visit())[0]||[];return o.app(c.visit(),d).withSource(this.source)},Base_range(c,h,d){return o.range(c.visit(),d.visit()).withSource(this.source)},Base_terminal(c){return o.terminal(c.visit()).withSource(this.source)},Base_paren(c,h,d){return h.visit()},ruleDescr(c,h,d){return h.visit()},ruleDescrText(c){return this.sourceString.trim()},caseName(c,h,d,g,m){return d.visit()},name(c,h){return this.sourceString},nameFirst(c){},nameRest(c){},terminal(c,h,d){return h.children.map(g=>g.visit()).join("")},oneCharTerminal(c,h,d){return h.visit()},escapeChar(c){try{return Cy.unescapeCodePoint(this.sourceString)}catch(h){throw h instanceof RangeError&&h.message.startsWith("Invalid code point ")?hl.invalidCodePoint(c):h}},NonemptyListOf(c,h,d){return[c.visit()].concat(d.children.map(g=>g.visit()))},EmptyListOf(){return[]},_terminal(){return this.sourceString}})(t).visit()}function IF(t,e){let r=ph.match(t,"Grammars");if(r.failed())throw hl.grammarSyntaxError(r);return Vp(r,e)}function BF(t,e){let r=_y(t,e),o=Object.keys(r);if(o.length===0)throw new Error("Missing grammar definition");if(o.length>1){let s=r[o[1]].source;throw new Error(Yp.getLineAndColumnMessage(s.sourceString,s.startIdx)+"Found more than one grammar definition -- use ohm.grammars() instead.")}return r[o[0]]}function _y(t,e){let r=Lp.extend(Lp.asNamespace(e));if(typeof t!="string")if(PF(t))t=t.toString();else throw new TypeError("Expected string as first argument, got "+Cy.unexpectedObjToString(t));return IF(t,r),r}function LF(t){throw new Error("grammarFromScriptElement was removed in Ohm v16.0. See https://ohmjs.org/d/gfs for more info.")}function MF(t){throw new Error("grammarsFromScriptElements was removed in Ohm v16.0. See https://ohmjs.org/d/gfs for more info.")}fh.exports={createNamespace:Lp.createNamespace,grammar:BF,grammars:_y,grammarFromScriptElement:LF,grammarsFromScriptElements:MF,makeRecipe:kF,ohmGrammar:null,pexprs:Xp,util:Yp,version:OF};fh.exports._buildGrammar=Vp;Yp.announceBuiltInRules(Hp.BuiltInRules);fh.exports.ohmGrammar=ph=TF;Hp.initApplicationParser(ph,Vp);var wy=fh.exports,{assert:Xo}=Ft;function RF(t,e,r){return r(e[t])}function jF(t,e,r){return e[t].map(r)}function q1(t){let e=t.split(/ ?\[\]/);return e.length===2?jF.bind(null,e[0]):RF.bind(null,t)}function $1(t,e,r){return t.map(o=>o(e,r))}function NF(t){return typeof t=="string"?$1.bind(null,[q1(t)]):Array.isArray(t)?$1.bind(null,t.map(q1)):(Xo(typeof t=="function","Expected a string, Array, or function"),Xo(t.length===2,"Expected a function of arity 2, got "+t.length),t)}function K1(t){return/^[a-zA-Z_][0-9a-zA-Z_]*$/.test(t)}function J1(t){return t.trim()}function UF(t){let e=t.split(/[()]/).map(J1);if(e.length===3&&e[2]===""){let r=e[0],o=[];if(e[1].length>0&&(o=e[1].split(",").map(J1)),K1(r)&&o.every(K1))return{name:r,formals:o}}throw new Error("Invalid operation signature: "+t)}function gh(t){this._shapes=t.shapes,this._getTag=t.getTag,this.Adapter=function(e,r){this._adaptee=e,this._family=r},this.Adapter.prototype.valueOf=function(){throw new Error("heeey!")},this.operations={},this._arities=Object.create(null),this._getChildren=Object.create(null),Object.keys(this._shapes).forEach(e=>{let r=this._shapes[e];this._getChildren[e]=NF(r),typeof r!="function"&&(this._arities[e]=Array.isArray(r)?r.length:1)}),this._wrap=e=>new this.Adapter(e,this)}gh.prototype.wrap=function(t){return this._wrap(t)};gh.prototype._checkActionDict=function(t){Object.keys(t).forEach(e=>{Xo(e in this._getChildren,"Unrecognized action name '"+e+"'");let r=t[e];if(Xo(typeof r=="function","Key '"+e+"': expected function, got "+r),e in this._arities){let o=this._arities[e],n=t[e].length;Xo(n===o,"Action '"+e+"' has the wrong arity: expected "+o+", got "+n)}})};gh.prototype.addOperation=function(t,e){let r=UF(t),{name:o}=r;this._checkActionDict(e),this.operations[o]={name:o,formals:r.formals,actions:e};let n=this;return this.Adapter.prototype[o]=function(...s){let i=n._getTag(this._adaptee);Xo(i in n._getChildren,"getTag returned unrecognized tag '"+i+"'"),Xo(i in e,"No action for '"+i+"' in operation '"+o+"'");let a=Object.create(null);for(let[c,h]of Object.entries(s))a[r.formals[c]]=h;let l=this.args;this.args=a;let u=e[i].apply(this,n._getChildren[i](this._adaptee,n._wrap));return this.args=l,u},this};var zF=gh,Sy={_terminal(){return this.sourceString},_nonterminal(...t){let{ctorName:e}=this._node,{mapping:r}=this.args;if(!Object.prototype.hasOwnProperty.call(r,e)){if(this.isLexical())return this.sourceString;let s=t.filter(i=>!i.isTerminal());if(s.length===1)return s[0].toAST(r)}if(typeof r[e]=="number")return t[r[e]].toAST(r);let o=r[e]||t,n={type:e};for(let s in o){let i=r[e]&&r[e][s];typeof i=="number"?n[s]=t[i].toAST(r):typeof i=="string"||typeof i=="boolean"||i===null?n[s]=i:typeof i=="object"&&i instanceof Number?n[s]=Number(i):typeof i=="function"?n[s]=i.call(this,t):i===void 0&&(t[s]&&!t[s].isTerminal()?n[s]=t[s].toAST(r):delete n[s])}return n},_iter(...t){return this._node.isOptional()?this.numChildren===0?null:t[0].toAST(this.args.mapping):t.map(function(e){return e.toAST(this.args.mapping)},this)},NonemptyListOf(t,e,r){return[t.toAST(this.args.mapping)].concat(r.toAST(this.args.mapping))},EmptyListOf(){return[]}};function WF(t,e){if(typeof t.failed!="function"||t.failed())throw new Error("toAST() expects a succesful MatchResult as first parameter");e=Object.assign({},e);let r=Object.assign({},Sy);for(let s in e)typeof e[s]=="function"&&(r[s]=e[s],delete e[s]);return t._cst.grammar.createSemantics().addOperation("toAST(mapping)",r)(t).toAST(e)}function GF(t){if(typeof t.createSemantics!="function")throw new Error("semanticsToAST() expects a Grammar as parameter");return t.createSemantics().addOperation("toAST(mapping)",Sy)}var Q1={helper:WF,semantics:GF},VP={VisitorFamily:zF,semanticsForToAST:Q1.semantics,toAST:Q1.helper};var JP=wy.grammar(String.raw`
    StrRegArray {
        Exp = listOf<StrOrRegex, separator> separator*
        separator = (whitespace)* "," (whitespace)*
        StrOrRegex = (Regex | Str | "")
        Str = "\'" seqStr "\'"
        Regex =  "/" seqReg "/" (letter|lineTerminator)*
        seqReg = (("\\/" |"\\\\"|~("/")  any))+
        seqStr = (("\\\\"|"\\'"| ~("\'")  any))*
            
        // External rules
        whitespace = "\t"
                   | "\x0B"    -- verticalTab
                   | "\x0C"    -- formFeed
                   | " "
                   | "\u00A0"  -- noBreakSpace
                   | "\uFEFF"  -- byteOrderMark
                   | unicodeSpaceSeparator
         unicodeSpaceSeparator = "\u2000".."\u200B" | "\u3000"
         lineTerminator = "\n" | "\r" | "\u2028" | "\u2029"
      }`);var PO=Fr(Go()),IO=Fr(Vy());var BO=Fr(Go());var qy=Fr(Go());var Qw=Fr(zC());var TP=Fr(jw());var V4=Fr(Nw()),qw=Fr(Uw());function cP(t){for(var e=t.length,r=5381,o=52711,n;e--;)n=t.charCodeAt(e),r=r*33^n,o=o*33^n;return(r>>>0)*4096+(o>>>0)}var _c="|",hP=/\[object ([HTML|SVG](.*)Element)\]/,fP={"[object Arguments]":0,"[object Array]":1,"[object ArrayBuffer]":2,"[object AsyncFunction]":3,"[object AsyncGeneratorFunction]":4,"[object BigInt]":5,"[object BigInt64Array]":6,"[object BigUint64Array]":7,"[object Boolean]":8,"[object DataView]":9,"[object Date]":10,"[object DocumentFragment]":11,"[object Error]":12,"[object Event]":13,"[object Float32Array]":14,"[object Float64Array]":15,"[object Function]":16,"[object Generator]":17,"[object GeneratorFunction]":18,"[object Int8Array]":19,"[object Int16Array]":20,"[object Map]":21,"[object Number]":22,"[object Object]":23,"[object Promise]":24,"[object RegExp]":25,"[object Set]":26,"[object SharedArrayBuffer]":27,"[object String]":28,"[object Uint8Array]":29,"[object Uint8ClampedArray]":30,"[object Uint16Array]":31,"[object Uint32Array]":32,"[object WeakMap]":33,"[object WeakRef]":34,"[object WeakSet]":35,CUSTOM:36,ELEMENT:37},dP={"[object Arguments]":1,"[object Array]":2},Xw={"[object Generator]":1,"[object Promise]":2,"[object WeakMap]":3,"[object WeakRef]":4,"[object WeakSet]":5},pP={"[object AsyncFunction]":1,"[object AsyncGeneratorFunction]":2,"[object Boolean]":3,"[object Function]":4,"[object GeneratorFunction]":5,"[object Number]":6,"[object String]":7},gP={"[object BigInt64Array]":1,"[object BigUint64Array]":2,"[object Float32Array]":3,"[object Float64Array]":4,"[object Int8Array]":5,"[object Int16Array]":6,"[object Uint8Array]":7,"[object Uint8ClampedArray]":8,"[object Uint16Array]":9,"[object Uint32Array]":10},mP={"[object Arguments]":1,"[object Array]":2,"[object ArrayBuffer]":3,"[object BigInt64Array]":4,"[object BigUint64Array]":5,"[object DataView]":6,"[object Float32Array]":7,"[object Float64Array]":8,"[object Int8Array]":9,"[object Int16Array]":10,"[object Map]":11,"[object Object]":12,"[object Set]":13,"[object SharedArrayBuffer]":14,"[object Uint8Array]":15,"[object Uint8ClampedArray]":16,"[object Uint16Array]":17,"[object Uint32Array]":18,CUSTOM:19},Cc={bigint:"i",boolean:"b",empty:"e",function:"g",number:"n",object:"o",string:"s",symbol:"s"};function vP(t,e){return t[0]>e[0]}function Yw(t,e){return t>e}function wm(t,e){for(var r,o,n=0;n<t.length;++n){for(o=t[n],r=n-1;~r&&e(t[r],o);--r)t[r+1]=t[r];t[r+1]=o}return t}function xr(t,e){return Cc.object+_c+fP[t]+_c+e}var zw=new WeakMap,yP=0;function _m(t,e){var r=zw.get(t);if(r)return r;var o=xr(e,"NOT_ENUMERABLE"+_c+yP++);return zw.set(t,o),o}var CP=Object.prototype.toString;function _P(t,e,r){if(mP[e])return Ww(e,t,r);if(e==="[object Date]")return xr(e,t.getTime());if(e==="[object RegExp]")return xr(e,t.toString());if(e==="[object Event]")return xr(e,[t.bubbles,t.cancelBubble,t.cancelable,t.composed,t.currentTarget,t.defaultPrevented,t.eventPhase,t.isTrusted,t.returnValue,t.target,t.type].join());if(e==="[object Error]")return xr(e,t.message+_c+t.stack);if(e==="[object DocumentFragment]")return xr(e,DP(t));var o=e.match(hP);return o?xr("ELEMENT",o[1]+_c+t.outerHTML):Xw[e]?_m(t,e):pP[e]?xr(e,t.toString()):Ww("CUSTOM",t,r)}function Ww(t,e,r){var o=r.cache.get(e);return o?xr(t,"RECURSIVE~"+o):(r.cache.set(e,++r.id),t==="[object Object]"?e[Symbol.iterator]?_m(e,t):xr(t,Hw(e,r)):dP[t]?xr(t,wP(e,r)):t==="[object Map]"?xr(t,EP(e,r)):t==="[object Set]"?xr(t,AP(e,r)):gP[t]?xr(t,e.join()):t==="[object ArrayBuffer]"?xr(t,Gw(e)):t==="[object DataView]"?xr(t,Gw(e.buffer)):Xw[t]?_m(e,t):xr("CUSTOM",Hw(e,r)))}function wP(t,e){for(var r=t.length,o=new Array(r);--r>=0;)o[r]=Au(t[r],e);return o.join()}function SP(t){return Buffer.from(t).toString("utf8")}function bP(t){return String.fromCharCode.apply(null,new Uint16Array(t))}function xP(){return"UNSUPPORTED"}function DP(t){for(var e=t.children,r=e.length,o=new Array(r);--r>=0;)o[r]=e[r].outerHTML;return o.join()}var Gw=typeof Buffer<"u"&&typeof Buffer.from=="function"?SP:typeof Uint16Array=="function"?bP:xP;function EP(t,e){var r=new Array(t.size),o=0;for(t.forEach(function(n,s){r[o++]=[Au(s,e),Au(n,e)]}),wm(r,vP);--o>=0;)r[o]="["+r[o][0]+","+r[o][1]+"]";return"["+r.join()+"]"}function Hw(t,e){for(var r=wm(Object.getOwnPropertyNames(t),Yw),o=r.length,n=new Array(o),s=o;--s>=0;)n[s]=r[s]+":"+Au(t[r[s]],e);return"{"+n.join()+"}"}function AP(t,e){var r=new Array(t.size),o=0;return t.forEach(function(n){r[o++]=Au(n,e)}),"["+wm(r,Yw).join()+"]"}function Au(t,e){var r=typeof t;return t==null||r==="undefined"?Cc.empty+t:r==="object"?_P(t,CP.call(t),e||{cache:new WeakMap,id:1}):r==="function"||r==="symbol"?Cc[r]+t.toString():r==="boolean"?Cc.boolean+ +t:Cc[r]+t}function Vw(t){return cP(Au(t,void 0))}function st(t){return Vw(t)}var wc=Fr(uh());var Nf=Fr(uh());function Tu(t){return Nf.default.get(t,"uuid['$uuid$']",null)||Nf.default.get(t,"uuid.Wd",null)||Nf.default.get(t,"uuid",null)||null}var ot=new Map,mn=new qw.default,$w;(i=>{class t{static async getBlock(l,u={}){if(l=typeof l=="string"?l.toLowerCase():l,ot.has(st({operation:"getBlock",parameters:{srcBlock:l,opts:u}})))return ot.get(st({operation:"getBlock",parameters:{srcBlock:l,opts:u}}));if(ot.has(st({operation:"getBlock",parameters:{srcBlock:l,opts:wc.default.extend({includeChildren:!0},u)}})))return ot.get(st({operation:"getBlock",parameters:{srcBlock:l,opts:wc.default.extend({includeChildren:!0},u)}}));let c=null;await mn.acquireAsync();try{c=await logseq.Editor.getBlock(l,u),ot.set(st({operation:"getBlock",parameters:{srcBlock:l,opts:u}}),c);let h=null,d=null;if(c&&(h=Tu(c),d=c.id||null),c&&h!=null&&ot.set(st({operation:"getBlock",parameters:{srcBlock:h,opts:u}}),c),c&&d!=null&&ot.set(st({operation:"getBlock",parameters:{srcBlock:d,opts:u}}),c),c&&u&&u.includeChildren){let g=[...c.children];for(;g.length>0;){let m=g.pop();if(m==null)continue;let y=Tu(m),C=m.id||null;y!=null&&ot.set(st({operation:"getBlock",parameters:{srcBlock:y,opts:u}}),m),C!=null&&ot.set(st({operation:"getBlock",parameters:{srcBlock:C,opts:u}}),m),g.push(...m.children)}}}catch(h){console.error(h)}finally{mn.release()}return c}static async getBlocks(l){l=l.map(d=>typeof d=="string"?d.toLowerCase():d);let u=[],c=[];for(let d=0;d<l.length;d++)ot.has(st({operation:"getBlock",parameters:{srcBlock:l[d],opts:{}}}))?u[d]=ot.get(st({operation:"getBlock",parameters:{srcBlock:l[d],opts:{}}})):c.push(l[d]);c=[...new Set(c)];let h;c.length>0&&(h=await i.DB.datascriptQueryBlocks(`
                [:find (pull ?b [*])
                :where
                [?b :block/uuid ?uuid]
                [(contains? #{${c.map(d=>`#uuid "${d}" `)}} ?uuid)]
                ]`));for(let d=0,g=0;d<l.length&&g<h.length;d++)h[g][0]!=null&&u[d]==null&&(u[d]=h[g][0],g++);return u}static async getPage(l){if(l=typeof l=="string"?l.toLowerCase():l,ot.has(st({operation:"getPage",parameters:{srcPage:l}})))return ot.get(st({operation:"getPage",parameters:{srcPage:l}}));let u=null;await mn.acquireAsync();try{if(typeof l=="number"){u=await logseq.Editor.getPage(l),u=await logseq.Editor.getPage(u.name),ot.set(st({operation:"getPage",parameters:{srcPage:l}}),u);let c=wc.default.get(u,"originalName",null)||wc.default.get(u,"name",null);c=c.toLowerCase(),ot.set(st({operation:"getPage",parameters:{srcPage:c}}),u)}else u=await logseq.Editor.getPage(l),ot.set(st({operation:"getPage",parameters:{srcPage:l}}),u)}catch(c){console.error(c)}finally{mn.release()}return u}static async getPageBlocksTree(l){if(l=typeof l=="string"?l.toLowerCase():l,ot.has(st({operation:"getPageBlocksTree",parameters:{srcPage:l}})))return ot.get(st({operation:"getPageBlocksTree",parameters:{srcPage:l}}));let u=null;await mn.acquireAsync();try{u=await logseq.Editor.getPageBlocksTree(l),ot.set(st({operation:"getPageBlocksTree",parameters:{srcPage:l}}),u)}catch(c){console.error(c)}finally{mn.release()}return u}static async upsertBlockProperty(l,u,c){await mn.acquireAsync();try{await logseq.Editor.upsertBlockProperty(l,u,c)}catch(h){console.error(h)}finally{mn.release()}}static async createPageSilentlyIfNotExists(l){await mn.acquireAsync();try{await logseq.Editor.getPage(l)==null&&await logseq.Editor.createPage(l,{},{redirect:!1})}catch(u){console.error(u)}finally{mn.release()}}}i.Editor=t;class e{static async datascriptQuery(l,...u){let c;await mn.acquireAsync();try{c=await logseq.DB.datascriptQuery(l,...u)}catch(h){console.error(h)}finally{mn.release()}return c}static async datascriptQueryBlocks(l,...u){let c=[];await mn.acquireAsync();try{c=await logseq.DB.datascriptQuery(l,...u);for(let h of c){if(h=h[0],h==null||h==null)continue;let d=Tu(h),g=h.id||null;d!=null&&!ot.has(st({operation:"getBlock",parameters:{srcBlock:d,opts:{}}}))&&ot.set(st({operation:"getBlock",parameters:{srcBlock:d,opts:{}}}),h),g!=null&&!ot.has(st({operation:"getBlock",parameters:{srcBlock:g,opts:{}}}))&&ot.set(st({operation:"getBlock",parameters:{srcBlock:g,opts:{}}}),h)}}catch(h){console.error(h)}finally{mn.release()}return c}static{this.registeredDBListeners=[]}static registerDBChangeListener(l){this.registeredDBListeners.push(l)}}i.DB=e;class r{static useSettingsSchema(l){logseq.useSettingsSchema(l)}static{this.registeredSettingsChangeListeners=[]}static registerSettingsChangeListener(l){this.registeredSettingsChangeListeners.push(l)}}i.Settings=r;class o{static{this.registeredGraphChangeListeners=[]}static registerGraphChangeListener(l){this.registeredGraphChangeListeners.push(l)}static{this.registeredGraphIndexedListeners=[]}static registerGraphIndexedListener(l){this.registeredGraphIndexedListeners.push(l)}static{this.registerPluginUnloadListeners=[]}static registerPluginUnloadListener(l){this.registerPluginUnloadListeners.push(l)}}i.App=o;class n{static clear(){ot.clear()}static has(l){return ot.has(l)}}i.Cache=n;function s(){logseq.DB.onChanged(async({blocks:a,txData:l,txMeta:u})=>{for(let c of i.DB.registeredDBListeners)c({blocks:[...a],txData:l,txMeta:u})}),logseq.onSettingsChanged((a,l)=>{for(let u of i.Settings.registeredSettingsChangeListeners)u(a,l)}),logseq.App.onCurrentGraphChanged(a=>{for(let l of i.App.registeredGraphChangeListeners)l(a)}),logseq.App.onCurrentGraphIndexed(a=>{for(let l of i.App.registeredGraphIndexedListeners)l(a)}),logseq.beforeunload(async()=>{for(let a of i.App.registerPluginUnloadListeners)a()}),i.DB.registerDBChangeListener(async({blocks:a,txData:l,txMeta:u})=>{if(!logseq.settings.cacheLogseqAPIv1){i.Cache.clear();return}logseq.settings.debug.includes("blockAndPageHashCache.ts")&&console.log("Maintaining LogseqProxy Cache",[...a],l,u);for(let h of l){let[d,g,...m]=h;if(g!="left"&&g!="parent")continue;let y=await logseq.Editor.getBlock(d);y!=null&&a.push(y),y=await logseq.Editor.getBlock(m[0]),y!=null&&a.push(y)}let c=new Set;for(;a.length>0;){let h=a.pop();if(!c.has(h.id)){if(c.add(h.id),h.uuid=Tu(h),h.uuid!=null&&(h.uuid=h.uuid.toString().toLowerCase(),ot.delete(st({operation:"getBlock",parameters:{srcBlock:h.uuid,opts:{}}})),ot.delete(st({operation:"getBlock",parameters:{srcBlock:h.uuid,opts:{includeChildren:!0}}})),ot.delete(st({operation:"getPage",parameters:{srcPage:h.uuid}})),ot.delete(st({operation:"getPageBlocksTree",parameters:{srcPage:h.uuid}}))),h.page!=null&&h.page.id!=null){ot.delete(st({operation:"getPage",parameters:{srcPage:h.page.id}})),ot.delete(st({operation:"getPageBlocksTree",parameters:{srcPage:h.page.id}}));let d=await logseq.Editor.getPage(h.page.id);d.originalName!=null&&(d.originalName=d.originalName.toLowerCase(),ot.delete(st({operation:"getPage",parameters:{srcPage:d.originalName}})),ot.delete(st({operation:"getPageBlocksTree",parameters:{srcPage:d.originalName}}))),d.name!=null&&(d.name=d.name.toLowerCase(),ot.delete(st({operation:"getPage",parameters:{srcPage:d.name}})),ot.delete(st({operation:"getPageBlocksTree",parameters:{srcPage:d.name}})))}if(h.originalName!=null&&(h.originalName=h.originalName.toLowerCase(),ot.delete(st({operation:"getPage",parameters:{srcPage:h.originalName}})),ot.delete(st({operation:"getPageBlocksTree",parameters:{srcPage:h.originalName}}))),h.name!=null&&(h.name=h.name.toLowerCase(),ot.delete(st({operation:"getPage",parameters:{srcPage:h.name}})),ot.delete(st({operation:"getPageBlocksTree",parameters:{srcPage:h.name}}))),h.id!=null&&(ot.delete(st({operation:"getBlock",parameters:{srcBlock:h.id,opts:{includeChildren:!0}}})),ot.delete(st({operation:"getBlock",parameters:{srcBlock:h.id,opts:{}}})),ot.delete(st({operation:"getPage",parameters:{srcPage:h.id}})),ot.delete(st({operation:"getPageBlocksTree",parameters:{srcPage:h.id}}))),h.parent!=null&&h.parent.id!=null){let d=await logseq.Editor.getBlock(h.parent.id);d!=null&&a.push(d)}}}}),i.Settings.registerSettingsChangeListener((a,l)=>{a.cacheLogseqAPIv1||i.Cache.clear()}),i.App.registerGraphChangeListener(a=>{i.Cache.clear()}),i.App.registerGraphIndexedListener(a=>{i.Cache.clear()}),window.addEventListener("syncLogseqToAnkiComplete",()=>{logseq.settings.cacheLogseqAPIv1||i.Cache.clear()})}i.init=s})($w||={});if(!window.parent.fabric){let t=window.parent.document.createElement("script");t.innerHTML=Jw.default,window.parent.document.body.appendChild(t)}function Sm(t=0,e=0,r=80,o=40,n=0,s=1){let i=new window.parent.fabric.Rect({fill:"#FFEBA2",stroke:"#000",strokeWidth:1,strokeUniform:!0,noScaleCache:!1,opacity:.8,width:r,height:o,originX:"center",originY:"center"}),a=new window.parent.fabric.Text(`${s}`,{originX:"center",originY:"center"});return a.scaleToHeight(o),new window.parent.fabric.Group([i,a],{left:t,top:e,width:r,height:o,originX:"center",originY:"center",angle:n})}var Dm=Fr(hp()),bm=()=>{if(!document.getElementsByClassName("anki-card-front-side")[0]){console.log("Not front side of anki card");return}kP(),PP(),IP()};function kP(){if(window.type!=="image_occlusion")return;let t="-1";for(let i=1;i<=9;i++)document.getElementById(`c${i}`)&&(t=`${i}`);if(console.log(`Current cloze id: ${t}`),t=="-1"||!document.getElementById("localImgBasePath"))return;let e=document.getElementById("localImgBasePath").src;e=e.substring(0,e.lastIndexOf("/"));let r={},o=Array.from(document.getElementsByTagName("img"));for(let i of o){i.style.visibility="hidden";let a=document.createElement("canvas");a.width=i.width,a.height=i.height;let l=new xm.fabric.Canvas(a,{imageSmoothingEnabled:!1}),u=new Image;u.src=i.src,u.onload=function(){let c=new xm.fabric.Image(u),h=l.width/c.width,d=l.height/c.height;l.setViewportTransform([h,0,0,d,0,0]),l.setBackgroundImage(c,l.renderAll.bind(l),{scaleX:1,scaleY:1})},a.style.position="relative",i.replaceWith(a),r[i.src]==null&&(r[i.src]=[]),r[i.src].push(l)}document.getElementById("main-content").style.visibility="visible";let n=JSON.parse(document.getElementById("imgToOcclusionDataHashMap").innerHTML);for(let i in n){let a=n[i].elements,l=n[i].config;console.log(l),a.forEach(u=>{let c=r[e+"/"+Dm.default.basename(i)]||r[encodeURI(e+"/"+Dm.default.basename(i))]||r[i]||r[encodeURI(i)]||[];u.cId==t?c.forEach(h=>{let d=Sm(u.left,u.top,u.width,u.height,u.angle,u.cId);d._objects[0].set("opacity",1),h.add(d),h.renderAll()}):u.cId!=t&&l.hideAllTestOne==!0&&c.forEach(h=>{let d=Sm(u.left,u.top,u.width,u.height,u.angle,u.cId);d._objects[0].set("opacity",1),d._objects[0].set("fill","#3b4042"),d._objects[0].set("stroke","#2a3942"),d._objects[1].set("opacity",0),h.add(d),h.renderAll()})})}let s=Array.from(document.getElementsByTagName("canvas"));for(let i of s)i.classList.contains("lower-canvas")&&(i.style["user-select"]="inherit",i.style["touch-action"]="inherit")}function PP(){window.type!=="multiline_card"&&window.type!=="cloze"||document.getElementById("tags").getAttribute("tags_name").split(" ").includes("hide-all-test-one")&&[...document.getElementsByClassName("cloze-inactive")].forEach(t=>{function e(n){n.classList.contains("cloze-inactive-hidden")||(n.classList.add("cloze-inactive-hidden"),n.setAttribute("data-html-content",n.innerHTML),n.innerHTML="[...]",n.style.color="rgb(115, 115, 115)",n.style.cursor="pointer")}function r(n){n.classList.contains("cloze-inactive-hidden")&&(n.classList.remove("cloze-inactive-hidden"),n.innerHTML=n.getAttribute("data-html-content"))}function o(n){n.classList.contains("cloze-inactive-hidden")?r(n):e(n)}t.onclick=function(){o(t)},e(t)})}function IP(){localStorage.setItem("logseq-prev-typeans","");let t=document.getElementById("typeans");if(t==null)return;try{t.focus(),t.click()}catch{}try{let r=!1;t.addEventListener("focusin",async o=>{if(AnkiDroidJS&&(r||window.addEventListener("resize",()=>{r=!0}),await new Promise(n=>setTimeout(n,200)),!r)){let n=document.createElement("div");n.style.color="red",n.style.fontSize="small",n.style.marginTop="5px",n.style.textAlign="left",n.style.float="left",n.innerHTML=`Ankidroid doesn't support virtual keyboard by default. Please go to Settings > Advanced and enable "Type answer into the card".`,t.parentNode.appendChild(n)}})}catch{}let e=r=>{localStorage.setItem("logseq-prev-typeans",t.value)};t.onchange=e,t.onkeyup=e}document.readyState==="complete"&&bm(),window.addEventListener("load",bm);})();
/*! Bundled license information:

fabric/dist/fabric.js:
fabric/dist/fabric.js:
  (*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) *)

object-assign/index.js:
  (*
  object-assign
  (c) Sindre Sorhus
  @license MIT
  *)

react/cjs/react.production.min.js:
  (** @license React v17.0.2
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)

tabbable/dist/index.js:
  (*!
  * tabbable 6.2.0
  * @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
  *)

focus-trap/dist/focus-trap.js:
  (*!
  * focus-trap 7.5.4
  * @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
  *)

scheduler/cjs/scheduler.production.min.js:
  (** @license React v0.20.2
   * scheduler.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom.production.min.js:
  (** @license React v17.0.2
   * react-dom.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

@logseq/libs/dist/lsplugin.user.js:
  (*! For license information please see lsplugin.user.js.LICENSE.txt *)
*/
